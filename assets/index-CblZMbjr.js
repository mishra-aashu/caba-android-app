function Ux(i,n){for(var a=0;a<n.length;a++){const l=n[a];if(typeof l!="string"&&!Array.isArray(l)){for(const d in l)if(d!=="default"&&!(d in i)){const f=Object.getOwnPropertyDescriptor(l,d);f&&Object.defineProperty(i,d,f.get?f:{enumerable:!0,get:()=>l[d]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))l(d);new MutationObserver(d=>{for(const f of d)if(f.type==="childList")for(const x of f.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&l(x)}).observe(document,{childList:!0,subtree:!0});function a(d){const f={};return d.integrity&&(f.integrity=d.integrity),d.referrerPolicy&&(f.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?f.credentials="include":d.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function l(d){if(d.ep)return;d.ep=!0;const f=a(d);fetch(d.href,f)}})();var Cu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qu(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function zw(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var n=i.default;if(typeof n=="function"){var a=function l(){var d=!1;try{d=this instanceof l}catch{}return d?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};a.prototype=n.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(i).forEach(function(l){var d=Object.getOwnPropertyDescriptor(i,l);Object.defineProperty(a,l,d.get?d:{enumerable:!0,get:function(){return i[l]}})}),a}var tf={exports:{}},Hl={};var qm;function Fw(){if(qm)return Hl;qm=1;var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(l,d,f){var x=null;if(f!==void 0&&(x=""+f),d.key!==void 0&&(x=""+d.key),"key"in d){f={};for(var v in d)v!=="key"&&(f[v]=d[v])}else f=d;return d=f.ref,{$$typeof:i,type:l,key:x,ref:d!==void 0?d:null,props:f}}return Hl.Fragment=n,Hl.jsx=a,Hl.jsxs=a,Hl}var Vm;function Hw(){return Vm||(Vm=1,tf.exports=Fw()),tf.exports}var o=Hw(),nf={exports:{}},bt={};var Gm;function qw(){if(Gm)return bt;Gm=1;var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),f=Symbol.for("react.consumer"),x=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),w=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),R=Symbol.iterator;function T(ne){return ne===null||typeof ne!="object"?null:(ne=R&&ne[R]||ne["@@iterator"],typeof ne=="function"?ne:null)}var O={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},L=Object.assign,B={};function H(ne,ye,Le){this.props=ne,this.context=ye,this.refs=B,this.updater=Le||O}H.prototype.isReactComponent={},H.prototype.setState=function(ne,ye){if(typeof ne!="object"&&typeof ne!="function"&&ne!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ne,ye,"setState")},H.prototype.forceUpdate=function(ne){this.updater.enqueueForceUpdate(this,ne,"forceUpdate")};function U(){}U.prototype=H.prototype;function P(ne,ye,Le){this.props=ne,this.context=ye,this.refs=B,this.updater=Le||O}var K=P.prototype=new U;K.constructor=P,L(K,H.prototype),K.isPureReactComponent=!0;var Z=Array.isArray;function W(){}var X={H:null,A:null,T:null,S:null},J=Object.prototype.hasOwnProperty;function q(ne,ye,Le){var Ue=Le.ref;return{$$typeof:i,type:ne,key:ye,ref:Ue!==void 0?Ue:null,props:Le}}function he(ne,ye){return q(ne.type,ye,ne.props)}function ge(ne){return typeof ne=="object"&&ne!==null&&ne.$$typeof===i}function ie(ne){var ye={"=":"=0",":":"=2"};return"$"+ne.replace(/[=:]/g,function(Le){return ye[Le]})}var be=/\/+/g;function Ie(ne,ye){return typeof ne=="object"&&ne!==null&&ne.key!=null?ie(""+ne.key):ye.toString(36)}function V(ne){switch(ne.status){case"fulfilled":return ne.value;case"rejected":throw ne.reason;default:switch(typeof ne.status=="string"?ne.then(W,W):(ne.status="pending",ne.then(function(ye){ne.status==="pending"&&(ne.status="fulfilled",ne.value=ye)},function(ye){ne.status==="pending"&&(ne.status="rejected",ne.reason=ye)})),ne.status){case"fulfilled":return ne.value;case"rejected":throw ne.reason}}throw ne}function $(ne,ye,Le,Ue,We){var Ne=typeof ne;(Ne==="undefined"||Ne==="boolean")&&(ne=null);var $e=!1;if(ne===null)$e=!0;else switch(Ne){case"bigint":case"string":case"number":$e=!0;break;case"object":switch(ne.$$typeof){case i:case n:$e=!0;break;case A:return $e=ne._init,$($e(ne._payload),ye,Le,Ue,We)}}if($e)return We=We(ne),$e=Ue===""?"."+Ie(ne,0):Ue,Z(We)?(Le="",$e!=null&&(Le=$e.replace(be,"$&/")+"/"),$(We,ye,Le,"",function(Je){return Je})):We!=null&&(ge(We)&&(We=he(We,Le+(We.key==null||ne&&ne.key===We.key?"":(""+We.key).replace(be,"$&/")+"/")+$e)),ye.push(We)),1;$e=0;var De=Ue===""?".":Ue+":";if(Z(ne))for(var Ce=0;Ce<ne.length;Ce++)Ue=ne[Ce],Ne=De+Ie(Ue,Ce),$e+=$(Ue,ye,Le,Ne,We);else if(Ce=T(ne),typeof Ce=="function")for(ne=Ce.call(ne),Ce=0;!(Ue=ne.next()).done;)Ue=Ue.value,Ne=De+Ie(Ue,Ce++),$e+=$(Ue,ye,Le,Ne,We);else if(Ne==="object"){if(typeof ne.then=="function")return $(V(ne),ye,Le,Ue,We);throw ye=String(ne),Error("Objects are not valid as a React child (found: "+(ye==="[object Object]"?"object with keys {"+Object.keys(ne).join(", ")+"}":ye)+"). If you meant to render a collection of children, use an array instead.")}return $e}function oe(ne,ye,Le){if(ne==null)return ne;var Ue=[],We=0;return $(ne,Ue,"","",function(Ne){return ye.call(Le,Ne,We++)}),Ue}function ke(ne){if(ne._status===-1){var ye=ne._result;ye=ye(),ye.then(function(Le){(ne._status===0||ne._status===-1)&&(ne._status=1,ne._result=Le)},function(Le){(ne._status===0||ne._status===-1)&&(ne._status=2,ne._result=Le)}),ne._status===-1&&(ne._status=0,ne._result=ye)}if(ne._status===1)return ne._result.default;throw ne._result}var Ge=typeof reportError=="function"?reportError:function(ne){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ye=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ne=="object"&&ne!==null&&typeof ne.message=="string"?String(ne.message):String(ne),error:ne});if(!window.dispatchEvent(ye))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ne);return}console.error(ne)},Ke={map:oe,forEach:function(ne,ye,Le){oe(ne,function(){ye.apply(this,arguments)},Le)},count:function(ne){var ye=0;return oe(ne,function(){ye++}),ye},toArray:function(ne){return oe(ne,function(ye){return ye})||[]},only:function(ne){if(!ge(ne))throw Error("React.Children.only expected to receive a single React element child.");return ne}};return bt.Activity=N,bt.Children=Ke,bt.Component=H,bt.Fragment=a,bt.Profiler=d,bt.PureComponent=P,bt.StrictMode=l,bt.Suspense=C,bt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=X,bt.__COMPILER_RUNTIME={__proto__:null,c:function(ne){return X.H.useMemoCache(ne)}},bt.cache=function(ne){return function(){return ne.apply(null,arguments)}},bt.cacheSignal=function(){return null},bt.cloneElement=function(ne,ye,Le){if(ne==null)throw Error("The argument must be a React element, but you passed "+ne+".");var Ue=L({},ne.props),We=ne.key;if(ye!=null)for(Ne in ye.key!==void 0&&(We=""+ye.key),ye)!J.call(ye,Ne)||Ne==="key"||Ne==="__self"||Ne==="__source"||Ne==="ref"&&ye.ref===void 0||(Ue[Ne]=ye[Ne]);var Ne=arguments.length-2;if(Ne===1)Ue.children=Le;else if(1<Ne){for(var $e=Array(Ne),De=0;De<Ne;De++)$e[De]=arguments[De+2];Ue.children=$e}return q(ne.type,We,Ue)},bt.createContext=function(ne){return ne={$$typeof:x,_currentValue:ne,_currentValue2:ne,_threadCount:0,Provider:null,Consumer:null},ne.Provider=ne,ne.Consumer={$$typeof:f,_context:ne},ne},bt.createElement=function(ne,ye,Le){var Ue,We={},Ne=null;if(ye!=null)for(Ue in ye.key!==void 0&&(Ne=""+ye.key),ye)J.call(ye,Ue)&&Ue!=="key"&&Ue!=="__self"&&Ue!=="__source"&&(We[Ue]=ye[Ue]);var $e=arguments.length-2;if($e===1)We.children=Le;else if(1<$e){for(var De=Array($e),Ce=0;Ce<$e;Ce++)De[Ce]=arguments[Ce+2];We.children=De}if(ne&&ne.defaultProps)for(Ue in $e=ne.defaultProps,$e)We[Ue]===void 0&&(We[Ue]=$e[Ue]);return q(ne,Ne,We)},bt.createRef=function(){return{current:null}},bt.forwardRef=function(ne){return{$$typeof:v,render:ne}},bt.isValidElement=ge,bt.lazy=function(ne){return{$$typeof:A,_payload:{_status:-1,_result:ne},_init:ke}},bt.memo=function(ne,ye){return{$$typeof:w,type:ne,compare:ye===void 0?null:ye}},bt.startTransition=function(ne){var ye=X.T,Le={};X.T=Le;try{var Ue=ne(),We=X.S;We!==null&&We(Le,Ue),typeof Ue=="object"&&Ue!==null&&typeof Ue.then=="function"&&Ue.then(W,Ge)}catch(Ne){Ge(Ne)}finally{ye!==null&&Le.types!==null&&(ye.types=Le.types),X.T=ye}},bt.unstable_useCacheRefresh=function(){return X.H.useCacheRefresh()},bt.use=function(ne){return X.H.use(ne)},bt.useActionState=function(ne,ye,Le){return X.H.useActionState(ne,ye,Le)},bt.useCallback=function(ne,ye){return X.H.useCallback(ne,ye)},bt.useContext=function(ne){return X.H.useContext(ne)},bt.useDebugValue=function(){},bt.useDeferredValue=function(ne,ye){return X.H.useDeferredValue(ne,ye)},bt.useEffect=function(ne,ye){return X.H.useEffect(ne,ye)},bt.useEffectEvent=function(ne){return X.H.useEffectEvent(ne)},bt.useId=function(){return X.H.useId()},bt.useImperativeHandle=function(ne,ye,Le){return X.H.useImperativeHandle(ne,ye,Le)},bt.useInsertionEffect=function(ne,ye){return X.H.useInsertionEffect(ne,ye)},bt.useLayoutEffect=function(ne,ye){return X.H.useLayoutEffect(ne,ye)},bt.useMemo=function(ne,ye){return X.H.useMemo(ne,ye)},bt.useOptimistic=function(ne,ye){return X.H.useOptimistic(ne,ye)},bt.useReducer=function(ne,ye,Le){return X.H.useReducer(ne,ye,Le)},bt.useRef=function(ne){return X.H.useRef(ne)},bt.useState=function(ne){return X.H.useState(ne)},bt.useSyncExternalStore=function(ne,ye,Le){return X.H.useSyncExternalStore(ne,ye,Le)},bt.useTransition=function(){return X.H.useTransition()},bt.version="19.2.0",bt}var Ym;function p0(){return Ym||(Ym=1,nf.exports=qw()),nf.exports}var M=p0();const Px=Qu(M);var sf={exports:{}},ql={},af={exports:{}},rf={};var Xm;function Vw(){return Xm||(Xm=1,(function(i){function n($,oe){var ke=$.length;$.push(oe);e:for(;0<ke;){var Ge=ke-1>>>1,Ke=$[Ge];if(0<d(Ke,oe))$[Ge]=oe,$[ke]=Ke,ke=Ge;else break e}}function a($){return $.length===0?null:$[0]}function l($){if($.length===0)return null;var oe=$[0],ke=$.pop();if(ke!==oe){$[0]=ke;e:for(var Ge=0,Ke=$.length,ne=Ke>>>1;Ge<ne;){var ye=2*(Ge+1)-1,Le=$[ye],Ue=ye+1,We=$[Ue];if(0>d(Le,ke))Ue<Ke&&0>d(We,Le)?($[Ge]=We,$[Ue]=ke,Ge=Ue):($[Ge]=Le,$[ye]=ke,Ge=ye);else if(Ue<Ke&&0>d(We,ke))$[Ge]=We,$[Ue]=ke,Ge=Ue;else break e}}return oe}function d($,oe){var ke=$.sortIndex-oe.sortIndex;return ke!==0?ke:$.id-oe.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var f=performance;i.unstable_now=function(){return f.now()}}else{var x=Date,v=x.now();i.unstable_now=function(){return x.now()-v}}var C=[],w=[],A=1,N=null,R=3,T=!1,O=!1,L=!1,B=!1,H=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function K($){for(var oe=a(w);oe!==null;){if(oe.callback===null)l(w);else if(oe.startTime<=$)l(w),oe.sortIndex=oe.expirationTime,n(C,oe);else break;oe=a(w)}}function Z($){if(L=!1,K($),!O)if(a(C)!==null)O=!0,W||(W=!0,ie());else{var oe=a(w);oe!==null&&V(Z,oe.startTime-$)}}var W=!1,X=-1,J=5,q=-1;function he(){return B?!0:!(i.unstable_now()-q<J)}function ge(){if(B=!1,W){var $=i.unstable_now();q=$;var oe=!0;try{e:{O=!1,L&&(L=!1,U(X),X=-1),T=!0;var ke=R;try{t:{for(K($),N=a(C);N!==null&&!(N.expirationTime>$&&he());){var Ge=N.callback;if(typeof Ge=="function"){N.callback=null,R=N.priorityLevel;var Ke=Ge(N.expirationTime<=$);if($=i.unstable_now(),typeof Ke=="function"){N.callback=Ke,K($),oe=!0;break t}N===a(C)&&l(C),K($)}else l(C);N=a(C)}if(N!==null)oe=!0;else{var ne=a(w);ne!==null&&V(Z,ne.startTime-$),oe=!1}}break e}finally{N=null,R=ke,T=!1}oe=void 0}}finally{oe?ie():W=!1}}}var ie;if(typeof P=="function")ie=function(){P(ge)};else if(typeof MessageChannel<"u"){var be=new MessageChannel,Ie=be.port2;be.port1.onmessage=ge,ie=function(){Ie.postMessage(null)}}else ie=function(){H(ge,0)};function V($,oe){X=H(function(){$(i.unstable_now())},oe)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function($){$.callback=null},i.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<$?Math.floor(1e3/$):5},i.unstable_getCurrentPriorityLevel=function(){return R},i.unstable_next=function($){switch(R){case 1:case 2:case 3:var oe=3;break;default:oe=R}var ke=R;R=oe;try{return $()}finally{R=ke}},i.unstable_requestPaint=function(){B=!0},i.unstable_runWithPriority=function($,oe){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var ke=R;R=$;try{return oe()}finally{R=ke}},i.unstable_scheduleCallback=function($,oe,ke){var Ge=i.unstable_now();switch(typeof ke=="object"&&ke!==null?(ke=ke.delay,ke=typeof ke=="number"&&0<ke?Ge+ke:Ge):ke=Ge,$){case 1:var Ke=-1;break;case 2:Ke=250;break;case 5:Ke=1073741823;break;case 4:Ke=1e4;break;default:Ke=5e3}return Ke=ke+Ke,$={id:A++,callback:oe,priorityLevel:$,startTime:ke,expirationTime:Ke,sortIndex:-1},ke>Ge?($.sortIndex=ke,n(w,$),a(C)===null&&$===a(w)&&(L?(U(X),X=-1):L=!0,V(Z,ke-Ge))):($.sortIndex=Ke,n(C,$),O||T||(O=!0,W||(W=!0,ie()))),$},i.unstable_shouldYield=he,i.unstable_wrapCallback=function($){var oe=R;return function(){var ke=R;R=oe;try{return $.apply(this,arguments)}finally{R=ke}}}})(rf)),rf}var Wm;function Gw(){return Wm||(Wm=1,af.exports=Vw()),af.exports}var of={exports:{}},Cs={};var Qm;function Yw(){if(Qm)return Cs;Qm=1;var i=p0();function n(C){var w="https://react.dev/errors/"+C;if(1<arguments.length){w+="?args[]="+encodeURIComponent(arguments[1]);for(var A=2;A<arguments.length;A++)w+="&args[]="+encodeURIComponent(arguments[A])}return"Minified React error #"+C+"; visit "+w+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var l={d:{f:a,r:function(){throw Error(n(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},d=Symbol.for("react.portal");function f(C,w,A){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:N==null?null:""+N,children:C,containerInfo:w,implementation:A}}var x=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function v(C,w){if(C==="font")return"";if(typeof w=="string")return w==="use-credentials"?w:""}return Cs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,Cs.createPortal=function(C,w){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!w||w.nodeType!==1&&w.nodeType!==9&&w.nodeType!==11)throw Error(n(299));return f(C,w,null,A)},Cs.flushSync=function(C){var w=x.T,A=l.p;try{if(x.T=null,l.p=2,C)return C()}finally{x.T=w,l.p=A,l.d.f()}},Cs.preconnect=function(C,w){typeof C=="string"&&(w?(w=w.crossOrigin,w=typeof w=="string"?w==="use-credentials"?w:"":void 0):w=null,l.d.C(C,w))},Cs.prefetchDNS=function(C){typeof C=="string"&&l.d.D(C)},Cs.preinit=function(C,w){if(typeof C=="string"&&w&&typeof w.as=="string"){var A=w.as,N=v(A,w.crossOrigin),R=typeof w.integrity=="string"?w.integrity:void 0,T=typeof w.fetchPriority=="string"?w.fetchPriority:void 0;A==="style"?l.d.S(C,typeof w.precedence=="string"?w.precedence:void 0,{crossOrigin:N,integrity:R,fetchPriority:T}):A==="script"&&l.d.X(C,{crossOrigin:N,integrity:R,fetchPriority:T,nonce:typeof w.nonce=="string"?w.nonce:void 0})}},Cs.preinitModule=function(C,w){if(typeof C=="string")if(typeof w=="object"&&w!==null){if(w.as==null||w.as==="script"){var A=v(w.as,w.crossOrigin);l.d.M(C,{crossOrigin:A,integrity:typeof w.integrity=="string"?w.integrity:void 0,nonce:typeof w.nonce=="string"?w.nonce:void 0})}}else w==null&&l.d.M(C)},Cs.preload=function(C,w){if(typeof C=="string"&&typeof w=="object"&&w!==null&&typeof w.as=="string"){var A=w.as,N=v(A,w.crossOrigin);l.d.L(C,A,{crossOrigin:N,integrity:typeof w.integrity=="string"?w.integrity:void 0,nonce:typeof w.nonce=="string"?w.nonce:void 0,type:typeof w.type=="string"?w.type:void 0,fetchPriority:typeof w.fetchPriority=="string"?w.fetchPriority:void 0,referrerPolicy:typeof w.referrerPolicy=="string"?w.referrerPolicy:void 0,imageSrcSet:typeof w.imageSrcSet=="string"?w.imageSrcSet:void 0,imageSizes:typeof w.imageSizes=="string"?w.imageSizes:void 0,media:typeof w.media=="string"?w.media:void 0})}},Cs.preloadModule=function(C,w){if(typeof C=="string")if(w){var A=v(w.as,w.crossOrigin);l.d.m(C,{as:typeof w.as=="string"&&w.as!=="script"?w.as:void 0,crossOrigin:A,integrity:typeof w.integrity=="string"?w.integrity:void 0})}else l.d.m(C)},Cs.requestFormReset=function(C){l.d.r(C)},Cs.unstable_batchedUpdates=function(C,w){return C(w)},Cs.useFormState=function(C,w,A){return x.H.useFormState(C,w,A)},Cs.useFormStatus=function(){return x.H.useHostTransitionStatus()},Cs.version="19.2.0",Cs}var Km;function Xw(){if(Km)return of.exports;Km=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),of.exports=Yw(),of.exports}var Zm;function Ww(){if(Zm)return ql;Zm=1;var i=Gw(),n=p0(),a=Xw();function l(e){var s="https://react.dev/errors/"+e;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)s+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+e+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function d(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function f(e){var s=e,u=e;if(e.alternate)for(;s.return;)s=s.return;else{e=s;do s=e,(s.flags&4098)!==0&&(u=s.return),e=s.return;while(e)}return s.tag===3?u:null}function x(e){if(e.tag===13){var s=e.memoizedState;if(s===null&&(e=e.alternate,e!==null&&(s=e.memoizedState)),s!==null)return s.dehydrated}return null}function v(e){if(e.tag===31){var s=e.memoizedState;if(s===null&&(e=e.alternate,e!==null&&(s=e.memoizedState)),s!==null)return s.dehydrated}return null}function C(e){if(f(e)!==e)throw Error(l(188))}function w(e){var s=e.alternate;if(!s){if(s=f(e),s===null)throw Error(l(188));return s!==e?null:e}for(var u=e,m=s;;){var b=u.return;if(b===null)break;var S=b.alternate;if(S===null){if(m=b.return,m!==null){u=m;continue}break}if(b.child===S.child){for(S=b.child;S;){if(S===u)return C(b),e;if(S===m)return C(b),s;S=S.sibling}throw Error(l(188))}if(u.return!==m.return)u=b,m=S;else{for(var I=!1,F=b.child;F;){if(F===u){I=!0,u=b,m=S;break}if(F===m){I=!0,m=b,u=S;break}F=F.sibling}if(!I){for(F=S.child;F;){if(F===u){I=!0,u=S,m=b;break}if(F===m){I=!0,m=S,u=b;break}F=F.sibling}if(!I)throw Error(l(189))}}if(u.alternate!==m)throw Error(l(190))}if(u.tag!==3)throw Error(l(188));return u.stateNode.current===u?e:s}function A(e){var s=e.tag;if(s===5||s===26||s===27||s===6)return e;for(e=e.child;e!==null;){if(s=A(e),s!==null)return s;e=e.sibling}return null}var N=Object.assign,R=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),O=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),P=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),he=Symbol.for("react.memo_cache_sentinel"),ge=Symbol.iterator;function ie(e){return e===null||typeof e!="object"?null:(e=ge&&e[ge]||e["@@iterator"],typeof e=="function"?e:null)}var be=Symbol.for("react.client.reference");function Ie(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===be?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case L:return"Fragment";case H:return"Profiler";case B:return"StrictMode";case Z:return"Suspense";case W:return"SuspenseList";case q:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case O:return"Portal";case P:return e.displayName||"Context";case U:return(e._context.displayName||"Context")+".Consumer";case K:var s=e.render;return e=e.displayName,e||(e=s.displayName||s.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case X:return s=e.displayName||null,s!==null?s:Ie(e.type)||"Memo";case J:s=e._payload,e=e._init;try{return Ie(e(s))}catch{}}return null}var V=Array.isArray,$=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ke={pending:!1,data:null,method:null,action:null},Ge=[],Ke=-1;function ne(e){return{current:e}}function ye(e){0>Ke||(e.current=Ge[Ke],Ge[Ke]=null,Ke--)}function Le(e,s){Ke++,Ge[Ke]=e.current,e.current=s}var Ue=ne(null),We=ne(null),Ne=ne(null),$e=ne(null);function De(e,s){switch(Le(Ne,s),Le(We,e),Le(Ue,null),s.nodeType){case 9:case 11:e=(e=s.documentElement)&&(e=e.namespaceURI)?hm(e):0;break;default:if(e=s.tagName,s=s.namespaceURI)s=hm(s),e=fm(s,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}ye(Ue),Le(Ue,e)}function Ce(){ye(Ue),ye(We),ye(Ne)}function Je(e){e.memoizedState!==null&&Le($e,e);var s=Ue.current,u=fm(s,e.type);s!==u&&(Le(We,e),Le(Ue,u))}function mt(e){We.current===e&&(ye(Ue),ye(We)),$e.current===e&&(ye($e),Ul._currentValue=ke)}var Wt,ft;function Mt(e){if(Wt===void 0)try{throw Error()}catch(u){var s=u.stack.trim().match(/\n( *(at )?)/);Wt=s&&s[1]||"",ft=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Wt+e+ft}var xn=!1;function cn(e,s){if(!e||xn)return"";xn=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(s){var Ae=function(){throw Error()};if(Object.defineProperty(Ae.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ae,[])}catch(we){var fe=we}Reflect.construct(e,[],Ae)}else{try{Ae.call()}catch(we){fe=we}e.call(Ae.prototype)}}else{try{throw Error()}catch(we){fe=we}(Ae=e())&&typeof Ae.catch=="function"&&Ae.catch(function(){})}}catch(we){if(we&&fe&&typeof we.stack=="string")return[we.stack,fe.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=m.DetermineComponentFrameRoot(),I=S[0],F=S[1];if(I&&F){var ee=I.split(`
`),de=F.split(`
`);for(b=m=0;m<ee.length&&!ee[m].includes("DetermineComponentFrameRoot");)m++;for(;b<de.length&&!de[b].includes("DetermineComponentFrameRoot");)b++;if(m===ee.length||b===de.length)for(m=ee.length-1,b=de.length-1;1<=m&&0<=b&&ee[m]!==de[b];)b--;for(;1<=m&&0<=b;m--,b--)if(ee[m]!==de[b]){if(m!==1||b!==1)do if(m--,b--,0>b||ee[m]!==de[b]){var ve=`
`+ee[m].replace(" at new "," at ");return e.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",e.displayName)),ve}while(1<=m&&0<=b);break}}}finally{xn=!1,Error.prepareStackTrace=u}return(u=e?e.displayName||e.name:"")?Mt(u):""}function qt(e,s){switch(e.tag){case 26:case 27:case 5:return Mt(e.type);case 16:return Mt("Lazy");case 13:return e.child!==s&&s!==null?Mt("Suspense Fallback"):Mt("Suspense");case 19:return Mt("SuspenseList");case 0:case 15:return cn(e.type,!1);case 11:return cn(e.type.render,!1);case 1:return cn(e.type,!0);case 31:return Mt("Activity");default:return""}}function Nt(e){try{var s="",u=null;do s+=qt(e,u),u=e,e=e.return;while(e);return s}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}var ht=Object.prototype.hasOwnProperty,Hn=i.unstable_scheduleCallback,ze=i.unstable_cancelCallback,Is=i.unstable_shouldYield,Me=i.unstable_requestPaint,Fe=i.unstable_now,nt=i.unstable_getCurrentPriorityLevel,_t=i.unstable_ImmediatePriority,Tn=i.unstable_UserBlockingPriority,sn=i.unstable_NormalPriority,Vt=i.unstable_LowPriority,qn=i.unstable_IdlePriority,jn=i.log,ts=i.unstable_setDisableYieldValue,Ut=null,je=null;function lt(e){if(typeof jn=="function"&&ts(e),je&&typeof je.setStrictMode=="function")try{je.setStrictMode(Ut,e)}catch{}}var gt=Math.clz32?Math.clz32:va,Qt=Math.log,Os=Math.LN2;function va(e){return e>>>=0,e===0?32:31-(Qt(e)/Os|0)|0}var qs=256,wt=262144,Rn=4194304;function me(e){var s=e&42;if(s!==0)return s;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function qe(e,s,u){var m=e.pendingLanes;if(m===0)return 0;var b=0,S=e.suspendedLanes,I=e.pingedLanes;e=e.warmLanes;var F=m&134217727;return F!==0?(m=F&~S,m!==0?b=me(m):(I&=F,I!==0?b=me(I):u||(u=F&~e,u!==0&&(b=me(u))))):(F=m&~S,F!==0?b=me(F):I!==0?b=me(I):u||(u=m&~e,u!==0&&(b=me(u)))),b===0?0:s!==0&&s!==b&&(s&S)===0&&(S=b&-b,u=s&-s,S>=u||S===32&&(u&4194048)!==0)?s:b}function ct(e,s){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&s)===0}function an(e,s){switch(e){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pt(){var e=Rn;return Rn<<=1,(Rn&62914560)===0&&(Rn=4194304),e}function In(e){for(var s=[],u=0;31>u;u++)s.push(e);return s}function G(e,s){e.pendingLanes|=s,s!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Te(e,s,u,m,b,S){var I=e.pendingLanes;e.pendingLanes=u,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=u,e.entangledLanes&=u,e.errorRecoveryDisabledLanes&=u,e.shellSuspendCounter=0;var F=e.entanglements,ee=e.expirationTimes,de=e.hiddenUpdates;for(u=I&~u;0<u;){var ve=31-gt(u),Ae=1<<ve;F[ve]=0,ee[ve]=-1;var fe=de[ve];if(fe!==null)for(de[ve]=null,ve=0;ve<fe.length;ve++){var we=fe[ve];we!==null&&(we.lane&=-536870913)}u&=~Ae}m!==0&&jt(e,m,0),S!==0&&b===0&&e.tag!==0&&(e.suspendedLanes|=S&~(I&~s))}function jt(e,s,u){e.pendingLanes|=s,e.suspendedLanes&=~s;var m=31-gt(s);e.entangledLanes|=s,e.entanglements[m]=e.entanglements[m]|1073741824|u&261930}function On(e,s){var u=e.entangledLanes|=s;for(e=e.entanglements;u;){var m=31-gt(u),b=1<<m;b&s|e[m]&s&&(e[m]|=s),u&=~b}}function hs(e,s){var u=s&-s;return u=(u&42)!==0?1:yn(u),(u&(e.suspendedLanes|s))!==0?0:u}function yn(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Kt(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function ns(){var e=oe.p;return e!==0?e:(e=window.event,e===void 0?32:Lm(e.type))}function He(e,s){var u=oe.p;try{return oe.p=e,s()}finally{oe.p=u}}var fs=Math.random().toString(36).slice(2),Ee="__reactFiber$"+fs,_e="__reactProps$"+fs,Ve="__reactContainer$"+fs,Dn="__reactEvents$"+fs,Vs="__reactListeners$"+fs,gs="__reactHandles$"+fs,Ki="__reactResources$"+fs,gi="__reactMarker$"+fs;function Ms(e){delete e[Ee],delete e[_e],delete e[Dn],delete e[Vs],delete e[gs]}function Ln(e){var s=e[Ee];if(s)return s;for(var u=e.parentNode;u;){if(s=u[Ve]||u[Ee]){if(u=s.alternate,s.child!==null||u!==null&&u.child!==null)for(e=bm(e);e!==null;){if(u=e[Ee])return u;e=bm(e)}return s}e=u,u=e.parentNode}return null}function Zt(e){if(e=e[Ee]||e[Ve]){var s=e.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return e}return null}function _r(e){var s=e.tag;if(s===5||s===26||s===27||s===6)return e.stateNode;throw Error(l(33))}function Ss(e){var s=e[Ki];return s||(s=e[Ki]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Bn(e){e[gi]=!0}var Re=new Set,oc={};function en(e,s){Gs(e,s),Gs(e+"Capture",s)}function Gs(e,s){for(oc[e]=s,e=0;e<s.length;e++)Re.add(s[e])}var od=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ht={},Ft={};function Rt(e){return ht.call(Ft,e)?!0:ht.call(Ht,e)?!1:od.test(e)?Ft[e]=!0:(Ht[e]=!0,!1)}function Sr(e,s,u){if(Rt(s))if(u===null)e.removeAttribute(s);else{switch(typeof u){case"undefined":case"function":case"symbol":e.removeAttribute(s);return;case"boolean":var m=s.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){e.removeAttribute(s);return}}e.setAttribute(s,""+u)}}function Er(e,s,u){if(u===null)e.removeAttribute(s);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(s);return}e.setAttribute(s,""+u)}}function Ys(e,s,u,m){if(m===null)e.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(u);return}e.setAttributeNS(s,u,""+m)}}function Gt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ca(e){var s=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function ld(e,s,u){var m=Object.getOwnPropertyDescriptor(e.constructor.prototype,s);if(!e.hasOwnProperty(s)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var b=m.get,S=m.set;return Object.defineProperty(e,s,{configurable:!0,get:function(){return b.call(this)},set:function(I){u=""+I,S.call(this,I)}}),Object.defineProperty(e,s,{enumerable:m.enumerable}),{getValue:function(){return u},setValue:function(I){u=""+I},stopTracking:function(){e._valueTracker=null,delete e[s]}}}}function bn(e){if(!e._valueTracker){var s=Ca(e)?"checked":"value";e._valueTracker=ld(e,s,""+e[s])}}function _a(e){if(!e)return!1;var s=e._valueTracker;if(!s)return!0;var u=s.getValue(),m="";return e&&(m=Ca(e)?e.checked?"true":"false":e.value),e=m,e!==u?(s.setValue(e),!0):!1}function Zi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Ar=/[\n"\\]/g;function Tt(e){return e.replace(Ar,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Wn(e,s,u,m,b,S,I,F){e.name="",I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?e.type=I:e.removeAttribute("type"),s!=null?I==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+Gt(s)):e.value!==""+Gt(s)&&(e.value=""+Gt(s)):I!=="submit"&&I!=="reset"||e.removeAttribute("value"),s!=null?Y(e,I,Gt(s)):u!=null?Y(e,I,Gt(u)):m!=null&&e.removeAttribute("value"),b==null&&S!=null&&(e.defaultChecked=!!S),b!=null&&(e.checked=b&&typeof b!="function"&&typeof b!="symbol"),F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?e.name=""+Gt(F):e.removeAttribute("name")}function ce(e,s,u,m,b,S,I,F){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(e.type=S),s!=null||u!=null){if(!(S!=="submit"&&S!=="reset"||s!=null)){bn(e);return}u=u!=null?""+Gt(u):"",s=s!=null?""+Gt(s):u,F||s===e.value||(e.value=s),e.defaultValue=s}m=m??b,m=typeof m!="function"&&typeof m!="symbol"&&!!m,e.checked=F?e.checked:!!m,e.defaultChecked=!!m,I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(e.name=I),bn(e)}function Y(e,s,u){s==="number"&&Zi(e.ownerDocument)===e||e.defaultValue===""+u||(e.defaultValue=""+u)}function Ze(e,s,u,m){if(e=e.options,s){s={};for(var b=0;b<u.length;b++)s["$"+u[b]]=!0;for(u=0;u<e.length;u++)b=s.hasOwnProperty("$"+e[u].value),e[u].selected!==b&&(e[u].selected=b),b&&m&&(e[u].defaultSelected=!0)}else{for(u=""+Gt(u),s=null,b=0;b<e.length;b++){if(e[b].value===u){e[b].selected=!0,m&&(e[b].defaultSelected=!0);return}s!==null||e[b].disabled||(s=e[b])}s!==null&&(s.selected=!0)}}function Vn(e,s,u){if(s!=null&&(s=""+Gt(s),s!==e.value&&(e.value=s),u==null)){e.defaultValue!==s&&(e.defaultValue=s);return}e.defaultValue=u!=null?""+Gt(u):""}function Es(e,s,u,m){if(s==null){if(m!=null){if(u!=null)throw Error(l(92));if(V(m)){if(1<m.length)throw Error(l(93));m=m[0]}u=m}u==null&&(u=""),s=u}u=Gt(s),e.defaultValue=u,m=e.textContent,m===u&&m!==""&&m!==null&&(e.value=m),bn(e)}function Nr(e,s){if(s){var u=e.firstChild;if(u&&u===e.lastChild&&u.nodeType===3){u.nodeValue=s;return}}e.textContent=s}var el=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function As(e,s,u){var m=s.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?m?e.setProperty(s,""):s==="float"?e.cssFloat="":e[s]="":m?e.setProperty(s,u):typeof u!="number"||u===0||el.has(s)?s==="float"?e.cssFloat=u:e[s]=(""+u).trim():e[s]=u+"px"}function at(e,s,u){if(s!=null&&typeof s!="object")throw Error(l(62));if(e=e.style,u!=null){for(var m in u)!u.hasOwnProperty(m)||s!=null&&s.hasOwnProperty(m)||(m.indexOf("--")===0?e.setProperty(m,""):m==="float"?e.cssFloat="":e[m]="");for(var b in s)m=s[b],s.hasOwnProperty(b)&&u[b]!==m&&As(e,b,m)}else for(var S in s)s.hasOwnProperty(S)&&As(e,S,s[S])}function fn(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lc=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),cd=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Tr(e){return cd.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function ks(){}var mi=null;function tl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vn=null,ca=null;function Sa(e){var s=Zt(e);if(s&&(e=s.stateNode)){var u=e[_e]||null;e:switch(e=s.stateNode,s.type){case"input":if(Wn(e,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),s=u.name,u.type==="radio"&&s!=null){for(u=e;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Tt(""+s)+'"][type="radio"]'),s=0;s<u.length;s++){var m=u[s];if(m!==e&&m.form===e.form){var b=m[_e]||null;if(!b)throw Error(l(90));Wn(m,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(s=0;s<u.length;s++)m=u[s],m.form===e.form&&_a(m)}break e;case"textarea":Vn(e,u.value,u.defaultValue);break e;case"select":s=u.value,s!=null&&Ze(e,!!u.multiple,s,!1)}}}var it=!1;function cc(e,s,u){if(it)return e(s,u);it=!0;try{var m=e(s);return m}finally{if(it=!1,(vn!==null||ca!==null)&&(eu(),vn&&(s=vn,e=ca,ca=vn=null,Sa(s),e)))for(s=0;s<e.length;s++)Sa(e[s])}}function pt(e,s){var u=e.stateNode;if(u===null)return null;var m=u[_e]||null;if(m===null)return null;u=m[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(e=e.type,m=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!m;break e;default:e=!1}if(e)return null;if(u&&typeof u!="function")throw Error(l(231,s,typeof u));return u}var gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nl=!1;if(gn)try{var Wa={};Object.defineProperty(Wa,"passive",{get:function(){nl=!0}}),window.addEventListener("test",Wa,Wa),window.removeEventListener("test",Wa,Wa)}catch{nl=!1}var Ea=null,Aa=null,$i=null;function jr(){if($i)return $i;var e,s=Aa,u=s.length,m,b="value"in Ea?Ea.value:Ea.textContent,S=b.length;for(e=0;e<u&&s[e]===b[e];e++);var I=u-e;for(m=1;m<=I&&s[u-m]===b[S-m];m++);return $i=b.slice(e,1<m?1-m:void 0)}function La(e){var s=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&s===13&&(e=13)):e=s,e===10&&(e=13),32<=e||e===13?e:0}function Ba(){return!0}function sl(){return!1}function Qn(e){function s(u,m,b,S,I){this._reactName=u,this._targetInst=b,this.type=m,this.nativeEvent=S,this.target=I,this.currentTarget=null;for(var F in e)e.hasOwnProperty(F)&&(u=e[F],this[F]=u?u(S):S[F]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Ba:sl,this.isPropagationStopped=sl,this}return N(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Ba)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Ba)},persist:function(){},isPersistent:Ba}),s}var Xs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ss=Qn(Xs),Rr=N({},Xs,{view:0,detail:0}),uc=Qn(Rr),Ji,al,pi,eo=N({},Rr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xi,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pi&&(pi&&e.type==="mousemove"?(Ji=e.screenX-pi.screenX,al=e.screenY-pi.screenY):al=Ji=0,pi=e),Ji)},movementY:function(e){return"movementY"in e?e.movementY:al}}),$t=Qn(eo),dc=N({},eo,{dataTransfer:0}),to=Qn(dc),Ua=N({},Rr,{relatedTarget:0}),rl=Qn(Ua),xe=N({},Xs,{animationName:0,elapsedTime:0,pseudoElement:0}),St=Qn(xe),as=N({},Xs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),no=Qn(as),hc=N({},Xs,{data:0}),fc=Qn(hc),ud={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},il={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gn(e){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(e):(e=il[e])?!!s[e]:!1}function xi(){return Gn}var En=N({},Rr,{key:function(e){if(e.key){var s=ud[e.key]||e.key;if(s!=="Unidentified")return s}return e.type==="keypress"?(e=La(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?dd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xi,charCode:function(e){return e.type==="keypress"?La(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?La(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),so=Qn(En),Qa=N({},eo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tn=Qn(Qa),ot=N({},Rr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xi}),hd=Qn(ot),mn=N({},Xs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ka=Qn(mn),Ir=N({},eo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),fd=Qn(Ir),ua=N({},Xs,{newState:0,oldState:0}),ol=Qn(ua),gc=[9,13,27,32],yi=gn&&"CompositionEvent"in window,Or=null;gn&&"documentMode"in document&&(Or=document.documentMode);var mc=gn&&"TextEvent"in window&&!Or,pc=gn&&(!yi||Or&&8<Or&&11>=Or),Za=" ",ao=!1;function xc(e,s){switch(e){case"keyup":return gc.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mr(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var kr=!1;function Pa(e,s){switch(e){case"compositionend":return Mr(s);case"keypress":return s.which!==32?null:(ao=!0,Za);case"textInput":return e=s.data,e===Za&&ao?null:e;default:return null}}function ro(e,s){if(kr)return e==="compositionend"||!yi&&xc(e,s)?(e=jr(),$i=Aa=Ea=null,kr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return pc&&s.locale!=="ko"?null:s.data;default:return null}}var Ds={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ll(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s==="input"?!!Ds[e.type]:s==="textarea"}function Ws(e,s,u,m){vn?ca?ca.push(m):ca=[m]:vn=m,s=ou(s,"onChange"),0<s.length&&(u=new ss("onChange","change",null,u,m),e.push({event:u,listeners:s}))}var wi=null,$a=null;function gd(e){im(e,0)}function bi(e){var s=_r(e);if(_a(s))return e}function Qs(e,s){if(e==="change")return s}var yc=!1;if(gn){var vi;if(gn){var Ja="oninput"in document;if(!Ja){var kt=document.createElement("div");kt.setAttribute("oninput","return;"),Ja=typeof kt.oninput=="function"}vi=Ja}else vi=!1;yc=vi&&(!document.documentMode||9<document.documentMode)}function Ci(){wi&&(wi.detachEvent("onpropertychange",k),$a=wi=null)}function k(e){if(e.propertyName==="value"&&bi($a)){var s=[];Ws(s,$a,e,tl(e)),cc(gd,s)}}function t(e,s,u){e==="focusin"?(Ci(),wi=s,$a=u,wi.attachEvent("onpropertychange",k)):e==="focusout"&&Ci()}function r(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return bi($a)}function c(e,s){if(e==="click")return bi(s)}function h(e,s){if(e==="input"||e==="change")return bi(s)}function g(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}var p=typeof Object.is=="function"?Object.is:g;function y(e,s){if(p(e,s))return!0;if(typeof e!="object"||e===null||typeof s!="object"||s===null)return!1;var u=Object.keys(e),m=Object.keys(s);if(u.length!==m.length)return!1;for(m=0;m<u.length;m++){var b=u[m];if(!ht.call(s,b)||!p(e[b],s[b]))return!1}return!0}function _(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function E(e,s){var u=_(e);e=0;for(var m;u;){if(u.nodeType===3){if(m=e+u.textContent.length,e<=s&&m>=s)return{node:u,offset:s-e};e=m}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=_(u)}}function j(e,s){return e&&s?e===s?!0:e&&e.nodeType===3?!1:s&&s.nodeType===3?j(e,s.parentNode):"contains"in e?e.contains(s):e.compareDocumentPosition?!!(e.compareDocumentPosition(s)&16):!1:!1}function D(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var s=Zi(e.document);s instanceof e.HTMLIFrameElement;){try{var u=typeof s.contentWindow.location.href=="string"}catch{u=!1}if(u)e=s.contentWindow;else break;s=Zi(e.document)}return s}function z(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s&&(s==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||s==="textarea"||e.contentEditable==="true")}var Q=gn&&"documentMode"in document&&11>=document.documentMode,te=null,se=null,le=null,pe=!1;function Pe(e,s,u){var m=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;pe||te==null||te!==Zi(m)||(m=te,"selectionStart"in m&&z(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),le&&y(le,m)||(le=m,m=ou(se,"onSelect"),0<m.length&&(s=new ss("onSelect","select",null,s,u),e.push({event:s,listeners:m}),s.target=te)))}function Be(e,s){var u={};return u[e.toLowerCase()]=s.toLowerCase(),u["Webkit"+e]="webkit"+s,u["Moz"+e]="moz"+s,u}var Oe={animationend:Be("Animation","AnimationEnd"),animationiteration:Be("Animation","AnimationIteration"),animationstart:Be("Animation","AnimationStart"),transitionrun:Be("Transition","TransitionRun"),transitionstart:Be("Transition","TransitionStart"),transitioncancel:Be("Transition","TransitionCancel"),transitionend:Be("Transition","TransitionEnd")},At={},yt={};gn&&(yt=document.createElement("div").style,"AnimationEvent"in window||(delete Oe.animationend.animation,delete Oe.animationiteration.animation,delete Oe.animationstart.animation),"TransitionEvent"in window||delete Oe.transitionend.transition);function Un(e){if(At[e])return At[e];if(!Oe[e])return e;var s=Oe[e],u;for(u in s)if(s.hasOwnProperty(u)&&u in yt)return At[e]=s[u];return e}var Ls=Un("animationend"),ms=Un("animationiteration"),nn=Un("animationstart"),rs=Un("transitionrun"),Ns=Un("transitionstart"),Dr=Un("transitioncancel"),er=Un("transitionend"),wc=new Map,cl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");cl.push("scrollEnd");function Na(e,s){wc.set(e,s),en(s,[e])}var bc=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)},da=[],io=0,md=0;function vc(){for(var e=io,s=md=io=0;s<e;){var u=da[s];da[s++]=null;var m=da[s];da[s++]=null;var b=da[s];da[s++]=null;var S=da[s];if(da[s++]=null,m!==null&&b!==null){var I=m.pending;I===null?b.next=b:(b.next=I.next,I.next=b),m.pending=b}S!==0&&F0(u,b,S)}}function Cc(e,s,u,m){da[io++]=e,da[io++]=s,da[io++]=u,da[io++]=m,md|=m,e.lanes|=m,e=e.alternate,e!==null&&(e.lanes|=m)}function pd(e,s,u,m){return Cc(e,s,u,m),_c(e)}function _i(e,s){return Cc(e,null,null,s),_c(e)}function F0(e,s,u){e.lanes|=u;var m=e.alternate;m!==null&&(m.lanes|=u);for(var b=!1,S=e.return;S!==null;)S.childLanes|=u,m=S.alternate,m!==null&&(m.childLanes|=u),S.tag===22&&(e=S.stateNode,e===null||e._visibility&1||(b=!0)),e=S,S=S.return;return e.tag===3?(S=e.stateNode,b&&s!==null&&(b=31-gt(u),e=S.hiddenUpdates,m=e[b],m===null?e[b]=[s]:m.push(s),s.lane=u|536870912),S):null}function _c(e){if(50<Il)throw Il=0,Eh=null,Error(l(185));for(var s=e.return;s!==null;)e=s,s=e.return;return e.tag===3?e.stateNode:null}var oo={};function _y(e,s,u,m){this.tag=e,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ks(e,s,u,m){return new _y(e,s,u,m)}function xd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function tr(e,s){var u=e.alternate;return u===null?(u=Ks(e.tag,s,e.key,e.mode),u.elementType=e.elementType,u.type=e.type,u.stateNode=e.stateNode,u.alternate=e,e.alternate=u):(u.pendingProps=s,u.type=e.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=e.flags&65011712,u.childLanes=e.childLanes,u.lanes=e.lanes,u.child=e.child,u.memoizedProps=e.memoizedProps,u.memoizedState=e.memoizedState,u.updateQueue=e.updateQueue,s=e.dependencies,u.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},u.sibling=e.sibling,u.index=e.index,u.ref=e.ref,u.refCleanup=e.refCleanup,u}function H0(e,s){e.flags&=65011714;var u=e.alternate;return u===null?(e.childLanes=0,e.lanes=s,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=u.childLanes,e.lanes=u.lanes,e.child=u.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=u.memoizedProps,e.memoizedState=u.memoizedState,e.updateQueue=u.updateQueue,e.type=u.type,s=u.dependencies,e.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),e}function Sc(e,s,u,m,b,S){var I=0;if(m=e,typeof e=="function")xd(e)&&(I=1);else if(typeof e=="string")I=Tw(e,u,Ue.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case q:return e=Ks(31,u,s,b),e.elementType=q,e.lanes=S,e;case L:return Si(u.children,b,S,s);case B:I=8,b|=24;break;case H:return e=Ks(12,u,s,b|2),e.elementType=H,e.lanes=S,e;case Z:return e=Ks(13,u,s,b),e.elementType=Z,e.lanes=S,e;case W:return e=Ks(19,u,s,b),e.elementType=W,e.lanes=S,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case P:I=10;break e;case U:I=9;break e;case K:I=11;break e;case X:I=14;break e;case J:I=16,m=null;break e}I=29,u=Error(l(130,e===null?"null":typeof e,"")),m=null}return s=Ks(I,u,s,b),s.elementType=e,s.type=m,s.lanes=S,s}function Si(e,s,u,m){return e=Ks(7,e,m,s),e.lanes=u,e}function yd(e,s,u){return e=Ks(6,e,null,s),e.lanes=u,e}function q0(e){var s=Ks(18,null,null,0);return s.stateNode=e,s}function wd(e,s,u){return s=Ks(4,e.children!==null?e.children:[],e.key,s),s.lanes=u,s.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},s}var V0=new WeakMap;function ha(e,s){if(typeof e=="object"&&e!==null){var u=V0.get(e);return u!==void 0?u:(s={value:e,source:s,stack:Nt(s)},V0.set(e,s),s)}return{value:e,source:s,stack:Nt(s)}}var lo=[],co=0,Ec=null,ul=0,fa=[],ga=0,Lr=null,za=1,Fa="";function nr(e,s){lo[co++]=ul,lo[co++]=Ec,Ec=e,ul=s}function G0(e,s,u){fa[ga++]=za,fa[ga++]=Fa,fa[ga++]=Lr,Lr=e;var m=za;e=Fa;var b=32-gt(m)-1;m&=~(1<<b),u+=1;var S=32-gt(s)+b;if(30<S){var I=b-b%5;S=(m&(1<<I)-1).toString(32),m>>=I,b-=I,za=1<<32-gt(s)+b|u<<b|m,Fa=S+e}else za=1<<S|u<<b|m,Fa=e}function bd(e){e.return!==null&&(nr(e,1),G0(e,1,0))}function vd(e){for(;e===Ec;)Ec=lo[--co],lo[co]=null,ul=lo[--co],lo[co]=null;for(;e===Lr;)Lr=fa[--ga],fa[ga]=null,Fa=fa[--ga],fa[ga]=null,za=fa[--ga],fa[ga]=null}function Y0(e,s){fa[ga++]=za,fa[ga++]=Fa,fa[ga++]=Lr,za=s.id,Fa=s.overflow,Lr=e}var ps=null,Cn=null,zt=!1,Br=null,ma=!1,Cd=Error(l(519));function Ur(e){var s=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw dl(ha(s,e)),Cd}function X0(e){var s=e.stateNode,u=e.type,m=e.memoizedProps;switch(s[Ee]=e,s[_e]=m,u){case"dialog":Ot("cancel",s),Ot("close",s);break;case"iframe":case"object":case"embed":Ot("load",s);break;case"video":case"audio":for(u=0;u<Ml.length;u++)Ot(Ml[u],s);break;case"source":Ot("error",s);break;case"img":case"image":case"link":Ot("error",s),Ot("load",s);break;case"details":Ot("toggle",s);break;case"input":Ot("invalid",s),ce(s,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0);break;case"select":Ot("invalid",s);break;case"textarea":Ot("invalid",s),Es(s,m.value,m.defaultValue,m.children)}u=m.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||s.textContent===""+u||m.suppressHydrationWarning===!0||um(s.textContent,u)?(m.popover!=null&&(Ot("beforetoggle",s),Ot("toggle",s)),m.onScroll!=null&&Ot("scroll",s),m.onScrollEnd!=null&&Ot("scrollend",s),m.onClick!=null&&(s.onclick=ks),s=!0):s=!1,s||Ur(e,!0)}function W0(e){for(ps=e.return;ps;)switch(ps.tag){case 5:case 31:case 13:ma=!1;return;case 27:case 3:ma=!0;return;default:ps=ps.return}}function uo(e){if(e!==ps)return!1;if(!zt)return W0(e),zt=!0,!1;var s=e.tag,u;if((u=s!==3&&s!==27)&&((u=s===5)&&(u=e.type,u=!(u!=="form"&&u!=="button")||zh(e.type,e.memoizedProps)),u=!u),u&&Cn&&Ur(e),W0(e),s===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));Cn=wm(e)}else if(s===31){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));Cn=wm(e)}else s===27?(s=Cn,$r(e.type)?(e=Gh,Gh=null,Cn=e):Cn=s):Cn=ps?xa(e.stateNode.nextSibling):null;return!0}function Ei(){Cn=ps=null,zt=!1}function _d(){var e=Br;return e!==null&&(zs===null?zs=e:zs.push.apply(zs,e),Br=null),e}function dl(e){Br===null?Br=[e]:Br.push(e)}var Sd=ne(null),Ai=null,sr=null;function Pr(e,s,u){Le(Sd,s._currentValue),s._currentValue=u}function ar(e){e._currentValue=Sd.current,ye(Sd)}function Ed(e,s,u){for(;e!==null;){var m=e.alternate;if((e.childLanes&s)!==s?(e.childLanes|=s,m!==null&&(m.childLanes|=s)):m!==null&&(m.childLanes&s)!==s&&(m.childLanes|=s),e===u)break;e=e.return}}function Ad(e,s,u,m){var b=e.child;for(b!==null&&(b.return=e);b!==null;){var S=b.dependencies;if(S!==null){var I=b.child;S=S.firstContext;e:for(;S!==null;){var F=S;S=b;for(var ee=0;ee<s.length;ee++)if(F.context===s[ee]){S.lanes|=u,F=S.alternate,F!==null&&(F.lanes|=u),Ed(S.return,u,e),m||(I=null);break e}S=F.next}}else if(b.tag===18){if(I=b.return,I===null)throw Error(l(341));I.lanes|=u,S=I.alternate,S!==null&&(S.lanes|=u),Ed(I,u,e),I=null}else I=b.child;if(I!==null)I.return=b;else for(I=b;I!==null;){if(I===e){I=null;break}if(b=I.sibling,b!==null){b.return=I.return,I=b;break}I=I.return}b=I}}function ho(e,s,u,m){e=null;for(var b=s,S=!1;b!==null;){if(!S){if((b.flags&524288)!==0)S=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var I=b.alternate;if(I===null)throw Error(l(387));if(I=I.memoizedProps,I!==null){var F=b.type;p(b.pendingProps.value,I.value)||(e!==null?e.push(F):e=[F])}}else if(b===$e.current){if(I=b.alternate,I===null)throw Error(l(387));I.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(e!==null?e.push(Ul):e=[Ul])}b=b.return}e!==null&&Ad(s,e,u,m),s.flags|=262144}function Ac(e){for(e=e.firstContext;e!==null;){if(!p(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ni(e){Ai=e,sr=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function xs(e){return Q0(Ai,e)}function Nc(e,s){return Ai===null&&Ni(e),Q0(e,s)}function Q0(e,s){var u=s._currentValue;if(s={context:s,memoizedValue:u,next:null},sr===null){if(e===null)throw Error(l(308));sr=s,e.dependencies={lanes:0,firstContext:s},e.flags|=524288}else sr=sr.next=s;return u}var Sy=typeof AbortController<"u"?AbortController:function(){var e=[],s=this.signal={aborted:!1,addEventListener:function(u,m){e.push(m)}};this.abort=function(){s.aborted=!0,e.forEach(function(u){return u()})}},Ey=i.unstable_scheduleCallback,Ay=i.unstable_NormalPriority,Kn={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Nd(){return{controller:new Sy,data:new Map,refCount:0}}function hl(e){e.refCount--,e.refCount===0&&Ey(Ay,function(){e.controller.abort()})}var fl=null,Td=0,fo=0,go=null;function Ny(e,s){if(fl===null){var u=fl=[];Td=0,fo=Ih(),go={status:"pending",value:void 0,then:function(m){u.push(m)}}}return Td++,s.then(K0,K0),s}function K0(){if(--Td===0&&fl!==null){go!==null&&(go.status="fulfilled");var e=fl;fl=null,fo=0,go=null;for(var s=0;s<e.length;s++)(0,e[s])()}}function Ty(e,s){var u=[],m={status:"pending",value:null,reason:null,then:function(b){u.push(b)}};return e.then(function(){m.status="fulfilled",m.value=s;for(var b=0;b<u.length;b++)(0,u[b])(s)},function(b){for(m.status="rejected",m.reason=b,b=0;b<u.length;b++)(0,u[b])(void 0)}),m}var Z0=$.S;$.S=function(e,s){kg=Fe(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&Ny(e,s),Z0!==null&&Z0(e,s)};var Ti=ne(null);function jd(){var e=Ti.current;return e!==null?e:pn.pooledCache}function Tc(e,s){s===null?Le(Ti,Ti.current):Le(Ti,s.pool)}function $0(){var e=jd();return e===null?null:{parent:Kn._currentValue,pool:e}}var mo=Error(l(460)),Rd=Error(l(474)),jc=Error(l(542)),Rc={then:function(){}};function J0(e){return e=e.status,e==="fulfilled"||e==="rejected"}function e1(e,s,u){switch(u=e[u],u===void 0?e.push(s):u!==s&&(s.then(ks,ks),s=u),s.status){case"fulfilled":return s.value;case"rejected":throw e=s.reason,n1(e),e;default:if(typeof s.status=="string")s.then(ks,ks);else{if(e=pn,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=s,e.status="pending",e.then(function(m){if(s.status==="pending"){var b=s;b.status="fulfilled",b.value=m}},function(m){if(s.status==="pending"){var b=s;b.status="rejected",b.reason=m}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw e=s.reason,n1(e),e}throw Ri=s,mo}}function ji(e){try{var s=e._init;return s(e._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Ri=u,mo):u}}var Ri=null;function t1(){if(Ri===null)throw Error(l(459));var e=Ri;return Ri=null,e}function n1(e){if(e===mo||e===jc)throw Error(l(483))}var po=null,gl=0;function Ic(e){var s=gl;return gl+=1,po===null&&(po=[]),e1(po,e,s)}function ml(e,s){s=s.props.ref,e.ref=s!==void 0?s:null}function Oc(e,s){throw s.$$typeof===R?Error(l(525)):(e=Object.prototype.toString.call(s),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e)))}function s1(e){function s(re,ae){if(e){var ue=re.deletions;ue===null?(re.deletions=[ae],re.flags|=16):ue.push(ae)}}function u(re,ae){if(!e)return null;for(;ae!==null;)s(re,ae),ae=ae.sibling;return null}function m(re){for(var ae=new Map;re!==null;)re.key!==null?ae.set(re.key,re):ae.set(re.index,re),re=re.sibling;return ae}function b(re,ae){return re=tr(re,ae),re.index=0,re.sibling=null,re}function S(re,ae,ue){return re.index=ue,e?(ue=re.alternate,ue!==null?(ue=ue.index,ue<ae?(re.flags|=67108866,ae):ue):(re.flags|=67108866,ae)):(re.flags|=1048576,ae)}function I(re){return e&&re.alternate===null&&(re.flags|=67108866),re}function F(re,ae,ue,Se){return ae===null||ae.tag!==6?(ae=yd(ue,re.mode,Se),ae.return=re,ae):(ae=b(ae,ue),ae.return=re,ae)}function ee(re,ae,ue,Se){var rt=ue.type;return rt===L?ve(re,ae,ue.props.children,Se,ue.key):ae!==null&&(ae.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===J&&ji(rt)===ae.type)?(ae=b(ae,ue.props),ml(ae,ue),ae.return=re,ae):(ae=Sc(ue.type,ue.key,ue.props,null,re.mode,Se),ml(ae,ue),ae.return=re,ae)}function de(re,ae,ue,Se){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==ue.containerInfo||ae.stateNode.implementation!==ue.implementation?(ae=wd(ue,re.mode,Se),ae.return=re,ae):(ae=b(ae,ue.children||[]),ae.return=re,ae)}function ve(re,ae,ue,Se,rt){return ae===null||ae.tag!==7?(ae=Si(ue,re.mode,Se,rt),ae.return=re,ae):(ae=b(ae,ue),ae.return=re,ae)}function Ae(re,ae,ue){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return ae=yd(""+ae,re.mode,ue),ae.return=re,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case T:return ue=Sc(ae.type,ae.key,ae.props,null,re.mode,ue),ml(ue,ae),ue.return=re,ue;case O:return ae=wd(ae,re.mode,ue),ae.return=re,ae;case J:return ae=ji(ae),Ae(re,ae,ue)}if(V(ae)||ie(ae))return ae=Si(ae,re.mode,ue,null),ae.return=re,ae;if(typeof ae.then=="function")return Ae(re,Ic(ae),ue);if(ae.$$typeof===P)return Ae(re,Nc(re,ae),ue);Oc(re,ae)}return null}function fe(re,ae,ue,Se){var rt=ae!==null?ae.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return rt!==null?null:F(re,ae,""+ue,Se);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case T:return ue.key===rt?ee(re,ae,ue,Se):null;case O:return ue.key===rt?de(re,ae,ue,Se):null;case J:return ue=ji(ue),fe(re,ae,ue,Se)}if(V(ue)||ie(ue))return rt!==null?null:ve(re,ae,ue,Se,null);if(typeof ue.then=="function")return fe(re,ae,Ic(ue),Se);if(ue.$$typeof===P)return fe(re,ae,Nc(re,ue),Se);Oc(re,ue)}return null}function we(re,ae,ue,Se,rt){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return re=re.get(ue)||null,F(ae,re,""+Se,rt);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case T:return re=re.get(Se.key===null?ue:Se.key)||null,ee(ae,re,Se,rt);case O:return re=re.get(Se.key===null?ue:Se.key)||null,de(ae,re,Se,rt);case J:return Se=ji(Se),we(re,ae,ue,Se,rt)}if(V(Se)||ie(Se))return re=re.get(ue)||null,ve(ae,re,Se,rt,null);if(typeof Se.then=="function")return we(re,ae,ue,Ic(Se),rt);if(Se.$$typeof===P)return we(re,ae,ue,Nc(ae,Se),rt);Oc(ae,Se)}return null}function Qe(re,ae,ue,Se){for(var rt=null,Yt=null,et=ae,Et=ae=0,Lt=null;et!==null&&Et<ue.length;Et++){et.index>Et?(Lt=et,et=null):Lt=et.sibling;var Xt=fe(re,et,ue[Et],Se);if(Xt===null){et===null&&(et=Lt);break}e&&et&&Xt.alternate===null&&s(re,et),ae=S(Xt,ae,Et),Yt===null?rt=Xt:Yt.sibling=Xt,Yt=Xt,et=Lt}if(Et===ue.length)return u(re,et),zt&&nr(re,Et),rt;if(et===null){for(;Et<ue.length;Et++)et=Ae(re,ue[Et],Se),et!==null&&(ae=S(et,ae,Et),Yt===null?rt=et:Yt.sibling=et,Yt=et);return zt&&nr(re,Et),rt}for(et=m(et);Et<ue.length;Et++)Lt=we(et,re,Et,ue[Et],Se),Lt!==null&&(e&&Lt.alternate!==null&&et.delete(Lt.key===null?Et:Lt.key),ae=S(Lt,ae,Et),Yt===null?rt=Lt:Yt.sibling=Lt,Yt=Lt);return e&&et.forEach(function(si){return s(re,si)}),zt&&nr(re,Et),rt}function ut(re,ae,ue,Se){if(ue==null)throw Error(l(151));for(var rt=null,Yt=null,et=ae,Et=ae=0,Lt=null,Xt=ue.next();et!==null&&!Xt.done;Et++,Xt=ue.next()){et.index>Et?(Lt=et,et=null):Lt=et.sibling;var si=fe(re,et,Xt.value,Se);if(si===null){et===null&&(et=Lt);break}e&&et&&si.alternate===null&&s(re,et),ae=S(si,ae,Et),Yt===null?rt=si:Yt.sibling=si,Yt=si,et=Lt}if(Xt.done)return u(re,et),zt&&nr(re,Et),rt;if(et===null){for(;!Xt.done;Et++,Xt=ue.next())Xt=Ae(re,Xt.value,Se),Xt!==null&&(ae=S(Xt,ae,Et),Yt===null?rt=Xt:Yt.sibling=Xt,Yt=Xt);return zt&&nr(re,Et),rt}for(et=m(et);!Xt.done;Et++,Xt=ue.next())Xt=we(et,re,Et,Xt.value,Se),Xt!==null&&(e&&Xt.alternate!==null&&et.delete(Xt.key===null?Et:Xt.key),ae=S(Xt,ae,Et),Yt===null?rt=Xt:Yt.sibling=Xt,Yt=Xt);return e&&et.forEach(function(Pw){return s(re,Pw)}),zt&&nr(re,Et),rt}function hn(re,ae,ue,Se){if(typeof ue=="object"&&ue!==null&&ue.type===L&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case T:e:{for(var rt=ue.key;ae!==null;){if(ae.key===rt){if(rt=ue.type,rt===L){if(ae.tag===7){u(re,ae.sibling),Se=b(ae,ue.props.children),Se.return=re,re=Se;break e}}else if(ae.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===J&&ji(rt)===ae.type){u(re,ae.sibling),Se=b(ae,ue.props),ml(Se,ue),Se.return=re,re=Se;break e}u(re,ae);break}else s(re,ae);ae=ae.sibling}ue.type===L?(Se=Si(ue.props.children,re.mode,Se,ue.key),Se.return=re,re=Se):(Se=Sc(ue.type,ue.key,ue.props,null,re.mode,Se),ml(Se,ue),Se.return=re,re=Se)}return I(re);case O:e:{for(rt=ue.key;ae!==null;){if(ae.key===rt)if(ae.tag===4&&ae.stateNode.containerInfo===ue.containerInfo&&ae.stateNode.implementation===ue.implementation){u(re,ae.sibling),Se=b(ae,ue.children||[]),Se.return=re,re=Se;break e}else{u(re,ae);break}else s(re,ae);ae=ae.sibling}Se=wd(ue,re.mode,Se),Se.return=re,re=Se}return I(re);case J:return ue=ji(ue),hn(re,ae,ue,Se)}if(V(ue))return Qe(re,ae,ue,Se);if(ie(ue)){if(rt=ie(ue),typeof rt!="function")throw Error(l(150));return ue=rt.call(ue),ut(re,ae,ue,Se)}if(typeof ue.then=="function")return hn(re,ae,Ic(ue),Se);if(ue.$$typeof===P)return hn(re,ae,Nc(re,ue),Se);Oc(re,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint"?(ue=""+ue,ae!==null&&ae.tag===6?(u(re,ae.sibling),Se=b(ae,ue),Se.return=re,re=Se):(u(re,ae),Se=yd(ue,re.mode,Se),Se.return=re,re=Se),I(re)):u(re,ae)}return function(re,ae,ue,Se){try{gl=0;var rt=hn(re,ae,ue,Se);return po=null,rt}catch(et){if(et===mo||et===jc)throw et;var Yt=Ks(29,et,null,re.mode);return Yt.lanes=Se,Yt.return=re,Yt}finally{}}}var Ii=s1(!0),a1=s1(!1),zr=!1;function Id(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Od(e,s){e=e.updateQueue,s.updateQueue===e&&(s.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Fr(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Hr(e,s,u){var m=e.updateQueue;if(m===null)return null;if(m=m.shared,(Jt&2)!==0){var b=m.pending;return b===null?s.next=s:(s.next=b.next,b.next=s),m.pending=s,s=_c(e),F0(e,null,u),s}return Cc(e,m,s,u),_c(e)}function pl(e,s,u){if(s=s.updateQueue,s!==null&&(s=s.shared,(u&4194048)!==0)){var m=s.lanes;m&=e.pendingLanes,u|=m,s.lanes=u,On(e,u)}}function Md(e,s){var u=e.updateQueue,m=e.alternate;if(m!==null&&(m=m.updateQueue,u===m)){var b=null,S=null;if(u=u.firstBaseUpdate,u!==null){do{var I={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};S===null?b=S=I:S=S.next=I,u=u.next}while(u!==null);S===null?b=S=s:S=S.next=s}else b=S=s;u={baseState:m.baseState,firstBaseUpdate:b,lastBaseUpdate:S,shared:m.shared,callbacks:m.callbacks},e.updateQueue=u;return}e=u.lastBaseUpdate,e===null?u.firstBaseUpdate=s:e.next=s,u.lastBaseUpdate=s}var kd=!1;function xl(){if(kd){var e=go;if(e!==null)throw e}}function yl(e,s,u,m){kd=!1;var b=e.updateQueue;zr=!1;var S=b.firstBaseUpdate,I=b.lastBaseUpdate,F=b.shared.pending;if(F!==null){b.shared.pending=null;var ee=F,de=ee.next;ee.next=null,I===null?S=de:I.next=de,I=ee;var ve=e.alternate;ve!==null&&(ve=ve.updateQueue,F=ve.lastBaseUpdate,F!==I&&(F===null?ve.firstBaseUpdate=de:F.next=de,ve.lastBaseUpdate=ee))}if(S!==null){var Ae=b.baseState;I=0,ve=de=ee=null,F=S;do{var fe=F.lane&-536870913,we=fe!==F.lane;if(we?(Dt&fe)===fe:(m&fe)===fe){fe!==0&&fe===fo&&(kd=!0),ve!==null&&(ve=ve.next={lane:0,tag:F.tag,payload:F.payload,callback:null,next:null});e:{var Qe=e,ut=F;fe=s;var hn=u;switch(ut.tag){case 1:if(Qe=ut.payload,typeof Qe=="function"){Ae=Qe.call(hn,Ae,fe);break e}Ae=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=ut.payload,fe=typeof Qe=="function"?Qe.call(hn,Ae,fe):Qe,fe==null)break e;Ae=N({},Ae,fe);break e;case 2:zr=!0}}fe=F.callback,fe!==null&&(e.flags|=64,we&&(e.flags|=8192),we=b.callbacks,we===null?b.callbacks=[fe]:we.push(fe))}else we={lane:fe,tag:F.tag,payload:F.payload,callback:F.callback,next:null},ve===null?(de=ve=we,ee=Ae):ve=ve.next=we,I|=fe;if(F=F.next,F===null){if(F=b.shared.pending,F===null)break;we=F,F=we.next,we.next=null,b.lastBaseUpdate=we,b.shared.pending=null}}while(!0);ve===null&&(ee=Ae),b.baseState=ee,b.firstBaseUpdate=de,b.lastBaseUpdate=ve,S===null&&(b.shared.lanes=0),Xr|=I,e.lanes=I,e.memoizedState=Ae}}function r1(e,s){if(typeof e!="function")throw Error(l(191,e));e.call(s)}function i1(e,s){var u=e.callbacks;if(u!==null)for(e.callbacks=null,e=0;e<u.length;e++)r1(u[e],s)}var xo=ne(null),Mc=ne(0);function o1(e,s){e=fr,Le(Mc,e),Le(xo,s),fr=e|s.baseLanes}function Dd(){Le(Mc,fr),Le(xo,xo.current)}function Ld(){fr=Mc.current,ye(xo),ye(Mc)}var Zs=ne(null),pa=null;function qr(e){var s=e.alternate;Le(Yn,Yn.current&1),Le(Zs,e),pa===null&&(s===null||xo.current!==null||s.memoizedState!==null)&&(pa=e)}function Bd(e){Le(Yn,Yn.current),Le(Zs,e),pa===null&&(pa=e)}function l1(e){e.tag===22?(Le(Yn,Yn.current),Le(Zs,e),pa===null&&(pa=e)):Vr()}function Vr(){Le(Yn,Yn.current),Le(Zs,Zs.current)}function $s(e){ye(Zs),pa===e&&(pa=null),ye(Yn)}var Yn=ne(0);function kc(e){for(var s=e;s!==null;){if(s.tag===13){var u=s.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||qh(u)||Vh(u)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var rr=0,Ct=null,un=null,Zn=null,Dc=!1,yo=!1,Oi=!1,Lc=0,wl=0,wo=null,jy=0;function Pn(){throw Error(l(321))}function Ud(e,s){if(s===null)return!1;for(var u=0;u<s.length&&u<e.length;u++)if(!p(e[u],s[u]))return!1;return!0}function Pd(e,s,u,m,b,S){return rr=S,Ct=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,$.H=e===null||e.memoizedState===null?G1:eh,Oi=!1,S=u(m,b),Oi=!1,yo&&(S=u1(s,u,m,b)),c1(e),S}function c1(e){$.H=Cl;var s=un!==null&&un.next!==null;if(rr=0,Zn=un=Ct=null,Dc=!1,wl=0,wo=null,s)throw Error(l(300));e===null||$n||(e=e.dependencies,e!==null&&Ac(e)&&($n=!0))}function u1(e,s,u,m){Ct=e;var b=0;do{if(yo&&(wo=null),wl=0,yo=!1,25<=b)throw Error(l(301));if(b+=1,Zn=un=null,e.updateQueue!=null){var S=e.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}$.H=Y1,S=s(u,m)}while(yo);return S}function Ry(){var e=$.H,s=e.useState()[0];return s=typeof s.then=="function"?bl(s):s,e=e.useState()[0],(un!==null?un.memoizedState:null)!==e&&(Ct.flags|=1024),s}function zd(){var e=Lc!==0;return Lc=0,e}function Fd(e,s,u){s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~u}function Hd(e){if(Dc){for(e=e.memoizedState;e!==null;){var s=e.queue;s!==null&&(s.pending=null),e=e.next}Dc=!1}rr=0,Zn=un=Ct=null,yo=!1,wl=Lc=0,wo=null}function Ts(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zn===null?Ct.memoizedState=Zn=e:Zn=Zn.next=e,Zn}function Xn(){if(un===null){var e=Ct.alternate;e=e!==null?e.memoizedState:null}else e=un.next;var s=Zn===null?Ct.memoizedState:Zn.next;if(s!==null)Zn=s,un=e;else{if(e===null)throw Ct.alternate===null?Error(l(467)):Error(l(310));un=e,e={memoizedState:un.memoizedState,baseState:un.baseState,baseQueue:un.baseQueue,queue:un.queue,next:null},Zn===null?Ct.memoizedState=Zn=e:Zn=Zn.next=e}return Zn}function Bc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function bl(e){var s=wl;return wl+=1,wo===null&&(wo=[]),e=e1(wo,e,s),s=Ct,(Zn===null?s.memoizedState:Zn.next)===null&&(s=s.alternate,$.H=s===null||s.memoizedState===null?G1:eh),e}function Uc(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return bl(e);if(e.$$typeof===P)return xs(e)}throw Error(l(438,String(e)))}function qd(e){var s=null,u=Ct.updateQueue;if(u!==null&&(s=u.memoCache),s==null){var m=Ct.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(s={data:m.data.map(function(b){return b.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),u===null&&(u=Bc(),Ct.updateQueue=u),u.memoCache=s,u=s.data[s.index],u===void 0)for(u=s.data[s.index]=Array(e),m=0;m<e;m++)u[m]=he;return s.index++,u}function ir(e,s){return typeof s=="function"?s(e):s}function Pc(e){var s=Xn();return Vd(s,un,e)}function Vd(e,s,u){var m=e.queue;if(m===null)throw Error(l(311));m.lastRenderedReducer=u;var b=e.baseQueue,S=m.pending;if(S!==null){if(b!==null){var I=b.next;b.next=S.next,S.next=I}s.baseQueue=b=S,m.pending=null}if(S=e.baseState,b===null)e.memoizedState=S;else{s=b.next;var F=I=null,ee=null,de=s,ve=!1;do{var Ae=de.lane&-536870913;if(Ae!==de.lane?(Dt&Ae)===Ae:(rr&Ae)===Ae){var fe=de.revertLane;if(fe===0)ee!==null&&(ee=ee.next={lane:0,revertLane:0,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),Ae===fo&&(ve=!0);else if((rr&fe)===fe){de=de.next,fe===fo&&(ve=!0);continue}else Ae={lane:0,revertLane:de.revertLane,gesture:null,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},ee===null?(F=ee=Ae,I=S):ee=ee.next=Ae,Ct.lanes|=fe,Xr|=fe;Ae=de.action,Oi&&u(S,Ae),S=de.hasEagerState?de.eagerState:u(S,Ae)}else fe={lane:Ae,revertLane:de.revertLane,gesture:de.gesture,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},ee===null?(F=ee=fe,I=S):ee=ee.next=fe,Ct.lanes|=Ae,Xr|=Ae;de=de.next}while(de!==null&&de!==s);if(ee===null?I=S:ee.next=F,!p(S,e.memoizedState)&&($n=!0,ve&&(u=go,u!==null)))throw u;e.memoizedState=S,e.baseState=I,e.baseQueue=ee,m.lastRenderedState=S}return b===null&&(m.lanes=0),[e.memoizedState,m.dispatch]}function Gd(e){var s=Xn(),u=s.queue;if(u===null)throw Error(l(311));u.lastRenderedReducer=e;var m=u.dispatch,b=u.pending,S=s.memoizedState;if(b!==null){u.pending=null;var I=b=b.next;do S=e(S,I.action),I=I.next;while(I!==b);p(S,s.memoizedState)||($n=!0),s.memoizedState=S,s.baseQueue===null&&(s.baseState=S),u.lastRenderedState=S}return[S,m]}function d1(e,s,u){var m=Ct,b=Xn(),S=zt;if(S){if(u===void 0)throw Error(l(407));u=u()}else u=s();var I=!p((un||b).memoizedState,u);if(I&&(b.memoizedState=u,$n=!0),b=b.queue,Wd(g1.bind(null,m,b,e),[e]),b.getSnapshot!==s||I||Zn!==null&&Zn.memoizedState.tag&1){if(m.flags|=2048,bo(9,{destroy:void 0},f1.bind(null,m,b,u,s),null),pn===null)throw Error(l(349));S||(rr&127)!==0||h1(m,s,u)}return u}function h1(e,s,u){e.flags|=16384,e={getSnapshot:s,value:u},s=Ct.updateQueue,s===null?(s=Bc(),Ct.updateQueue=s,s.stores=[e]):(u=s.stores,u===null?s.stores=[e]:u.push(e))}function f1(e,s,u,m){s.value=u,s.getSnapshot=m,m1(s)&&p1(e)}function g1(e,s,u){return u(function(){m1(s)&&p1(e)})}function m1(e){var s=e.getSnapshot;e=e.value;try{var u=s();return!p(e,u)}catch{return!0}}function p1(e){var s=_i(e,2);s!==null&&Fs(s,e,2)}function Yd(e){var s=Ts();if(typeof e=="function"){var u=e;if(e=u(),Oi){lt(!0);try{u()}finally{lt(!1)}}}return s.memoizedState=s.baseState=e,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ir,lastRenderedState:e},s}function x1(e,s,u,m){return e.baseState=u,Vd(e,un,typeof m=="function"?m:ir)}function Iy(e,s,u,m,b){if(Hc(e))throw Error(l(485));if(e=s.action,e!==null){var S={payload:b,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(I){S.listeners.push(I)}};$.T!==null?u(!0):S.isTransition=!1,m(S),u=s.pending,u===null?(S.next=s.pending=S,y1(s,S)):(S.next=u.next,s.pending=u.next=S)}}function y1(e,s){var u=s.action,m=s.payload,b=e.state;if(s.isTransition){var S=$.T,I={};$.T=I;try{var F=u(b,m),ee=$.S;ee!==null&&ee(I,F),w1(e,s,F)}catch(de){Xd(e,s,de)}finally{S!==null&&I.types!==null&&(S.types=I.types),$.T=S}}else try{S=u(b,m),w1(e,s,S)}catch(de){Xd(e,s,de)}}function w1(e,s,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(m){b1(e,s,m)},function(m){return Xd(e,s,m)}):b1(e,s,u)}function b1(e,s,u){s.status="fulfilled",s.value=u,v1(s),e.state=u,s=e.pending,s!==null&&(u=s.next,u===s?e.pending=null:(u=u.next,s.next=u,y1(e,u)))}function Xd(e,s,u){var m=e.pending;if(e.pending=null,m!==null){m=m.next;do s.status="rejected",s.reason=u,v1(s),s=s.next;while(s!==m)}e.action=null}function v1(e){e=e.listeners;for(var s=0;s<e.length;s++)(0,e[s])()}function C1(e,s){return s}function _1(e,s){if(zt){var u=pn.formState;if(u!==null){e:{var m=Ct;if(zt){if(Cn){t:{for(var b=Cn,S=ma;b.nodeType!==8;){if(!S){b=null;break t}if(b=xa(b.nextSibling),b===null){b=null;break t}}S=b.data,b=S==="F!"||S==="F"?b:null}if(b){Cn=xa(b.nextSibling),m=b.data==="F!";break e}}Ur(m)}m=!1}m&&(s=u[0])}}return u=Ts(),u.memoizedState=u.baseState=s,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:C1,lastRenderedState:s},u.queue=m,u=H1.bind(null,Ct,m),m.dispatch=u,m=Yd(!1),S=Jd.bind(null,Ct,!1,m.queue),m=Ts(),b={state:s,dispatch:null,action:e,pending:null},m.queue=b,u=Iy.bind(null,Ct,b,S,u),b.dispatch=u,m.memoizedState=e,[s,u,!1]}function S1(e){var s=Xn();return E1(s,un,e)}function E1(e,s,u){if(s=Vd(e,s,C1)[0],e=Pc(ir)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var m=bl(s)}catch(I){throw I===mo?jc:I}else m=s;s=Xn();var b=s.queue,S=b.dispatch;return u!==s.memoizedState&&(Ct.flags|=2048,bo(9,{destroy:void 0},Oy.bind(null,b,u),null)),[m,S,e]}function Oy(e,s){e.action=s}function A1(e){var s=Xn(),u=un;if(u!==null)return E1(s,u,e);Xn(),s=s.memoizedState,u=Xn();var m=u.queue.dispatch;return u.memoizedState=e,[s,m,!1]}function bo(e,s,u,m){return e={tag:e,create:u,deps:m,inst:s,next:null},s=Ct.updateQueue,s===null&&(s=Bc(),Ct.updateQueue=s),u=s.lastEffect,u===null?s.lastEffect=e.next=e:(m=u.next,u.next=e,e.next=m,s.lastEffect=e),e}function N1(){return Xn().memoizedState}function zc(e,s,u,m){var b=Ts();Ct.flags|=e,b.memoizedState=bo(1|s,{destroy:void 0},u,m===void 0?null:m)}function Fc(e,s,u,m){var b=Xn();m=m===void 0?null:m;var S=b.memoizedState.inst;un!==null&&m!==null&&Ud(m,un.memoizedState.deps)?b.memoizedState=bo(s,S,u,m):(Ct.flags|=e,b.memoizedState=bo(1|s,S,u,m))}function T1(e,s){zc(8390656,8,e,s)}function Wd(e,s){Fc(2048,8,e,s)}function My(e){Ct.flags|=4;var s=Ct.updateQueue;if(s===null)s=Bc(),Ct.updateQueue=s,s.events=[e];else{var u=s.events;u===null?s.events=[e]:u.push(e)}}function j1(e){var s=Xn().memoizedState;return My({ref:s,nextImpl:e}),function(){if((Jt&2)!==0)throw Error(l(440));return s.impl.apply(void 0,arguments)}}function R1(e,s){return Fc(4,2,e,s)}function I1(e,s){return Fc(4,4,e,s)}function O1(e,s){if(typeof s=="function"){e=e();var u=s(e);return function(){typeof u=="function"?u():s(null)}}if(s!=null)return e=e(),s.current=e,function(){s.current=null}}function M1(e,s,u){u=u!=null?u.concat([e]):null,Fc(4,4,O1.bind(null,s,e),u)}function Qd(){}function k1(e,s){var u=Xn();s=s===void 0?null:s;var m=u.memoizedState;return s!==null&&Ud(s,m[1])?m[0]:(u.memoizedState=[e,s],e)}function D1(e,s){var u=Xn();s=s===void 0?null:s;var m=u.memoizedState;if(s!==null&&Ud(s,m[1]))return m[0];if(m=e(),Oi){lt(!0);try{e()}finally{lt(!1)}}return u.memoizedState=[m,s],m}function Kd(e,s,u){return u===void 0||(rr&1073741824)!==0&&(Dt&261930)===0?e.memoizedState=s:(e.memoizedState=u,e=Lg(),Ct.lanes|=e,Xr|=e,u)}function L1(e,s,u,m){return p(u,s)?u:xo.current!==null?(e=Kd(e,u,m),p(e,s)||($n=!0),e):(rr&42)===0||(rr&1073741824)!==0&&(Dt&261930)===0?($n=!0,e.memoizedState=u):(e=Lg(),Ct.lanes|=e,Xr|=e,s)}function B1(e,s,u,m,b){var S=oe.p;oe.p=S!==0&&8>S?S:8;var I=$.T,F={};$.T=F,Jd(e,!1,s,u);try{var ee=b(),de=$.S;if(de!==null&&de(F,ee),ee!==null&&typeof ee=="object"&&typeof ee.then=="function"){var ve=Ty(ee,m);vl(e,s,ve,ta(e))}else vl(e,s,m,ta(e))}catch(Ae){vl(e,s,{then:function(){},status:"rejected",reason:Ae},ta())}finally{oe.p=S,I!==null&&F.types!==null&&(I.types=F.types),$.T=I}}function ky(){}function Zd(e,s,u,m){if(e.tag!==5)throw Error(l(476));var b=U1(e).queue;B1(e,b,s,ke,u===null?ky:function(){return P1(e),u(m)})}function U1(e){var s=e.memoizedState;if(s!==null)return s;s={memoizedState:ke,baseState:ke,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ir,lastRenderedState:ke},next:null};var u={};return s.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ir,lastRenderedState:u},next:null},e.memoizedState=s,e=e.alternate,e!==null&&(e.memoizedState=s),s}function P1(e){var s=U1(e);s.next===null&&(s=e.alternate.memoizedState),vl(e,s.next.queue,{},ta())}function $d(){return xs(Ul)}function z1(){return Xn().memoizedState}function F1(){return Xn().memoizedState}function Dy(e){for(var s=e.return;s!==null;){switch(s.tag){case 24:case 3:var u=ta();e=Fr(u);var m=Hr(s,e,u);m!==null&&(Fs(m,s,u),pl(m,s,u)),s={cache:Nd()},e.payload=s;return}s=s.return}}function Ly(e,s,u){var m=ta();u={lane:m,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Hc(e)?q1(s,u):(u=pd(e,s,u,m),u!==null&&(Fs(u,e,m),V1(u,s,m)))}function H1(e,s,u){var m=ta();vl(e,s,u,m)}function vl(e,s,u,m){var b={lane:m,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Hc(e))q1(s,b);else{var S=e.alternate;if(e.lanes===0&&(S===null||S.lanes===0)&&(S=s.lastRenderedReducer,S!==null))try{var I=s.lastRenderedState,F=S(I,u);if(b.hasEagerState=!0,b.eagerState=F,p(F,I))return Cc(e,s,b,0),pn===null&&vc(),!1}catch{}finally{}if(u=pd(e,s,b,m),u!==null)return Fs(u,e,m),V1(u,s,m),!0}return!1}function Jd(e,s,u,m){if(m={lane:2,revertLane:Ih(),gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Hc(e)){if(s)throw Error(l(479))}else s=pd(e,u,m,2),s!==null&&Fs(s,e,2)}function Hc(e){var s=e.alternate;return e===Ct||s!==null&&s===Ct}function q1(e,s){yo=Dc=!0;var u=e.pending;u===null?s.next=s:(s.next=u.next,u.next=s),e.pending=s}function V1(e,s,u){if((u&4194048)!==0){var m=s.lanes;m&=e.pendingLanes,u|=m,s.lanes=u,On(e,u)}}var Cl={readContext:xs,use:Uc,useCallback:Pn,useContext:Pn,useEffect:Pn,useImperativeHandle:Pn,useLayoutEffect:Pn,useInsertionEffect:Pn,useMemo:Pn,useReducer:Pn,useRef:Pn,useState:Pn,useDebugValue:Pn,useDeferredValue:Pn,useTransition:Pn,useSyncExternalStore:Pn,useId:Pn,useHostTransitionStatus:Pn,useFormState:Pn,useActionState:Pn,useOptimistic:Pn,useMemoCache:Pn,useCacheRefresh:Pn};Cl.useEffectEvent=Pn;var G1={readContext:xs,use:Uc,useCallback:function(e,s){return Ts().memoizedState=[e,s===void 0?null:s],e},useContext:xs,useEffect:T1,useImperativeHandle:function(e,s,u){u=u!=null?u.concat([e]):null,zc(4194308,4,O1.bind(null,s,e),u)},useLayoutEffect:function(e,s){return zc(4194308,4,e,s)},useInsertionEffect:function(e,s){zc(4,2,e,s)},useMemo:function(e,s){var u=Ts();s=s===void 0?null:s;var m=e();if(Oi){lt(!0);try{e()}finally{lt(!1)}}return u.memoizedState=[m,s],m},useReducer:function(e,s,u){var m=Ts();if(u!==void 0){var b=u(s);if(Oi){lt(!0);try{u(s)}finally{lt(!1)}}}else b=s;return m.memoizedState=m.baseState=b,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:b},m.queue=e,e=e.dispatch=Ly.bind(null,Ct,e),[m.memoizedState,e]},useRef:function(e){var s=Ts();return e={current:e},s.memoizedState=e},useState:function(e){e=Yd(e);var s=e.queue,u=H1.bind(null,Ct,s);return s.dispatch=u,[e.memoizedState,u]},useDebugValue:Qd,useDeferredValue:function(e,s){var u=Ts();return Kd(u,e,s)},useTransition:function(){var e=Yd(!1);return e=B1.bind(null,Ct,e.queue,!0,!1),Ts().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,s,u){var m=Ct,b=Ts();if(zt){if(u===void 0)throw Error(l(407));u=u()}else{if(u=s(),pn===null)throw Error(l(349));(Dt&127)!==0||h1(m,s,u)}b.memoizedState=u;var S={value:u,getSnapshot:s};return b.queue=S,T1(g1.bind(null,m,S,e),[e]),m.flags|=2048,bo(9,{destroy:void 0},f1.bind(null,m,S,u,s),null),u},useId:function(){var e=Ts(),s=pn.identifierPrefix;if(zt){var u=Fa,m=za;u=(m&~(1<<32-gt(m)-1)).toString(32)+u,s="_"+s+"R_"+u,u=Lc++,0<u&&(s+="H"+u.toString(32)),s+="_"}else u=jy++,s="_"+s+"r_"+u.toString(32)+"_";return e.memoizedState=s},useHostTransitionStatus:$d,useFormState:_1,useActionState:_1,useOptimistic:function(e){var s=Ts();s.memoizedState=s.baseState=e;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=u,s=Jd.bind(null,Ct,!0,u),u.dispatch=s,[e,s]},useMemoCache:qd,useCacheRefresh:function(){return Ts().memoizedState=Dy.bind(null,Ct)},useEffectEvent:function(e){var s=Ts(),u={impl:e};return s.memoizedState=u,function(){if((Jt&2)!==0)throw Error(l(440));return u.impl.apply(void 0,arguments)}}},eh={readContext:xs,use:Uc,useCallback:k1,useContext:xs,useEffect:Wd,useImperativeHandle:M1,useInsertionEffect:R1,useLayoutEffect:I1,useMemo:D1,useReducer:Pc,useRef:N1,useState:function(){return Pc(ir)},useDebugValue:Qd,useDeferredValue:function(e,s){var u=Xn();return L1(u,un.memoizedState,e,s)},useTransition:function(){var e=Pc(ir)[0],s=Xn().memoizedState;return[typeof e=="boolean"?e:bl(e),s]},useSyncExternalStore:d1,useId:z1,useHostTransitionStatus:$d,useFormState:S1,useActionState:S1,useOptimistic:function(e,s){var u=Xn();return x1(u,un,e,s)},useMemoCache:qd,useCacheRefresh:F1};eh.useEffectEvent=j1;var Y1={readContext:xs,use:Uc,useCallback:k1,useContext:xs,useEffect:Wd,useImperativeHandle:M1,useInsertionEffect:R1,useLayoutEffect:I1,useMemo:D1,useReducer:Gd,useRef:N1,useState:function(){return Gd(ir)},useDebugValue:Qd,useDeferredValue:function(e,s){var u=Xn();return un===null?Kd(u,e,s):L1(u,un.memoizedState,e,s)},useTransition:function(){var e=Gd(ir)[0],s=Xn().memoizedState;return[typeof e=="boolean"?e:bl(e),s]},useSyncExternalStore:d1,useId:z1,useHostTransitionStatus:$d,useFormState:A1,useActionState:A1,useOptimistic:function(e,s){var u=Xn();return un!==null?x1(u,un,e,s):(u.baseState=e,[e,u.queue.dispatch])},useMemoCache:qd,useCacheRefresh:F1};Y1.useEffectEvent=j1;function th(e,s,u,m){s=e.memoizedState,u=u(m,s),u=u==null?s:N({},s,u),e.memoizedState=u,e.lanes===0&&(e.updateQueue.baseState=u)}var nh={enqueueSetState:function(e,s,u){e=e._reactInternals;var m=ta(),b=Fr(m);b.payload=s,u!=null&&(b.callback=u),s=Hr(e,b,m),s!==null&&(Fs(s,e,m),pl(s,e,m))},enqueueReplaceState:function(e,s,u){e=e._reactInternals;var m=ta(),b=Fr(m);b.tag=1,b.payload=s,u!=null&&(b.callback=u),s=Hr(e,b,m),s!==null&&(Fs(s,e,m),pl(s,e,m))},enqueueForceUpdate:function(e,s){e=e._reactInternals;var u=ta(),m=Fr(u);m.tag=2,s!=null&&(m.callback=s),s=Hr(e,m,u),s!==null&&(Fs(s,e,u),pl(s,e,u))}};function X1(e,s,u,m,b,S,I){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(m,S,I):s.prototype&&s.prototype.isPureReactComponent?!y(u,m)||!y(b,S):!0}function W1(e,s,u,m){e=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(u,m),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(u,m),s.state!==e&&nh.enqueueReplaceState(s,s.state,null)}function Mi(e,s){var u=s;if("ref"in s){u={};for(var m in s)m!=="ref"&&(u[m]=s[m])}if(e=e.defaultProps){u===s&&(u=N({},u));for(var b in e)u[b]===void 0&&(u[b]=e[b])}return u}function Q1(e){bc(e)}function K1(e){console.error(e)}function Z1(e){bc(e)}function qc(e,s){try{var u=e.onUncaughtError;u(s.value,{componentStack:s.stack})}catch(m){setTimeout(function(){throw m})}}function $1(e,s,u){try{var m=e.onCaughtError;m(u.value,{componentStack:u.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function sh(e,s,u){return u=Fr(u),u.tag=3,u.payload={element:null},u.callback=function(){qc(e,s)},u}function J1(e){return e=Fr(e),e.tag=3,e}function eg(e,s,u,m){var b=u.type.getDerivedStateFromError;if(typeof b=="function"){var S=m.value;e.payload=function(){return b(S)},e.callback=function(){$1(s,u,m)}}var I=u.stateNode;I!==null&&typeof I.componentDidCatch=="function"&&(e.callback=function(){$1(s,u,m),typeof b!="function"&&(Wr===null?Wr=new Set([this]):Wr.add(this));var F=m.stack;this.componentDidCatch(m.value,{componentStack:F!==null?F:""})})}function By(e,s,u,m,b){if(u.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(s=u.alternate,s!==null&&ho(s,u,b,!0),u=Zs.current,u!==null){switch(u.tag){case 31:case 13:return pa===null?tu():u.alternate===null&&zn===0&&(zn=3),u.flags&=-257,u.flags|=65536,u.lanes=b,m===Rc?u.flags|=16384:(s=u.updateQueue,s===null?u.updateQueue=new Set([m]):s.add(m),Th(e,m,b)),!1;case 22:return u.flags|=65536,m===Rc?u.flags|=16384:(s=u.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([m])},u.updateQueue=s):(u=s.retryQueue,u===null?s.retryQueue=new Set([m]):u.add(m)),Th(e,m,b)),!1}throw Error(l(435,u.tag))}return Th(e,m,b),tu(),!1}if(zt)return s=Zs.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=b,m!==Cd&&(e=Error(l(422),{cause:m}),dl(ha(e,u)))):(m!==Cd&&(s=Error(l(423),{cause:m}),dl(ha(s,u))),e=e.current.alternate,e.flags|=65536,b&=-b,e.lanes|=b,m=ha(m,u),b=sh(e.stateNode,m,b),Md(e,b),zn!==4&&(zn=2)),!1;var S=Error(l(520),{cause:m});if(S=ha(S,u),Rl===null?Rl=[S]:Rl.push(S),zn!==4&&(zn=2),s===null)return!0;m=ha(m,u),u=s;do{switch(u.tag){case 3:return u.flags|=65536,e=b&-b,u.lanes|=e,e=sh(u.stateNode,m,e),Md(u,e),!1;case 1:if(s=u.type,S=u.stateNode,(u.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Wr===null||!Wr.has(S))))return u.flags|=65536,b&=-b,u.lanes|=b,b=J1(b),eg(b,e,u,m),Md(u,b),!1}u=u.return}while(u!==null);return!1}var ah=Error(l(461)),$n=!1;function ys(e,s,u,m){s.child=e===null?a1(s,null,u,m):Ii(s,e.child,u,m)}function tg(e,s,u,m,b){u=u.render;var S=s.ref;if("ref"in m){var I={};for(var F in m)F!=="ref"&&(I[F]=m[F])}else I=m;return Ni(s),m=Pd(e,s,u,I,S,b),F=zd(),e!==null&&!$n?(Fd(e,s,b),or(e,s,b)):(zt&&F&&bd(s),s.flags|=1,ys(e,s,m,b),s.child)}function ng(e,s,u,m,b){if(e===null){var S=u.type;return typeof S=="function"&&!xd(S)&&S.defaultProps===void 0&&u.compare===null?(s.tag=15,s.type=S,sg(e,s,S,m,b)):(e=Sc(u.type,null,m,s,s.mode,b),e.ref=s.ref,e.return=s,s.child=e)}if(S=e.child,!hh(e,b)){var I=S.memoizedProps;if(u=u.compare,u=u!==null?u:y,u(I,m)&&e.ref===s.ref)return or(e,s,b)}return s.flags|=1,e=tr(S,m),e.ref=s.ref,e.return=s,s.child=e}function sg(e,s,u,m,b){if(e!==null){var S=e.memoizedProps;if(y(S,m)&&e.ref===s.ref)if($n=!1,s.pendingProps=m=S,hh(e,b))(e.flags&131072)!==0&&($n=!0);else return s.lanes=e.lanes,or(e,s,b)}return rh(e,s,u,m,b)}function ag(e,s,u,m){var b=m.children,S=e!==null?e.memoizedState:null;if(e===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.mode==="hidden"){if((s.flags&128)!==0){if(S=S!==null?S.baseLanes|u:u,e!==null){for(m=s.child=e.child,b=0;m!==null;)b=b|m.lanes|m.childLanes,m=m.sibling;m=b&~S}else m=0,s.child=null;return rg(e,s,S,u,m)}if((u&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},e!==null&&Tc(s,S!==null?S.cachePool:null),S!==null?o1(s,S):Dd(),l1(s);else return m=s.lanes=536870912,rg(e,s,S!==null?S.baseLanes|u:u,u,m)}else S!==null?(Tc(s,S.cachePool),o1(s,S),Vr(),s.memoizedState=null):(e!==null&&Tc(s,null),Dd(),Vr());return ys(e,s,b,u),s.child}function _l(e,s){return e!==null&&e.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function rg(e,s,u,m,b){var S=jd();return S=S===null?null:{parent:Kn._currentValue,pool:S},s.memoizedState={baseLanes:u,cachePool:S},e!==null&&Tc(s,null),Dd(),l1(s),e!==null&&ho(e,s,m,!0),s.childLanes=b,null}function Vc(e,s){return s=Yc({mode:s.mode,children:s.children},e.mode),s.ref=e.ref,e.child=s,s.return=e,s}function ig(e,s,u){return Ii(s,e.child,null,u),e=Vc(s,s.pendingProps),e.flags|=2,$s(s),s.memoizedState=null,e}function Uy(e,s,u){var m=s.pendingProps,b=(s.flags&128)!==0;if(s.flags&=-129,e===null){if(zt){if(m.mode==="hidden")return e=Vc(s,m),s.lanes=536870912,_l(null,e);if(Bd(s),(e=Cn)?(e=ym(e,ma),e=e!==null&&e.data==="&"?e:null,e!==null&&(s.memoizedState={dehydrated:e,treeContext:Lr!==null?{id:za,overflow:Fa}:null,retryLane:536870912,hydrationErrors:null},u=q0(e),u.return=s,s.child=u,ps=s,Cn=null)):e=null,e===null)throw Ur(s);return s.lanes=536870912,null}return Vc(s,m)}var S=e.memoizedState;if(S!==null){var I=S.dehydrated;if(Bd(s),b)if(s.flags&256)s.flags&=-257,s=ig(e,s,u);else if(s.memoizedState!==null)s.child=e.child,s.flags|=128,s=null;else throw Error(l(558));else if($n||ho(e,s,u,!1),b=(u&e.childLanes)!==0,$n||b){if(m=pn,m!==null&&(I=hs(m,u),I!==0&&I!==S.retryLane))throw S.retryLane=I,_i(e,I),Fs(m,e,I),ah;tu(),s=ig(e,s,u)}else e=S.treeContext,Cn=xa(I.nextSibling),ps=s,zt=!0,Br=null,ma=!1,e!==null&&Y0(s,e),s=Vc(s,m),s.flags|=4096;return s}return e=tr(e.child,{mode:m.mode,children:m.children}),e.ref=s.ref,s.child=e,e.return=s,e}function Gc(e,s){var u=s.ref;if(u===null)e!==null&&e.ref!==null&&(s.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(l(284));(e===null||e.ref!==u)&&(s.flags|=4194816)}}function rh(e,s,u,m,b){return Ni(s),u=Pd(e,s,u,m,void 0,b),m=zd(),e!==null&&!$n?(Fd(e,s,b),or(e,s,b)):(zt&&m&&bd(s),s.flags|=1,ys(e,s,u,b),s.child)}function og(e,s,u,m,b,S){return Ni(s),s.updateQueue=null,u=u1(s,m,u,b),c1(e),m=zd(),e!==null&&!$n?(Fd(e,s,S),or(e,s,S)):(zt&&m&&bd(s),s.flags|=1,ys(e,s,u,S),s.child)}function lg(e,s,u,m,b){if(Ni(s),s.stateNode===null){var S=oo,I=u.contextType;typeof I=="object"&&I!==null&&(S=xs(I)),S=new u(m,S),s.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=nh,s.stateNode=S,S._reactInternals=s,S=s.stateNode,S.props=m,S.state=s.memoizedState,S.refs={},Id(s),I=u.contextType,S.context=typeof I=="object"&&I!==null?xs(I):oo,S.state=s.memoizedState,I=u.getDerivedStateFromProps,typeof I=="function"&&(th(s,u,I,m),S.state=s.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(I=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),I!==S.state&&nh.enqueueReplaceState(S,S.state,null),yl(s,m,S,b),xl(),S.state=s.memoizedState),typeof S.componentDidMount=="function"&&(s.flags|=4194308),m=!0}else if(e===null){S=s.stateNode;var F=s.memoizedProps,ee=Mi(u,F);S.props=ee;var de=S.context,ve=u.contextType;I=oo,typeof ve=="object"&&ve!==null&&(I=xs(ve));var Ae=u.getDerivedStateFromProps;ve=typeof Ae=="function"||typeof S.getSnapshotBeforeUpdate=="function",F=s.pendingProps!==F,ve||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(F||de!==I)&&W1(s,S,m,I),zr=!1;var fe=s.memoizedState;S.state=fe,yl(s,m,S,b),xl(),de=s.memoizedState,F||fe!==de||zr?(typeof Ae=="function"&&(th(s,u,Ae,m),de=s.memoizedState),(ee=zr||X1(s,u,ee,m,fe,de,I))?(ve||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(s.flags|=4194308)):(typeof S.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=m,s.memoizedState=de),S.props=m,S.state=de,S.context=I,m=ee):(typeof S.componentDidMount=="function"&&(s.flags|=4194308),m=!1)}else{S=s.stateNode,Od(e,s),I=s.memoizedProps,ve=Mi(u,I),S.props=ve,Ae=s.pendingProps,fe=S.context,de=u.contextType,ee=oo,typeof de=="object"&&de!==null&&(ee=xs(de)),F=u.getDerivedStateFromProps,(de=typeof F=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(I!==Ae||fe!==ee)&&W1(s,S,m,ee),zr=!1,fe=s.memoizedState,S.state=fe,yl(s,m,S,b),xl();var we=s.memoizedState;I!==Ae||fe!==we||zr||e!==null&&e.dependencies!==null&&Ac(e.dependencies)?(typeof F=="function"&&(th(s,u,F,m),we=s.memoizedState),(ve=zr||X1(s,u,ve,m,fe,we,ee)||e!==null&&e.dependencies!==null&&Ac(e.dependencies))?(de||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(m,we,ee),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(m,we,ee)),typeof S.componentDidUpdate=="function"&&(s.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof S.componentDidUpdate!="function"||I===e.memoizedProps&&fe===e.memoizedState||(s.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||I===e.memoizedProps&&fe===e.memoizedState||(s.flags|=1024),s.memoizedProps=m,s.memoizedState=we),S.props=m,S.state=we,S.context=ee,m=ve):(typeof S.componentDidUpdate!="function"||I===e.memoizedProps&&fe===e.memoizedState||(s.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||I===e.memoizedProps&&fe===e.memoizedState||(s.flags|=1024),m=!1)}return S=m,Gc(e,s),m=(s.flags&128)!==0,S||m?(S=s.stateNode,u=m&&typeof u.getDerivedStateFromError!="function"?null:S.render(),s.flags|=1,e!==null&&m?(s.child=Ii(s,e.child,null,b),s.child=Ii(s,null,u,b)):ys(e,s,u,b),s.memoizedState=S.state,e=s.child):e=or(e,s,b),e}function cg(e,s,u,m){return Ei(),s.flags|=256,ys(e,s,u,m),s.child}var ih={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function oh(e){return{baseLanes:e,cachePool:$0()}}function lh(e,s,u){return e=e!==null?e.childLanes&~u:0,s&&(e|=ea),e}function ug(e,s,u){var m=s.pendingProps,b=!1,S=(s.flags&128)!==0,I;if((I=S)||(I=e!==null&&e.memoizedState===null?!1:(Yn.current&2)!==0),I&&(b=!0,s.flags&=-129),I=(s.flags&32)!==0,s.flags&=-33,e===null){if(zt){if(b?qr(s):Vr(),(e=Cn)?(e=ym(e,ma),e=e!==null&&e.data!=="&"?e:null,e!==null&&(s.memoizedState={dehydrated:e,treeContext:Lr!==null?{id:za,overflow:Fa}:null,retryLane:536870912,hydrationErrors:null},u=q0(e),u.return=s,s.child=u,ps=s,Cn=null)):e=null,e===null)throw Ur(s);return Vh(e)?s.lanes=32:s.lanes=536870912,null}var F=m.children;return m=m.fallback,b?(Vr(),b=s.mode,F=Yc({mode:"hidden",children:F},b),m=Si(m,b,u,null),F.return=s,m.return=s,F.sibling=m,s.child=F,m=s.child,m.memoizedState=oh(u),m.childLanes=lh(e,I,u),s.memoizedState=ih,_l(null,m)):(qr(s),ch(s,F))}var ee=e.memoizedState;if(ee!==null&&(F=ee.dehydrated,F!==null)){if(S)s.flags&256?(qr(s),s.flags&=-257,s=uh(e,s,u)):s.memoizedState!==null?(Vr(),s.child=e.child,s.flags|=128,s=null):(Vr(),F=m.fallback,b=s.mode,m=Yc({mode:"visible",children:m.children},b),F=Si(F,b,u,null),F.flags|=2,m.return=s,F.return=s,m.sibling=F,s.child=m,Ii(s,e.child,null,u),m=s.child,m.memoizedState=oh(u),m.childLanes=lh(e,I,u),s.memoizedState=ih,s=_l(null,m));else if(qr(s),Vh(F)){if(I=F.nextSibling&&F.nextSibling.dataset,I)var de=I.dgst;I=de,m=Error(l(419)),m.stack="",m.digest=I,dl({value:m,source:null,stack:null}),s=uh(e,s,u)}else if($n||ho(e,s,u,!1),I=(u&e.childLanes)!==0,$n||I){if(I=pn,I!==null&&(m=hs(I,u),m!==0&&m!==ee.retryLane))throw ee.retryLane=m,_i(e,m),Fs(I,e,m),ah;qh(F)||tu(),s=uh(e,s,u)}else qh(F)?(s.flags|=192,s.child=e.child,s=null):(e=ee.treeContext,Cn=xa(F.nextSibling),ps=s,zt=!0,Br=null,ma=!1,e!==null&&Y0(s,e),s=ch(s,m.children),s.flags|=4096);return s}return b?(Vr(),F=m.fallback,b=s.mode,ee=e.child,de=ee.sibling,m=tr(ee,{mode:"hidden",children:m.children}),m.subtreeFlags=ee.subtreeFlags&65011712,de!==null?F=tr(de,F):(F=Si(F,b,u,null),F.flags|=2),F.return=s,m.return=s,m.sibling=F,s.child=m,_l(null,m),m=s.child,F=e.child.memoizedState,F===null?F=oh(u):(b=F.cachePool,b!==null?(ee=Kn._currentValue,b=b.parent!==ee?{parent:ee,pool:ee}:b):b=$0(),F={baseLanes:F.baseLanes|u,cachePool:b}),m.memoizedState=F,m.childLanes=lh(e,I,u),s.memoizedState=ih,_l(e.child,m)):(qr(s),u=e.child,e=u.sibling,u=tr(u,{mode:"visible",children:m.children}),u.return=s,u.sibling=null,e!==null&&(I=s.deletions,I===null?(s.deletions=[e],s.flags|=16):I.push(e)),s.child=u,s.memoizedState=null,u)}function ch(e,s){return s=Yc({mode:"visible",children:s},e.mode),s.return=e,e.child=s}function Yc(e,s){return e=Ks(22,e,null,s),e.lanes=0,e}function uh(e,s,u){return Ii(s,e.child,null,u),e=ch(s,s.pendingProps.children),e.flags|=2,s.memoizedState=null,e}function dg(e,s,u){e.lanes|=s;var m=e.alternate;m!==null&&(m.lanes|=s),Ed(e.return,s,u)}function dh(e,s,u,m,b,S){var I=e.memoizedState;I===null?e.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:m,tail:u,tailMode:b,treeForkCount:S}:(I.isBackwards=s,I.rendering=null,I.renderingStartTime=0,I.last=m,I.tail=u,I.tailMode=b,I.treeForkCount=S)}function hg(e,s,u){var m=s.pendingProps,b=m.revealOrder,S=m.tail;m=m.children;var I=Yn.current,F=(I&2)!==0;if(F?(I=I&1|2,s.flags|=128):I&=1,Le(Yn,I),ys(e,s,m,u),m=zt?ul:0,!F&&e!==null&&(e.flags&128)!==0)e:for(e=s.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&dg(e,u,s);else if(e.tag===19)dg(e,u,s);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break e;for(;e.sibling===null;){if(e.return===null||e.return===s)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(b){case"forwards":for(u=s.child,b=null;u!==null;)e=u.alternate,e!==null&&kc(e)===null&&(b=u),u=u.sibling;u=b,u===null?(b=s.child,s.child=null):(b=u.sibling,u.sibling=null),dh(s,!1,b,u,S,m);break;case"backwards":case"unstable_legacy-backwards":for(u=null,b=s.child,s.child=null;b!==null;){if(e=b.alternate,e!==null&&kc(e)===null){s.child=b;break}e=b.sibling,b.sibling=u,u=b,b=e}dh(s,!0,u,null,S,m);break;case"together":dh(s,!1,null,null,void 0,m);break;default:s.memoizedState=null}return s.child}function or(e,s,u){if(e!==null&&(s.dependencies=e.dependencies),Xr|=s.lanes,(u&s.childLanes)===0)if(e!==null){if(ho(e,s,u,!1),(u&s.childLanes)===0)return null}else return null;if(e!==null&&s.child!==e.child)throw Error(l(153));if(s.child!==null){for(e=s.child,u=tr(e,e.pendingProps),s.child=u,u.return=s;e.sibling!==null;)e=e.sibling,u=u.sibling=tr(e,e.pendingProps),u.return=s;u.sibling=null}return s.child}function hh(e,s){return(e.lanes&s)!==0?!0:(e=e.dependencies,!!(e!==null&&Ac(e)))}function Py(e,s,u){switch(s.tag){case 3:De(s,s.stateNode.containerInfo),Pr(s,Kn,e.memoizedState.cache),Ei();break;case 27:case 5:Je(s);break;case 4:De(s,s.stateNode.containerInfo);break;case 10:Pr(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Bd(s),null;break;case 13:var m=s.memoizedState;if(m!==null)return m.dehydrated!==null?(qr(s),s.flags|=128,null):(u&s.child.childLanes)!==0?ug(e,s,u):(qr(s),e=or(e,s,u),e!==null?e.sibling:null);qr(s);break;case 19:var b=(e.flags&128)!==0;if(m=(u&s.childLanes)!==0,m||(ho(e,s,u,!1),m=(u&s.childLanes)!==0),b){if(m)return hg(e,s,u);s.flags|=128}if(b=s.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),Le(Yn,Yn.current),m)break;return null;case 22:return s.lanes=0,ag(e,s,u,s.pendingProps);case 24:Pr(s,Kn,e.memoizedState.cache)}return or(e,s,u)}function fg(e,s,u){if(e!==null)if(e.memoizedProps!==s.pendingProps)$n=!0;else{if(!hh(e,u)&&(s.flags&128)===0)return $n=!1,Py(e,s,u);$n=(e.flags&131072)!==0}else $n=!1,zt&&(s.flags&1048576)!==0&&G0(s,ul,s.index);switch(s.lanes=0,s.tag){case 16:e:{var m=s.pendingProps;if(e=ji(s.elementType),s.type=e,typeof e=="function")xd(e)?(m=Mi(e,m),s.tag=1,s=lg(null,s,e,m,u)):(s.tag=0,s=rh(null,s,e,m,u));else{if(e!=null){var b=e.$$typeof;if(b===K){s.tag=11,s=tg(null,s,e,m,u);break e}else if(b===X){s.tag=14,s=ng(null,s,e,m,u);break e}}throw s=Ie(e)||e,Error(l(306,s,""))}}return s;case 0:return rh(e,s,s.type,s.pendingProps,u);case 1:return m=s.type,b=Mi(m,s.pendingProps),lg(e,s,m,b,u);case 3:e:{if(De(s,s.stateNode.containerInfo),e===null)throw Error(l(387));m=s.pendingProps;var S=s.memoizedState;b=S.element,Od(e,s),yl(s,m,null,u);var I=s.memoizedState;if(m=I.cache,Pr(s,Kn,m),m!==S.cache&&Ad(s,[Kn],u,!0),xl(),m=I.element,S.isDehydrated)if(S={element:m,isDehydrated:!1,cache:I.cache},s.updateQueue.baseState=S,s.memoizedState=S,s.flags&256){s=cg(e,s,m,u);break e}else if(m!==b){b=ha(Error(l(424)),s),dl(b),s=cg(e,s,m,u);break e}else{switch(e=s.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Cn=xa(e.firstChild),ps=s,zt=!0,Br=null,ma=!0,u=a1(s,null,m,u),s.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Ei(),m===b){s=or(e,s,u);break e}ys(e,s,m,u)}s=s.child}return s;case 26:return Gc(e,s),e===null?(u=Sm(s.type,null,s.pendingProps,null))?s.memoizedState=u:zt||(u=s.type,e=s.pendingProps,m=lu(Ne.current).createElement(u),m[Ee]=s,m[_e]=e,ws(m,u,e),Bn(m),s.stateNode=m):s.memoizedState=Sm(s.type,e.memoizedProps,s.pendingProps,e.memoizedState),null;case 27:return Je(s),e===null&&zt&&(m=s.stateNode=vm(s.type,s.pendingProps,Ne.current),ps=s,ma=!0,b=Cn,$r(s.type)?(Gh=b,Cn=xa(m.firstChild)):Cn=b),ys(e,s,s.pendingProps.children,u),Gc(e,s),e===null&&(s.flags|=4194304),s.child;case 5:return e===null&&zt&&((b=m=Cn)&&(m=mw(m,s.type,s.pendingProps,ma),m!==null?(s.stateNode=m,ps=s,Cn=xa(m.firstChild),ma=!1,b=!0):b=!1),b||Ur(s)),Je(s),b=s.type,S=s.pendingProps,I=e!==null?e.memoizedProps:null,m=S.children,zh(b,S)?m=null:I!==null&&zh(b,I)&&(s.flags|=32),s.memoizedState!==null&&(b=Pd(e,s,Ry,null,null,u),Ul._currentValue=b),Gc(e,s),ys(e,s,m,u),s.child;case 6:return e===null&&zt&&((e=u=Cn)&&(u=pw(u,s.pendingProps,ma),u!==null?(s.stateNode=u,ps=s,Cn=null,e=!0):e=!1),e||Ur(s)),null;case 13:return ug(e,s,u);case 4:return De(s,s.stateNode.containerInfo),m=s.pendingProps,e===null?s.child=Ii(s,null,m,u):ys(e,s,m,u),s.child;case 11:return tg(e,s,s.type,s.pendingProps,u);case 7:return ys(e,s,s.pendingProps,u),s.child;case 8:return ys(e,s,s.pendingProps.children,u),s.child;case 12:return ys(e,s,s.pendingProps.children,u),s.child;case 10:return m=s.pendingProps,Pr(s,s.type,m.value),ys(e,s,m.children,u),s.child;case 9:return b=s.type._context,m=s.pendingProps.children,Ni(s),b=xs(b),m=m(b),s.flags|=1,ys(e,s,m,u),s.child;case 14:return ng(e,s,s.type,s.pendingProps,u);case 15:return sg(e,s,s.type,s.pendingProps,u);case 19:return hg(e,s,u);case 31:return Uy(e,s,u);case 22:return ag(e,s,u,s.pendingProps);case 24:return Ni(s),m=xs(Kn),e===null?(b=jd(),b===null&&(b=pn,S=Nd(),b.pooledCache=S,S.refCount++,S!==null&&(b.pooledCacheLanes|=u),b=S),s.memoizedState={parent:m,cache:b},Id(s),Pr(s,Kn,b)):((e.lanes&u)!==0&&(Od(e,s),yl(s,null,null,u),xl()),b=e.memoizedState,S=s.memoizedState,b.parent!==m?(b={parent:m,cache:m},s.memoizedState=b,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=b),Pr(s,Kn,m)):(m=S.cache,Pr(s,Kn,m),m!==b.cache&&Ad(s,[Kn],u,!0))),ys(e,s,s.pendingProps.children,u),s.child;case 29:throw s.pendingProps}throw Error(l(156,s.tag))}function lr(e){e.flags|=4}function fh(e,s,u,m,b){if((s=(e.mode&32)!==0)&&(s=!1),s){if(e.flags|=16777216,(b&335544128)===b)if(e.stateNode.complete)e.flags|=8192;else if(zg())e.flags|=8192;else throw Ri=Rc,Rd}else e.flags&=-16777217}function gg(e,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!jm(s))if(zg())e.flags|=8192;else throw Ri=Rc,Rd}function Xc(e,s){s!==null&&(e.flags|=4),e.flags&16384&&(s=e.tag!==22?Pt():536870912,e.lanes|=s,So|=s)}function Sl(e,s){if(!zt)switch(e.tailMode){case"hidden":s=e.tail;for(var u=null;s!==null;)s.alternate!==null&&(u=s),s=s.sibling;u===null?e.tail=null:u.sibling=null;break;case"collapsed":u=e.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?s||e.tail===null?e.tail=null:e.tail.sibling=null:m.sibling=null}}function _n(e){var s=e.alternate!==null&&e.alternate.child===e.child,u=0,m=0;if(s)for(var b=e.child;b!==null;)u|=b.lanes|b.childLanes,m|=b.subtreeFlags&65011712,m|=b.flags&65011712,b.return=e,b=b.sibling;else for(b=e.child;b!==null;)u|=b.lanes|b.childLanes,m|=b.subtreeFlags,m|=b.flags,b.return=e,b=b.sibling;return e.subtreeFlags|=m,e.childLanes=u,s}function zy(e,s,u){var m=s.pendingProps;switch(vd(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(s),null;case 1:return _n(s),null;case 3:return u=s.stateNode,m=null,e!==null&&(m=e.memoizedState.cache),s.memoizedState.cache!==m&&(s.flags|=2048),ar(Kn),Ce(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(e===null||e.child===null)&&(uo(s)?lr(s):e===null||e.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,_d())),_n(s),null;case 26:var b=s.type,S=s.memoizedState;return e===null?(lr(s),S!==null?(_n(s),gg(s,S)):(_n(s),fh(s,b,null,m,u))):S?S!==e.memoizedState?(lr(s),_n(s),gg(s,S)):(_n(s),s.flags&=-16777217):(e=e.memoizedProps,e!==m&&lr(s),_n(s),fh(s,b,e,m,u)),null;case 27:if(mt(s),u=Ne.current,b=s.type,e!==null&&s.stateNode!=null)e.memoizedProps!==m&&lr(s);else{if(!m){if(s.stateNode===null)throw Error(l(166));return _n(s),null}e=Ue.current,uo(s)?X0(s):(e=vm(b,m,u),s.stateNode=e,lr(s))}return _n(s),null;case 5:if(mt(s),b=s.type,e!==null&&s.stateNode!=null)e.memoizedProps!==m&&lr(s);else{if(!m){if(s.stateNode===null)throw Error(l(166));return _n(s),null}if(S=Ue.current,uo(s))X0(s);else{var I=lu(Ne.current);switch(S){case 1:S=I.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:S=I.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":S=I.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":S=I.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":S=I.createElement("div"),S.innerHTML="<script><\/script>",S=S.removeChild(S.firstChild);break;case"select":S=typeof m.is=="string"?I.createElement("select",{is:m.is}):I.createElement("select"),m.multiple?S.multiple=!0:m.size&&(S.size=m.size);break;default:S=typeof m.is=="string"?I.createElement(b,{is:m.is}):I.createElement(b)}}S[Ee]=s,S[_e]=m;e:for(I=s.child;I!==null;){if(I.tag===5||I.tag===6)S.appendChild(I.stateNode);else if(I.tag!==4&&I.tag!==27&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===s)break e;for(;I.sibling===null;){if(I.return===null||I.return===s)break e;I=I.return}I.sibling.return=I.return,I=I.sibling}s.stateNode=S;e:switch(ws(S,b,m),b){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&lr(s)}}return _n(s),fh(s,s.type,e===null?null:e.memoizedProps,s.pendingProps,u),null;case 6:if(e&&s.stateNode!=null)e.memoizedProps!==m&&lr(s);else{if(typeof m!="string"&&s.stateNode===null)throw Error(l(166));if(e=Ne.current,uo(s)){if(e=s.stateNode,u=s.memoizedProps,m=null,b=ps,b!==null)switch(b.tag){case 27:case 5:m=b.memoizedProps}e[Ee]=s,e=!!(e.nodeValue===u||m!==null&&m.suppressHydrationWarning===!0||um(e.nodeValue,u)),e||Ur(s,!0)}else e=lu(e).createTextNode(m),e[Ee]=s,s.stateNode=e}return _n(s),null;case 31:if(u=s.memoizedState,e===null||e.memoizedState!==null){if(m=uo(s),u!==null){if(e===null){if(!m)throw Error(l(318));if(e=s.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(557));e[Ee]=s}else Ei(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;_n(s),e=!1}else u=_d(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=u),e=!0;if(!e)return s.flags&256?($s(s),s):($s(s),null);if((s.flags&128)!==0)throw Error(l(558))}return _n(s),null;case 13:if(m=s.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(b=uo(s),m!==null&&m.dehydrated!==null){if(e===null){if(!b)throw Error(l(318));if(b=s.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(l(317));b[Ee]=s}else Ei(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;_n(s),b=!1}else b=_d(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=b),b=!0;if(!b)return s.flags&256?($s(s),s):($s(s),null)}return $s(s),(s.flags&128)!==0?(s.lanes=u,s):(u=m!==null,e=e!==null&&e.memoizedState!==null,u&&(m=s.child,b=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(b=m.alternate.memoizedState.cachePool.pool),S=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(S=m.memoizedState.cachePool.pool),S!==b&&(m.flags|=2048)),u!==e&&u&&(s.child.flags|=8192),Xc(s,s.updateQueue),_n(s),null);case 4:return Ce(),e===null&&Dh(s.stateNode.containerInfo),_n(s),null;case 10:return ar(s.type),_n(s),null;case 19:if(ye(Yn),m=s.memoizedState,m===null)return _n(s),null;if(b=(s.flags&128)!==0,S=m.rendering,S===null)if(b)Sl(m,!1);else{if(zn!==0||e!==null&&(e.flags&128)!==0)for(e=s.child;e!==null;){if(S=kc(e),S!==null){for(s.flags|=128,Sl(m,!1),e=S.updateQueue,s.updateQueue=e,Xc(s,e),s.subtreeFlags=0,e=u,u=s.child;u!==null;)H0(u,e),u=u.sibling;return Le(Yn,Yn.current&1|2),zt&&nr(s,m.treeForkCount),s.child}e=e.sibling}m.tail!==null&&Fe()>$c&&(s.flags|=128,b=!0,Sl(m,!1),s.lanes=4194304)}else{if(!b)if(e=kc(S),e!==null){if(s.flags|=128,b=!0,e=e.updateQueue,s.updateQueue=e,Xc(s,e),Sl(m,!0),m.tail===null&&m.tailMode==="hidden"&&!S.alternate&&!zt)return _n(s),null}else 2*Fe()-m.renderingStartTime>$c&&u!==536870912&&(s.flags|=128,b=!0,Sl(m,!1),s.lanes=4194304);m.isBackwards?(S.sibling=s.child,s.child=S):(e=m.last,e!==null?e.sibling=S:s.child=S,m.last=S)}return m.tail!==null?(e=m.tail,m.rendering=e,m.tail=e.sibling,m.renderingStartTime=Fe(),e.sibling=null,u=Yn.current,Le(Yn,b?u&1|2:u&1),zt&&nr(s,m.treeForkCount),e):(_n(s),null);case 22:case 23:return $s(s),Ld(),m=s.memoizedState!==null,e!==null?e.memoizedState!==null!==m&&(s.flags|=8192):m&&(s.flags|=8192),m?(u&536870912)!==0&&(s.flags&128)===0&&(_n(s),s.subtreeFlags&6&&(s.flags|=8192)):_n(s),u=s.updateQueue,u!==null&&Xc(s,u.retryQueue),u=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(u=e.memoizedState.cachePool.pool),m=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(m=s.memoizedState.cachePool.pool),m!==u&&(s.flags|=2048),e!==null&&ye(Ti),null;case 24:return u=null,e!==null&&(u=e.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),ar(Kn),_n(s),null;case 25:return null;case 30:return null}throw Error(l(156,s.tag))}function Fy(e,s){switch(vd(s),s.tag){case 1:return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 3:return ar(Kn),Ce(),e=s.flags,(e&65536)!==0&&(e&128)===0?(s.flags=e&-65537|128,s):null;case 26:case 27:case 5:return mt(s),null;case 31:if(s.memoizedState!==null){if($s(s),s.alternate===null)throw Error(l(340));Ei()}return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 13:if($s(s),e=s.memoizedState,e!==null&&e.dehydrated!==null){if(s.alternate===null)throw Error(l(340));Ei()}return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 19:return ye(Yn),null;case 4:return Ce(),null;case 10:return ar(s.type),null;case 22:case 23:return $s(s),Ld(),e!==null&&ye(Ti),e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 24:return ar(Kn),null;case 25:return null;default:return null}}function mg(e,s){switch(vd(s),s.tag){case 3:ar(Kn),Ce();break;case 26:case 27:case 5:mt(s);break;case 4:Ce();break;case 31:s.memoizedState!==null&&$s(s);break;case 13:$s(s);break;case 19:ye(Yn);break;case 10:ar(s.type);break;case 22:case 23:$s(s),Ld(),e!==null&&ye(Ti);break;case 24:ar(Kn)}}function El(e,s){try{var u=s.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var b=m.next;u=b;do{if((u.tag&e)===e){m=void 0;var S=u.create,I=u.inst;m=S(),I.destroy=m}u=u.next}while(u!==b)}}catch(F){on(s,s.return,F)}}function Gr(e,s,u){try{var m=s.updateQueue,b=m!==null?m.lastEffect:null;if(b!==null){var S=b.next;m=S;do{if((m.tag&e)===e){var I=m.inst,F=I.destroy;if(F!==void 0){I.destroy=void 0,b=s;var ee=u,de=F;try{de()}catch(ve){on(b,ee,ve)}}}m=m.next}while(m!==S)}}catch(ve){on(s,s.return,ve)}}function pg(e){var s=e.updateQueue;if(s!==null){var u=e.stateNode;try{i1(s,u)}catch(m){on(e,e.return,m)}}}function xg(e,s,u){u.props=Mi(e.type,e.memoizedProps),u.state=e.memoizedState;try{u.componentWillUnmount()}catch(m){on(e,s,m)}}function Al(e,s){try{var u=e.ref;if(u!==null){switch(e.tag){case 26:case 27:case 5:var m=e.stateNode;break;case 30:m=e.stateNode;break;default:m=e.stateNode}typeof u=="function"?e.refCleanup=u(m):u.current=m}}catch(b){on(e,s,b)}}function Ha(e,s){var u=e.ref,m=e.refCleanup;if(u!==null)if(typeof m=="function")try{m()}catch(b){on(e,s,b)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(b){on(e,s,b)}else u.current=null}function yg(e){var s=e.type,u=e.memoizedProps,m=e.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":u.autoFocus&&m.focus();break e;case"img":u.src?m.src=u.src:u.srcSet&&(m.srcset=u.srcSet)}}catch(b){on(e,e.return,b)}}function gh(e,s,u){try{var m=e.stateNode;cw(m,e.type,u,s),m[_e]=s}catch(b){on(e,e.return,b)}}function wg(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&$r(e.type)||e.tag===4}function mh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||wg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&$r(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ph(e,s,u){var m=e.tag;if(m===5||m===6)e=e.stateNode,s?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(e,s):(s=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,s.appendChild(e),u=u._reactRootContainer,u!=null||s.onclick!==null||(s.onclick=ks));else if(m!==4&&(m===27&&$r(e.type)&&(u=e.stateNode,s=null),e=e.child,e!==null))for(ph(e,s,u),e=e.sibling;e!==null;)ph(e,s,u),e=e.sibling}function Wc(e,s,u){var m=e.tag;if(m===5||m===6)e=e.stateNode,s?u.insertBefore(e,s):u.appendChild(e);else if(m!==4&&(m===27&&$r(e.type)&&(u=e.stateNode),e=e.child,e!==null))for(Wc(e,s,u),e=e.sibling;e!==null;)Wc(e,s,u),e=e.sibling}function bg(e){var s=e.stateNode,u=e.memoizedProps;try{for(var m=e.type,b=s.attributes;b.length;)s.removeAttributeNode(b[0]);ws(s,m,u),s[Ee]=e,s[_e]=u}catch(S){on(e,e.return,S)}}var cr=!1,Jn=!1,xh=!1,vg=typeof WeakSet=="function"?WeakSet:Set,cs=null;function Hy(e,s){if(e=e.containerInfo,Uh=mu,e=D(e),z(e)){if("selectionStart"in e)var u={start:e.selectionStart,end:e.selectionEnd};else e:{u=(u=e.ownerDocument)&&u.defaultView||window;var m=u.getSelection&&u.getSelection();if(m&&m.rangeCount!==0){u=m.anchorNode;var b=m.anchorOffset,S=m.focusNode;m=m.focusOffset;try{u.nodeType,S.nodeType}catch{u=null;break e}var I=0,F=-1,ee=-1,de=0,ve=0,Ae=e,fe=null;t:for(;;){for(var we;Ae!==u||b!==0&&Ae.nodeType!==3||(F=I+b),Ae!==S||m!==0&&Ae.nodeType!==3||(ee=I+m),Ae.nodeType===3&&(I+=Ae.nodeValue.length),(we=Ae.firstChild)!==null;)fe=Ae,Ae=we;for(;;){if(Ae===e)break t;if(fe===u&&++de===b&&(F=I),fe===S&&++ve===m&&(ee=I),(we=Ae.nextSibling)!==null)break;Ae=fe,fe=Ae.parentNode}Ae=we}u=F===-1||ee===-1?null:{start:F,end:ee}}else u=null}u=u||{start:0,end:0}}else u=null;for(Ph={focusedElem:e,selectionRange:u},mu=!1,cs=s;cs!==null;)if(s=cs,e=s.child,(s.subtreeFlags&1028)!==0&&e!==null)e.return=s,cs=e;else for(;cs!==null;){switch(s=cs,S=s.alternate,e=s.flags,s.tag){case 0:if((e&4)!==0&&(e=s.updateQueue,e=e!==null?e.events:null,e!==null))for(u=0;u<e.length;u++)b=e[u],b.ref.impl=b.nextImpl;break;case 11:case 15:break;case 1:if((e&1024)!==0&&S!==null){e=void 0,u=s,b=S.memoizedProps,S=S.memoizedState,m=u.stateNode;try{var Qe=Mi(u.type,b);e=m.getSnapshotBeforeUpdate(Qe,S),m.__reactInternalSnapshotBeforeUpdate=e}catch(ut){on(u,u.return,ut)}}break;case 3:if((e&1024)!==0){if(e=s.stateNode.containerInfo,u=e.nodeType,u===9)Hh(e);else if(u===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Hh(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=s.sibling,e!==null){e.return=s.return,cs=e;break}cs=s.return}}function Cg(e,s,u){var m=u.flags;switch(u.tag){case 0:case 11:case 15:dr(e,u),m&4&&El(5,u);break;case 1:if(dr(e,u),m&4)if(e=u.stateNode,s===null)try{e.componentDidMount()}catch(I){on(u,u.return,I)}else{var b=Mi(u.type,s.memoizedProps);s=s.memoizedState;try{e.componentDidUpdate(b,s,e.__reactInternalSnapshotBeforeUpdate)}catch(I){on(u,u.return,I)}}m&64&&pg(u),m&512&&Al(u,u.return);break;case 3:if(dr(e,u),m&64&&(e=u.updateQueue,e!==null)){if(s=null,u.child!==null)switch(u.child.tag){case 27:case 5:s=u.child.stateNode;break;case 1:s=u.child.stateNode}try{i1(e,s)}catch(I){on(u,u.return,I)}}break;case 27:s===null&&m&4&&bg(u);case 26:case 5:dr(e,u),s===null&&m&4&&yg(u),m&512&&Al(u,u.return);break;case 12:dr(e,u);break;case 31:dr(e,u),m&4&&Eg(e,u);break;case 13:dr(e,u),m&4&&Ag(e,u),m&64&&(e=u.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(u=Zy.bind(null,u),xw(e,u))));break;case 22:if(m=u.memoizedState!==null||cr,!m){s=s!==null&&s.memoizedState!==null||Jn,b=cr;var S=Jn;cr=m,(Jn=s)&&!S?hr(e,u,(u.subtreeFlags&8772)!==0):dr(e,u),cr=b,Jn=S}break;case 30:break;default:dr(e,u)}}function _g(e){var s=e.alternate;s!==null&&(e.alternate=null,_g(s)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(s=e.stateNode,s!==null&&Ms(s)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var An=null,Bs=!1;function ur(e,s,u){for(u=u.child;u!==null;)Sg(e,s,u),u=u.sibling}function Sg(e,s,u){if(je&&typeof je.onCommitFiberUnmount=="function")try{je.onCommitFiberUnmount(Ut,u)}catch{}switch(u.tag){case 26:Jn||Ha(u,s),ur(e,s,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Jn||Ha(u,s);var m=An,b=Bs;$r(u.type)&&(An=u.stateNode,Bs=!1),ur(e,s,u),Dl(u.stateNode),An=m,Bs=b;break;case 5:Jn||Ha(u,s);case 6:if(m=An,b=Bs,An=null,ur(e,s,u),An=m,Bs=b,An!==null)if(Bs)try{(An.nodeType===9?An.body:An.nodeName==="HTML"?An.ownerDocument.body:An).removeChild(u.stateNode)}catch(S){on(u,s,S)}else try{An.removeChild(u.stateNode)}catch(S){on(u,s,S)}break;case 18:An!==null&&(Bs?(e=An,pm(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,u.stateNode),Oo(e)):pm(An,u.stateNode));break;case 4:m=An,b=Bs,An=u.stateNode.containerInfo,Bs=!0,ur(e,s,u),An=m,Bs=b;break;case 0:case 11:case 14:case 15:Gr(2,u,s),Jn||Gr(4,u,s),ur(e,s,u);break;case 1:Jn||(Ha(u,s),m=u.stateNode,typeof m.componentWillUnmount=="function"&&xg(u,s,m)),ur(e,s,u);break;case 21:ur(e,s,u);break;case 22:Jn=(m=Jn)||u.memoizedState!==null,ur(e,s,u),Jn=m;break;default:ur(e,s,u)}}function Eg(e,s){if(s.memoizedState===null&&(e=s.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Oo(e)}catch(u){on(s,s.return,u)}}}function Ag(e,s){if(s.memoizedState===null&&(e=s.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Oo(e)}catch(u){on(s,s.return,u)}}function qy(e){switch(e.tag){case 31:case 13:case 19:var s=e.stateNode;return s===null&&(s=e.stateNode=new vg),s;case 22:return e=e.stateNode,s=e._retryCache,s===null&&(s=e._retryCache=new vg),s;default:throw Error(l(435,e.tag))}}function Qc(e,s){var u=qy(e);s.forEach(function(m){if(!u.has(m)){u.add(m);var b=$y.bind(null,e,m);m.then(b,b)}})}function Us(e,s){var u=s.deletions;if(u!==null)for(var m=0;m<u.length;m++){var b=u[m],S=e,I=s,F=I;e:for(;F!==null;){switch(F.tag){case 27:if($r(F.type)){An=F.stateNode,Bs=!1;break e}break;case 5:An=F.stateNode,Bs=!1;break e;case 3:case 4:An=F.stateNode.containerInfo,Bs=!0;break e}F=F.return}if(An===null)throw Error(l(160));Sg(S,I,b),An=null,Bs=!1,S=b.alternate,S!==null&&(S.return=null),b.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Ng(s,e),s=s.sibling}var Ta=null;function Ng(e,s){var u=e.alternate,m=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Us(s,e),Ps(e),m&4&&(Gr(3,e,e.return),El(3,e),Gr(5,e,e.return));break;case 1:Us(s,e),Ps(e),m&512&&(Jn||u===null||Ha(u,u.return)),m&64&&cr&&(e=e.updateQueue,e!==null&&(m=e.callbacks,m!==null&&(u=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=u===null?m:u.concat(m))));break;case 26:var b=Ta;if(Us(s,e),Ps(e),m&512&&(Jn||u===null||Ha(u,u.return)),m&4){var S=u!==null?u.memoizedState:null;if(m=e.memoizedState,u===null)if(m===null)if(e.stateNode===null){e:{m=e.type,u=e.memoizedProps,b=b.ownerDocument||b;t:switch(m){case"title":S=b.getElementsByTagName("title")[0],(!S||S[gi]||S[Ee]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=b.createElement(m),b.head.insertBefore(S,b.querySelector("head > title"))),ws(S,m,u),S[Ee]=e,Bn(S),m=S;break e;case"link":var I=Nm("link","href",b).get(m+(u.href||""));if(I){for(var F=0;F<I.length;F++)if(S=I[F],S.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&S.getAttribute("rel")===(u.rel==null?null:u.rel)&&S.getAttribute("title")===(u.title==null?null:u.title)&&S.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){I.splice(F,1);break t}}S=b.createElement(m),ws(S,m,u),b.head.appendChild(S);break;case"meta":if(I=Nm("meta","content",b).get(m+(u.content||""))){for(F=0;F<I.length;F++)if(S=I[F],S.getAttribute("content")===(u.content==null?null:""+u.content)&&S.getAttribute("name")===(u.name==null?null:u.name)&&S.getAttribute("property")===(u.property==null?null:u.property)&&S.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&S.getAttribute("charset")===(u.charSet==null?null:u.charSet)){I.splice(F,1);break t}}S=b.createElement(m),ws(S,m,u),b.head.appendChild(S);break;default:throw Error(l(468,m))}S[Ee]=e,Bn(S),m=S}e.stateNode=m}else Tm(b,e.type,e.stateNode);else e.stateNode=Am(b,m,e.memoizedProps);else S!==m?(S===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):S.count--,m===null?Tm(b,e.type,e.stateNode):Am(b,m,e.memoizedProps)):m===null&&e.stateNode!==null&&gh(e,e.memoizedProps,u.memoizedProps)}break;case 27:Us(s,e),Ps(e),m&512&&(Jn||u===null||Ha(u,u.return)),u!==null&&m&4&&gh(e,e.memoizedProps,u.memoizedProps);break;case 5:if(Us(s,e),Ps(e),m&512&&(Jn||u===null||Ha(u,u.return)),e.flags&32){b=e.stateNode;try{Nr(b,"")}catch(Qe){on(e,e.return,Qe)}}m&4&&e.stateNode!=null&&(b=e.memoizedProps,gh(e,b,u!==null?u.memoizedProps:b)),m&1024&&(xh=!0);break;case 6:if(Us(s,e),Ps(e),m&4){if(e.stateNode===null)throw Error(l(162));m=e.memoizedProps,u=e.stateNode;try{u.nodeValue=m}catch(Qe){on(e,e.return,Qe)}}break;case 3:if(du=null,b=Ta,Ta=cu(s.containerInfo),Us(s,e),Ta=b,Ps(e),m&4&&u!==null&&u.memoizedState.isDehydrated)try{Oo(s.containerInfo)}catch(Qe){on(e,e.return,Qe)}xh&&(xh=!1,Tg(e));break;case 4:m=Ta,Ta=cu(e.stateNode.containerInfo),Us(s,e),Ps(e),Ta=m;break;case 12:Us(s,e),Ps(e);break;case 31:Us(s,e),Ps(e),m&4&&(m=e.updateQueue,m!==null&&(e.updateQueue=null,Qc(e,m)));break;case 13:Us(s,e),Ps(e),e.child.flags&8192&&e.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Zc=Fe()),m&4&&(m=e.updateQueue,m!==null&&(e.updateQueue=null,Qc(e,m)));break;case 22:b=e.memoizedState!==null;var ee=u!==null&&u.memoizedState!==null,de=cr,ve=Jn;if(cr=de||b,Jn=ve||ee,Us(s,e),Jn=ve,cr=de,Ps(e),m&8192)e:for(s=e.stateNode,s._visibility=b?s._visibility&-2:s._visibility|1,b&&(u===null||ee||cr||Jn||ki(e)),u=null,s=e;;){if(s.tag===5||s.tag===26){if(u===null){ee=u=s;try{if(S=ee.stateNode,b)I=S.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none";else{F=ee.stateNode;var Ae=ee.memoizedProps.style,fe=Ae!=null&&Ae.hasOwnProperty("display")?Ae.display:null;F.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(Qe){on(ee,ee.return,Qe)}}}else if(s.tag===6){if(u===null){ee=s;try{ee.stateNode.nodeValue=b?"":ee.memoizedProps}catch(Qe){on(ee,ee.return,Qe)}}}else if(s.tag===18){if(u===null){ee=s;try{var we=ee.stateNode;b?xm(we,!0):xm(ee.stateNode,!1)}catch(Qe){on(ee,ee.return,Qe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===e)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break e;for(;s.sibling===null;){if(s.return===null||s.return===e)break e;u===s&&(u=null),s=s.return}u===s&&(u=null),s.sibling.return=s.return,s=s.sibling}m&4&&(m=e.updateQueue,m!==null&&(u=m.retryQueue,u!==null&&(m.retryQueue=null,Qc(e,u))));break;case 19:Us(s,e),Ps(e),m&4&&(m=e.updateQueue,m!==null&&(e.updateQueue=null,Qc(e,m)));break;case 30:break;case 21:break;default:Us(s,e),Ps(e)}}function Ps(e){var s=e.flags;if(s&2){try{for(var u,m=e.return;m!==null;){if(wg(m)){u=m;break}m=m.return}if(u==null)throw Error(l(160));switch(u.tag){case 27:var b=u.stateNode,S=mh(e);Wc(e,S,b);break;case 5:var I=u.stateNode;u.flags&32&&(Nr(I,""),u.flags&=-33);var F=mh(e);Wc(e,F,I);break;case 3:case 4:var ee=u.stateNode.containerInfo,de=mh(e);ph(e,de,ee);break;default:throw Error(l(161))}}catch(ve){on(e,e.return,ve)}e.flags&=-3}s&4096&&(e.flags&=-4097)}function Tg(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var s=e;Tg(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),e=e.sibling}}function dr(e,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Cg(e,s.alternate,s),s=s.sibling}function ki(e){for(e=e.child;e!==null;){var s=e;switch(s.tag){case 0:case 11:case 14:case 15:Gr(4,s,s.return),ki(s);break;case 1:Ha(s,s.return);var u=s.stateNode;typeof u.componentWillUnmount=="function"&&xg(s,s.return,u),ki(s);break;case 27:Dl(s.stateNode);case 26:case 5:Ha(s,s.return),ki(s);break;case 22:s.memoizedState===null&&ki(s);break;case 30:ki(s);break;default:ki(s)}e=e.sibling}}function hr(e,s,u){for(u=u&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var m=s.alternate,b=e,S=s,I=S.flags;switch(S.tag){case 0:case 11:case 15:hr(b,S,u),El(4,S);break;case 1:if(hr(b,S,u),m=S,b=m.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(de){on(m,m.return,de)}if(m=S,b=m.updateQueue,b!==null){var F=m.stateNode;try{var ee=b.shared.hiddenCallbacks;if(ee!==null)for(b.shared.hiddenCallbacks=null,b=0;b<ee.length;b++)r1(ee[b],F)}catch(de){on(m,m.return,de)}}u&&I&64&&pg(S),Al(S,S.return);break;case 27:bg(S);case 26:case 5:hr(b,S,u),u&&m===null&&I&4&&yg(S),Al(S,S.return);break;case 12:hr(b,S,u);break;case 31:hr(b,S,u),u&&I&4&&Eg(b,S);break;case 13:hr(b,S,u),u&&I&4&&Ag(b,S);break;case 22:S.memoizedState===null&&hr(b,S,u),Al(S,S.return);break;case 30:break;default:hr(b,S,u)}s=s.sibling}}function yh(e,s){var u=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(u=e.memoizedState.cachePool.pool),e=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(e=s.memoizedState.cachePool.pool),e!==u&&(e!=null&&e.refCount++,u!=null&&hl(u))}function wh(e,s){e=null,s.alternate!==null&&(e=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==e&&(s.refCount++,e!=null&&hl(e))}function ja(e,s,u,m){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)jg(e,s,u,m),s=s.sibling}function jg(e,s,u,m){var b=s.flags;switch(s.tag){case 0:case 11:case 15:ja(e,s,u,m),b&2048&&El(9,s);break;case 1:ja(e,s,u,m);break;case 3:ja(e,s,u,m),b&2048&&(e=null,s.alternate!==null&&(e=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==e&&(s.refCount++,e!=null&&hl(e)));break;case 12:if(b&2048){ja(e,s,u,m),e=s.stateNode;try{var S=s.memoizedProps,I=S.id,F=S.onPostCommit;typeof F=="function"&&F(I,s.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(ee){on(s,s.return,ee)}}else ja(e,s,u,m);break;case 31:ja(e,s,u,m);break;case 13:ja(e,s,u,m);break;case 23:break;case 22:S=s.stateNode,I=s.alternate,s.memoizedState!==null?S._visibility&2?ja(e,s,u,m):Nl(e,s):S._visibility&2?ja(e,s,u,m):(S._visibility|=2,vo(e,s,u,m,(s.subtreeFlags&10256)!==0||!1)),b&2048&&yh(I,s);break;case 24:ja(e,s,u,m),b&2048&&wh(s.alternate,s);break;default:ja(e,s,u,m)}}function vo(e,s,u,m,b){for(b=b&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var S=e,I=s,F=u,ee=m,de=I.flags;switch(I.tag){case 0:case 11:case 15:vo(S,I,F,ee,b),El(8,I);break;case 23:break;case 22:var ve=I.stateNode;I.memoizedState!==null?ve._visibility&2?vo(S,I,F,ee,b):Nl(S,I):(ve._visibility|=2,vo(S,I,F,ee,b)),b&&de&2048&&yh(I.alternate,I);break;case 24:vo(S,I,F,ee,b),b&&de&2048&&wh(I.alternate,I);break;default:vo(S,I,F,ee,b)}s=s.sibling}}function Nl(e,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var u=e,m=s,b=m.flags;switch(m.tag){case 22:Nl(u,m),b&2048&&yh(m.alternate,m);break;case 24:Nl(u,m),b&2048&&wh(m.alternate,m);break;default:Nl(u,m)}s=s.sibling}}var Tl=8192;function Co(e,s,u){if(e.subtreeFlags&Tl)for(e=e.child;e!==null;)Rg(e,s,u),e=e.sibling}function Rg(e,s,u){switch(e.tag){case 26:Co(e,s,u),e.flags&Tl&&e.memoizedState!==null&&jw(u,Ta,e.memoizedState,e.memoizedProps);break;case 5:Co(e,s,u);break;case 3:case 4:var m=Ta;Ta=cu(e.stateNode.containerInfo),Co(e,s,u),Ta=m;break;case 22:e.memoizedState===null&&(m=e.alternate,m!==null&&m.memoizedState!==null?(m=Tl,Tl=16777216,Co(e,s,u),Tl=m):Co(e,s,u));break;default:Co(e,s,u)}}function Ig(e){var s=e.alternate;if(s!==null&&(e=s.child,e!==null)){s.child=null;do s=e.sibling,e.sibling=null,e=s;while(e!==null)}}function jl(e){var s=e.deletions;if((e.flags&16)!==0){if(s!==null)for(var u=0;u<s.length;u++){var m=s[u];cs=m,Mg(m,e)}Ig(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Og(e),e=e.sibling}function Og(e){switch(e.tag){case 0:case 11:case 15:jl(e),e.flags&2048&&Gr(9,e,e.return);break;case 3:jl(e);break;case 12:jl(e);break;case 22:var s=e.stateNode;e.memoizedState!==null&&s._visibility&2&&(e.return===null||e.return.tag!==13)?(s._visibility&=-3,Kc(e)):jl(e);break;default:jl(e)}}function Kc(e){var s=e.deletions;if((e.flags&16)!==0){if(s!==null)for(var u=0;u<s.length;u++){var m=s[u];cs=m,Mg(m,e)}Ig(e)}for(e=e.child;e!==null;){switch(s=e,s.tag){case 0:case 11:case 15:Gr(8,s,s.return),Kc(s);break;case 22:u=s.stateNode,u._visibility&2&&(u._visibility&=-3,Kc(s));break;default:Kc(s)}e=e.sibling}}function Mg(e,s){for(;cs!==null;){var u=cs;switch(u.tag){case 0:case 11:case 15:Gr(8,u,s);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var m=u.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:hl(u.memoizedState.cache)}if(m=u.child,m!==null)m.return=u,cs=m;else e:for(u=e;cs!==null;){m=cs;var b=m.sibling,S=m.return;if(_g(m),m===u){cs=null;break e}if(b!==null){b.return=S,cs=b;break e}cs=S}}}var Vy={getCacheForType:function(e){var s=xs(Kn),u=s.data.get(e);return u===void 0&&(u=e(),s.data.set(e,u)),u},cacheSignal:function(){return xs(Kn).controller.signal}},Gy=typeof WeakMap=="function"?WeakMap:Map,Jt=0,pn=null,It=null,Dt=0,rn=0,Js=null,Yr=!1,_o=!1,bh=!1,fr=0,zn=0,Xr=0,Di=0,vh=0,ea=0,So=0,Rl=null,zs=null,Ch=!1,Zc=0,kg=0,$c=1/0,Jc=null,Wr=null,is=0,Qr=null,Eo=null,gr=0,_h=0,Sh=null,Dg=null,Il=0,Eh=null;function ta(){return(Jt&2)!==0&&Dt!==0?Dt&-Dt:$.T!==null?Ih():ns()}function Lg(){if(ea===0)if((Dt&536870912)===0||zt){var e=wt;wt<<=1,(wt&3932160)===0&&(wt=262144),ea=e}else ea=536870912;return e=Zs.current,e!==null&&(e.flags|=32),ea}function Fs(e,s,u){(e===pn&&(rn===2||rn===9)||e.cancelPendingCommit!==null)&&(Ao(e,0),Kr(e,Dt,ea,!1)),G(e,u),((Jt&2)===0||e!==pn)&&(e===pn&&((Jt&2)===0&&(Di|=u),zn===4&&Kr(e,Dt,ea,!1)),qa(e))}function Bg(e,s,u){if((Jt&6)!==0)throw Error(l(327));var m=!u&&(s&127)===0&&(s&e.expiredLanes)===0||ct(e,s),b=m?Wy(e,s):Nh(e,s,!0),S=m;do{if(b===0){_o&&!m&&Kr(e,s,0,!1);break}else{if(u=e.current.alternate,S&&!Yy(u)){b=Nh(e,s,!1),S=!1;continue}if(b===2){if(S=s,e.errorRecoveryDisabledLanes&S)var I=0;else I=e.pendingLanes&-536870913,I=I!==0?I:I&536870912?536870912:0;if(I!==0){s=I;e:{var F=e;b=Rl;var ee=F.current.memoizedState.isDehydrated;if(ee&&(Ao(F,I).flags|=256),I=Nh(F,I,!1),I!==2){if(bh&&!ee){F.errorRecoveryDisabledLanes|=S,Di|=S,b=4;break e}S=zs,zs=b,S!==null&&(zs===null?zs=S:zs.push.apply(zs,S))}b=I}if(S=!1,b!==2)continue}}if(b===1){Ao(e,0),Kr(e,s,0,!0);break}e:{switch(m=e,S=b,S){case 0:case 1:throw Error(l(345));case 4:if((s&4194048)!==s)break;case 6:Kr(m,s,ea,!Yr);break e;case 2:zs=null;break;case 3:case 5:break;default:throw Error(l(329))}if((s&62914560)===s&&(b=Zc+300-Fe(),10<b)){if(Kr(m,s,ea,!Yr),qe(m,0,!0)!==0)break e;gr=s,m.timeoutHandle=gm(Ug.bind(null,m,u,zs,Jc,Ch,s,ea,Di,So,Yr,S,"Throttled",-0,0),b);break e}Ug(m,u,zs,Jc,Ch,s,ea,Di,So,Yr,S,null,-0,0)}}break}while(!0);qa(e)}function Ug(e,s,u,m,b,S,I,F,ee,de,ve,Ae,fe,we){if(e.timeoutHandle=-1,Ae=s.subtreeFlags,Ae&8192||(Ae&16785408)===16785408){Ae={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ks},Rg(s,S,Ae);var Qe=(S&62914560)===S?Zc-Fe():(S&4194048)===S?kg-Fe():0;if(Qe=Rw(Ae,Qe),Qe!==null){gr=S,e.cancelPendingCommit=Qe(Yg.bind(null,e,s,S,u,m,b,I,F,ee,ve,Ae,null,fe,we)),Kr(e,S,I,!de);return}}Yg(e,s,S,u,m,b,I,F,ee)}function Yy(e){for(var s=e;;){var u=s.tag;if((u===0||u===11||u===15)&&s.flags&16384&&(u=s.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var m=0;m<u.length;m++){var b=u[m],S=b.getSnapshot;b=b.value;try{if(!p(S(),b))return!1}catch{return!1}}if(u=s.child,s.subtreeFlags&16384&&u!==null)u.return=s,s=u;else{if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Kr(e,s,u,m){s&=~vh,s&=~Di,e.suspendedLanes|=s,e.pingedLanes&=~s,m&&(e.warmLanes|=s),m=e.expirationTimes;for(var b=s;0<b;){var S=31-gt(b),I=1<<S;m[S]=-1,b&=~I}u!==0&&jt(e,u,s)}function eu(){return(Jt&6)===0?(Ol(0),!1):!0}function Ah(){if(It!==null){if(rn===0)var e=It.return;else e=It,sr=Ai=null,Hd(e),po=null,gl=0,e=It;for(;e!==null;)mg(e.alternate,e),e=e.return;It=null}}function Ao(e,s){var u=e.timeoutHandle;u!==-1&&(e.timeoutHandle=-1,hw(u)),u=e.cancelPendingCommit,u!==null&&(e.cancelPendingCommit=null,u()),gr=0,Ah(),pn=e,It=u=tr(e.current,null),Dt=s,rn=0,Js=null,Yr=!1,_o=ct(e,s),bh=!1,So=ea=vh=Di=Xr=zn=0,zs=Rl=null,Ch=!1,(s&8)!==0&&(s|=s&32);var m=e.entangledLanes;if(m!==0)for(e=e.entanglements,m&=s;0<m;){var b=31-gt(m),S=1<<b;s|=e[b],m&=~S}return fr=s,vc(),u}function Pg(e,s){Ct=null,$.H=Cl,s===mo||s===jc?(s=t1(),rn=3):s===Rd?(s=t1(),rn=4):rn=s===ah?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Js=s,It===null&&(zn=1,qc(e,ha(s,e.current)))}function zg(){var e=Zs.current;return e===null?!0:(Dt&4194048)===Dt?pa===null:(Dt&62914560)===Dt||(Dt&536870912)!==0?e===pa:!1}function Fg(){var e=$.H;return $.H=Cl,e===null?Cl:e}function Hg(){var e=$.A;return $.A=Vy,e}function tu(){zn=4,Yr||(Dt&4194048)!==Dt&&Zs.current!==null||(_o=!0),(Xr&134217727)===0&&(Di&134217727)===0||pn===null||Kr(pn,Dt,ea,!1)}function Nh(e,s,u){var m=Jt;Jt|=2;var b=Fg(),S=Hg();(pn!==e||Dt!==s)&&(Jc=null,Ao(e,s)),s=!1;var I=zn;e:do try{if(rn!==0&&It!==null){var F=It,ee=Js;switch(rn){case 8:Ah(),I=6;break e;case 3:case 2:case 9:case 6:Zs.current===null&&(s=!0);var de=rn;if(rn=0,Js=null,No(e,F,ee,de),u&&_o){I=0;break e}break;default:de=rn,rn=0,Js=null,No(e,F,ee,de)}}Xy(),I=zn;break}catch(ve){Pg(e,ve)}while(!0);return s&&e.shellSuspendCounter++,sr=Ai=null,Jt=m,$.H=b,$.A=S,It===null&&(pn=null,Dt=0,vc()),I}function Xy(){for(;It!==null;)qg(It)}function Wy(e,s){var u=Jt;Jt|=2;var m=Fg(),b=Hg();pn!==e||Dt!==s?(Jc=null,$c=Fe()+500,Ao(e,s)):_o=ct(e,s);e:do try{if(rn!==0&&It!==null){s=It;var S=Js;t:switch(rn){case 1:rn=0,Js=null,No(e,s,S,1);break;case 2:case 9:if(J0(S)){rn=0,Js=null,Vg(s);break}s=function(){rn!==2&&rn!==9||pn!==e||(rn=7),qa(e)},S.then(s,s);break e;case 3:rn=7;break e;case 4:rn=5;break e;case 7:J0(S)?(rn=0,Js=null,Vg(s)):(rn=0,Js=null,No(e,s,S,7));break;case 5:var I=null;switch(It.tag){case 26:I=It.memoizedState;case 5:case 27:var F=It;if(I?jm(I):F.stateNode.complete){rn=0,Js=null;var ee=F.sibling;if(ee!==null)It=ee;else{var de=F.return;de!==null?(It=de,nu(de)):It=null}break t}}rn=0,Js=null,No(e,s,S,5);break;case 6:rn=0,Js=null,No(e,s,S,6);break;case 8:Ah(),zn=6;break e;default:throw Error(l(462))}}Qy();break}catch(ve){Pg(e,ve)}while(!0);return sr=Ai=null,$.H=m,$.A=b,Jt=u,It!==null?0:(pn=null,Dt=0,vc(),zn)}function Qy(){for(;It!==null&&!Is();)qg(It)}function qg(e){var s=fg(e.alternate,e,fr);e.memoizedProps=e.pendingProps,s===null?nu(e):It=s}function Vg(e){var s=e,u=s.alternate;switch(s.tag){case 15:case 0:s=og(u,s,s.pendingProps,s.type,void 0,Dt);break;case 11:s=og(u,s,s.pendingProps,s.type.render,s.ref,Dt);break;case 5:Hd(s);default:mg(u,s),s=It=H0(s,fr),s=fg(u,s,fr)}e.memoizedProps=e.pendingProps,s===null?nu(e):It=s}function No(e,s,u,m){sr=Ai=null,Hd(s),po=null,gl=0;var b=s.return;try{if(By(e,b,s,u,Dt)){zn=1,qc(e,ha(u,e.current)),It=null;return}}catch(S){if(b!==null)throw It=b,S;zn=1,qc(e,ha(u,e.current)),It=null;return}s.flags&32768?(zt||m===1?e=!0:_o||(Dt&536870912)!==0?e=!1:(Yr=e=!0,(m===2||m===9||m===3||m===6)&&(m=Zs.current,m!==null&&m.tag===13&&(m.flags|=16384))),Gg(s,e)):nu(s)}function nu(e){var s=e;do{if((s.flags&32768)!==0){Gg(s,Yr);return}e=s.return;var u=zy(s.alternate,s,fr);if(u!==null){It=u;return}if(s=s.sibling,s!==null){It=s;return}It=s=e}while(s!==null);zn===0&&(zn=5)}function Gg(e,s){do{var u=Fy(e.alternate,e);if(u!==null){u.flags&=32767,It=u;return}if(u=e.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!s&&(e=e.sibling,e!==null)){It=e;return}It=e=u}while(e!==null);zn=6,It=null}function Yg(e,s,u,m,b,S,I,F,ee){e.cancelPendingCommit=null;do su();while(is!==0);if((Jt&6)!==0)throw Error(l(327));if(s!==null){if(s===e.current)throw Error(l(177));if(S=s.lanes|s.childLanes,S|=md,Te(e,u,S,I,F,ee),e===pn&&(It=pn=null,Dt=0),Eo=s,Qr=e,gr=u,_h=S,Sh=b,Dg=m,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,Jy(sn,function(){return Zg(),null})):(e.callbackNode=null,e.callbackPriority=0),m=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||m){m=$.T,$.T=null,b=oe.p,oe.p=2,I=Jt,Jt|=4;try{Hy(e,s,u)}finally{Jt=I,oe.p=b,$.T=m}}is=1,Xg(),Wg(),Qg()}}function Xg(){if(is===1){is=0;var e=Qr,s=Eo,u=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||u){u=$.T,$.T=null;var m=oe.p;oe.p=2;var b=Jt;Jt|=4;try{Ng(s,e);var S=Ph,I=D(e.containerInfo),F=S.focusedElem,ee=S.selectionRange;if(I!==F&&F&&F.ownerDocument&&j(F.ownerDocument.documentElement,F)){if(ee!==null&&z(F)){var de=ee.start,ve=ee.end;if(ve===void 0&&(ve=de),"selectionStart"in F)F.selectionStart=de,F.selectionEnd=Math.min(ve,F.value.length);else{var Ae=F.ownerDocument||document,fe=Ae&&Ae.defaultView||window;if(fe.getSelection){var we=fe.getSelection(),Qe=F.textContent.length,ut=Math.min(ee.start,Qe),hn=ee.end===void 0?ut:Math.min(ee.end,Qe);!we.extend&&ut>hn&&(I=hn,hn=ut,ut=I);var re=E(F,ut),ae=E(F,hn);if(re&&ae&&(we.rangeCount!==1||we.anchorNode!==re.node||we.anchorOffset!==re.offset||we.focusNode!==ae.node||we.focusOffset!==ae.offset)){var ue=Ae.createRange();ue.setStart(re.node,re.offset),we.removeAllRanges(),ut>hn?(we.addRange(ue),we.extend(ae.node,ae.offset)):(ue.setEnd(ae.node,ae.offset),we.addRange(ue))}}}}for(Ae=[],we=F;we=we.parentNode;)we.nodeType===1&&Ae.push({element:we,left:we.scrollLeft,top:we.scrollTop});for(typeof F.focus=="function"&&F.focus(),F=0;F<Ae.length;F++){var Se=Ae[F];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}mu=!!Uh,Ph=Uh=null}finally{Jt=b,oe.p=m,$.T=u}}e.current=s,is=2}}function Wg(){if(is===2){is=0;var e=Qr,s=Eo,u=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||u){u=$.T,$.T=null;var m=oe.p;oe.p=2;var b=Jt;Jt|=4;try{Cg(e,s.alternate,s)}finally{Jt=b,oe.p=m,$.T=u}}is=3}}function Qg(){if(is===4||is===3){is=0,Me();var e=Qr,s=Eo,u=gr,m=Dg;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?is=5:(is=0,Eo=Qr=null,Kg(e,e.pendingLanes));var b=e.pendingLanes;if(b===0&&(Wr=null),Kt(u),s=s.stateNode,je&&typeof je.onCommitFiberRoot=="function")try{je.onCommitFiberRoot(Ut,s,void 0,(s.current.flags&128)===128)}catch{}if(m!==null){s=$.T,b=oe.p,oe.p=2,$.T=null;try{for(var S=e.onRecoverableError,I=0;I<m.length;I++){var F=m[I];S(F.value,{componentStack:F.stack})}}finally{$.T=s,oe.p=b}}(gr&3)!==0&&su(),qa(e),b=e.pendingLanes,(u&261930)!==0&&(b&42)!==0?e===Eh?Il++:(Il=0,Eh=e):Il=0,Ol(0)}}function Kg(e,s){(e.pooledCacheLanes&=s)===0&&(s=e.pooledCache,s!=null&&(e.pooledCache=null,hl(s)))}function su(){return Xg(),Wg(),Qg(),Zg()}function Zg(){if(is!==5)return!1;var e=Qr,s=_h;_h=0;var u=Kt(gr),m=$.T,b=oe.p;try{oe.p=32>u?32:u,$.T=null,u=Sh,Sh=null;var S=Qr,I=gr;if(is=0,Eo=Qr=null,gr=0,(Jt&6)!==0)throw Error(l(331));var F=Jt;if(Jt|=4,Og(S.current),jg(S,S.current,I,u),Jt=F,Ol(0,!1),je&&typeof je.onPostCommitFiberRoot=="function")try{je.onPostCommitFiberRoot(Ut,S)}catch{}return!0}finally{oe.p=b,$.T=m,Kg(e,s)}}function $g(e,s,u){s=ha(u,s),s=sh(e.stateNode,s,2),e=Hr(e,s,2),e!==null&&(G(e,2),qa(e))}function on(e,s,u){if(e.tag===3)$g(e,e,u);else for(;s!==null;){if(s.tag===3){$g(s,e,u);break}else if(s.tag===1){var m=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Wr===null||!Wr.has(m))){e=ha(u,e),u=J1(2),m=Hr(s,u,2),m!==null&&(eg(u,m,s,e),G(m,2),qa(m));break}}s=s.return}}function Th(e,s,u){var m=e.pingCache;if(m===null){m=e.pingCache=new Gy;var b=new Set;m.set(s,b)}else b=m.get(s),b===void 0&&(b=new Set,m.set(s,b));b.has(u)||(bh=!0,b.add(u),e=Ky.bind(null,e,s,u),s.then(e,e))}function Ky(e,s,u){var m=e.pingCache;m!==null&&m.delete(s),e.pingedLanes|=e.suspendedLanes&u,e.warmLanes&=~u,pn===e&&(Dt&u)===u&&(zn===4||zn===3&&(Dt&62914560)===Dt&&300>Fe()-Zc?(Jt&2)===0&&Ao(e,0):vh|=u,So===Dt&&(So=0)),qa(e)}function Jg(e,s){s===0&&(s=Pt()),e=_i(e,s),e!==null&&(G(e,s),qa(e))}function Zy(e){var s=e.memoizedState,u=0;s!==null&&(u=s.retryLane),Jg(e,u)}function $y(e,s){var u=0;switch(e.tag){case 31:case 13:var m=e.stateNode,b=e.memoizedState;b!==null&&(u=b.retryLane);break;case 19:m=e.stateNode;break;case 22:m=e.stateNode._retryCache;break;default:throw Error(l(314))}m!==null&&m.delete(s),Jg(e,u)}function Jy(e,s){return Hn(e,s)}var au=null,To=null,jh=!1,ru=!1,Rh=!1,Zr=0;function qa(e){e!==To&&e.next===null&&(To===null?au=To=e:To=To.next=e),ru=!0,jh||(jh=!0,tw())}function Ol(e,s){if(!Rh&&ru){Rh=!0;do for(var u=!1,m=au;m!==null;){if(e!==0){var b=m.pendingLanes;if(b===0)var S=0;else{var I=m.suspendedLanes,F=m.pingedLanes;S=(1<<31-gt(42|e)+1)-1,S&=b&~(I&~F),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(u=!0,sm(m,S))}else S=Dt,S=qe(m,m===pn?S:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(S&3)===0||ct(m,S)||(u=!0,sm(m,S));m=m.next}while(u);Rh=!1}}function ew(){em()}function em(){ru=jh=!1;var e=0;Zr!==0&&dw()&&(e=Zr);for(var s=Fe(),u=null,m=au;m!==null;){var b=m.next,S=tm(m,s);S===0?(m.next=null,u===null?au=b:u.next=b,b===null&&(To=u)):(u=m,(e!==0||(S&3)!==0)&&(ru=!0)),m=b}is!==0&&is!==5||Ol(e),Zr!==0&&(Zr=0)}function tm(e,s){for(var u=e.suspendedLanes,m=e.pingedLanes,b=e.expirationTimes,S=e.pendingLanes&-62914561;0<S;){var I=31-gt(S),F=1<<I,ee=b[I];ee===-1?((F&u)===0||(F&m)!==0)&&(b[I]=an(F,s)):ee<=s&&(e.expiredLanes|=F),S&=~F}if(s=pn,u=Dt,u=qe(e,e===s?u:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),m=e.callbackNode,u===0||e===s&&(rn===2||rn===9)||e.cancelPendingCommit!==null)return m!==null&&m!==null&&ze(m),e.callbackNode=null,e.callbackPriority=0;if((u&3)===0||ct(e,u)){if(s=u&-u,s===e.callbackPriority)return s;switch(m!==null&&ze(m),Kt(u)){case 2:case 8:u=Tn;break;case 32:u=sn;break;case 268435456:u=qn;break;default:u=sn}return m=nm.bind(null,e),u=Hn(u,m),e.callbackPriority=s,e.callbackNode=u,s}return m!==null&&m!==null&&ze(m),e.callbackPriority=2,e.callbackNode=null,2}function nm(e,s){if(is!==0&&is!==5)return e.callbackNode=null,e.callbackPriority=0,null;var u=e.callbackNode;if(su()&&e.callbackNode!==u)return null;var m=Dt;return m=qe(e,e===pn?m:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),m===0?null:(Bg(e,m,s),tm(e,Fe()),e.callbackNode!=null&&e.callbackNode===u?nm.bind(null,e):null)}function sm(e,s){if(su())return null;Bg(e,s,!0)}function tw(){fw(function(){(Jt&6)!==0?Hn(_t,ew):em()})}function Ih(){if(Zr===0){var e=fo;e===0&&(e=qs,qs<<=1,(qs&261888)===0&&(qs=256)),Zr=e}return Zr}function am(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Tr(""+e)}function rm(e,s){var u=s.ownerDocument.createElement("input");return u.name=s.name,u.value=s.value,e.id&&u.setAttribute("form",e.id),s.parentNode.insertBefore(u,s),e=new FormData(e),u.parentNode.removeChild(u),e}function nw(e,s,u,m,b){if(s==="submit"&&u&&u.stateNode===b){var S=am((b[_e]||null).action),I=m.submitter;I&&(s=(s=I[_e]||null)?am(s.formAction):I.getAttribute("formAction"),s!==null&&(S=s,I=null));var F=new ss("action","action",null,m,b);e.push({event:F,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Zr!==0){var ee=I?rm(b,I):new FormData(b);Zd(u,{pending:!0,data:ee,method:b.method,action:S},null,ee)}}else typeof S=="function"&&(F.preventDefault(),ee=I?rm(b,I):new FormData(b),Zd(u,{pending:!0,data:ee,method:b.method,action:S},S,ee))},currentTarget:b}]})}}for(var Oh=0;Oh<cl.length;Oh++){var Mh=cl[Oh],sw=Mh.toLowerCase(),aw=Mh[0].toUpperCase()+Mh.slice(1);Na(sw,"on"+aw)}Na(Ls,"onAnimationEnd"),Na(ms,"onAnimationIteration"),Na(nn,"onAnimationStart"),Na("dblclick","onDoubleClick"),Na("focusin","onFocus"),Na("focusout","onBlur"),Na(rs,"onTransitionRun"),Na(Ns,"onTransitionStart"),Na(Dr,"onTransitionCancel"),Na(er,"onTransitionEnd"),Gs("onMouseEnter",["mouseout","mouseover"]),Gs("onMouseLeave",["mouseout","mouseover"]),Gs("onPointerEnter",["pointerout","pointerover"]),Gs("onPointerLeave",["pointerout","pointerover"]),en("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),en("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),en("onBeforeInput",["compositionend","keypress","textInput","paste"]),en("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),en("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),en("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ml="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ml));function im(e,s){s=(s&4)!==0;for(var u=0;u<e.length;u++){var m=e[u],b=m.event;m=m.listeners;e:{var S=void 0;if(s)for(var I=m.length-1;0<=I;I--){var F=m[I],ee=F.instance,de=F.currentTarget;if(F=F.listener,ee!==S&&b.isPropagationStopped())break e;S=F,b.currentTarget=de;try{S(b)}catch(ve){bc(ve)}b.currentTarget=null,S=ee}else for(I=0;I<m.length;I++){if(F=m[I],ee=F.instance,de=F.currentTarget,F=F.listener,ee!==S&&b.isPropagationStopped())break e;S=F,b.currentTarget=de;try{S(b)}catch(ve){bc(ve)}b.currentTarget=null,S=ee}}}}function Ot(e,s){var u=s[Dn];u===void 0&&(u=s[Dn]=new Set);var m=e+"__bubble";u.has(m)||(om(s,e,2,!1),u.add(m))}function kh(e,s,u){var m=0;s&&(m|=4),om(u,e,m,s)}var iu="_reactListening"+Math.random().toString(36).slice(2);function Dh(e){if(!e[iu]){e[iu]=!0,Re.forEach(function(u){u!=="selectionchange"&&(rw.has(u)||kh(u,!1,e),kh(u,!0,e))});var s=e.nodeType===9?e:e.ownerDocument;s===null||s[iu]||(s[iu]=!0,kh("selectionchange",!1,s))}}function om(e,s,u,m){switch(Lm(s)){case 2:var b=Mw;break;case 8:b=kw;break;default:b=Kh}u=b.bind(null,s,u,e),b=void 0,!nl||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(b=!0),m?b!==void 0?e.addEventListener(s,u,{capture:!0,passive:b}):e.addEventListener(s,u,!0):b!==void 0?e.addEventListener(s,u,{passive:b}):e.addEventListener(s,u,!1)}function Lh(e,s,u,m,b){var S=m;if((s&1)===0&&(s&2)===0&&m!==null)e:for(;;){if(m===null)return;var I=m.tag;if(I===3||I===4){var F=m.stateNode.containerInfo;if(F===b)break;if(I===4)for(I=m.return;I!==null;){var ee=I.tag;if((ee===3||ee===4)&&I.stateNode.containerInfo===b)return;I=I.return}for(;F!==null;){if(I=Ln(F),I===null)return;if(ee=I.tag,ee===5||ee===6||ee===26||ee===27){m=S=I;continue e}F=F.parentNode}}m=m.return}cc(function(){var de=S,ve=tl(u),Ae=[];e:{var fe=wc.get(e);if(fe!==void 0){var we=ss,Qe=e;switch(e){case"keypress":if(La(u)===0)break e;case"keydown":case"keyup":we=so;break;case"focusin":Qe="focus",we=rl;break;case"focusout":Qe="blur",we=rl;break;case"beforeblur":case"afterblur":we=rl;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=$t;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=to;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=hd;break;case Ls:case ms:case nn:we=St;break;case er:we=Ka;break;case"scroll":case"scrollend":we=uc;break;case"wheel":we=fd;break;case"copy":case"cut":case"paste":we=no;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=tn;break;case"toggle":case"beforetoggle":we=ol}var ut=(s&4)!==0,hn=!ut&&(e==="scroll"||e==="scrollend"),re=ut?fe!==null?fe+"Capture":null:fe;ut=[];for(var ae=de,ue;ae!==null;){var Se=ae;if(ue=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||ue===null||re===null||(Se=pt(ae,re),Se!=null&&ut.push(kl(ae,Se,ue))),hn)break;ae=ae.return}0<ut.length&&(fe=new we(fe,Qe,null,u,ve),Ae.push({event:fe,listeners:ut}))}}if((s&7)===0){e:{if(fe=e==="mouseover"||e==="pointerover",we=e==="mouseout"||e==="pointerout",fe&&u!==mi&&(Qe=u.relatedTarget||u.fromElement)&&(Ln(Qe)||Qe[Ve]))break e;if((we||fe)&&(fe=ve.window===ve?ve:(fe=ve.ownerDocument)?fe.defaultView||fe.parentWindow:window,we?(Qe=u.relatedTarget||u.toElement,we=de,Qe=Qe?Ln(Qe):null,Qe!==null&&(hn=f(Qe),ut=Qe.tag,Qe!==hn||ut!==5&&ut!==27&&ut!==6)&&(Qe=null)):(we=null,Qe=de),we!==Qe)){if(ut=$t,Se="onMouseLeave",re="onMouseEnter",ae="mouse",(e==="pointerout"||e==="pointerover")&&(ut=tn,Se="onPointerLeave",re="onPointerEnter",ae="pointer"),hn=we==null?fe:_r(we),ue=Qe==null?fe:_r(Qe),fe=new ut(Se,ae+"leave",we,u,ve),fe.target=hn,fe.relatedTarget=ue,Se=null,Ln(ve)===de&&(ut=new ut(re,ae+"enter",Qe,u,ve),ut.target=ue,ut.relatedTarget=hn,Se=ut),hn=Se,we&&Qe)t:{for(ut=iw,re=we,ae=Qe,ue=0,Se=re;Se;Se=ut(Se))ue++;Se=0;for(var rt=ae;rt;rt=ut(rt))Se++;for(;0<ue-Se;)re=ut(re),ue--;for(;0<Se-ue;)ae=ut(ae),Se--;for(;ue--;){if(re===ae||ae!==null&&re===ae.alternate){ut=re;break t}re=ut(re),ae=ut(ae)}ut=null}else ut=null;we!==null&&lm(Ae,fe,we,ut,!1),Qe!==null&&hn!==null&&lm(Ae,hn,Qe,ut,!0)}}e:{if(fe=de?_r(de):window,we=fe.nodeName&&fe.nodeName.toLowerCase(),we==="select"||we==="input"&&fe.type==="file")var Yt=Qs;else if(ll(fe))if(yc)Yt=h;else{Yt=r;var et=t}else we=fe.nodeName,!we||we.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?de&&fn(de.elementType)&&(Yt=Qs):Yt=c;if(Yt&&(Yt=Yt(e,de))){Ws(Ae,Yt,u,ve);break e}et&&et(e,fe,de),e==="focusout"&&de&&fe.type==="number"&&de.memoizedProps.value!=null&&Y(fe,"number",fe.value)}switch(et=de?_r(de):window,e){case"focusin":(ll(et)||et.contentEditable==="true")&&(te=et,se=de,le=null);break;case"focusout":le=se=te=null;break;case"mousedown":pe=!0;break;case"contextmenu":case"mouseup":case"dragend":pe=!1,Pe(Ae,u,ve);break;case"selectionchange":if(Q)break;case"keydown":case"keyup":Pe(Ae,u,ve)}var Et;if(yi)e:{switch(e){case"compositionstart":var Lt="onCompositionStart";break e;case"compositionend":Lt="onCompositionEnd";break e;case"compositionupdate":Lt="onCompositionUpdate";break e}Lt=void 0}else kr?xc(e,u)&&(Lt="onCompositionEnd"):e==="keydown"&&u.keyCode===229&&(Lt="onCompositionStart");Lt&&(pc&&u.locale!=="ko"&&(kr||Lt!=="onCompositionStart"?Lt==="onCompositionEnd"&&kr&&(Et=jr()):(Ea=ve,Aa="value"in Ea?Ea.value:Ea.textContent,kr=!0)),et=ou(de,Lt),0<et.length&&(Lt=new fc(Lt,e,null,u,ve),Ae.push({event:Lt,listeners:et}),Et?Lt.data=Et:(Et=Mr(u),Et!==null&&(Lt.data=Et)))),(Et=mc?Pa(e,u):ro(e,u))&&(Lt=ou(de,"onBeforeInput"),0<Lt.length&&(et=new fc("onBeforeInput","beforeinput",null,u,ve),Ae.push({event:et,listeners:Lt}),et.data=Et)),nw(Ae,e,de,u,ve)}im(Ae,s)})}function kl(e,s,u){return{instance:e,listener:s,currentTarget:u}}function ou(e,s){for(var u=s+"Capture",m=[];e!==null;){var b=e,S=b.stateNode;if(b=b.tag,b!==5&&b!==26&&b!==27||S===null||(b=pt(e,u),b!=null&&m.unshift(kl(e,b,S)),b=pt(e,s),b!=null&&m.push(kl(e,b,S))),e.tag===3)return m;e=e.return}return[]}function iw(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function lm(e,s,u,m,b){for(var S=s._reactName,I=[];u!==null&&u!==m;){var F=u,ee=F.alternate,de=F.stateNode;if(F=F.tag,ee!==null&&ee===m)break;F!==5&&F!==26&&F!==27||de===null||(ee=de,b?(de=pt(u,S),de!=null&&I.unshift(kl(u,de,ee))):b||(de=pt(u,S),de!=null&&I.push(kl(u,de,ee)))),u=u.return}I.length!==0&&e.push({event:s,listeners:I})}var ow=/\r\n?/g,lw=/\u0000|\uFFFD/g;function cm(e){return(typeof e=="string"?e:""+e).replace(ow,`
`).replace(lw,"")}function um(e,s){return s=cm(s),cm(e)===s}function dn(e,s,u,m,b,S){switch(u){case"children":typeof m=="string"?s==="body"||s==="textarea"&&m===""||Nr(e,m):(typeof m=="number"||typeof m=="bigint")&&s!=="body"&&Nr(e,""+m);break;case"className":Er(e,"class",m);break;case"tabIndex":Er(e,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Er(e,u,m);break;case"style":at(e,m,S);break;case"data":if(s!=="object"){Er(e,"data",m);break}case"src":case"href":if(m===""&&(s!=="a"||u!=="href")){e.removeAttribute(u);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){e.removeAttribute(u);break}m=Tr(""+m),e.setAttribute(u,m);break;case"action":case"formAction":if(typeof m=="function"){e.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(u==="formAction"?(s!=="input"&&dn(e,s,"name",b.name,b,null),dn(e,s,"formEncType",b.formEncType,b,null),dn(e,s,"formMethod",b.formMethod,b,null),dn(e,s,"formTarget",b.formTarget,b,null)):(dn(e,s,"encType",b.encType,b,null),dn(e,s,"method",b.method,b,null),dn(e,s,"target",b.target,b,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){e.removeAttribute(u);break}m=Tr(""+m),e.setAttribute(u,m);break;case"onClick":m!=null&&(e.onclick=ks);break;case"onScroll":m!=null&&Ot("scroll",e);break;case"onScrollEnd":m!=null&&Ot("scrollend",e);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(l(61));if(u=m.__html,u!=null){if(b.children!=null)throw Error(l(60));e.innerHTML=u}}break;case"multiple":e.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":e.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){e.removeAttribute("xlink:href");break}u=Tr(""+m),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?e.setAttribute(u,""+m):e.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?e.setAttribute(u,""):e.removeAttribute(u);break;case"capture":case"download":m===!0?e.setAttribute(u,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?e.setAttribute(u,m):e.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?e.setAttribute(u,m):e.removeAttribute(u);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?e.removeAttribute(u):e.setAttribute(u,m);break;case"popover":Ot("beforetoggle",e),Ot("toggle",e),Sr(e,"popover",m);break;case"xlinkActuate":Ys(e,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":Ys(e,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":Ys(e,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":Ys(e,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":Ys(e,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":Ys(e,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":Ys(e,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":Ys(e,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":Ys(e,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":Sr(e,"is",m);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=lc.get(u)||u,Sr(e,u,m))}}function Bh(e,s,u,m,b,S){switch(u){case"style":at(e,m,S);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(l(61));if(u=m.__html,u!=null){if(b.children!=null)throw Error(l(60));e.innerHTML=u}}break;case"children":typeof m=="string"?Nr(e,m):(typeof m=="number"||typeof m=="bigint")&&Nr(e,""+m);break;case"onScroll":m!=null&&Ot("scroll",e);break;case"onScrollEnd":m!=null&&Ot("scrollend",e);break;case"onClick":m!=null&&(e.onclick=ks);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!oc.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(b=u.endsWith("Capture"),s=u.slice(2,b?u.length-7:void 0),S=e[_e]||null,S=S!=null?S[u]:null,typeof S=="function"&&e.removeEventListener(s,S,b),typeof m=="function")){typeof S!="function"&&S!==null&&(u in e?e[u]=null:e.hasAttribute(u)&&e.removeAttribute(u)),e.addEventListener(s,m,b);break e}u in e?e[u]=m:m===!0?e.setAttribute(u,""):Sr(e,u,m)}}}function ws(e,s,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ot("error",e),Ot("load",e);var m=!1,b=!1,S;for(S in u)if(u.hasOwnProperty(S)){var I=u[S];if(I!=null)switch(S){case"src":m=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,s));default:dn(e,s,S,I,u,null)}}b&&dn(e,s,"srcSet",u.srcSet,u,null),m&&dn(e,s,"src",u.src,u,null);return;case"input":Ot("invalid",e);var F=S=I=b=null,ee=null,de=null;for(m in u)if(u.hasOwnProperty(m)){var ve=u[m];if(ve!=null)switch(m){case"name":b=ve;break;case"type":I=ve;break;case"checked":ee=ve;break;case"defaultChecked":de=ve;break;case"value":S=ve;break;case"defaultValue":F=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(l(137,s));break;default:dn(e,s,m,ve,u,null)}}ce(e,S,F,ee,de,I,b,!1);return;case"select":Ot("invalid",e),m=I=S=null;for(b in u)if(u.hasOwnProperty(b)&&(F=u[b],F!=null))switch(b){case"value":S=F;break;case"defaultValue":I=F;break;case"multiple":m=F;default:dn(e,s,b,F,u,null)}s=S,u=I,e.multiple=!!m,s!=null?Ze(e,!!m,s,!1):u!=null&&Ze(e,!!m,u,!0);return;case"textarea":Ot("invalid",e),S=b=m=null;for(I in u)if(u.hasOwnProperty(I)&&(F=u[I],F!=null))switch(I){case"value":m=F;break;case"defaultValue":b=F;break;case"children":S=F;break;case"dangerouslySetInnerHTML":if(F!=null)throw Error(l(91));break;default:dn(e,s,I,F,u,null)}Es(e,m,b,S);return;case"option":for(ee in u)if(u.hasOwnProperty(ee)&&(m=u[ee],m!=null))switch(ee){case"selected":e.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:dn(e,s,ee,m,u,null)}return;case"dialog":Ot("beforetoggle",e),Ot("toggle",e),Ot("cancel",e),Ot("close",e);break;case"iframe":case"object":Ot("load",e);break;case"video":case"audio":for(m=0;m<Ml.length;m++)Ot(Ml[m],e);break;case"image":Ot("error",e),Ot("load",e);break;case"details":Ot("toggle",e);break;case"embed":case"source":case"link":Ot("error",e),Ot("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(de in u)if(u.hasOwnProperty(de)&&(m=u[de],m!=null))switch(de){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,s));default:dn(e,s,de,m,u,null)}return;default:if(fn(s)){for(ve in u)u.hasOwnProperty(ve)&&(m=u[ve],m!==void 0&&Bh(e,s,ve,m,u,void 0));return}}for(F in u)u.hasOwnProperty(F)&&(m=u[F],m!=null&&dn(e,s,F,m,u,null))}function cw(e,s,u,m){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,S=null,I=null,F=null,ee=null,de=null,ve=null;for(we in u){var Ae=u[we];if(u.hasOwnProperty(we)&&Ae!=null)switch(we){case"checked":break;case"value":break;case"defaultValue":ee=Ae;default:m.hasOwnProperty(we)||dn(e,s,we,null,m,Ae)}}for(var fe in m){var we=m[fe];if(Ae=u[fe],m.hasOwnProperty(fe)&&(we!=null||Ae!=null))switch(fe){case"type":S=we;break;case"name":b=we;break;case"checked":de=we;break;case"defaultChecked":ve=we;break;case"value":I=we;break;case"defaultValue":F=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(l(137,s));break;default:we!==Ae&&dn(e,s,fe,we,m,Ae)}}Wn(e,I,F,ee,de,ve,S,b);return;case"select":we=I=F=fe=null;for(S in u)if(ee=u[S],u.hasOwnProperty(S)&&ee!=null)switch(S){case"value":break;case"multiple":we=ee;default:m.hasOwnProperty(S)||dn(e,s,S,null,m,ee)}for(b in m)if(S=m[b],ee=u[b],m.hasOwnProperty(b)&&(S!=null||ee!=null))switch(b){case"value":fe=S;break;case"defaultValue":F=S;break;case"multiple":I=S;default:S!==ee&&dn(e,s,b,S,m,ee)}s=F,u=I,m=we,fe!=null?Ze(e,!!u,fe,!1):!!m!=!!u&&(s!=null?Ze(e,!!u,s,!0):Ze(e,!!u,u?[]:"",!1));return;case"textarea":we=fe=null;for(F in u)if(b=u[F],u.hasOwnProperty(F)&&b!=null&&!m.hasOwnProperty(F))switch(F){case"value":break;case"children":break;default:dn(e,s,F,null,m,b)}for(I in m)if(b=m[I],S=u[I],m.hasOwnProperty(I)&&(b!=null||S!=null))switch(I){case"value":fe=b;break;case"defaultValue":we=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(l(91));break;default:b!==S&&dn(e,s,I,b,m,S)}Vn(e,fe,we);return;case"option":for(var Qe in u)if(fe=u[Qe],u.hasOwnProperty(Qe)&&fe!=null&&!m.hasOwnProperty(Qe))switch(Qe){case"selected":e.selected=!1;break;default:dn(e,s,Qe,null,m,fe)}for(ee in m)if(fe=m[ee],we=u[ee],m.hasOwnProperty(ee)&&fe!==we&&(fe!=null||we!=null))switch(ee){case"selected":e.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:dn(e,s,ee,fe,m,we)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ut in u)fe=u[ut],u.hasOwnProperty(ut)&&fe!=null&&!m.hasOwnProperty(ut)&&dn(e,s,ut,null,m,fe);for(de in m)if(fe=m[de],we=u[de],m.hasOwnProperty(de)&&fe!==we&&(fe!=null||we!=null))switch(de){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(l(137,s));break;default:dn(e,s,de,fe,m,we)}return;default:if(fn(s)){for(var hn in u)fe=u[hn],u.hasOwnProperty(hn)&&fe!==void 0&&!m.hasOwnProperty(hn)&&Bh(e,s,hn,void 0,m,fe);for(ve in m)fe=m[ve],we=u[ve],!m.hasOwnProperty(ve)||fe===we||fe===void 0&&we===void 0||Bh(e,s,ve,fe,m,we);return}}for(var re in u)fe=u[re],u.hasOwnProperty(re)&&fe!=null&&!m.hasOwnProperty(re)&&dn(e,s,re,null,m,fe);for(Ae in m)fe=m[Ae],we=u[Ae],!m.hasOwnProperty(Ae)||fe===we||fe==null&&we==null||dn(e,s,Ae,fe,m,we)}function dm(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function uw(){if(typeof performance.getEntriesByType=="function"){for(var e=0,s=0,u=performance.getEntriesByType("resource"),m=0;m<u.length;m++){var b=u[m],S=b.transferSize,I=b.initiatorType,F=b.duration;if(S&&F&&dm(I)){for(I=0,F=b.responseEnd,m+=1;m<u.length;m++){var ee=u[m],de=ee.startTime;if(de>F)break;var ve=ee.transferSize,Ae=ee.initiatorType;ve&&dm(Ae)&&(ee=ee.responseEnd,I+=ve*(ee<F?1:(F-de)/(ee-de)))}if(--m,s+=8*(S+I)/(b.duration/1e3),e++,10<e)break}}if(0<e)return s/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e=="number")?e:5}var Uh=null,Ph=null;function lu(e){return e.nodeType===9?e:e.ownerDocument}function hm(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function fm(e,s){if(e===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&s==="foreignObject"?0:e}function zh(e,s){return e==="textarea"||e==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Fh=null;function dw(){var e=window.event;return e&&e.type==="popstate"?e===Fh?!1:(Fh=e,!0):(Fh=null,!1)}var gm=typeof setTimeout=="function"?setTimeout:void 0,hw=typeof clearTimeout=="function"?clearTimeout:void 0,mm=typeof Promise=="function"?Promise:void 0,fw=typeof queueMicrotask=="function"?queueMicrotask:typeof mm<"u"?function(e){return mm.resolve(null).then(e).catch(gw)}:gm;function gw(e){setTimeout(function(){throw e})}function $r(e){return e==="head"}function pm(e,s){var u=s,m=0;do{var b=u.nextSibling;if(e.removeChild(u),b&&b.nodeType===8)if(u=b.data,u==="/$"||u==="/&"){if(m===0){e.removeChild(b),Oo(s);return}m--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")m++;else if(u==="html")Dl(e.ownerDocument.documentElement);else if(u==="head"){u=e.ownerDocument.head,Dl(u);for(var S=u.firstChild;S;){var I=S.nextSibling,F=S.nodeName;S[gi]||F==="SCRIPT"||F==="STYLE"||F==="LINK"&&S.rel.toLowerCase()==="stylesheet"||u.removeChild(S),S=I}}else u==="body"&&Dl(e.ownerDocument.body);u=b}while(u);Oo(s)}function xm(e,s){var u=e;e=0;do{var m=u.nextSibling;if(u.nodeType===1?s?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(s?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),m&&m.nodeType===8)if(u=m.data,u==="/$"){if(e===0)break;e--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||e++;u=m}while(u)}function Hh(e){var s=e.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var u=s;switch(s=s.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Hh(u),Ms(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}e.removeChild(u)}}function mw(e,s,u,m){for(;e.nodeType===1;){var b=u;if(e.nodeName.toLowerCase()!==s.toLowerCase()){if(!m&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(m){if(!e[gi])switch(s){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(S=e.getAttribute("rel"),S==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(S!==b.rel||e.getAttribute("href")!==(b.href==null||b.href===""?null:b.href)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||e.getAttribute("title")!==(b.title==null?null:b.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(S=e.getAttribute("src"),(S!==(b.src==null?null:b.src)||e.getAttribute("type")!==(b.type==null?null:b.type)||e.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&S&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(s==="input"&&e.type==="hidden"){var S=b.name==null?null:""+b.name;if(b.type==="hidden"&&e.getAttribute("name")===S)return e}else return e;if(e=xa(e.nextSibling),e===null)break}return null}function pw(e,s,u){if(s==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!u||(e=xa(e.nextSibling),e===null))return null;return e}function ym(e,s){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!s||(e=xa(e.nextSibling),e===null))return null;return e}function qh(e){return e.data==="$?"||e.data==="$~"}function Vh(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState!=="loading"}function xw(e,s){var u=e.ownerDocument;if(e.data==="$~")e._reactRetry=s;else if(e.data!=="$?"||u.readyState!=="loading")s();else{var m=function(){s(),u.removeEventListener("DOMContentLoaded",m)};u.addEventListener("DOMContentLoaded",m),e._reactRetry=m}}function xa(e){for(;e!=null;e=e.nextSibling){var s=e.nodeType;if(s===1||s===3)break;if(s===8){if(s=e.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return e}var Gh=null;function wm(e){e=e.nextSibling;for(var s=0;e;){if(e.nodeType===8){var u=e.data;if(u==="/$"||u==="/&"){if(s===0)return xa(e.nextSibling);s--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||s++}e=e.nextSibling}return null}function bm(e){e=e.previousSibling;for(var s=0;e;){if(e.nodeType===8){var u=e.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(s===0)return e;s--}else u!=="/$"&&u!=="/&"||s++}e=e.previousSibling}return null}function vm(e,s,u){switch(s=lu(u),e){case"html":if(e=s.documentElement,!e)throw Error(l(452));return e;case"head":if(e=s.head,!e)throw Error(l(453));return e;case"body":if(e=s.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function Dl(e){for(var s=e.attributes;s.length;)e.removeAttributeNode(s[0]);Ms(e)}var ya=new Map,Cm=new Set;function cu(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var mr=oe.d;oe.d={f:yw,r:ww,D:bw,C:vw,L:Cw,m:_w,X:Ew,S:Sw,M:Aw};function yw(){var e=mr.f(),s=eu();return e||s}function ww(e){var s=Zt(e);s!==null&&s.tag===5&&s.type==="form"?P1(s):mr.r(e)}var jo=typeof document>"u"?null:document;function _m(e,s,u){var m=jo;if(m&&typeof s=="string"&&s){var b=Tt(s);b='link[rel="'+e+'"][href="'+b+'"]',typeof u=="string"&&(b+='[crossorigin="'+u+'"]'),Cm.has(b)||(Cm.add(b),e={rel:e,crossOrigin:u,href:s},m.querySelector(b)===null&&(s=m.createElement("link"),ws(s,"link",e),Bn(s),m.head.appendChild(s)))}}function bw(e){mr.D(e),_m("dns-prefetch",e,null)}function vw(e,s){mr.C(e,s),_m("preconnect",e,s)}function Cw(e,s,u){mr.L(e,s,u);var m=jo;if(m&&e&&s){var b='link[rel="preload"][as="'+Tt(s)+'"]';s==="image"&&u&&u.imageSrcSet?(b+='[imagesrcset="'+Tt(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(b+='[imagesizes="'+Tt(u.imageSizes)+'"]')):b+='[href="'+Tt(e)+'"]';var S=b;switch(s){case"style":S=Ro(e);break;case"script":S=Io(e)}ya.has(S)||(e=N({rel:"preload",href:s==="image"&&u&&u.imageSrcSet?void 0:e,as:s},u),ya.set(S,e),m.querySelector(b)!==null||s==="style"&&m.querySelector(Ll(S))||s==="script"&&m.querySelector(Bl(S))||(s=m.createElement("link"),ws(s,"link",e),Bn(s),m.head.appendChild(s)))}}function _w(e,s){mr.m(e,s);var u=jo;if(u&&e){var m=s&&typeof s.as=="string"?s.as:"script",b='link[rel="modulepreload"][as="'+Tt(m)+'"][href="'+Tt(e)+'"]',S=b;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=Io(e)}if(!ya.has(S)&&(e=N({rel:"modulepreload",href:e},s),ya.set(S,e),u.querySelector(b)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Bl(S)))return}m=u.createElement("link"),ws(m,"link",e),Bn(m),u.head.appendChild(m)}}}function Sw(e,s,u){mr.S(e,s,u);var m=jo;if(m&&e){var b=Ss(m).hoistableStyles,S=Ro(e);s=s||"default";var I=b.get(S);if(!I){var F={loading:0,preload:null};if(I=m.querySelector(Ll(S)))F.loading=5;else{e=N({rel:"stylesheet",href:e,"data-precedence":s},u),(u=ya.get(S))&&Yh(e,u);var ee=I=m.createElement("link");Bn(ee),ws(ee,"link",e),ee._p=new Promise(function(de,ve){ee.onload=de,ee.onerror=ve}),ee.addEventListener("load",function(){F.loading|=1}),ee.addEventListener("error",function(){F.loading|=2}),F.loading|=4,uu(I,s,m)}I={type:"stylesheet",instance:I,count:1,state:F},b.set(S,I)}}}function Ew(e,s){mr.X(e,s);var u=jo;if(u&&e){var m=Ss(u).hoistableScripts,b=Io(e),S=m.get(b);S||(S=u.querySelector(Bl(b)),S||(e=N({src:e,async:!0},s),(s=ya.get(b))&&Xh(e,s),S=u.createElement("script"),Bn(S),ws(S,"link",e),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},m.set(b,S))}}function Aw(e,s){mr.M(e,s);var u=jo;if(u&&e){var m=Ss(u).hoistableScripts,b=Io(e),S=m.get(b);S||(S=u.querySelector(Bl(b)),S||(e=N({src:e,async:!0,type:"module"},s),(s=ya.get(b))&&Xh(e,s),S=u.createElement("script"),Bn(S),ws(S,"link",e),u.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},m.set(b,S))}}function Sm(e,s,u,m){var b=(b=Ne.current)?cu(b):null;if(!b)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(s=Ro(u.href),u=Ss(b).hoistableStyles,m=u.get(s),m||(m={type:"style",instance:null,count:0,state:null},u.set(s,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){e=Ro(u.href);var S=Ss(b).hoistableStyles,I=S.get(e);if(I||(b=b.ownerDocument||b,I={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(e,I),(S=b.querySelector(Ll(e)))&&!S._p&&(I.instance=S,I.state.loading=5),ya.has(e)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},ya.set(e,u),S||Nw(b,e,u,I.state))),s&&m===null)throw Error(l(528,""));return I}if(s&&m!==null)throw Error(l(529,""));return null;case"script":return s=u.async,u=u.src,typeof u=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Io(u),u=Ss(b).hoistableScripts,m=u.get(s),m||(m={type:"script",instance:null,count:0,state:null},u.set(s,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function Ro(e){return'href="'+Tt(e)+'"'}function Ll(e){return'link[rel="stylesheet"]['+e+"]"}function Em(e){return N({},e,{"data-precedence":e.precedence,precedence:null})}function Nw(e,s,u,m){e.querySelector('link[rel="preload"][as="style"]['+s+"]")?m.loading=1:(s=e.createElement("link"),m.preload=s,s.addEventListener("load",function(){return m.loading|=1}),s.addEventListener("error",function(){return m.loading|=2}),ws(s,"link",u),Bn(s),e.head.appendChild(s))}function Io(e){return'[src="'+Tt(e)+'"]'}function Bl(e){return"script[async]"+e}function Am(e,s,u){if(s.count++,s.instance===null)switch(s.type){case"style":var m=e.querySelector('style[data-href~="'+Tt(u.href)+'"]');if(m)return s.instance=m,Bn(m),m;var b=N({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return m=(e.ownerDocument||e).createElement("style"),Bn(m),ws(m,"style",b),uu(m,u.precedence,e),s.instance=m;case"stylesheet":b=Ro(u.href);var S=e.querySelector(Ll(b));if(S)return s.state.loading|=4,s.instance=S,Bn(S),S;m=Em(u),(b=ya.get(b))&&Yh(m,b),S=(e.ownerDocument||e).createElement("link"),Bn(S);var I=S;return I._p=new Promise(function(F,ee){I.onload=F,I.onerror=ee}),ws(S,"link",m),s.state.loading|=4,uu(S,u.precedence,e),s.instance=S;case"script":return S=Io(u.src),(b=e.querySelector(Bl(S)))?(s.instance=b,Bn(b),b):(m=u,(b=ya.get(S))&&(m=N({},u),Xh(m,b)),e=e.ownerDocument||e,b=e.createElement("script"),Bn(b),ws(b,"link",m),e.head.appendChild(b),s.instance=b);case"void":return null;default:throw Error(l(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(m=s.instance,s.state.loading|=4,uu(m,u.precedence,e));return s.instance}function uu(e,s,u){for(var m=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=m.length?m[m.length-1]:null,S=b,I=0;I<m.length;I++){var F=m[I];if(F.dataset.precedence===s)S=F;else if(S!==b)break}S?S.parentNode.insertBefore(e,S.nextSibling):(s=u.nodeType===9?u.head:u,s.insertBefore(e,s.firstChild))}function Yh(e,s){e.crossOrigin==null&&(e.crossOrigin=s.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=s.referrerPolicy),e.title==null&&(e.title=s.title)}function Xh(e,s){e.crossOrigin==null&&(e.crossOrigin=s.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=s.referrerPolicy),e.integrity==null&&(e.integrity=s.integrity)}var du=null;function Nm(e,s,u){if(du===null){var m=new Map,b=du=new Map;b.set(u,m)}else b=du,m=b.get(u),m||(m=new Map,b.set(u,m));if(m.has(e))return m;for(m.set(e,null),u=u.getElementsByTagName(e),b=0;b<u.length;b++){var S=u[b];if(!(S[gi]||S[Ee]||e==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var I=S.getAttribute(s)||"";I=e+I;var F=m.get(I);F?F.push(S):m.set(I,[S])}}return m}function Tm(e,s,u){e=e.ownerDocument||e,e.head.insertBefore(u,s==="title"?e.querySelector("head > title"):null)}function Tw(e,s,u){if(u===1||s.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return e=s.disabled,typeof s.precedence=="string"&&e==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function jm(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}function jw(e,s,u,m){if(u.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var b=Ro(m.href),S=s.querySelector(Ll(b));if(S){s=S._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(e.count++,e=hu.bind(e),s.then(e,e)),u.state.loading|=4,u.instance=S,Bn(S);return}S=s.ownerDocument||s,m=Em(m),(b=ya.get(b))&&Yh(m,b),S=S.createElement("link"),Bn(S);var I=S;I._p=new Promise(function(F,ee){I.onload=F,I.onerror=ee}),ws(S,"link",m),u.instance=S}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(u,s),(s=u.state.preload)&&(u.state.loading&3)===0&&(e.count++,u=hu.bind(e),s.addEventListener("load",u),s.addEventListener("error",u))}}var Wh=0;function Rw(e,s){return e.stylesheets&&e.count===0&&gu(e,e.stylesheets),0<e.count||0<e.imgCount?function(u){var m=setTimeout(function(){if(e.stylesheets&&gu(e,e.stylesheets),e.unsuspend){var S=e.unsuspend;e.unsuspend=null,S()}},6e4+s);0<e.imgBytes&&Wh===0&&(Wh=62500*uw());var b=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&gu(e,e.stylesheets),e.unsuspend)){var S=e.unsuspend;e.unsuspend=null,S()}},(e.imgBytes>Wh?50:800)+s);return e.unsuspend=u,function(){e.unsuspend=null,clearTimeout(m),clearTimeout(b)}}:null}function hu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)gu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var fu=null;function gu(e,s){e.stylesheets=null,e.unsuspend!==null&&(e.count++,fu=new Map,s.forEach(Iw,e),fu=null,hu.call(e))}function Iw(e,s){if(!(s.state.loading&4)){var u=fu.get(e);if(u)var m=u.get(null);else{u=new Map,fu.set(e,u);for(var b=e.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<b.length;S++){var I=b[S];(I.nodeName==="LINK"||I.getAttribute("media")!=="not all")&&(u.set(I.dataset.precedence,I),m=I)}m&&u.set(null,m)}b=s.instance,I=b.getAttribute("data-precedence"),S=u.get(I)||m,S===m&&u.set(null,b),u.set(I,b),this.count++,m=hu.bind(this),b.addEventListener("load",m),b.addEventListener("error",m),S?S.parentNode.insertBefore(b,S.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(b,e.firstChild)),s.state.loading|=4}}var Ul={$$typeof:P,Provider:null,Consumer:null,_currentValue:ke,_currentValue2:ke,_threadCount:0};function Ow(e,s,u,m,b,S,I,F,ee){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=In(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=In(0),this.hiddenUpdates=In(null),this.identifierPrefix=m,this.onUncaughtError=b,this.onCaughtError=S,this.onRecoverableError=I,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ee,this.incompleteTransitions=new Map}function Rm(e,s,u,m,b,S,I,F,ee,de,ve,Ae){return e=new Ow(e,s,u,I,ee,de,ve,Ae,F),s=1,S===!0&&(s|=24),S=Ks(3,null,null,s),e.current=S,S.stateNode=e,s=Nd(),s.refCount++,e.pooledCache=s,s.refCount++,S.memoizedState={element:m,isDehydrated:u,cache:s},Id(S),e}function Im(e){return e?(e=oo,e):oo}function Om(e,s,u,m,b,S){b=Im(b),m.context===null?m.context=b:m.pendingContext=b,m=Fr(s),m.payload={element:u},S=S===void 0?null:S,S!==null&&(m.callback=S),u=Hr(e,m,s),u!==null&&(Fs(u,e,s),pl(u,e,s))}function Mm(e,s){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var u=e.retryLane;e.retryLane=u!==0&&u<s?u:s}}function Qh(e,s){Mm(e,s),(e=e.alternate)&&Mm(e,s)}function km(e){if(e.tag===13||e.tag===31){var s=_i(e,67108864);s!==null&&Fs(s,e,67108864),Qh(e,67108864)}}function Dm(e){if(e.tag===13||e.tag===31){var s=ta();s=yn(s);var u=_i(e,s);u!==null&&Fs(u,e,s),Qh(e,s)}}var mu=!0;function Mw(e,s,u,m){var b=$.T;$.T=null;var S=oe.p;try{oe.p=2,Kh(e,s,u,m)}finally{oe.p=S,$.T=b}}function kw(e,s,u,m){var b=$.T;$.T=null;var S=oe.p;try{oe.p=8,Kh(e,s,u,m)}finally{oe.p=S,$.T=b}}function Kh(e,s,u,m){if(mu){var b=Zh(m);if(b===null)Lh(e,s,m,pu,u),Bm(e,m);else if(Lw(b,e,s,u,m))m.stopPropagation();else if(Bm(e,m),s&4&&-1<Dw.indexOf(e)){for(;b!==null;){var S=Zt(b);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var I=me(S.pendingLanes);if(I!==0){var F=S;for(F.pendingLanes|=2,F.entangledLanes|=2;I;){var ee=1<<31-gt(I);F.entanglements[1]|=ee,I&=~ee}qa(S),(Jt&6)===0&&($c=Fe()+500,Ol(0))}}break;case 31:case 13:F=_i(S,2),F!==null&&Fs(F,S,2),eu(),Qh(S,2)}if(S=Zh(m),S===null&&Lh(e,s,m,pu,u),S===b)break;b=S}b!==null&&m.stopPropagation()}else Lh(e,s,m,null,u)}}function Zh(e){return e=tl(e),$h(e)}var pu=null;function $h(e){if(pu=null,e=Ln(e),e!==null){var s=f(e);if(s===null)e=null;else{var u=s.tag;if(u===13){if(e=x(s),e!==null)return e;e=null}else if(u===31){if(e=v(s),e!==null)return e;e=null}else if(u===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;e=null}else s!==e&&(e=null)}}return pu=e,null}function Lm(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(nt()){case _t:return 2;case Tn:return 8;case sn:case Vt:return 32;case qn:return 268435456;default:return 32}default:return 32}}var Jh=!1,Jr=null,ei=null,ti=null,Pl=new Map,zl=new Map,ni=[],Dw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Bm(e,s){switch(e){case"focusin":case"focusout":Jr=null;break;case"dragenter":case"dragleave":ei=null;break;case"mouseover":case"mouseout":ti=null;break;case"pointerover":case"pointerout":Pl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":zl.delete(s.pointerId)}}function Fl(e,s,u,m,b,S){return e===null||e.nativeEvent!==S?(e={blockedOn:s,domEventName:u,eventSystemFlags:m,nativeEvent:S,targetContainers:[b]},s!==null&&(s=Zt(s),s!==null&&km(s)),e):(e.eventSystemFlags|=m,s=e.targetContainers,b!==null&&s.indexOf(b)===-1&&s.push(b),e)}function Lw(e,s,u,m,b){switch(s){case"focusin":return Jr=Fl(Jr,e,s,u,m,b),!0;case"dragenter":return ei=Fl(ei,e,s,u,m,b),!0;case"mouseover":return ti=Fl(ti,e,s,u,m,b),!0;case"pointerover":var S=b.pointerId;return Pl.set(S,Fl(Pl.get(S)||null,e,s,u,m,b)),!0;case"gotpointercapture":return S=b.pointerId,zl.set(S,Fl(zl.get(S)||null,e,s,u,m,b)),!0}return!1}function Um(e){var s=Ln(e.target);if(s!==null){var u=f(s);if(u!==null){if(s=u.tag,s===13){if(s=x(u),s!==null){e.blockedOn=s,He(e.priority,function(){Dm(u)});return}}else if(s===31){if(s=v(u),s!==null){e.blockedOn=s,He(e.priority,function(){Dm(u)});return}}else if(s===3&&u.stateNode.current.memoizedState.isDehydrated){e.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}e.blockedOn=null}function xu(e){if(e.blockedOn!==null)return!1;for(var s=e.targetContainers;0<s.length;){var u=Zh(e.nativeEvent);if(u===null){u=e.nativeEvent;var m=new u.constructor(u.type,u);mi=m,u.target.dispatchEvent(m),mi=null}else return s=Zt(u),s!==null&&km(s),e.blockedOn=u,!1;s.shift()}return!0}function Pm(e,s,u){xu(e)&&u.delete(s)}function Bw(){Jh=!1,Jr!==null&&xu(Jr)&&(Jr=null),ei!==null&&xu(ei)&&(ei=null),ti!==null&&xu(ti)&&(ti=null),Pl.forEach(Pm),zl.forEach(Pm)}function yu(e,s){e.blockedOn===s&&(e.blockedOn=null,Jh||(Jh=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Bw)))}var wu=null;function zm(e){wu!==e&&(wu=e,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){wu===e&&(wu=null);for(var s=0;s<e.length;s+=3){var u=e[s],m=e[s+1],b=e[s+2];if(typeof m!="function"){if($h(m||u)===null)continue;break}var S=Zt(u);S!==null&&(e.splice(s,3),s-=3,Zd(S,{pending:!0,data:b,method:u.method,action:m},m,b))}}))}function Oo(e){function s(ee){return yu(ee,e)}Jr!==null&&yu(Jr,e),ei!==null&&yu(ei,e),ti!==null&&yu(ti,e),Pl.forEach(s),zl.forEach(s);for(var u=0;u<ni.length;u++){var m=ni[u];m.blockedOn===e&&(m.blockedOn=null)}for(;0<ni.length&&(u=ni[0],u.blockedOn===null);)Um(u),u.blockedOn===null&&ni.shift();if(u=(e.ownerDocument||e).$$reactFormReplay,u!=null)for(m=0;m<u.length;m+=3){var b=u[m],S=u[m+1],I=b[_e]||null;if(typeof S=="function")I||zm(u);else if(I){var F=null;if(S&&S.hasAttribute("formAction")){if(b=S,I=S[_e]||null)F=I.formAction;else if($h(b)!==null)continue}else F=I.action;typeof F=="function"?u[m+1]=F:(u.splice(m,3),m-=3),zm(u)}}}function Fm(){function e(S){S.canIntercept&&S.info==="react-transition"&&S.intercept({handler:function(){return new Promise(function(I){return b=I})},focusReset:"manual",scroll:"manual"})}function s(){b!==null&&(b(),b=null),m||setTimeout(u,20)}function u(){if(!m&&!navigation.transition){var S=navigation.currentEntry;S&&S.url!=null&&navigation.navigate(S.url,{state:S.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var m=!1,b=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(u,100),function(){m=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),b!==null&&(b(),b=null)}}}function ef(e){this._internalRoot=e}bu.prototype.render=ef.prototype.render=function(e){var s=this._internalRoot;if(s===null)throw Error(l(409));var u=s.current,m=ta();Om(u,m,e,s,null,null)},bu.prototype.unmount=ef.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var s=e.containerInfo;Om(e.current,2,null,e,null,null),eu(),s[Ve]=null}};function bu(e){this._internalRoot=e}bu.prototype.unstable_scheduleHydration=function(e){if(e){var s=ns();e={blockedOn:null,target:e,priority:s};for(var u=0;u<ni.length&&s!==0&&s<ni[u].priority;u++);ni.splice(u,0,e),u===0&&Um(e)}};var Hm=n.version;if(Hm!=="19.2.0")throw Error(l(527,Hm,"19.2.0"));oe.findDOMNode=function(e){var s=e._reactInternals;if(s===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=w(s),e=e!==null?A(e):null,e=e===null?null:e.stateNode,e};var Uw={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vu.isDisabled&&vu.supportsFiber)try{Ut=vu.inject(Uw),je=vu}catch{}}return ql.createRoot=function(e,s){if(!d(e))throw Error(l(299));var u=!1,m="",b=Q1,S=K1,I=Z1;return s!=null&&(s.unstable_strictMode===!0&&(u=!0),s.identifierPrefix!==void 0&&(m=s.identifierPrefix),s.onUncaughtError!==void 0&&(b=s.onUncaughtError),s.onCaughtError!==void 0&&(S=s.onCaughtError),s.onRecoverableError!==void 0&&(I=s.onRecoverableError)),s=Rm(e,1,!1,null,null,u,m,null,b,S,I,Fm),e[Ve]=s.current,Dh(e),new ef(s)},ql.hydrateRoot=function(e,s,u){if(!d(e))throw Error(l(299));var m=!1,b="",S=Q1,I=K1,F=Z1,ee=null;return u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(b=u.identifierPrefix),u.onUncaughtError!==void 0&&(S=u.onUncaughtError),u.onCaughtError!==void 0&&(I=u.onCaughtError),u.onRecoverableError!==void 0&&(F=u.onRecoverableError),u.formState!==void 0&&(ee=u.formState)),s=Rm(e,1,!0,s,u??null,m,b,ee,S,I,F,Fm),s.context=Im(null),u=s.current,m=ta(),m=yn(m),b=Fr(m),b.callback=null,Hr(u,b,m),u=m,s.current.lanes=u,G(s,u),qa(s),e[Ve]=s.current,Dh(e),new bu(s)},ql.version="19.2.0",ql}var $m;function Qw(){if($m)return sf.exports;$m=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),sf.exports=Ww(),sf.exports}var Kw=Qw();var Jm="popstate";function Zw(i={}){function n(d,f){let{pathname:x="/",search:v="",hash:C=""}=Yi(d.location.hash.substring(1));return!x.startsWith("/")&&!x.startsWith(".")&&(x="/"+x),Wf("",{pathname:x,search:v,hash:C},f.state&&f.state.usr||null,f.state&&f.state.key||"default")}function a(d,f){let x=d.document.querySelector("base"),v="";if(x&&x.getAttribute("href")){let C=d.location.href,w=C.indexOf("#");v=w===-1?C:C.slice(0,w)}return v+"#"+(typeof f=="string"?f:$l(f))}function l(d,f){la(d.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(f)})`)}return Jw(n,a,l,i)}function Nn(i,n){if(i===!1||i===null||typeof i>"u")throw new Error(n)}function la(i,n){if(!i){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function $w(){return Math.random().toString(36).substring(2,10)}function ep(i,n){return{usr:i.state,key:i.key,idx:n}}function Wf(i,n,a=null,l){return{pathname:typeof i=="string"?i:i.pathname,search:"",hash:"",...typeof n=="string"?Yi(n):n,state:a,key:n&&n.key||l||$w()}}function $l({pathname:i="/",search:n="",hash:a=""}){return n&&n!=="?"&&(i+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(i+=a.charAt(0)==="#"?a:"#"+a),i}function Yi(i){let n={};if(i){let a=i.indexOf("#");a>=0&&(n.hash=i.substring(a),i=i.substring(0,a));let l=i.indexOf("?");l>=0&&(n.search=i.substring(l),i=i.substring(0,l)),i&&(n.pathname=i)}return n}function Jw(i,n,a,l={}){let{window:d=document.defaultView,v5Compat:f=!1}=l,x=d.history,v="POP",C=null,w=A();w==null&&(w=0,x.replaceState({...x.state,idx:w},""));function A(){return(x.state||{idx:null}).idx}function N(){v="POP";let B=A(),H=B==null?null:B-w;w=B,C&&C({action:v,location:L.location,delta:H})}function R(B,H){v="PUSH";let U=Wf(L.location,B,H);a&&a(U,B),w=A()+1;let P=ep(U,w),K=L.createHref(U);try{x.pushState(P,"",K)}catch(Z){if(Z instanceof DOMException&&Z.name==="DataCloneError")throw Z;d.location.assign(K)}f&&C&&C({action:v,location:L.location,delta:1})}function T(B,H){v="REPLACE";let U=Wf(L.location,B,H);a&&a(U,B),w=A();let P=ep(U,w),K=L.createHref(U);x.replaceState(P,"",K),f&&C&&C({action:v,location:L.location,delta:0})}function O(B){return eb(B)}let L={get action(){return v},get location(){return i(d,x)},listen(B){if(C)throw new Error("A history only accepts one active listener");return d.addEventListener(Jm,N),C=B,()=>{d.removeEventListener(Jm,N),C=null}},createHref(B){return n(d,B)},createURL:O,encodeLocation(B){let H=O(B);return{pathname:H.pathname,search:H.search,hash:H.hash}},push:R,replace:T,go(B){return x.go(B)}};return L}function eb(i,n=!1){let a="http://localhost";typeof window<"u"&&(a=window.location.origin!=="null"?window.location.origin:window.location.href),Nn(a,"No window.location.(origin|href) available to create URL");let l=typeof i=="string"?i:$l(i);return l=l.replace(/ $/,"%20"),!n&&l.startsWith("//")&&(l=a+l),new URL(l,a)}function zx(i,n,a="/"){return tb(i,n,a,!1)}function tb(i,n,a,l){let d=typeof n=="string"?Yi(n):n,f=br(d.pathname||"/",a);if(f==null)return null;let x=Fx(i);nb(x);let v=null;for(let C=0;v==null&&C<x.length;++C){let w=fb(f);v=db(x[C],w,l)}return v}function Fx(i,n=[],a=[],l="",d=!1){let f=(x,v,C=d,w)=>{let A={relativePath:w===void 0?x.path||"":w,caseSensitive:x.caseSensitive===!0,childrenIndex:v,route:x};if(A.relativePath.startsWith("/")){if(!A.relativePath.startsWith(l)&&C)return;Nn(A.relativePath.startsWith(l),`Absolute route path "${A.relativePath}" nested under path "${l}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),A.relativePath=A.relativePath.slice(l.length)}let N=yr([l,A.relativePath]),R=a.concat(A);x.children&&x.children.length>0&&(Nn(x.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${N}".`),Fx(x.children,n,R,N,C)),!(x.path==null&&!x.index)&&n.push({path:N,score:cb(N,x.index),routesMeta:R})};return i.forEach((x,v)=>{if(x.path===""||!x.path?.includes("?"))f(x,v);else for(let C of Hx(x.path))f(x,v,!0,C)}),n}function Hx(i){let n=i.split("/");if(n.length===0)return[];let[a,...l]=n,d=a.endsWith("?"),f=a.replace(/\?$/,"");if(l.length===0)return d?[f,""]:[f];let x=Hx(l.join("/")),v=[];return v.push(...x.map(C=>C===""?f:[f,C].join("/"))),d&&v.push(...x),v.map(C=>i.startsWith("/")&&C===""?"/":C)}function nb(i){i.sort((n,a)=>n.score!==a.score?a.score-n.score:ub(n.routesMeta.map(l=>l.childrenIndex),a.routesMeta.map(l=>l.childrenIndex)))}var sb=/^:[\w-]+$/,ab=3,rb=2,ib=1,ob=10,lb=-2,tp=i=>i==="*";function cb(i,n){let a=i.split("/"),l=a.length;return a.some(tp)&&(l+=lb),n&&(l+=rb),a.filter(d=>!tp(d)).reduce((d,f)=>d+(sb.test(f)?ab:f===""?ib:ob),l)}function ub(i,n){return i.length===n.length&&i.slice(0,-1).every((l,d)=>l===n[d])?i[i.length-1]-n[n.length-1]:0}function db(i,n,a=!1){let{routesMeta:l}=i,d={},f="/",x=[];for(let v=0;v<l.length;++v){let C=l[v],w=v===l.length-1,A=f==="/"?n:n.slice(f.length)||"/",N=Pu({path:C.relativePath,caseSensitive:C.caseSensitive,end:w},A),R=C.route;if(!N&&w&&a&&!l[l.length-1].route.index&&(N=Pu({path:C.relativePath,caseSensitive:C.caseSensitive,end:!1},A)),!N)return null;Object.assign(d,N.params),x.push({params:d,pathname:yr([f,N.pathname]),pathnameBase:yb(yr([f,N.pathnameBase])),route:R}),N.pathnameBase!=="/"&&(f=yr([f,N.pathnameBase]))}return x}function Pu(i,n){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[a,l]=hb(i.path,i.caseSensitive,i.end),d=n.match(a);if(!d)return null;let f=d[0],x=f.replace(/(.)\/+$/,"$1"),v=d.slice(1);return{params:l.reduce((w,{paramName:A,isOptional:N},R)=>{if(A==="*"){let O=v[R]||"";x=f.slice(0,f.length-O.length).replace(/(.)\/+$/,"$1")}const T=v[R];return N&&!T?w[A]=void 0:w[A]=(T||"").replace(/%2F/g,"/"),w},{}),pathname:f,pathnameBase:x,pattern:i}}function hb(i,n=!1,a=!0){la(i==="*"||!i.endsWith("*")||i.endsWith("/*"),`Route path "${i}" will be treated as if it were "${i.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${i.replace(/\*$/,"/*")}".`);let l=[],d="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(x,v,C)=>(l.push({paramName:v,isOptional:C!=null}),C?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return i.endsWith("*")?(l.push({paramName:"*"}),d+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?d+="\\/*$":i!==""&&i!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,n?void 0:"i"),l]}function fb(i){try{return i.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return la(!1,`The URL path "${i}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),i}}function br(i,n){if(n==="/")return i;if(!i.toLowerCase().startsWith(n.toLowerCase()))return null;let a=n.endsWith("/")?n.length-1:n.length,l=i.charAt(a);return l&&l!=="/"?null:i.slice(a)||"/"}var gb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mb=i=>gb.test(i);function pb(i,n="/"){let{pathname:a,search:l="",hash:d=""}=typeof i=="string"?Yi(i):i,f;if(a)if(mb(a))f=a;else{if(a.includes("//")){let x=a;a=a.replace(/\/\/+/g,"/"),la(!1,`Pathnames cannot have embedded double slashes - normalizing ${x} -> ${a}`)}a.startsWith("/")?f=np(a.substring(1),"/"):f=np(a,n)}else f=n;return{pathname:f,search:wb(l),hash:bb(d)}}function np(i,n){let a=n.replace(/\/+$/,"").split("/");return i.split("/").forEach(d=>{d===".."?a.length>1&&a.pop():d!=="."&&a.push(d)}),a.length>1?a.join("/"):"/"}function lf(i,n,a,l){return`Cannot include a '${i}' character in a manually specified \`to.${n}\` field [${JSON.stringify(l)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function xb(i){return i.filter((n,a)=>a===0||n.route.path&&n.route.path.length>0)}function x0(i){let n=xb(i);return n.map((a,l)=>l===n.length-1?a.pathname:a.pathnameBase)}function y0(i,n,a,l=!1){let d;typeof i=="string"?d=Yi(i):(d={...i},Nn(!d.pathname||!d.pathname.includes("?"),lf("?","pathname","search",d)),Nn(!d.pathname||!d.pathname.includes("#"),lf("#","pathname","hash",d)),Nn(!d.search||!d.search.includes("#"),lf("#","search","hash",d)));let f=i===""||d.pathname==="",x=f?"/":d.pathname,v;if(x==null)v=a;else{let N=n.length-1;if(!l&&x.startsWith("..")){let R=x.split("/");for(;R[0]==="..";)R.shift(),N-=1;d.pathname=R.join("/")}v=N>=0?n[N]:"/"}let C=pb(d,v),w=x&&x!=="/"&&x.endsWith("/"),A=(f||x===".")&&a.endsWith("/");return!C.pathname.endsWith("/")&&(w||A)&&(C.pathname+="/"),C}var yr=i=>i.join("/").replace(/\/\/+/g,"/"),yb=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),wb=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,bb=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function vb(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var qx=["POST","PUT","PATCH","DELETE"];new Set(qx);var Cb=["GET",...qx];new Set(Cb);var Wo=M.createContext(null);Wo.displayName="DataRouter";var Ku=M.createContext(null);Ku.displayName="DataRouterState";M.createContext(!1);var Vx=M.createContext({isTransitioning:!1});Vx.displayName="ViewTransition";var _b=M.createContext(new Map);_b.displayName="Fetchers";var Sb=M.createContext(null);Sb.displayName="Await";var ka=M.createContext(null);ka.displayName="Navigation";var sc=M.createContext(null);sc.displayName="Location";var Da=M.createContext({outlet:null,matches:[],isDataRoute:!1});Da.displayName="Route";var w0=M.createContext(null);w0.displayName="RouteError";function Eb(i,{relative:n}={}){Nn(Qo(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:l}=M.useContext(ka),{hash:d,pathname:f,search:x}=ac(i,{relative:n}),v=f;return a!=="/"&&(v=f==="/"?a:yr([a,f])),l.createHref({pathname:v,search:x,hash:d})}function Qo(){return M.useContext(sc)!=null}function Cr(){return Nn(Qo(),"useLocation() may be used only in the context of a <Router> component."),M.useContext(sc).location}var Gx="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Yx(i){M.useContext(ka).static||M.useLayoutEffect(i)}function us(){let{isDataRoute:i}=M.useContext(Da);return i?Ub():Ab()}function Ab(){Nn(Qo(),"useNavigate() may be used only in the context of a <Router> component.");let i=M.useContext(Wo),{basename:n,navigator:a}=M.useContext(ka),{matches:l}=M.useContext(Da),{pathname:d}=Cr(),f=JSON.stringify(x0(l)),x=M.useRef(!1);return Yx(()=>{x.current=!0}),M.useCallback((C,w={})=>{if(la(x.current,Gx),!x.current)return;if(typeof C=="number"){a.go(C);return}let A=y0(C,JSON.parse(f),d,w.relative==="path");i==null&&n!=="/"&&(A.pathname=A.pathname==="/"?n:yr([n,A.pathname])),(w.replace?a.replace:a.push)(A,w.state,w)},[n,a,f,d,i])}M.createContext(null);function Zu(){let{matches:i}=M.useContext(Da),n=i[i.length-1];return n?n.params:{}}function ac(i,{relative:n}={}){let{matches:a}=M.useContext(Da),{pathname:l}=Cr(),d=JSON.stringify(x0(a));return M.useMemo(()=>y0(i,JSON.parse(d),l,n==="path"),[i,d,l,n])}function Nb(i,n){return Xx(i,n)}function Xx(i,n,a,l,d){Nn(Qo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:f}=M.useContext(ka),{matches:x}=M.useContext(Da),v=x[x.length-1],C=v?v.params:{},w=v?v.pathname:"/",A=v?v.pathnameBase:"/",N=v&&v.route;{let U=N&&N.path||"";Wx(w,!N||U.endsWith("*")||U.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${w}" (under <Route path="${U}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${U}"> to <Route path="${U==="/"?"*":`${U}/*`}">.`)}let R=Cr(),T;if(n){let U=typeof n=="string"?Yi(n):n;Nn(A==="/"||U.pathname?.startsWith(A),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${A}" but pathname "${U.pathname}" was given in the \`location\` prop.`),T=U}else T=R;let O=T.pathname||"/",L=O;if(A!=="/"){let U=A.replace(/^\//,"").split("/");L="/"+O.replace(/^\//,"").split("/").slice(U.length).join("/")}let B=zx(i,{pathname:L});la(N||B!=null,`No routes matched location "${T.pathname}${T.search}${T.hash}" `),la(B==null||B[B.length-1].route.element!==void 0||B[B.length-1].route.Component!==void 0||B[B.length-1].route.lazy!==void 0,`Matched leaf route at location "${T.pathname}${T.search}${T.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let H=Ob(B&&B.map(U=>Object.assign({},U,{params:Object.assign({},C,U.params),pathname:yr([A,f.encodeLocation?f.encodeLocation(U.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:U.pathname]),pathnameBase:U.pathnameBase==="/"?A:yr([A,f.encodeLocation?f.encodeLocation(U.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:U.pathnameBase])})),x,a,l,d);return n&&H?M.createElement(sc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...T},navigationType:"POP"}},H):H}function Tb(){let i=Bb(),n=vb(i)?`${i.status} ${i.statusText}`:i instanceof Error?i.message:JSON.stringify(i),a=i instanceof Error?i.stack:null,l="rgba(200,200,200, 0.5)",d={padding:"0.5rem",backgroundColor:l},f={padding:"2px 4px",backgroundColor:l},x=null;return console.error("Error handled by React Router default ErrorBoundary:",i),x=M.createElement(M.Fragment,null,M.createElement("p",null," Hey developer "),M.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",M.createElement("code",{style:f},"ErrorBoundary")," or"," ",M.createElement("code",{style:f},"errorElement")," prop on your route.")),M.createElement(M.Fragment,null,M.createElement("h2",null,"Unexpected Application Error!"),M.createElement("h3",{style:{fontStyle:"italic"}},n),a?M.createElement("pre",{style:d},a):null,x)}var jb=M.createElement(Tb,null),Rb=class extends M.Component{constructor(i){super(i),this.state={location:i.location,revalidation:i.revalidation,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,n){return n.location!==i.location||n.revalidation!=="idle"&&i.revalidation==="idle"?{error:i.error,location:i.location,revalidation:i.revalidation}:{error:i.error!==void 0?i.error:n.error,location:n.location,revalidation:i.revalidation||n.revalidation}}componentDidCatch(i,n){this.props.onError?this.props.onError(i,n):console.error("React Router caught the following error during render",i)}render(){return this.state.error!==void 0?M.createElement(Da.Provider,{value:this.props.routeContext},M.createElement(w0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Ib({routeContext:i,match:n,children:a}){let l=M.useContext(Wo);return l&&l.static&&l.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(l.staticContext._deepestRenderedBoundaryId=n.route.id),M.createElement(Da.Provider,{value:i},a)}function Ob(i,n=[],a=null,l=null,d=null){if(i==null){if(!a)return null;if(a.errors)i=a.matches;else if(n.length===0&&!a.initialized&&a.matches.length>0)i=a.matches;else return null}let f=i,x=a?.errors;if(x!=null){let A=f.findIndex(N=>N.route.id&&x?.[N.route.id]!==void 0);Nn(A>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(x).join(",")}`),f=f.slice(0,Math.min(f.length,A+1))}let v=!1,C=-1;if(a)for(let A=0;A<f.length;A++){let N=f[A];if((N.route.HydrateFallback||N.route.hydrateFallbackElement)&&(C=A),N.route.id){let{loaderData:R,errors:T}=a,O=N.route.loader&&!R.hasOwnProperty(N.route.id)&&(!T||T[N.route.id]===void 0);if(N.route.lazy||O){v=!0,C>=0?f=f.slice(0,C+1):f=[f[0]];break}}}let w=a&&l?(A,N)=>{l(A,{location:a.location,params:a.matches?.[0]?.params??{},errorInfo:N})}:void 0;return f.reduceRight((A,N,R)=>{let T,O=!1,L=null,B=null;a&&(T=x&&N.route.id?x[N.route.id]:void 0,L=N.route.errorElement||jb,v&&(C<0&&R===0?(Wx("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),O=!0,B=null):C===R&&(O=!0,B=N.route.hydrateFallbackElement||null)));let H=n.concat(f.slice(0,R+1)),U=()=>{let P;return T?P=L:O?P=B:N.route.Component?P=M.createElement(N.route.Component,null):N.route.element?P=N.route.element:P=A,M.createElement(Ib,{match:N,routeContext:{outlet:A,matches:H,isDataRoute:a!=null},children:P})};return a&&(N.route.ErrorBoundary||N.route.errorElement||R===0)?M.createElement(Rb,{location:a.location,revalidation:a.revalidation,component:L,error:T,children:U(),routeContext:{outlet:null,matches:H,isDataRoute:!0},onError:w}):U()},null)}function b0(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Mb(i){let n=M.useContext(Wo);return Nn(n,b0(i)),n}function kb(i){let n=M.useContext(Ku);return Nn(n,b0(i)),n}function Db(i){let n=M.useContext(Da);return Nn(n,b0(i)),n}function v0(i){let n=Db(i),a=n.matches[n.matches.length-1];return Nn(a.route.id,`${i} can only be used on routes that contain a unique "id"`),a.route.id}function Lb(){return v0("useRouteId")}function Bb(){let i=M.useContext(w0),n=kb("useRouteError"),a=v0("useRouteError");return i!==void 0?i:n.errors?.[a]}function Ub(){let{router:i}=Mb("useNavigate"),n=v0("useNavigate"),a=M.useRef(!1);return Yx(()=>{a.current=!0}),M.useCallback(async(d,f={})=>{la(a.current,Gx),a.current&&(typeof d=="number"?i.navigate(d):await i.navigate(d,{fromRouteId:n,...f}))},[i,n])}var sp={};function Wx(i,n,a){!n&&!sp[i]&&(sp[i]=!0,la(!1,a))}M.memo(Pb);function Pb({routes:i,future:n,state:a,unstable_onError:l}){return Xx(i,void 0,a,l,n)}function Qx({to:i,replace:n,state:a,relative:l}){Nn(Qo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:d}=M.useContext(ka);la(!d,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:f}=M.useContext(Da),{pathname:x}=Cr(),v=us(),C=y0(i,x0(f),x,l==="path"),w=JSON.stringify(C);return M.useEffect(()=>{v(JSON.parse(w),{replace:n,state:a,relative:l})},[v,w,l,n,a]),null}function Fn(i){Nn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function zb({basename:i="/",children:n=null,location:a,navigationType:l="POP",navigator:d,static:f=!1}){Nn(!Qo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let x=i.replace(/^\/*/,"/"),v=M.useMemo(()=>({basename:x,navigator:d,static:f,future:{}}),[x,d,f]);typeof a=="string"&&(a=Yi(a));let{pathname:C="/",search:w="",hash:A="",state:N=null,key:R="default"}=a,T=M.useMemo(()=>{let O=br(C,x);return O==null?null:{location:{pathname:O,search:w,hash:A,state:N,key:R},navigationType:l}},[x,C,w,A,N,R,l]);return la(T!=null,`<Router basename="${x}"> is not able to match the URL "${C}${w}${A}" because it does not start with the basename, so the <Router> won't render anything.`),T==null?null:M.createElement(ka.Provider,{value:v},M.createElement(sc.Provider,{children:n,value:T}))}function Fb({children:i,location:n}){return Nb(Qf(i),n)}function Qf(i,n=[]){let a=[];return M.Children.forEach(i,(l,d)=>{if(!M.isValidElement(l))return;let f=[...n,d];if(l.type===M.Fragment){a.push.apply(a,Qf(l.props.children,f));return}Nn(l.type===Fn,`[${typeof l.type=="string"?l.type:l.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Nn(!l.props.index||!l.props.children,"An index route cannot have child routes.");let x={id:l.props.id||f.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,middleware:l.props.middleware,loader:l.props.loader,action:l.props.action,hydrateFallbackElement:l.props.hydrateFallbackElement,HydrateFallback:l.props.HydrateFallback,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.hasErrorBoundary===!0||l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(x.children=Qf(l.props.children,f)),a.push(x)}),a}var Bu="get",Uu="application/x-www-form-urlencoded";function $u(i){return i!=null&&typeof i.tagName=="string"}function Hb(i){return $u(i)&&i.tagName.toLowerCase()==="button"}function qb(i){return $u(i)&&i.tagName.toLowerCase()==="form"}function Vb(i){return $u(i)&&i.tagName.toLowerCase()==="input"}function Gb(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}function Yb(i,n){return i.button===0&&(!n||n==="_self")&&!Gb(i)}var _u=null;function Xb(){if(_u===null)try{new FormData(document.createElement("form"),0),_u=!1}catch{_u=!0}return _u}var Wb=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function cf(i){return i!=null&&!Wb.has(i)?(la(!1,`"${i}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Uu}"`),null):i}function Qb(i,n){let a,l,d,f,x;if(qb(i)){let v=i.getAttribute("action");l=v?br(v,n):null,a=i.getAttribute("method")||Bu,d=cf(i.getAttribute("enctype"))||Uu,f=new FormData(i)}else if(Hb(i)||Vb(i)&&(i.type==="submit"||i.type==="image")){let v=i.form;if(v==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let C=i.getAttribute("formaction")||v.getAttribute("action");if(l=C?br(C,n):null,a=i.getAttribute("formmethod")||v.getAttribute("method")||Bu,d=cf(i.getAttribute("formenctype"))||cf(v.getAttribute("enctype"))||Uu,f=new FormData(v,i),!Xb()){let{name:w,type:A,value:N}=i;if(A==="image"){let R=w?`${w}.`:"";f.append(`${R}x`,"0"),f.append(`${R}y`,"0")}else w&&f.append(w,N)}}else{if($u(i))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=Bu,l=null,d=Uu,x=i}return f&&d==="text/plain"&&(x=f,f=void 0),{action:l,method:a.toLowerCase(),encType:d,formData:f,body:x}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function C0(i,n){if(i===!1||i===null||typeof i>"u")throw new Error(n)}function Kb(i,n,a){let l=typeof i=="string"?new URL(i,typeof window>"u"?"server://singlefetch/":window.location.origin):i;return l.pathname==="/"?l.pathname=`_root.${a}`:n&&br(l.pathname,n)==="/"?l.pathname=`${n.replace(/\/$/,"")}/_root.${a}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${a}`,l}async function Zb(i,n){if(i.id in n)return n[i.id];try{let a=await import(i.module);return n[i.id]=a,a}catch(a){return console.error(`Error loading route module \`${i.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function $b(i){return i==null?!1:i.href==null?i.rel==="preload"&&typeof i.imageSrcSet=="string"&&typeof i.imageSizes=="string":typeof i.rel=="string"&&typeof i.href=="string"}async function Jb(i,n,a){let l=await Promise.all(i.map(async d=>{let f=n.routes[d.route.id];if(f){let x=await Zb(f,a);return x.links?x.links():[]}return[]}));return sv(l.flat(1).filter($b).filter(d=>d.rel==="stylesheet"||d.rel==="preload").map(d=>d.rel==="stylesheet"?{...d,rel:"prefetch",as:"style"}:{...d,rel:"prefetch"}))}function ap(i,n,a,l,d,f){let x=(C,w)=>a[w]?C.route.id!==a[w].route.id:!0,v=(C,w)=>a[w].pathname!==C.pathname||a[w].route.path?.endsWith("*")&&a[w].params["*"]!==C.params["*"];return f==="assets"?n.filter((C,w)=>x(C,w)||v(C,w)):f==="data"?n.filter((C,w)=>{let A=l.routes[C.route.id];if(!A||!A.hasLoader)return!1;if(x(C,w)||v(C,w))return!0;if(C.route.shouldRevalidate){let N=C.route.shouldRevalidate({currentUrl:new URL(d.pathname+d.search+d.hash,window.origin),currentParams:a[0]?.params||{},nextUrl:new URL(i,window.origin),nextParams:C.params,defaultShouldRevalidate:!0});if(typeof N=="boolean")return N}return!0}):[]}function ev(i,n,{includeHydrateFallback:a}={}){return tv(i.map(l=>{let d=n.routes[l.route.id];if(!d)return[];let f=[d.module];return d.clientActionModule&&(f=f.concat(d.clientActionModule)),d.clientLoaderModule&&(f=f.concat(d.clientLoaderModule)),a&&d.hydrateFallbackModule&&(f=f.concat(d.hydrateFallbackModule)),d.imports&&(f=f.concat(d.imports)),f}).flat(1))}function tv(i){return[...new Set(i)]}function nv(i){let n={},a=Object.keys(i).sort();for(let l of a)n[l]=i[l];return n}function sv(i,n){let a=new Set;return new Set(n),i.reduce((l,d)=>{let f=JSON.stringify(nv(d));return a.has(f)||(a.add(f),l.push({key:f,link:d})),l},[])}function Kx(){let i=M.useContext(Wo);return C0(i,"You must render this element inside a <DataRouterContext.Provider> element"),i}function av(){let i=M.useContext(Ku);return C0(i,"You must render this element inside a <DataRouterStateContext.Provider> element"),i}var _0=M.createContext(void 0);_0.displayName="FrameworkContext";function Zx(){let i=M.useContext(_0);return C0(i,"You must render this element inside a <HydratedRouter> element"),i}function rv(i,n){let a=M.useContext(_0),[l,d]=M.useState(!1),[f,x]=M.useState(!1),{onFocus:v,onBlur:C,onMouseEnter:w,onMouseLeave:A,onTouchStart:N}=n,R=M.useRef(null);M.useEffect(()=>{if(i==="render"&&x(!0),i==="viewport"){let L=H=>{H.forEach(U=>{x(U.isIntersecting)})},B=new IntersectionObserver(L,{threshold:.5});return R.current&&B.observe(R.current),()=>{B.disconnect()}}},[i]),M.useEffect(()=>{if(l){let L=setTimeout(()=>{x(!0)},100);return()=>{clearTimeout(L)}}},[l]);let T=()=>{d(!0)},O=()=>{d(!1),x(!1)};return a?i!=="intent"?[f,R,{}]:[f,R,{onFocus:Vl(v,T),onBlur:Vl(C,O),onMouseEnter:Vl(w,T),onMouseLeave:Vl(A,O),onTouchStart:Vl(N,T)}]:[!1,R,{}]}function Vl(i,n){return a=>{i&&i(a),a.defaultPrevented||n(a)}}function iv({page:i,...n}){let{router:a}=Kx(),l=M.useMemo(()=>zx(a.routes,i,a.basename),[a.routes,i,a.basename]);return l?M.createElement(lv,{page:i,matches:l,...n}):null}function ov(i){let{manifest:n,routeModules:a}=Zx(),[l,d]=M.useState([]);return M.useEffect(()=>{let f=!1;return Jb(i,n,a).then(x=>{f||d(x)}),()=>{f=!0}},[i,n,a]),l}function lv({page:i,matches:n,...a}){let l=Cr(),{manifest:d,routeModules:f}=Zx(),{basename:x}=Kx(),{loaderData:v,matches:C}=av(),w=M.useMemo(()=>ap(i,n,C,d,l,"data"),[i,n,C,d,l]),A=M.useMemo(()=>ap(i,n,C,d,l,"assets"),[i,n,C,d,l]),N=M.useMemo(()=>{if(i===l.pathname+l.search+l.hash)return[];let O=new Set,L=!1;if(n.forEach(H=>{let U=d.routes[H.route.id];!U||!U.hasLoader||(!w.some(P=>P.route.id===H.route.id)&&H.route.id in v&&f[H.route.id]?.shouldRevalidate||U.hasClientLoader?L=!0:O.add(H.route.id))}),O.size===0)return[];let B=Kb(i,x,"data");return L&&O.size>0&&B.searchParams.set("_routes",n.filter(H=>O.has(H.route.id)).map(H=>H.route.id).join(",")),[B.pathname+B.search]},[x,v,l,d,w,n,i,f]),R=M.useMemo(()=>ev(A,d),[A,d]),T=ov(A);return M.createElement(M.Fragment,null,N.map(O=>M.createElement("link",{key:O,rel:"prefetch",as:"fetch",href:O,...a})),R.map(O=>M.createElement("link",{key:O,rel:"modulepreload",href:O,...a})),T.map(({key:O,link:L})=>M.createElement("link",{key:O,nonce:a.nonce,...L})))}function cv(...i){return n=>{i.forEach(a=>{typeof a=="function"?a(n):a!=null&&(a.current=n)})}}var $x=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{$x&&(window.__reactRouterVersion="7.9.6")}catch{}function uv({basename:i,children:n,window:a}){let l=M.useRef();l.current==null&&(l.current=Zw({window:a,v5Compat:!0}));let d=l.current,[f,x]=M.useState({action:d.action,location:d.location}),v=M.useCallback(C=>{M.startTransition(()=>x(C))},[x]);return M.useLayoutEffect(()=>d.listen(v),[d,v]),M.createElement(zb,{basename:i,children:n,location:f.location,navigationType:f.action,navigator:d})}var Jx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rc=M.forwardRef(function({onClick:n,discover:a="render",prefetch:l="none",relative:d,reloadDocument:f,replace:x,state:v,target:C,to:w,preventScrollReset:A,viewTransition:N,...R},T){let{basename:O}=M.useContext(ka),L=typeof w=="string"&&Jx.test(w),B,H=!1;if(typeof w=="string"&&L&&(B=w,$x))try{let q=new URL(window.location.href),he=w.startsWith("//")?new URL(q.protocol+w):new URL(w),ge=br(he.pathname,O);he.origin===q.origin&&ge!=null?w=ge+he.search+he.hash:H=!0}catch{la(!1,`<Link to="${w}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let U=Eb(w,{relative:d}),[P,K,Z]=rv(l,R),W=gv(w,{replace:x,state:v,target:C,preventScrollReset:A,relative:d,viewTransition:N});function X(q){n&&n(q),q.defaultPrevented||W(q)}let J=M.createElement("a",{...R,...Z,href:B||U,onClick:H||f?n:X,ref:cv(T,K),target:C,"data-discover":!L&&a==="render"?"true":void 0});return P&&!L?M.createElement(M.Fragment,null,J,M.createElement(iv,{page:U})):J});rc.displayName="Link";var dv=M.forwardRef(function({"aria-current":n="page",caseSensitive:a=!1,className:l="",end:d=!1,style:f,to:x,viewTransition:v,children:C,...w},A){let N=ac(x,{relative:w.relative}),R=Cr(),T=M.useContext(Ku),{navigator:O,basename:L}=M.useContext(ka),B=T!=null&&wv(N)&&v===!0,H=O.encodeLocation?O.encodeLocation(N).pathname:N.pathname,U=R.pathname,P=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;a||(U=U.toLowerCase(),P=P?P.toLowerCase():null,H=H.toLowerCase()),P&&L&&(P=br(P,L)||P);const K=H!=="/"&&H.endsWith("/")?H.length-1:H.length;let Z=U===H||!d&&U.startsWith(H)&&U.charAt(K)==="/",W=P!=null&&(P===H||!d&&P.startsWith(H)&&P.charAt(H.length)==="/"),X={isActive:Z,isPending:W,isTransitioning:B},J=Z?n:void 0,q;typeof l=="function"?q=l(X):q=[l,Z?"active":null,W?"pending":null,B?"transitioning":null].filter(Boolean).join(" ");let he=typeof f=="function"?f(X):f;return M.createElement(rc,{...w,"aria-current":J,className:q,ref:A,style:he,to:x,viewTransition:v},typeof C=="function"?C(X):C)});dv.displayName="NavLink";var hv=M.forwardRef(({discover:i="render",fetcherKey:n,navigate:a,reloadDocument:l,replace:d,state:f,method:x=Bu,action:v,onSubmit:C,relative:w,preventScrollReset:A,viewTransition:N,...R},T)=>{let O=xv(),L=yv(v,{relative:w}),B=x.toLowerCase()==="get"?"get":"post",H=typeof v=="string"&&Jx.test(v),U=P=>{if(C&&C(P),P.defaultPrevented)return;P.preventDefault();let K=P.nativeEvent.submitter,Z=K?.getAttribute("formmethod")||x;O(K||P.currentTarget,{fetcherKey:n,method:Z,navigate:a,replace:d,state:f,relative:w,preventScrollReset:A,viewTransition:N})};return M.createElement("form",{ref:T,method:B,action:L,onSubmit:l?C:U,...R,"data-discover":!H&&i==="render"?"true":void 0})});hv.displayName="Form";function fv(i){return`${i} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function e2(i){let n=M.useContext(Wo);return Nn(n,fv(i)),n}function gv(i,{target:n,replace:a,state:l,preventScrollReset:d,relative:f,viewTransition:x}={}){let v=us(),C=Cr(),w=ac(i,{relative:f});return M.useCallback(A=>{if(Yb(A,n)){A.preventDefault();let N=a!==void 0?a:$l(C)===$l(w);v(i,{replace:N,state:l,preventScrollReset:d,relative:f,viewTransition:x})}},[C,v,w,a,l,n,i,d,f,x])}var mv=0,pv=()=>`__${String(++mv)}__`;function xv(){let{router:i}=e2("useSubmit"),{basename:n}=M.useContext(ka),a=Lb();return M.useCallback(async(l,d={})=>{let{action:f,method:x,encType:v,formData:C,body:w}=Qb(l,n);if(d.navigate===!1){let A=d.fetcherKey||pv();await i.fetch(A,a,d.action||f,{preventScrollReset:d.preventScrollReset,formData:C,body:w,formMethod:d.method||x,formEncType:d.encType||v,flushSync:d.flushSync})}else await i.navigate(d.action||f,{preventScrollReset:d.preventScrollReset,formData:C,body:w,formMethod:d.method||x,formEncType:d.encType||v,replace:d.replace,state:d.state,fromRouteId:a,flushSync:d.flushSync,viewTransition:d.viewTransition})},[i,n,a])}function yv(i,{relative:n}={}){let{basename:a}=M.useContext(ka),l=M.useContext(Da);Nn(l,"useFormAction must be used inside a RouteContext");let[d]=l.matches.slice(-1),f={...ac(i||".",{relative:n})},x=Cr();if(i==null){f.search=x.search;let v=new URLSearchParams(f.search),C=v.getAll("index");if(C.some(A=>A==="")){v.delete("index"),C.filter(N=>N).forEach(N=>v.append("index",N));let A=v.toString();f.search=A?`?${A}`:""}}return(!i||i===".")&&d.route.index&&(f.search=f.search?f.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(f.pathname=f.pathname==="/"?a:yr([a,f.pathname])),$l(f)}function wv(i,{relative:n}={}){let a=M.useContext(Vx);Nn(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:l}=e2("useViewTransitionState"),d=ac(i,{relative:n});if(!a.isTransitioning)return!1;let f=br(a.currentLocation.pathname,l)||a.currentLocation.pathname,x=br(a.nextLocation.pathname,l)||a.nextLocation.pathname;return Pu(d.pathname,x)!=null||Pu(d.pathname,f)!=null}var Kf=function(i,n){return Kf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,l){a.__proto__=l}||function(a,l){for(var d in l)Object.prototype.hasOwnProperty.call(l,d)&&(a[d]=l[d])},Kf(i,n)};function t2(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");Kf(i,n);function a(){this.constructor=i}i.prototype=n===null?Object.create(n):(a.prototype=n.prototype,new a)}var zu=function(){return zu=Object.assign||function(n){for(var a,l=1,d=arguments.length;l<d;l++){a=arguments[l];for(var f in a)Object.prototype.hasOwnProperty.call(a,f)&&(n[f]=a[f])}return n},zu.apply(this,arguments)};function Ko(i,n){var a={};for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&n.indexOf(l)<0&&(a[l]=i[l]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,l=Object.getOwnPropertySymbols(i);d<l.length;d++)n.indexOf(l[d])<0&&Object.prototype.propertyIsEnumerable.call(i,l[d])&&(a[l[d]]=i[l[d]]);return a}function n2(i,n,a,l){var d=arguments.length,f=d<3?n:l===null?l=Object.getOwnPropertyDescriptor(n,a):l,x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(i,n,a,l);else for(var v=i.length-1;v>=0;v--)(x=i[v])&&(f=(d<3?x(f):d>3?x(n,a,f):x(n,a))||f);return d>3&&f&&Object.defineProperty(n,a,f),f}function s2(i,n){return function(a,l){n(a,l,i)}}function a2(i,n,a,l,d,f){function x(H){if(H!==void 0&&typeof H!="function")throw new TypeError("Function expected");return H}for(var v=l.kind,C=v==="getter"?"get":v==="setter"?"set":"value",w=!n&&i?l.static?i:i.prototype:null,A=n||(w?Object.getOwnPropertyDescriptor(w,l.name):{}),N,R=!1,T=a.length-1;T>=0;T--){var O={};for(var L in l)O[L]=L==="access"?{}:l[L];for(var L in l.access)O.access[L]=l.access[L];O.addInitializer=function(H){if(R)throw new TypeError("Cannot add initializers after decoration has completed");f.push(x(H||null))};var B=(0,a[T])(v==="accessor"?{get:A.get,set:A.set}:A[C],O);if(v==="accessor"){if(B===void 0)continue;if(B===null||typeof B!="object")throw new TypeError("Object expected");(N=x(B.get))&&(A.get=N),(N=x(B.set))&&(A.set=N),(N=x(B.init))&&d.unshift(N)}else(N=x(B))&&(v==="field"?d.unshift(N):A[C]=N)}w&&Object.defineProperty(w,l.name,A),R=!0}function r2(i,n,a){for(var l=arguments.length>2,d=0;d<n.length;d++)a=l?n[d].call(i,a):n[d].call(i);return l?a:void 0}function i2(i){return typeof i=="symbol"?i:"".concat(i)}function o2(i,n,a){return typeof n=="symbol"&&(n=n.description?"[".concat(n.description,"]"):""),Object.defineProperty(i,"name",{configurable:!0,value:a?"".concat(a," ",n):n})}function l2(i,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,n)}function tt(i,n,a,l){function d(f){return f instanceof a?f:new a(function(x){x(f)})}return new(a||(a=Promise))(function(f,x){function v(A){try{w(l.next(A))}catch(N){x(N)}}function C(A){try{w(l.throw(A))}catch(N){x(N)}}function w(A){A.done?f(A.value):d(A.value).then(v,C)}w((l=l.apply(i,n||[])).next())})}function c2(i,n){var a={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},l,d,f,x=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return x.next=v(0),x.throw=v(1),x.return=v(2),typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function v(w){return function(A){return C([w,A])}}function C(w){if(l)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(a=0)),a;)try{if(l=1,d&&(f=w[0]&2?d.return:w[0]?d.throw||((f=d.return)&&f.call(d),0):d.next)&&!(f=f.call(d,w[1])).done)return f;switch(d=0,f&&(w=[w[0]&2,f.value]),w[0]){case 0:case 1:f=w;break;case 4:return a.label++,{value:w[1],done:!1};case 5:a.label++,d=w[1],w=[0];continue;case 7:w=a.ops.pop(),a.trys.pop();continue;default:if(f=a.trys,!(f=f.length>0&&f[f.length-1])&&(w[0]===6||w[0]===2)){a=0;continue}if(w[0]===3&&(!f||w[1]>f[0]&&w[1]<f[3])){a.label=w[1];break}if(w[0]===6&&a.label<f[1]){a.label=f[1],f=w;break}if(f&&a.label<f[2]){a.label=f[2],a.ops.push(w);break}f[2]&&a.ops.pop(),a.trys.pop();continue}w=n.call(i,a)}catch(A){w=[6,A],d=0}finally{l=f=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}}var Ju=Object.create?(function(i,n,a,l){l===void 0&&(l=a);var d=Object.getOwnPropertyDescriptor(n,a);(!d||("get"in d?!n.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return n[a]}}),Object.defineProperty(i,l,d)}):(function(i,n,a,l){l===void 0&&(l=a),i[l]=n[a]});function u2(i,n){for(var a in i)a!=="default"&&!Object.prototype.hasOwnProperty.call(n,a)&&Ju(n,i,a)}function Fu(i){var n=typeof Symbol=="function"&&Symbol.iterator,a=n&&i[n],l=0;if(a)return a.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&l>=i.length&&(i=void 0),{value:i&&i[l++],done:!i}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function S0(i,n){var a=typeof Symbol=="function"&&i[Symbol.iterator];if(!a)return i;var l=a.call(i),d,f=[],x;try{for(;(n===void 0||n-- >0)&&!(d=l.next()).done;)f.push(d.value)}catch(v){x={error:v}}finally{try{d&&!d.done&&(a=l.return)&&a.call(l)}finally{if(x)throw x.error}}return f}function d2(){for(var i=[],n=0;n<arguments.length;n++)i=i.concat(S0(arguments[n]));return i}function h2(){for(var i=0,n=0,a=arguments.length;n<a;n++)i+=arguments[n].length;for(var l=Array(i),d=0,n=0;n<a;n++)for(var f=arguments[n],x=0,v=f.length;x<v;x++,d++)l[d]=f[x];return l}function f2(i,n,a){if(a||arguments.length===2)for(var l=0,d=n.length,f;l<d;l++)(f||!(l in n))&&(f||(f=Array.prototype.slice.call(n,0,l)),f[l]=n[l]);return i.concat(f||Array.prototype.slice.call(n))}function Yo(i){return this instanceof Yo?(this.v=i,this):new Yo(i)}function g2(i,n,a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=a.apply(i,n||[]),d,f=[];return d=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),v("next"),v("throw"),v("return",x),d[Symbol.asyncIterator]=function(){return this},d;function x(T){return function(O){return Promise.resolve(O).then(T,N)}}function v(T,O){l[T]&&(d[T]=function(L){return new Promise(function(B,H){f.push([T,L,B,H])>1||C(T,L)})},O&&(d[T]=O(d[T])))}function C(T,O){try{w(l[T](O))}catch(L){R(f[0][3],L)}}function w(T){T.value instanceof Yo?Promise.resolve(T.value.v).then(A,N):R(f[0][2],T)}function A(T){C("next",T)}function N(T){C("throw",T)}function R(T,O){T(O),f.shift(),f.length&&C(f[0][0],f[0][1])}}function m2(i){var n,a;return n={},l("next"),l("throw",function(d){throw d}),l("return"),n[Symbol.iterator]=function(){return this},n;function l(d,f){n[d]=i[d]?function(x){return(a=!a)?{value:Yo(i[d](x)),done:!1}:f?f(x):x}:f}}function p2(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=i[Symbol.asyncIterator],a;return n?n.call(i):(i=typeof Fu=="function"?Fu(i):i[Symbol.iterator](),a={},l("next"),l("throw"),l("return"),a[Symbol.asyncIterator]=function(){return this},a);function l(f){a[f]=i[f]&&function(x){return new Promise(function(v,C){x=i[f](x),d(v,C,x.done,x.value)})}}function d(f,x,v,C){Promise.resolve(C).then(function(w){f({value:w,done:v})},x)}}function x2(i,n){return Object.defineProperty?Object.defineProperty(i,"raw",{value:n}):i.raw=n,i}var bv=Object.create?(function(i,n){Object.defineProperty(i,"default",{enumerable:!0,value:n})}):function(i,n){i.default=n},Zf=function(i){return Zf=Object.getOwnPropertyNames||function(n){var a=[];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[a.length]=l);return a},Zf(i)};function y2(i){if(i&&i.__esModule)return i;var n={};if(i!=null)for(var a=Zf(i),l=0;l<a.length;l++)a[l]!=="default"&&Ju(n,i,a[l]);return bv(n,i),n}function w2(i){return i&&i.__esModule?i:{default:i}}function b2(i,n,a,l){if(a==="a"&&!l)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?i!==n||!l:!n.has(i))throw new TypeError("Cannot read private member from an object whose class did not declare it");return a==="m"?l:a==="a"?l.call(i):l?l.value:n.get(i)}function v2(i,n,a,l,d){if(l==="m")throw new TypeError("Private method is not writable");if(l==="a"&&!d)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?i!==n||!d:!n.has(i))throw new TypeError("Cannot write private member to an object whose class did not declare it");return l==="a"?d.call(i,a):d?d.value=a:n.set(i,a),a}function C2(i,n){if(n===null||typeof n!="object"&&typeof n!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof i=="function"?n===i:i.has(n)}function _2(i,n,a){if(n!=null){if(typeof n!="object"&&typeof n!="function")throw new TypeError("Object expected.");var l,d;if(a){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");l=n[Symbol.asyncDispose]}if(l===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");l=n[Symbol.dispose],a&&(d=l)}if(typeof l!="function")throw new TypeError("Object not disposable.");d&&(l=function(){try{d.call(this)}catch(f){return Promise.reject(f)}}),i.stack.push({value:n,dispose:l,async:a})}else a&&i.stack.push({async:!0});return n}var vv=typeof SuppressedError=="function"?SuppressedError:function(i,n,a){var l=new Error(a);return l.name="SuppressedError",l.error=i,l.suppressed=n,l};function S2(i){function n(f){i.error=i.hasError?new vv(f,i.error,"An error was suppressed during disposal."):f,i.hasError=!0}var a,l=0;function d(){for(;a=i.stack.pop();)try{if(!a.async&&l===1)return l=0,i.stack.push(a),Promise.resolve().then(d);if(a.dispose){var f=a.dispose.call(a.value);if(a.async)return l|=2,Promise.resolve(f).then(d,function(x){return n(x),d()})}else l|=1}catch(x){n(x)}if(l===1)return i.hasError?Promise.reject(i.error):Promise.resolve();if(i.hasError)throw i.error}return d()}function E2(i,n){return typeof i=="string"&&/^\.\.?\//.test(i)?i.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(a,l,d,f,x){return l?n?".jsx":".js":d&&(!f||!x)?a:d+f+"."+x.toLowerCase()+"js"}):i}const Cv={__extends:t2,__assign:zu,__rest:Ko,__decorate:n2,__param:s2,__esDecorate:a2,__runInitializers:r2,__propKey:i2,__setFunctionName:o2,__metadata:l2,__awaiter:tt,__generator:c2,__createBinding:Ju,__exportStar:u2,__values:Fu,__read:S0,__spread:d2,__spreadArrays:h2,__spreadArray:f2,__await:Yo,__asyncGenerator:g2,__asyncDelegator:m2,__asyncValues:p2,__makeTemplateObject:x2,__importStar:y2,__importDefault:w2,__classPrivateFieldGet:b2,__classPrivateFieldSet:v2,__classPrivateFieldIn:C2,__addDisposableResource:_2,__disposeResources:S2,__rewriteRelativeImportExtension:E2},_v=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:_2,get __assign(){return zu},__asyncDelegator:m2,__asyncGenerator:g2,__asyncValues:p2,__await:Yo,__awaiter:tt,__classPrivateFieldGet:b2,__classPrivateFieldIn:C2,__classPrivateFieldSet:v2,__createBinding:Ju,__decorate:n2,__disposeResources:S2,__esDecorate:a2,__exportStar:u2,__extends:t2,__generator:c2,__importDefault:w2,__importStar:y2,__makeTemplateObject:x2,__metadata:l2,__param:s2,__propKey:i2,__read:S0,__rest:Ko,__rewriteRelativeImportExtension:E2,__runInitializers:r2,__setFunctionName:o2,__spread:d2,__spreadArray:f2,__spreadArrays:h2,__values:Fu,default:Cv},Symbol.toStringTag,{value:"Module"})),Sv=i=>i?(...n)=>i(...n):(...n)=>fetch(...n);class E0 extends Error{constructor(n,a="FunctionsError",l){super(n),this.name=a,this.context=l}}class Ev extends E0{constructor(n){super("Failed to send a request to the Edge Function","FunctionsFetchError",n)}}class rp extends E0{constructor(n){super("Relay Error invoking the Edge Function","FunctionsRelayError",n)}}class ip extends E0{constructor(n){super("Edge Function returned a non-2xx status code","FunctionsHttpError",n)}}var $f;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})($f||($f={}));class Av{constructor(n,{headers:a={},customFetch:l,region:d=$f.Any}={}){this.url=n,this.headers=a,this.region=d,this.fetch=Sv(l)}setAuth(n){this.headers.Authorization=`Bearer ${n}`}invoke(n){return tt(this,arguments,void 0,function*(a,l={}){var d;let f,x;try{const{headers:v,method:C,body:w,signal:A,timeout:N}=l;let R={},{region:T}=l;T||(T=this.region);const O=new URL(`${this.url}/${a}`);T&&T!=="any"&&(R["x-region"]=T,O.searchParams.set("forceFunctionRegion",T));let L;w&&(v&&!Object.prototype.hasOwnProperty.call(v,"Content-Type")||!v)?typeof Blob<"u"&&w instanceof Blob||w instanceof ArrayBuffer?(R["Content-Type"]="application/octet-stream",L=w):typeof w=="string"?(R["Content-Type"]="text/plain",L=w):typeof FormData<"u"&&w instanceof FormData?L=w:(R["Content-Type"]="application/json",L=JSON.stringify(w)):L=w;let B=A;N&&(x=new AbortController,f=setTimeout(()=>x.abort(),N),A?(B=x.signal,A.addEventListener("abort",()=>x.abort())):B=x.signal);const H=yield this.fetch(O.toString(),{method:C||"POST",headers:Object.assign(Object.assign(Object.assign({},R),this.headers),v),body:L,signal:B}).catch(Z=>{throw new Ev(Z)}),U=H.headers.get("x-relay-error");if(U&&U==="true")throw new rp(H);if(!H.ok)throw new ip(H);let P=((d=H.headers.get("Content-Type"))!==null&&d!==void 0?d:"text/plain").split(";")[0].trim(),K;return P==="application/json"?K=yield H.json():P==="application/octet-stream"||P==="application/pdf"?K=yield H.blob():P==="text/event-stream"?K=H:P==="multipart/form-data"?K=yield H.formData():K=yield H.text(),{data:K,error:null,response:H}}catch(v){return{data:null,error:v,response:v instanceof ip||v instanceof rp?v.context:void 0}}finally{f&&clearTimeout(f)}})}}var _s={};const Zo=zw(_v);var Su={},Eu={},Au={},Nu={},Tu={},ju={},op;function A2(){if(op)return ju;op=1,Object.defineProperty(ju,"__esModule",{value:!0});class i extends Error{constructor(a){super(a.message),this.name="PostgrestError",this.details=a.details,this.hint=a.hint,this.code=a.code}}return ju.default=i,ju}var lp;function N2(){if(lp)return Tu;lp=1,Object.defineProperty(Tu,"__esModule",{value:!0});const n=Zo.__importDefault(A2());class a{constructor(d){var f,x;this.shouldThrowOnError=!1,this.method=d.method,this.url=d.url,this.headers=new Headers(d.headers),this.schema=d.schema,this.body=d.body,this.shouldThrowOnError=(f=d.shouldThrowOnError)!==null&&f!==void 0?f:!1,this.signal=d.signal,this.isMaybeSingle=(x=d.isMaybeSingle)!==null&&x!==void 0?x:!1,d.fetch?this.fetch=d.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(d,f){return this.headers=new Headers(this.headers),this.headers.set(d,f),this}then(d,f){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const x=this.fetch;let v=x(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async C=>{var w,A,N,R;let T=null,O=null,L=null,B=C.status,H=C.statusText;if(C.ok){if(this.method!=="HEAD"){const Z=await C.text();Z===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((w=this.headers.get("Accept"))===null||w===void 0)&&w.includes("application/vnd.pgrst.plan+text"))?O=Z:O=JSON.parse(Z))}const P=(A=this.headers.get("Prefer"))===null||A===void 0?void 0:A.match(/count=(exact|planned|estimated)/),K=(N=C.headers.get("content-range"))===null||N===void 0?void 0:N.split("/");P&&K&&K.length>1&&(L=parseInt(K[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(O)&&(O.length>1?(T={code:"PGRST116",details:`Results contain ${O.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},O=null,L=null,B=406,H="Not Acceptable"):O.length===1?O=O[0]:O=null)}else{const P=await C.text();try{T=JSON.parse(P),Array.isArray(T)&&C.status===404&&(O=[],T=null,B=200,H="OK")}catch{C.status===404&&P===""?(B=204,H="No Content"):T={message:P}}if(T&&this.isMaybeSingle&&(!((R=T?.details)===null||R===void 0)&&R.includes("0 rows"))&&(T=null,B=200,H="OK"),T&&this.shouldThrowOnError)throw new n.default(T)}return{error:T,data:O,count:L,status:B,statusText:H}});return this.shouldThrowOnError||(v=v.catch(C=>{var w,A,N,R,T,O;let L="";const B=C?.cause;if(B){const H=(w=B?.message)!==null&&w!==void 0?w:"",U=(A=B?.code)!==null&&A!==void 0?A:"";L=`${(N=C?.name)!==null&&N!==void 0?N:"FetchError"}: ${C?.message}`,L+=`

Caused by: ${(R=B?.name)!==null&&R!==void 0?R:"Error"}: ${H}`,U&&(L+=` (${U})`),B?.stack&&(L+=`
${B.stack}`)}else L=(T=C?.stack)!==null&&T!==void 0?T:"";return{error:{message:`${(O=C?.name)!==null&&O!==void 0?O:"FetchError"}: ${C?.message}`,details:L,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),v.then(d,f)}returns(){return this}overrideTypes(){return this}}return Tu.default=a,Tu}var cp;function T2(){if(cp)return Nu;cp=1,Object.defineProperty(Nu,"__esModule",{value:!0});const n=Zo.__importDefault(N2());class a extends n.default{select(d){let f=!1;const x=(d??"*").split("").map(v=>/\s/.test(v)&&!f?"":(v==='"'&&(f=!f),v)).join("");return this.url.searchParams.set("select",x),this.headers.append("Prefer","return=representation"),this}order(d,{ascending:f=!0,nullsFirst:x,foreignTable:v,referencedTable:C=v}={}){const w=C?`${C}.order`:"order",A=this.url.searchParams.get(w);return this.url.searchParams.set(w,`${A?`${A},`:""}${d}.${f?"asc":"desc"}${x===void 0?"":x?".nullsfirst":".nullslast"}`),this}limit(d,{foreignTable:f,referencedTable:x=f}={}){const v=typeof x>"u"?"limit":`${x}.limit`;return this.url.searchParams.set(v,`${d}`),this}range(d,f,{foreignTable:x,referencedTable:v=x}={}){const C=typeof v>"u"?"offset":`${v}.offset`,w=typeof v>"u"?"limit":`${v}.limit`;return this.url.searchParams.set(C,`${d}`),this.url.searchParams.set(w,`${f-d+1}`),this}abortSignal(d){return this.signal=d,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:d=!1,verbose:f=!1,settings:x=!1,buffers:v=!1,wal:C=!1,format:w="text"}={}){var A;const N=[d?"analyze":null,f?"verbose":null,x?"settings":null,v?"buffers":null,C?"wal":null].filter(Boolean).join("|"),R=(A=this.headers.get("Accept"))!==null&&A!==void 0?A:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${w}; for="${R}"; options=${N};`),w==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(d){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${d}`),this}}return Nu.default=a,Nu}var up;function A0(){if(up)return Au;up=1,Object.defineProperty(Au,"__esModule",{value:!0});const n=Zo.__importDefault(T2()),a=new RegExp("[,()]");class l extends n.default{eq(f,x){return this.url.searchParams.append(f,`eq.${x}`),this}neq(f,x){return this.url.searchParams.append(f,`neq.${x}`),this}gt(f,x){return this.url.searchParams.append(f,`gt.${x}`),this}gte(f,x){return this.url.searchParams.append(f,`gte.${x}`),this}lt(f,x){return this.url.searchParams.append(f,`lt.${x}`),this}lte(f,x){return this.url.searchParams.append(f,`lte.${x}`),this}like(f,x){return this.url.searchParams.append(f,`like.${x}`),this}likeAllOf(f,x){return this.url.searchParams.append(f,`like(all).{${x.join(",")}}`),this}likeAnyOf(f,x){return this.url.searchParams.append(f,`like(any).{${x.join(",")}}`),this}ilike(f,x){return this.url.searchParams.append(f,`ilike.${x}`),this}ilikeAllOf(f,x){return this.url.searchParams.append(f,`ilike(all).{${x.join(",")}}`),this}ilikeAnyOf(f,x){return this.url.searchParams.append(f,`ilike(any).{${x.join(",")}}`),this}is(f,x){return this.url.searchParams.append(f,`is.${x}`),this}in(f,x){const v=Array.from(new Set(x)).map(C=>typeof C=="string"&&a.test(C)?`"${C}"`:`${C}`).join(",");return this.url.searchParams.append(f,`in.(${v})`),this}contains(f,x){return typeof x=="string"?this.url.searchParams.append(f,`cs.${x}`):Array.isArray(x)?this.url.searchParams.append(f,`cs.{${x.join(",")}}`):this.url.searchParams.append(f,`cs.${JSON.stringify(x)}`),this}containedBy(f,x){return typeof x=="string"?this.url.searchParams.append(f,`cd.${x}`):Array.isArray(x)?this.url.searchParams.append(f,`cd.{${x.join(",")}}`):this.url.searchParams.append(f,`cd.${JSON.stringify(x)}`),this}rangeGt(f,x){return this.url.searchParams.append(f,`sr.${x}`),this}rangeGte(f,x){return this.url.searchParams.append(f,`nxl.${x}`),this}rangeLt(f,x){return this.url.searchParams.append(f,`sl.${x}`),this}rangeLte(f,x){return this.url.searchParams.append(f,`nxr.${x}`),this}rangeAdjacent(f,x){return this.url.searchParams.append(f,`adj.${x}`),this}overlaps(f,x){return typeof x=="string"?this.url.searchParams.append(f,`ov.${x}`):this.url.searchParams.append(f,`ov.{${x.join(",")}}`),this}textSearch(f,x,{config:v,type:C}={}){let w="";C==="plain"?w="pl":C==="phrase"?w="ph":C==="websearch"&&(w="w");const A=v===void 0?"":`(${v})`;return this.url.searchParams.append(f,`${w}fts${A}.${x}`),this}match(f){return Object.entries(f).forEach(([x,v])=>{this.url.searchParams.append(x,`eq.${v}`)}),this}not(f,x,v){return this.url.searchParams.append(f,`not.${x}.${v}`),this}or(f,{foreignTable:x,referencedTable:v=x}={}){const C=v?`${v}.or`:"or";return this.url.searchParams.append(C,`(${f})`),this}filter(f,x,v){return this.url.searchParams.append(f,`${x}.${v}`),this}}return Au.default=l,Au}var dp;function j2(){if(dp)return Eu;dp=1,Object.defineProperty(Eu,"__esModule",{value:!0});const n=Zo.__importDefault(A0());class a{constructor(d,{headers:f={},schema:x,fetch:v}){this.url=d,this.headers=new Headers(f),this.schema=x,this.fetch=v}select(d,f){const{head:x=!1,count:v}=f??{},C=x?"HEAD":"GET";let w=!1;const A=(d??"*").split("").map(N=>/\s/.test(N)&&!w?"":(N==='"'&&(w=!w),N)).join("");return this.url.searchParams.set("select",A),v&&this.headers.append("Prefer",`count=${v}`),new n.default({method:C,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(d,{count:f,defaultToNull:x=!0}={}){var v;const C="POST";if(f&&this.headers.append("Prefer",`count=${f}`),x||this.headers.append("Prefer","missing=default"),Array.isArray(d)){const w=d.reduce((A,N)=>A.concat(Object.keys(N)),[]);if(w.length>0){const A=[...new Set(w)].map(N=>`"${N}"`);this.url.searchParams.set("columns",A.join(","))}}return new n.default({method:C,url:this.url,headers:this.headers,schema:this.schema,body:d,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}upsert(d,{onConflict:f,ignoreDuplicates:x=!1,count:v,defaultToNull:C=!0}={}){var w;const A="POST";if(this.headers.append("Prefer",`resolution=${x?"ignore":"merge"}-duplicates`),f!==void 0&&this.url.searchParams.set("on_conflict",f),v&&this.headers.append("Prefer",`count=${v}`),C||this.headers.append("Prefer","missing=default"),Array.isArray(d)){const N=d.reduce((R,T)=>R.concat(Object.keys(T)),[]);if(N.length>0){const R=[...new Set(N)].map(T=>`"${T}"`);this.url.searchParams.set("columns",R.join(","))}}return new n.default({method:A,url:this.url,headers:this.headers,schema:this.schema,body:d,fetch:(w=this.fetch)!==null&&w!==void 0?w:fetch})}update(d,{count:f}={}){var x;const v="PATCH";return f&&this.headers.append("Prefer",`count=${f}`),new n.default({method:v,url:this.url,headers:this.headers,schema:this.schema,body:d,fetch:(x=this.fetch)!==null&&x!==void 0?x:fetch})}delete({count:d}={}){var f;const x="DELETE";return d&&this.headers.append("Prefer",`count=${d}`),new n.default({method:x,url:this.url,headers:this.headers,schema:this.schema,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}}return Eu.default=a,Eu}var hp;function Nv(){if(hp)return Su;hp=1,Object.defineProperty(Su,"__esModule",{value:!0});const i=Zo,n=i.__importDefault(j2()),a=i.__importDefault(A0());class l{constructor(f,{headers:x={},schema:v,fetch:C}={}){this.url=f,this.headers=new Headers(x),this.schemaName=v,this.fetch=C}from(f){const x=new URL(`${this.url}/${f}`);return new n.default(x,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(f){return new l(this.url,{headers:this.headers,schema:f,fetch:this.fetch})}rpc(f,x={},{head:v=!1,get:C=!1,count:w}={}){var A;let N;const R=new URL(`${this.url}/rpc/${f}`);let T;v||C?(N=v?"HEAD":"GET",Object.entries(x).filter(([L,B])=>B!==void 0).map(([L,B])=>[L,Array.isArray(B)?`{${B.join(",")}}`:`${B}`]).forEach(([L,B])=>{R.searchParams.append(L,B)})):(N="POST",T=x);const O=new Headers(this.headers);return w&&O.set("Prefer",`count=${w}`),new a.default({method:N,url:R,headers:O,schema:this.schemaName,body:T,fetch:(A=this.fetch)!==null&&A!==void 0?A:fetch})}}return Su.default=l,Su}var fp;function Tv(){if(fp)return _s;fp=1,Object.defineProperty(_s,"__esModule",{value:!0}),_s.PostgrestError=_s.PostgrestBuilder=_s.PostgrestTransformBuilder=_s.PostgrestFilterBuilder=_s.PostgrestQueryBuilder=_s.PostgrestClient=void 0;const i=Zo,n=i.__importDefault(Nv());_s.PostgrestClient=n.default;const a=i.__importDefault(j2());_s.PostgrestQueryBuilder=a.default;const l=i.__importDefault(A0());_s.PostgrestFilterBuilder=l.default;const d=i.__importDefault(T2());_s.PostgrestTransformBuilder=d.default;const f=i.__importDefault(N2());_s.PostgrestBuilder=f.default;const x=i.__importDefault(A2());return _s.PostgrestError=x.default,_s.default={PostgrestClient:n.default,PostgrestQueryBuilder:a.default,PostgrestFilterBuilder:l.default,PostgrestTransformBuilder:d.default,PostgrestBuilder:f.default,PostgrestError:x.default},_s}var R2=Tv();const I2=Qu(R2),jv=Ux({__proto__:null,default:I2},[R2]),{PostgrestClient:Rv,PostgrestQueryBuilder:nN,PostgrestFilterBuilder:sN,PostgrestTransformBuilder:aN,PostgrestBuilder:rN,PostgrestError:iN}=I2||jv;class Iv{constructor(){}static detectEnvironment(){var n;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((n=navigator.userAgent)===null||n===void 0)&&n.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const a=process.versions;if(a&&a.node){const l=a.node,d=parseInt(l.replace(/^v/,"").split(".")[0]);return d>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${d} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${d} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const n=this.detectEnvironment();if(n.constructor)return n.constructor;let a=n.error||"WebSocket not supported in this environment.";throw n.workaround&&(a+=`

Suggested solution: ${n.workaround}`),new Error(a)}static createWebSocket(n,a){const l=this.getWebSocketConstructor();return new l(n,a)}static isWebSocketSupported(){try{const n=this.detectEnvironment();return n.type==="native"||n.type==="ws"}catch{return!1}}}const Ov="2.83.0",Mv=`realtime-js/${Ov}`,O2="1.0.0",kv="2.0.0",gp=O2,Jf=1e4,Dv=1e3,Lv=100;var zi;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(zi||(zi={}));var os;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(os||(os={}));var ba;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(ba||(ba={}));var e0;(function(i){i.websocket="websocket"})(e0||(e0={}));var Fi;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(Fi||(Fi={}));class Bv{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(n,a){if(this._isArrayBuffer(n.payload))return a(this._binaryEncodePush(n));if(n.event===this.BROADCAST&&!(n.payload instanceof ArrayBuffer)&&typeof n.payload.event=="string")return a(this._binaryEncodeUserBroadcastPush(n));let l=[n.join_ref,n.ref,n.topic,n.event,n.payload];return a(JSON.stringify(l))}_binaryEncodePush(n){var a,l;const{event:d,topic:f,payload:x}=n,v=(a=n.ref)!==null&&a!==void 0?a:"",C=(l=n.join_ref)!==null&&l!==void 0?l:"",w=this.META_LENGTH+C.length+v.length+f.length+d.length,A=new ArrayBuffer(this.HEADER_LENGTH+w);let N=new DataView(A),R=0;N.setUint8(R++,this.KINDS.push),N.setUint8(R++,C.length),N.setUint8(R++,v.length),N.setUint8(R++,f.length),N.setUint8(R++,d.length),Array.from(C,O=>N.setUint8(R++,O.charCodeAt(0))),Array.from(v,O=>N.setUint8(R++,O.charCodeAt(0))),Array.from(f,O=>N.setUint8(R++,O.charCodeAt(0))),Array.from(d,O=>N.setUint8(R++,O.charCodeAt(0)));var T=new Uint8Array(A.byteLength+x.byteLength);return T.set(new Uint8Array(A),0),T.set(new Uint8Array(x),A.byteLength),T.buffer}_binaryEncodeUserBroadcastPush(n){var a;return this._isArrayBuffer((a=n.payload)===null||a===void 0?void 0:a.payload)?this._encodeBinaryUserBroadcastPush(n):this._encodeJsonUserBroadcastPush(n)}_encodeBinaryUserBroadcastPush(n){var a,l,d,f;const x=n.topic,v=(a=n.ref)!==null&&a!==void 0?a:"",C=(l=n.join_ref)!==null&&l!==void 0?l:"",w=n.payload.event,A=(f=(d=n.payload)===null||d===void 0?void 0:d.payload)!==null&&f!==void 0?f:new ArrayBuffer(0),N=this.USER_BROADCAST_PUSH_META_LENGTH+C.length+v.length+x.length+w.length,R=new ArrayBuffer(this.HEADER_LENGTH+N);let T=new DataView(R),O=0;T.setUint8(O++,this.KINDS.userBroadcastPush),T.setUint8(O++,C.length),T.setUint8(O++,v.length),T.setUint8(O++,x.length),T.setUint8(O++,w.length),T.setUint8(O++,this.BINARY_ENCODING),Array.from(C,B=>T.setUint8(O++,B.charCodeAt(0))),Array.from(v,B=>T.setUint8(O++,B.charCodeAt(0))),Array.from(x,B=>T.setUint8(O++,B.charCodeAt(0))),Array.from(w,B=>T.setUint8(O++,B.charCodeAt(0)));var L=new Uint8Array(R.byteLength+A.byteLength);return L.set(new Uint8Array(R),0),L.set(new Uint8Array(A),R.byteLength),L.buffer}_encodeJsonUserBroadcastPush(n){var a,l,d,f;const x=n.topic,v=(a=n.ref)!==null&&a!==void 0?a:"",C=(l=n.join_ref)!==null&&l!==void 0?l:"",w=n.payload.event,A=(f=(d=n.payload)===null||d===void 0?void 0:d.payload)!==null&&f!==void 0?f:{},R=new TextEncoder().encode(JSON.stringify(A)).buffer,T=this.USER_BROADCAST_PUSH_META_LENGTH+C.length+v.length+x.length+w.length,O=new ArrayBuffer(this.HEADER_LENGTH+T);let L=new DataView(O),B=0;L.setUint8(B++,this.KINDS.userBroadcastPush),L.setUint8(B++,C.length),L.setUint8(B++,v.length),L.setUint8(B++,x.length),L.setUint8(B++,w.length),L.setUint8(B++,this.JSON_ENCODING),Array.from(C,U=>L.setUint8(B++,U.charCodeAt(0))),Array.from(v,U=>L.setUint8(B++,U.charCodeAt(0))),Array.from(x,U=>L.setUint8(B++,U.charCodeAt(0))),Array.from(w,U=>L.setUint8(B++,U.charCodeAt(0)));var H=new Uint8Array(O.byteLength+R.byteLength);return H.set(new Uint8Array(O),0),H.set(new Uint8Array(R),O.byteLength),H.buffer}decode(n,a){if(this._isArrayBuffer(n)){let l=this._binaryDecode(n);return a(l)}if(typeof n=="string"){const l=JSON.parse(n),[d,f,x,v,C]=l;return a({join_ref:d,ref:f,topic:x,event:v,payload:C})}return a({})}_binaryDecode(n){const a=new DataView(n),l=a.getUint8(0),d=new TextDecoder;switch(l){case this.KINDS.push:return this._decodePush(n,a,d);case this.KINDS.reply:return this._decodeReply(n,a,d);case this.KINDS.broadcast:return this._decodeBroadcast(n,a,d);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(n,a,d)}}_decodePush(n,a,l){const d=a.getUint8(1),f=a.getUint8(2),x=a.getUint8(3);let v=this.HEADER_LENGTH+this.META_LENGTH-1;const C=l.decode(n.slice(v,v+d));v=v+d;const w=l.decode(n.slice(v,v+f));v=v+f;const A=l.decode(n.slice(v,v+x));v=v+x;const N=JSON.parse(l.decode(n.slice(v,n.byteLength)));return{join_ref:C,ref:null,topic:w,event:A,payload:N}}_decodeReply(n,a,l){const d=a.getUint8(1),f=a.getUint8(2),x=a.getUint8(3),v=a.getUint8(4);let C=this.HEADER_LENGTH+this.META_LENGTH;const w=l.decode(n.slice(C,C+d));C=C+d;const A=l.decode(n.slice(C,C+f));C=C+f;const N=l.decode(n.slice(C,C+x));C=C+x;const R=l.decode(n.slice(C,C+v));C=C+v;const T=JSON.parse(l.decode(n.slice(C,n.byteLength))),O={status:R,response:T};return{join_ref:w,ref:A,topic:N,event:ba.reply,payload:O}}_decodeBroadcast(n,a,l){const d=a.getUint8(1),f=a.getUint8(2);let x=this.HEADER_LENGTH+2;const v=l.decode(n.slice(x,x+d));x=x+d;const C=l.decode(n.slice(x,x+f));x=x+f;const w=JSON.parse(l.decode(n.slice(x,n.byteLength)));return{join_ref:null,ref:null,topic:v,event:C,payload:w}}_decodeUserBroadcast(n,a,l){const d=a.getUint8(1),f=a.getUint8(2),x=a.getUint8(3),v=a.getUint8(4);let C=this.HEADER_LENGTH+4;const w=l.decode(n.slice(C,C+d));C=C+d;const A=l.decode(n.slice(C,C+f));C=C+f;const N=l.decode(n.slice(C,C+x));C=C+x;const R=n.slice(C,n.byteLength),T=v===this.JSON_ENCODING?JSON.parse(l.decode(R)):R,O={type:this.BROADCAST,event:A,payload:T};return x>0&&(O.meta=JSON.parse(N)),{join_ref:null,ref:null,topic:w,event:this.BROADCAST,payload:O}}_isArrayBuffer(n){var a;return n instanceof ArrayBuffer||((a=n?.constructor)===null||a===void 0?void 0:a.name)==="ArrayBuffer"}}class M2{constructor(n,a){this.callback=n,this.timerCalc=a,this.timer=void 0,this.tries=0,this.callback=n,this.timerCalc=a}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var wn;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(wn||(wn={}));const mp=(i,n,a={})=>{var l;const d=(l=a.skipTypes)!==null&&l!==void 0?l:[];return n?Object.keys(n).reduce((f,x)=>(f[x]=Uv(x,i,n,d),f),{}):{}},Uv=(i,n,a,l)=>{const d=n.find(v=>v.name===i),f=d?.type,x=a[i];return f&&!l.includes(f)?k2(f,x):t0(x)},k2=(i,n)=>{if(i.charAt(0)==="_"){const a=i.slice(1,i.length);return Hv(n,a)}switch(i){case wn.bool:return Pv(n);case wn.float4:case wn.float8:case wn.int2:case wn.int4:case wn.int8:case wn.numeric:case wn.oid:return zv(n);case wn.json:case wn.jsonb:return Fv(n);case wn.timestamp:return qv(n);case wn.abstime:case wn.date:case wn.daterange:case wn.int4range:case wn.int8range:case wn.money:case wn.reltime:case wn.text:case wn.time:case wn.timestamptz:case wn.timetz:case wn.tsrange:case wn.tstzrange:return t0(n);default:return t0(n)}},t0=i=>i,Pv=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},zv=i=>{if(typeof i=="string"){const n=parseFloat(i);if(!Number.isNaN(n))return n}return i},Fv=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(n){return console.log(`JSON parse error: ${n}`),i}return i},Hv=(i,n)=>{if(typeof i!="string")return i;const a=i.length-1,l=i[a];if(i[0]==="{"&&l==="}"){let f;const x=i.slice(1,a);try{f=JSON.parse("["+x+"]")}catch{f=x?x.split(","):[]}return f.map(v=>k2(n,v))}return i},qv=i=>typeof i=="string"?i.replace(" ","T"):i,D2=i=>{const n=new URL(i);return n.protocol=n.protocol.replace(/^ws/i,"http"),n.pathname=n.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),n.pathname===""||n.pathname==="/"?n.pathname="/api/broadcast":n.pathname=n.pathname+"/api/broadcast",n.href};class uf{constructor(n,a,l={},d=Jf){this.channel=n,this.event=a,this.payload=l,this.timeout=d,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(n){this.timeout=n,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(n){this.payload=Object.assign(Object.assign({},this.payload),n)}receive(n,a){var l;return this._hasReceived(n)&&a((l=this.receivedResp)===null||l===void 0?void 0:l.response),this.recHooks.push({status:n,callback:a}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const n=a=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=a,this._matchReceive(a)};this.channel._on(this.refEvent,{},n),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(n,a){this.refEvent&&this.channel._trigger(this.refEvent,{status:n,response:a})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:n,response:a}){this.recHooks.filter(l=>l.status===n).forEach(l=>l.callback(a))}_hasReceived(n){return this.receivedResp&&this.receivedResp.status===n}}var pp;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(pp||(pp={}));class Wl{constructor(n,a){this.channel=n,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const l=a?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(l.state,{},d=>{const{onJoin:f,onLeave:x,onSync:v}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Wl.syncState(this.state,d,f,x),this.pendingDiffs.forEach(C=>{this.state=Wl.syncDiff(this.state,C,f,x)}),this.pendingDiffs=[],v()}),this.channel._on(l.diff,{},d=>{const{onJoin:f,onLeave:x,onSync:v}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(d):(this.state=Wl.syncDiff(this.state,d,f,x),v())}),this.onJoin((d,f,x)=>{this.channel._trigger("presence",{event:"join",key:d,currentPresences:f,newPresences:x})}),this.onLeave((d,f,x)=>{this.channel._trigger("presence",{event:"leave",key:d,currentPresences:f,leftPresences:x})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(n,a,l,d){const f=this.cloneDeep(n),x=this.transformState(a),v={},C={};return this.map(f,(w,A)=>{x[w]||(C[w]=A)}),this.map(x,(w,A)=>{const N=f[w];if(N){const R=A.map(B=>B.presence_ref),T=N.map(B=>B.presence_ref),O=A.filter(B=>T.indexOf(B.presence_ref)<0),L=N.filter(B=>R.indexOf(B.presence_ref)<0);O.length>0&&(v[w]=O),L.length>0&&(C[w]=L)}else v[w]=A}),this.syncDiff(f,{joins:v,leaves:C},l,d)}static syncDiff(n,a,l,d){const{joins:f,leaves:x}={joins:this.transformState(a.joins),leaves:this.transformState(a.leaves)};return l||(l=()=>{}),d||(d=()=>{}),this.map(f,(v,C)=>{var w;const A=(w=n[v])!==null&&w!==void 0?w:[];if(n[v]=this.cloneDeep(C),A.length>0){const N=n[v].map(T=>T.presence_ref),R=A.filter(T=>N.indexOf(T.presence_ref)<0);n[v].unshift(...R)}l(v,A,C)}),this.map(x,(v,C)=>{let w=n[v];if(!w)return;const A=C.map(N=>N.presence_ref);w=w.filter(N=>A.indexOf(N.presence_ref)<0),n[v]=w,d(v,w,C),w.length===0&&delete n[v]}),n}static map(n,a){return Object.getOwnPropertyNames(n).map(l=>a(l,n[l]))}static transformState(n){return n=this.cloneDeep(n),Object.getOwnPropertyNames(n).reduce((a,l)=>{const d=n[l];return"metas"in d?a[l]=d.metas.map(f=>(f.presence_ref=f.phx_ref,delete f.phx_ref,delete f.phx_ref_prev,f)):a[l]=d,a},{})}static cloneDeep(n){return JSON.parse(JSON.stringify(n))}onJoin(n){this.caller.onJoin=n}onLeave(n){this.caller.onLeave=n}onSync(n){this.caller.onSync=n}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var xp;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(xp||(xp={}));var Ql;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes",i.SYSTEM="system"})(Ql||(Ql={}));var pr;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(pr||(pr={}));class N0{constructor(n,a={config:{}},l){var d,f;if(this.topic=n,this.params=a,this.socket=l,this.bindings={},this.state=os.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=n.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},a.config),this.timeout=this.socket.timeout,this.joinPush=new uf(this,ba.join,this.params,this.timeout),this.rejoinTimer=new M2(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=os.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(x=>x.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=os.closed,this.socket._remove(this)}),this._onError(x=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,x),this.state=os.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=os.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",x=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,x),this.state=os.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ba.reply,{},(x,v)=>{this._trigger(this._replyEventName(v),x)}),this.presence=new Wl(this),this.broadcastEndpointURL=D2(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((f=(d=this.params.config)===null||d===void 0?void 0:d.broadcast)===null||f===void 0)&&f.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(n,a=this.timeout){var l,d,f;if(this.socket.isConnected()||this.socket.connect(),this.state==os.closed){const{config:{broadcast:x,presence:v,private:C}}=this.params,w=(d=(l=this.bindings.postgres_changes)===null||l===void 0?void 0:l.map(T=>T.filter))!==null&&d!==void 0?d:[],A=!!this.bindings[Ql.PRESENCE]&&this.bindings[Ql.PRESENCE].length>0||((f=this.params.config.presence)===null||f===void 0?void 0:f.enabled)===!0,N={},R={broadcast:x,presence:Object.assign(Object.assign({},v),{enabled:A}),postgres_changes:w,private:C};this.socket.accessTokenValue&&(N.access_token=this.socket.accessTokenValue),this._onError(T=>n?.(pr.CHANNEL_ERROR,T)),this._onClose(()=>n?.(pr.CLOSED)),this.updateJoinPayload(Object.assign({config:R},N)),this.joinedOnce=!0,this._rejoin(a),this.joinPush.receive("ok",async({postgres_changes:T})=>{var O;if(this.socket.setAuth(),T===void 0){n?.(pr.SUBSCRIBED);return}else{const L=this.bindings.postgres_changes,B=(O=L?.length)!==null&&O!==void 0?O:0,H=[];for(let U=0;U<B;U++){const P=L[U],{filter:{event:K,schema:Z,table:W,filter:X}}=P,J=T&&T[U];if(J&&J.event===K&&J.schema===Z&&J.table===W&&J.filter===X)H.push(Object.assign(Object.assign({},P),{id:J.id}));else{this.unsubscribe(),this.state=os.errored,n?.(pr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=H,n&&n(pr.SUBSCRIBED);return}}).receive("error",T=>{this.state=os.errored,n?.(pr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(T).join(", ")||"error")))}).receive("timeout",()=>{n?.(pr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(n,a={}){return await this.send({type:"presence",event:"track",payload:n},a.timeout||this.timeout)}async untrack(n={}){return await this.send({type:"presence",event:"untrack"},n)}on(n,a,l){return this.state===os.joined&&n===Ql.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(n,a,l)}async httpSend(n,a,l={}){var d;const f=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(a==null)return Promise.reject("Payload is required for httpSend()");const x={method:"POST",headers:{Authorization:f,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:a,private:this.private}]})},v=await this._fetchWithTimeout(this.broadcastEndpointURL,x,(d=l.timeout)!==null&&d!==void 0?d:this.timeout);if(v.status===202)return{success:!0};let C=v.statusText;try{const w=await v.json();C=w.error||w.message||C}catch{}return Promise.reject(new Error(C))}async send(n,a={}){var l,d;if(!this._canPush()&&n.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:f,payload:x}=n,C={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:f,payload:x,private:this.private}]})};try{const w=await this._fetchWithTimeout(this.broadcastEndpointURL,C,(l=a.timeout)!==null&&l!==void 0?l:this.timeout);return await((d=w.body)===null||d===void 0?void 0:d.cancel()),w.ok?"ok":"error"}catch(w){return w.name==="AbortError"?"timed out":"error"}}else return new Promise(f=>{var x,v,C;const w=this._push(n.type,n,a.timeout||this.timeout);n.type==="broadcast"&&!(!((C=(v=(x=this.params)===null||x===void 0?void 0:x.config)===null||v===void 0?void 0:v.broadcast)===null||C===void 0)&&C.ack)&&f("ok"),w.receive("ok",()=>f("ok")),w.receive("error",()=>f("error")),w.receive("timeout",()=>f("timed out"))})}updateJoinPayload(n){this.joinPush.updatePayload(n)}unsubscribe(n=this.timeout){this.state=os.leaving;const a=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ba.close,"leave",this._joinRef())};this.joinPush.destroy();let l=null;return new Promise(d=>{l=new uf(this,ba.leave,{},n),l.receive("ok",()=>{a(),d("ok")}).receive("timeout",()=>{a(),d("timed out")}).receive("error",()=>{d("error")}),l.send(),this._canPush()||l.trigger("ok",{})}).finally(()=>{l?.destroy()})}teardown(){this.pushBuffer.forEach(n=>n.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=os.closed,this.bindings={}}async _fetchWithTimeout(n,a,l){const d=new AbortController,f=setTimeout(()=>d.abort(),l),x=await this.socket.fetch(n,Object.assign(Object.assign({},a),{signal:d.signal}));return clearTimeout(f),x}_push(n,a,l=this.timeout){if(!this.joinedOnce)throw`tried to push '${n}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let d=new uf(this,n,a,l);return this._canPush()?d.send():this._addToPushBuffer(d),d}_addToPushBuffer(n){if(n.startTimeout(),this.pushBuffer.push(n),this.pushBuffer.length>Lv){const a=this.pushBuffer.shift();a&&(a.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${a.event}`,a.payload))}}_onMessage(n,a,l){return a}_isMember(n){return this.topic===n}_joinRef(){return this.joinPush.ref}_trigger(n,a,l){var d,f;const x=n.toLocaleLowerCase(),{close:v,error:C,leave:w,join:A}=ba;if(l&&[v,C,w,A].indexOf(x)>=0&&l!==this._joinRef())return;let R=this._onMessage(x,a,l);if(a&&!R)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(x)?(d=this.bindings.postgres_changes)===null||d===void 0||d.filter(T=>{var O,L,B;return((O=T.filter)===null||O===void 0?void 0:O.event)==="*"||((B=(L=T.filter)===null||L===void 0?void 0:L.event)===null||B===void 0?void 0:B.toLocaleLowerCase())===x}).map(T=>T.callback(R,l)):(f=this.bindings[x])===null||f===void 0||f.filter(T=>{var O,L,B,H,U,P;if(["broadcast","presence","postgres_changes"].includes(x))if("id"in T){const K=T.id,Z=(O=T.filter)===null||O===void 0?void 0:O.event;return K&&((L=a.ids)===null||L===void 0?void 0:L.includes(K))&&(Z==="*"||Z?.toLocaleLowerCase()===((B=a.data)===null||B===void 0?void 0:B.type.toLocaleLowerCase()))}else{const K=(U=(H=T?.filter)===null||H===void 0?void 0:H.event)===null||U===void 0?void 0:U.toLocaleLowerCase();return K==="*"||K===((P=a?.event)===null||P===void 0?void 0:P.toLocaleLowerCase())}else return T.type.toLocaleLowerCase()===x}).map(T=>{if(typeof R=="object"&&"ids"in R){const O=R.data,{schema:L,table:B,commit_timestamp:H,type:U,errors:P}=O;R=Object.assign(Object.assign({},{schema:L,table:B,commit_timestamp:H,eventType:U,new:{},old:{},errors:P}),this._getPayloadRecords(O))}T.callback(R,l)})}_isClosed(){return this.state===os.closed}_isJoined(){return this.state===os.joined}_isJoining(){return this.state===os.joining}_isLeaving(){return this.state===os.leaving}_replyEventName(n){return`chan_reply_${n}`}_on(n,a,l){const d=n.toLocaleLowerCase(),f={type:d,filter:a,callback:l};return this.bindings[d]?this.bindings[d].push(f):this.bindings[d]=[f],this}_off(n,a){const l=n.toLocaleLowerCase();return this.bindings[l]&&(this.bindings[l]=this.bindings[l].filter(d=>{var f;return!(((f=d.type)===null||f===void 0?void 0:f.toLocaleLowerCase())===l&&N0.isEqual(d.filter,a))})),this}static isEqual(n,a){if(Object.keys(n).length!==Object.keys(a).length)return!1;for(const l in n)if(n[l]!==a[l])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(n){this._on(ba.close,{},n)}_onError(n){this._on(ba.error,{},a=>n(a))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(n=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=os.joining,this.joinPush.resend(n))}_getPayloadRecords(n){const a={new:{},old:{}};return(n.type==="INSERT"||n.type==="UPDATE")&&(a.new=mp(n.columns,n.record)),(n.type==="UPDATE"||n.type==="DELETE")&&(a.old=mp(n.columns,n.old_record)),a}}const df=()=>{},Ru={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Vv=[1e3,2e3,5e3,1e4],Gv=1e4,Yv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Xv{constructor(n,a){var l;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Jf,this.transport=null,this.heartbeatIntervalMs=Ru.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=df,this.ref=0,this.reconnectTimer=null,this.vsn=gp,this.logger=df,this.conn=null,this.sendBuffer=[],this.serializer=new Bv,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=d=>d?(...f)=>d(...f):(...f)=>fetch(...f),!(!((l=a?.params)===null||l===void 0)&&l.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=a.params.apikey,this.endPoint=`${n}/${e0.websocket}`,this.httpEndpoint=D2(n),this._initializeOptions(a),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(a?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Iv.createWebSocket(this.endpointURL())}catch(n){this._setConnectionState("disconnected");const a=n.message;throw a.includes("Node.js")?new Error(`${a}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${a}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(n,a){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const l=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(l),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(n?this.conn.close(n,a??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(n){const a=await n.unsubscribe();return this.channels.length===0&&this.disconnect(),a}async removeAllChannels(){const n=await Promise.all(this.channels.map(a=>a.unsubscribe()));return this.channels=[],this.disconnect(),n}log(n,a,l){this.logger(n,a,l)}connectionState(){switch(this.conn&&this.conn.readyState){case zi.connecting:return Fi.Connecting;case zi.open:return Fi.Open;case zi.closing:return Fi.Closing;default:return Fi.Closed}}isConnected(){return this.connectionState()===Fi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(n,a={config:{}}){const l=`realtime:${n}`,d=this.getChannels().find(f=>f.topic===l);if(d)return d;{const f=new N0(`realtime:${n}`,a,this);return this.channels.push(f),f}}push(n){const{topic:a,event:l,payload:d,ref:f}=n,x=()=>{this.encode(n,v=>{var C;(C=this.conn)===null||C===void 0||C.send(v)})};this.log("push",`${a} ${l} (${f})`,d),this.isConnected()?x():this.sendBuffer.push(x)}async setAuth(n=null){this._authPromise=this._performAuth(n);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var n;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(a){this.log("error","error in heartbeat callback",a)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(a){this.log("error","error in heartbeat callback",a)}this._wasManualDisconnect=!1,(n=this.conn)===null||n===void 0||n.close(Dv,"heartbeat timeout"),setTimeout(()=>{var a;this.isConnected()||(a=this.reconnectTimer)===null||a===void 0||a.scheduleTimeout()},Ru.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(a){this.log("error","error in heartbeat callback",a)}this._setAuthSafely("heartbeat")}onHeartbeat(n){this.heartbeatCallback=n}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(n=>n()),this.sendBuffer=[])}_makeRef(){let n=this.ref+1;return n===this.ref?this.ref=0:this.ref=n,this.ref.toString()}_leaveOpenTopic(n){let a=this.channels.find(l=>l.topic===n&&(l._isJoined()||l._isJoining()));a&&(this.log("transport",`leaving duplicate topic "${n}"`),a.unsubscribe())}_remove(n){this.channels=this.channels.filter(a=>a.topic!==n.topic)}_onConnMessage(n){this.decode(n.data,a=>{if(a.topic==="phoenix"&&a.event==="phx_reply")try{this.heartbeatCallback(a.payload.status==="ok"?"ok":"error")}catch(w){this.log("error","error in heartbeat callback",w)}a.ref&&a.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:l,event:d,payload:f,ref:x}=a,v=x?`(${x})`:"",C=f.status||"";this.log("receive",`${C} ${l} ${d} ${v}`.trim(),f),this.channels.filter(w=>w._isMember(l)).forEach(w=>w._trigger(d,f,x)),this._triggerStateCallbacks("message",a)})}_clearTimer(n){var a;n==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):n==="reconnect"&&((a=this.reconnectTimer)===null||a===void 0||a.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=n=>this._onConnError(n),this.conn.onmessage=n=>this._onConnMessage(n),this.conn.onclose=n=>this._onConnClose(n))}_teardownConnection(){if(this.conn){if(this.conn.readyState===zi.open||this.conn.readyState===zi.connecting)try{this.conn.close()}catch(n){this.log("error","Error closing connection",n)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(n=>n.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(a=>{this.log("error","error waiting for auth on connect",a),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const n=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(n),this.workerRef.onerror=a=>{this.log("worker","worker error",a.message),this.workerRef.terminate()},this.workerRef.onmessage=a=>{a.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(n){var a;this._setConnectionState("disconnected"),this.log("transport","close",n),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(a=this.reconnectTimer)===null||a===void 0||a.scheduleTimeout(),this._triggerStateCallbacks("close",n)}_onConnError(n){this._setConnectionState("disconnected"),this.log("transport",`${n}`),this._triggerChanError(),this._triggerStateCallbacks("error",n)}_triggerChanError(){this.channels.forEach(n=>n._trigger(ba.error))}_appendParams(n,a){if(Object.keys(a).length===0)return n;const l=n.match(/\?/)?"&":"?",d=new URLSearchParams(a);return`${n}${l}${d}`}_workerObjectUrl(n){let a;if(n)a=n;else{const l=new Blob([Yv],{type:"application/javascript"});a=URL.createObjectURL(l)}return a}_setConnectionState(n,a=!1){this._connectionState=n,n==="connecting"?this._wasManualDisconnect=!1:n==="disconnecting"&&(this._wasManualDisconnect=a)}async _performAuth(n=null){let a;n?a=n:this.accessToken?a=await this.accessToken():a=this.accessTokenValue,this.accessTokenValue!=a&&(this.accessTokenValue=a,this.channels.forEach(l=>{const d={access_token:a,version:Mv};a&&l.updateJoinPayload(d),l.joinedOnce&&l._isJoined()&&l._push(ba.access_token,{access_token:a})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(n="general"){this.setAuth().catch(a=>{this.log("error",`error setting auth in ${n}`,a)})}_triggerStateCallbacks(n,a){try{this.stateChangeCallbacks[n].forEach(l=>{try{l(a)}catch(d){this.log("error",`error in ${n} callback`,d)}})}catch(l){this.log("error",`error triggering ${n} callbacks`,l)}}_setupReconnectionTimer(){this.reconnectTimer=new M2(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ru.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(n){var a,l,d,f,x,v,C,w,A,N,R,T;switch(this.transport=(a=n?.transport)!==null&&a!==void 0?a:null,this.timeout=(l=n?.timeout)!==null&&l!==void 0?l:Jf,this.heartbeatIntervalMs=(d=n?.heartbeatIntervalMs)!==null&&d!==void 0?d:Ru.HEARTBEAT_INTERVAL,this.worker=(f=n?.worker)!==null&&f!==void 0?f:!1,this.accessToken=(x=n?.accessToken)!==null&&x!==void 0?x:null,this.heartbeatCallback=(v=n?.heartbeatCallback)!==null&&v!==void 0?v:df,this.vsn=(C=n?.vsn)!==null&&C!==void 0?C:gp,n?.params&&(this.params=n.params),n?.logger&&(this.logger=n.logger),(n?.logLevel||n?.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(w=n?.reconnectAfterMs)!==null&&w!==void 0?w:(O=>Vv[O-1]||Gv),this.vsn){case O2:this.encode=(A=n?.encode)!==null&&A!==void 0?A:((O,L)=>L(JSON.stringify(O))),this.decode=(N=n?.decode)!==null&&N!==void 0?N:((O,L)=>L(JSON.parse(O)));break;case kv:this.encode=(R=n?.encode)!==null&&R!==void 0?R:this.serializer.encode.bind(this.serializer),this.decode=(T=n?.decode)!==null&&T!==void 0?T:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=n?.workerUrl}}}class T0 extends Error{constructor(n){super(n),this.__isStorageError=!0,this.name="StorageError"}}function Mn(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class Wv extends T0{constructor(n,a,l){super(n),this.name="StorageApiError",this.status=a,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class n0 extends T0{constructor(n,a){super(n),this.name="StorageUnknownError",this.originalError=a}}const j0=i=>i?(...n)=>i(...n):(...n)=>fetch(...n),Qv=()=>Response,s0=i=>{if(Array.isArray(i))return i.map(a=>s0(a));if(typeof i=="function"||i!==Object(i))return i;const n={};return Object.entries(i).forEach(([a,l])=>{const d=a.replace(/([-_][a-z])/gi,f=>f.toUpperCase().replace(/[-_]/g,""));n[d]=s0(l)}),n},Kv=i=>{if(typeof i!="object"||i===null)return!1;const n=Object.getPrototypeOf(i);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},hf=i=>{var n;return i.msg||i.message||i.error_description||(typeof i.error=="string"?i.error:(n=i.error)===null||n===void 0?void 0:n.message)||JSON.stringify(i)},Zv=(i,n,a)=>tt(void 0,void 0,void 0,function*(){const l=yield Qv();i instanceof l&&!a?.noResolveJson?i.json().then(d=>{const f=i.status||500,x=d?.statusCode||f+"";n(new Wv(hf(d),f,x))}).catch(d=>{n(new n0(hf(d),d))}):n(new n0(hf(i),i))}),$v=(i,n,a,l)=>{const d={method:i,headers:n?.headers||{}};return i==="GET"||!l?d:(Kv(l)?(d.headers=Object.assign({"Content-Type":"application/json"},n?.headers),d.body=JSON.stringify(l)):d.body=l,n?.duplex&&(d.duplex=n.duplex),Object.assign(Object.assign({},d),a))};function ic(i,n,a,l,d,f){return tt(this,void 0,void 0,function*(){return new Promise((x,v)=>{i(a,$v(n,l,d,f)).then(C=>{if(!C.ok)throw C;return l?.noResolveJson?C:C.json()}).then(C=>x(C)).catch(C=>Zv(C,v,l))})})}function Jl(i,n,a,l){return tt(this,void 0,void 0,function*(){return ic(i,"GET",n,a,l)})}function Ia(i,n,a,l,d){return tt(this,void 0,void 0,function*(){return ic(i,"POST",n,l,d,a)})}function a0(i,n,a,l,d){return tt(this,void 0,void 0,function*(){return ic(i,"PUT",n,l,d,a)})}function Jv(i,n,a,l){return tt(this,void 0,void 0,function*(){return ic(i,"HEAD",n,Object.assign(Object.assign({},a),{noResolveJson:!0}),l)})}function R0(i,n,a,l,d){return tt(this,void 0,void 0,function*(){return ic(i,"DELETE",n,l,d,a)})}class eC{constructor(n,a){this.downloadFn=n,this.shouldThrowOnError=a}then(n,a){return this.execute().then(n,a)}execute(){return tt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mn(n))return{data:null,error:n};throw n}})}}var L2;class tC{constructor(n,a){this.downloadFn=n,this.shouldThrowOnError=a,this[L2]="BlobDownloadBuilder",this.promise=null}asStream(){return new eC(this.downloadFn,this.shouldThrowOnError)}then(n,a){return this.getPromise().then(n,a)}catch(n){return this.getPromise().catch(n)}finally(n){return this.getPromise().finally(n)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return tt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mn(n))return{data:null,error:n};throw n}})}}L2=Symbol.toStringTag;const nC={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},yp={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class sC{constructor(n,a={},l,d){this.shouldThrowOnError=!1,this.url=n,this.headers=a,this.bucketId=l,this.fetch=j0(d)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(n,a,l,d){return tt(this,void 0,void 0,function*(){try{let f;const x=Object.assign(Object.assign({},yp),d);let v=Object.assign(Object.assign({},this.headers),n==="POST"&&{"x-upsert":String(x.upsert)});const C=x.metadata;typeof Blob<"u"&&l instanceof Blob?(f=new FormData,f.append("cacheControl",x.cacheControl),C&&f.append("metadata",this.encodeMetadata(C)),f.append("",l)):typeof FormData<"u"&&l instanceof FormData?(f=l,f.has("cacheControl")||f.append("cacheControl",x.cacheControl),C&&!f.has("metadata")&&f.append("metadata",this.encodeMetadata(C))):(f=l,v["cache-control"]=`max-age=${x.cacheControl}`,v["content-type"]=x.contentType,C&&(v["x-metadata"]=this.toBase64(this.encodeMetadata(C))),(typeof ReadableStream<"u"&&f instanceof ReadableStream||f&&typeof f=="object"&&"pipe"in f&&typeof f.pipe=="function")&&!x.duplex&&(x.duplex="half")),d?.headers&&(v=Object.assign(Object.assign({},v),d.headers));const w=this._removeEmptyFolders(a),A=this._getFinalPath(w),N=yield(n=="PUT"?a0:Ia)(this.fetch,`${this.url}/object/${A}`,f,Object.assign({headers:v},x?.duplex?{duplex:x.duplex}:{}));return{data:{path:w,id:N.Id,fullPath:N.Key},error:null}}catch(f){if(this.shouldThrowOnError)throw f;if(Mn(f))return{data:null,error:f};throw f}})}upload(n,a,l){return tt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",n,a,l)})}uploadToSignedUrl(n,a,l,d){return tt(this,void 0,void 0,function*(){const f=this._removeEmptyFolders(n),x=this._getFinalPath(f),v=new URL(this.url+`/object/upload/sign/${x}`);v.searchParams.set("token",a);try{let C;const w=Object.assign({upsert:yp.upsert},d),A=Object.assign(Object.assign({},this.headers),{"x-upsert":String(w.upsert)});typeof Blob<"u"&&l instanceof Blob?(C=new FormData,C.append("cacheControl",w.cacheControl),C.append("",l)):typeof FormData<"u"&&l instanceof FormData?(C=l,C.append("cacheControl",w.cacheControl)):(C=l,A["cache-control"]=`max-age=${w.cacheControl}`,A["content-type"]=w.contentType);const N=yield a0(this.fetch,v.toString(),C,{headers:A});return{data:{path:f,fullPath:N.Key},error:null}}catch(C){if(this.shouldThrowOnError)throw C;if(Mn(C))return{data:null,error:C};throw C}})}createSignedUploadUrl(n,a){return tt(this,void 0,void 0,function*(){try{let l=this._getFinalPath(n);const d=Object.assign({},this.headers);a?.upsert&&(d["x-upsert"]="true");const f=yield Ia(this.fetch,`${this.url}/object/upload/sign/${l}`,{},{headers:d}),x=new URL(this.url+f.url),v=x.searchParams.get("token");if(!v)throw new T0("No token returned by API");return{data:{signedUrl:x.toString(),path:n,token:v},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Mn(l))return{data:null,error:l};throw l}})}update(n,a,l){return tt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",n,a,l)})}move(n,a,l){return tt(this,void 0,void 0,function*(){try{return{data:yield Ia(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:n,destinationKey:a,destinationBucket:l?.destinationBucket},{headers:this.headers}),error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(Mn(d))return{data:null,error:d};throw d}})}copy(n,a,l){return tt(this,void 0,void 0,function*(){try{return{data:{path:(yield Ia(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:n,destinationKey:a,destinationBucket:l?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(Mn(d))return{data:null,error:d};throw d}})}createSignedUrl(n,a,l){return tt(this,void 0,void 0,function*(){try{let d=this._getFinalPath(n),f=yield Ia(this.fetch,`${this.url}/object/sign/${d}`,Object.assign({expiresIn:a},l?.transform?{transform:l.transform}:{}),{headers:this.headers});const x=l?.download?`&download=${l.download===!0?"":l.download}`:"";return f={signedUrl:encodeURI(`${this.url}${f.signedURL}${x}`)},{data:f,error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(Mn(d))return{data:null,error:d};throw d}})}createSignedUrls(n,a,l){return tt(this,void 0,void 0,function*(){try{const d=yield Ia(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:a,paths:n},{headers:this.headers}),f=l?.download?`&download=${l.download===!0?"":l.download}`:"";return{data:d.map(x=>Object.assign(Object.assign({},x),{signedUrl:x.signedURL?encodeURI(`${this.url}${x.signedURL}${f}`):null})),error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(Mn(d))return{data:null,error:d};throw d}})}download(n,a){const d=typeof a?.transform<"u"?"render/image/authenticated":"object",f=this.transformOptsToQueryString(a?.transform||{}),x=f?`?${f}`:"",v=this._getFinalPath(n),C=()=>Jl(this.fetch,`${this.url}/${d}/${v}${x}`,{headers:this.headers,noResolveJson:!0});return new tC(C,this.shouldThrowOnError)}info(n){return tt(this,void 0,void 0,function*(){const a=this._getFinalPath(n);try{const l=yield Jl(this.fetch,`${this.url}/object/info/${a}`,{headers:this.headers});return{data:s0(l),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Mn(l))return{data:null,error:l};throw l}})}exists(n){return tt(this,void 0,void 0,function*(){const a=this._getFinalPath(n);try{return yield Jv(this.fetch,`${this.url}/object/${a}`,{headers:this.headers}),{data:!0,error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Mn(l)&&l instanceof n0){const d=l.originalError;if([400,404].includes(d?.status))return{data:!1,error:l}}throw l}})}getPublicUrl(n,a){const l=this._getFinalPath(n),d=[],f=a?.download?`download=${a.download===!0?"":a.download}`:"";f!==""&&d.push(f);const v=typeof a?.transform<"u"?"render/image":"object",C=this.transformOptsToQueryString(a?.transform||{});C!==""&&d.push(C);let w=d.join("&");return w!==""&&(w=`?${w}`),{data:{publicUrl:encodeURI(`${this.url}/${v}/public/${l}${w}`)}}}remove(n){return tt(this,void 0,void 0,function*(){try{return{data:yield R0(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:n},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mn(a))return{data:null,error:a};throw a}})}list(n,a,l){return tt(this,void 0,void 0,function*(){try{const d=Object.assign(Object.assign(Object.assign({},nC),a),{prefix:n||""});return{data:yield Ia(this.fetch,`${this.url}/object/list/${this.bucketId}`,d,{headers:this.headers},l),error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(Mn(d))return{data:null,error:d};throw d}})}listV2(n,a){return tt(this,void 0,void 0,function*(){try{const l=Object.assign({},n);return{data:yield Ia(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,l,{headers:this.headers},a),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Mn(l))return{data:null,error:l};throw l}})}encodeMetadata(n){return JSON.stringify(n)}toBase64(n){return typeof Buffer<"u"?Buffer.from(n).toString("base64"):btoa(n)}_getFinalPath(n){return`${this.bucketId}/${n.replace(/^\/+/,"")}`}_removeEmptyFolders(n){return n.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(n){const a=[];return n.width&&a.push(`width=${n.width}`),n.height&&a.push(`height=${n.height}`),n.resize&&a.push(`resize=${n.resize}`),n.format&&a.push(`format=${n.format}`),n.quality&&a.push(`quality=${n.quality}`),a.join("&")}}const B2="2.83.0",U2={"X-Client-Info":`storage-js/${B2}`};class aC{constructor(n,a={},l,d){this.shouldThrowOnError=!1;const f=new URL(n);d?.useNewHostname&&/supabase\.(co|in|red)$/.test(f.hostname)&&!f.hostname.includes("storage.supabase.")&&(f.hostname=f.hostname.replace("supabase.","storage.supabase.")),this.url=f.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},U2),a),this.fetch=j0(l)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(n){return tt(this,void 0,void 0,function*(){try{const a=this.listBucketOptionsToQueryString(n);return{data:yield Jl(this.fetch,`${this.url}/bucket${a}`,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mn(a))return{data:null,error:a};throw a}})}getBucket(n){return tt(this,void 0,void 0,function*(){try{return{data:yield Jl(this.fetch,`${this.url}/bucket/${n}`,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mn(a))return{data:null,error:a};throw a}})}createBucket(n){return tt(this,arguments,void 0,function*(a,l={public:!1}){try{return{data:yield Ia(this.fetch,`${this.url}/bucket`,{id:a,name:a,type:l.type,public:l.public,file_size_limit:l.fileSizeLimit,allowed_mime_types:l.allowedMimeTypes},{headers:this.headers}),error:null}}catch(d){if(this.shouldThrowOnError)throw d;if(Mn(d))return{data:null,error:d};throw d}})}updateBucket(n,a){return tt(this,void 0,void 0,function*(){try{return{data:yield a0(this.fetch,`${this.url}/bucket/${n}`,{id:n,name:n,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Mn(l))return{data:null,error:l};throw l}})}emptyBucket(n){return tt(this,void 0,void 0,function*(){try{return{data:yield Ia(this.fetch,`${this.url}/bucket/${n}/empty`,{},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mn(a))return{data:null,error:a};throw a}})}deleteBucket(n){return tt(this,void 0,void 0,function*(){try{return{data:yield R0(this.fetch,`${this.url}/bucket/${n}`,{},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mn(a))return{data:null,error:a};throw a}})}listBucketOptionsToQueryString(n){const a={};return n&&("limit"in n&&(a.limit=String(n.limit)),"offset"in n&&(a.offset=String(n.offset)),n.search&&(a.search=n.search),n.sortColumn&&(a.sortColumn=n.sortColumn),n.sortOrder&&(a.sortOrder=n.sortOrder)),Object.keys(a).length>0?"?"+new URLSearchParams(a).toString():""}}class rC{constructor(n,a={},l){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},U2),a),this.fetch=j0(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(n){return tt(this,void 0,void 0,function*(){try{return{data:yield Ia(this.fetch,`${this.url}/bucket`,{name:n},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mn(a))return{data:null,error:a};throw a}})}listBuckets(n){return tt(this,void 0,void 0,function*(){try{const a=new URLSearchParams;n?.limit!==void 0&&a.set("limit",n.limit.toString()),n?.offset!==void 0&&a.set("offset",n.offset.toString()),n?.sortColumn&&a.set("sortColumn",n.sortColumn),n?.sortOrder&&a.set("sortOrder",n.sortOrder),n?.search&&a.set("search",n.search);const l=a.toString(),d=l?`${this.url}/bucket?${l}`:`${this.url}/bucket`;return{data:yield Jl(this.fetch,d,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mn(a))return{data:null,error:a};throw a}})}deleteBucket(n){return tt(this,void 0,void 0,function*(){try{return{data:yield R0(this.fetch,`${this.url}/bucket/${n}`,{},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Mn(a))return{data:null,error:a};throw a}})}}const I0={"X-Client-Info":`storage-js/${B2}`,"Content-Type":"application/json"};class P2 extends Error{constructor(n){super(n),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function ra(i){return typeof i=="object"&&i!==null&&"__isStorageVectorsError"in i}class ff extends P2{constructor(n,a,l){super(n),this.name="StorageVectorsApiError",this.status=a,this.statusCode=l}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class iC extends P2{constructor(n,a){super(n),this.name="StorageVectorsUnknownError",this.originalError=a}}var wp;(function(i){i.InternalError="InternalError",i.S3VectorConflictException="S3VectorConflictException",i.S3VectorNotFoundException="S3VectorNotFoundException",i.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",i.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",i.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(wp||(wp={}));const O0=i=>i?(...n)=>i(...n):(...n)=>fetch(...n),oC=i=>{if(typeof i!="object"||i===null)return!1;const n=Object.getPrototypeOf(i);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},bp=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),lC=(i,n,a)=>tt(void 0,void 0,void 0,function*(){if(i&&typeof i=="object"&&"status"in i&&"ok"in i&&typeof i.status=="number"&&!a?.noResolveJson){const d=i.status||500,f=i;if(typeof f.json=="function")f.json().then(x=>{const v=x?.statusCode||x?.code||d+"";n(new ff(bp(x),d,v))}).catch(()=>{const x=d+"",v=f.statusText||`HTTP ${d} error`;n(new ff(v,d,x))});else{const x=d+"",v=f.statusText||`HTTP ${d} error`;n(new ff(v,d,x))}}else n(new iC(bp(i),i))}),cC=(i,n,a,l)=>{const d={method:i,headers:n?.headers||{}};return l?(oC(l)?(d.headers=Object.assign({"Content-Type":"application/json"},n?.headers),d.body=JSON.stringify(l)):d.body=l,Object.assign(Object.assign({},d),a)):d};function uC(i,n,a,l,d,f){return tt(this,void 0,void 0,function*(){return new Promise((x,v)=>{i(a,cC(n,l,d,f)).then(C=>{if(!C.ok)throw C;if(l?.noResolveJson)return C;const w=C.headers.get("content-type");return!w||!w.includes("application/json")?{}:C.json()}).then(C=>x(C)).catch(C=>lC(C,v,l))})})}function ia(i,n,a,l,d){return tt(this,void 0,void 0,function*(){return uC(i,"POST",n,l,d,a)})}class dC{constructor(n,a={},l){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},I0),a),this.fetch=O0(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(n){return tt(this,void 0,void 0,function*(){try{return{data:(yield ia(this.fetch,`${this.url}/CreateIndex`,n,{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ra(a))return{data:null,error:a};throw a}})}getIndex(n,a){return tt(this,void 0,void 0,function*(){try{return{data:yield ia(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:n,indexName:a},{headers:this.headers}),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ra(l))return{data:null,error:l};throw l}})}listIndexes(n){return tt(this,void 0,void 0,function*(){try{return{data:yield ia(this.fetch,`${this.url}/ListIndexes`,n,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ra(a))return{data:null,error:a};throw a}})}deleteIndex(n,a){return tt(this,void 0,void 0,function*(){try{return{data:(yield ia(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:n,indexName:a},{headers:this.headers}))||{},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ra(l))return{data:null,error:l};throw l}})}}class hC{constructor(n,a={},l){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},I0),a),this.fetch=O0(l)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(n){return tt(this,void 0,void 0,function*(){try{if(n.vectors.length<1||n.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield ia(this.fetch,`${this.url}/PutVectors`,n,{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ra(a))return{data:null,error:a};throw a}})}getVectors(n){return tt(this,void 0,void 0,function*(){try{return{data:yield ia(this.fetch,`${this.url}/GetVectors`,n,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ra(a))return{data:null,error:a};throw a}})}listVectors(n){return tt(this,void 0,void 0,function*(){try{if(n.segmentCount!==void 0){if(n.segmentCount<1||n.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(n.segmentIndex!==void 0&&(n.segmentIndex<0||n.segmentIndex>=n.segmentCount))throw new Error(`segmentIndex must be between 0 and ${n.segmentCount-1}`)}return{data:yield ia(this.fetch,`${this.url}/ListVectors`,n,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ra(a))return{data:null,error:a};throw a}})}queryVectors(n){return tt(this,void 0,void 0,function*(){try{return{data:yield ia(this.fetch,`${this.url}/QueryVectors`,n,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ra(a))return{data:null,error:a};throw a}})}deleteVectors(n){return tt(this,void 0,void 0,function*(){try{if(n.keys.length<1||n.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield ia(this.fetch,`${this.url}/DeleteVectors`,n,{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ra(a))return{data:null,error:a};throw a}})}}class fC{constructor(n,a={},l){this.shouldThrowOnError=!1,this.url=n.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},I0),a),this.fetch=O0(l)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(n){return tt(this,void 0,void 0,function*(){try{return{data:(yield ia(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:n},{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ra(a))return{data:null,error:a};throw a}})}getBucket(n){return tt(this,void 0,void 0,function*(){try{return{data:yield ia(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:n},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ra(a))return{data:null,error:a};throw a}})}listBuckets(){return tt(this,arguments,void 0,function*(n={}){try{return{data:yield ia(this.fetch,`${this.url}/ListVectorBuckets`,n,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ra(a))return{data:null,error:a};throw a}})}deleteBucket(n){return tt(this,void 0,void 0,function*(){try{return{data:(yield ia(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:n},{headers:this.headers}))||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(ra(a))return{data:null,error:a};throw a}})}}class gC extends fC{constructor(n,a={}){super(n,a.headers||{},a.fetch)}from(n){return new mC(this.url,this.headers,n,this.fetch)}}class mC extends dC{constructor(n,a,l,d){super(n,a,d),this.vectorBucketName=l}createIndex(n){const a=Object.create(null,{createIndex:{get:()=>super.createIndex}});return tt(this,void 0,void 0,function*(){return a.createIndex.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const n=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return tt(this,arguments,void 0,function*(a={}){return n.listIndexes.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName}))})}getIndex(n){const a=Object.create(null,{getIndex:{get:()=>super.getIndex}});return tt(this,void 0,void 0,function*(){return a.getIndex.call(this,this.vectorBucketName,n)})}deleteIndex(n){const a=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return tt(this,void 0,void 0,function*(){return a.deleteIndex.call(this,this.vectorBucketName,n)})}index(n){return new pC(this.url,this.headers,this.vectorBucketName,n,this.fetch)}}class pC extends hC{constructor(n,a,l,d,f){super(n,a,f),this.vectorBucketName=l,this.indexName=d}putVectors(n){const a=Object.create(null,{putVectors:{get:()=>super.putVectors}});return tt(this,void 0,void 0,function*(){return a.putVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(n){const a=Object.create(null,{getVectors:{get:()=>super.getVectors}});return tt(this,void 0,void 0,function*(){return a.getVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const n=Object.create(null,{listVectors:{get:()=>super.listVectors}});return tt(this,arguments,void 0,function*(a={}){return n.listVectors.call(this,Object.assign(Object.assign({},a),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(n){const a=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return tt(this,void 0,void 0,function*(){return a.queryVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(n){const a=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return tt(this,void 0,void 0,function*(){return a.deleteVectors.call(this,Object.assign(Object.assign({},n),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class xC extends aC{constructor(n,a={},l,d){super(n,a,l,d)}from(n){return new sC(this.url,this.headers,n,this.fetch)}get vectors(){return new gC(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new rC(this.url+"/iceberg",this.headers,this.fetch)}}const yC="2.83.0";let Yl="";typeof Deno<"u"?Yl="deno":typeof document<"u"?Yl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Yl="react-native":Yl="node";const wC={"X-Client-Info":`supabase-js-${Yl}/${yC}`},bC={headers:wC},vC={schema:"public"},CC={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},_C={},SC=i=>i?(...n)=>i(...n):(...n)=>fetch(...n),EC=()=>Headers,AC=(i,n,a)=>{const l=SC(a),d=EC();return async(f,x)=>{var v;const C=(v=await n())!==null&&v!==void 0?v:i;let w=new d(x?.headers);return w.has("apikey")||w.set("apikey",i),w.has("Authorization")||w.set("Authorization",`Bearer ${C}`),l(f,Object.assign(Object.assign({},x),{headers:w}))}};function NC(i){return i.endsWith("/")?i:i+"/"}function TC(i,n){var a,l;const{db:d,auth:f,realtime:x,global:v}=i,{db:C,auth:w,realtime:A,global:N}=n,R={db:Object.assign(Object.assign({},C),d),auth:Object.assign(Object.assign({},w),f),realtime:Object.assign(Object.assign({},A),x),storage:{},global:Object.assign(Object.assign(Object.assign({},N),v),{headers:Object.assign(Object.assign({},(a=N?.headers)!==null&&a!==void 0?a:{}),(l=v?.headers)!==null&&l!==void 0?l:{})}),accessToken:async()=>""};return i.accessToken?R.accessToken=i.accessToken:delete R.accessToken,R}function jC(i){const n=i?.trim();if(!n)throw new Error("supabaseUrl is required.");if(!n.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(NC(n))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const z2="2.83.0",zo=30*1e3,r0=3,gf=r0*zo,RC="http://localhost:9999",IC="supabase.auth.token",OC={"X-Client-Info":`gotrue-js/${z2}`},i0="X-Supabase-Api-Version",F2={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},MC=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,kC=600*1e3;class ec extends Error{constructor(n,a,l){super(n),this.__isAuthError=!0,this.name="AuthError",this.status=a,this.code=l}}function st(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class DC extends ec{constructor(n,a,l){super(n,a,l),this.name="AuthApiError",this.status=a,this.code=l}}function LC(i){return st(i)&&i.name==="AuthApiError"}class Hi extends ec{constructor(n,a){super(n),this.name="AuthUnknownError",this.originalError=a}}class di extends ec{constructor(n,a,l,d){super(n,l,d),this.name=a,this.status=l}}class na extends di{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function BC(i){return st(i)&&i.name==="AuthSessionMissingError"}class Mo extends di{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Iu extends di{constructor(n){super(n,"AuthInvalidCredentialsError",400,void 0)}}class Ou extends di{constructor(n,a=null){super(n,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function UC(i){return st(i)&&i.name==="AuthImplicitGrantRedirectError"}class vp extends di{constructor(n,a=null){super(n,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class o0 extends di{constructor(n,a){super(n,"AuthRetryableFetchError",a,void 0)}}function mf(i){return st(i)&&i.name==="AuthRetryableFetchError"}class Cp extends di{constructor(n,a,l){super(n,"AuthWeakPasswordError",a,"weak_password"),this.reasons=l}}class l0 extends di{constructor(n){super(n,"AuthInvalidJwtError",400,"invalid_jwt")}}const Hu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),_p=` 	
\r=`.split(""),PC=(()=>{const i=new Array(128);for(let n=0;n<i.length;n+=1)i[n]=-1;for(let n=0;n<_p.length;n+=1)i[_p[n].charCodeAt(0)]=-2;for(let n=0;n<Hu.length;n+=1)i[Hu[n].charCodeAt(0)]=n;return i})();function Sp(i,n,a){if(i!==null)for(n.queue=n.queue<<8|i,n.queuedBits+=8;n.queuedBits>=6;){const l=n.queue>>n.queuedBits-6&63;a(Hu[l]),n.queuedBits-=6}else if(n.queuedBits>0)for(n.queue=n.queue<<6-n.queuedBits,n.queuedBits=6;n.queuedBits>=6;){const l=n.queue>>n.queuedBits-6&63;a(Hu[l]),n.queuedBits-=6}}function H2(i,n,a){const l=PC[i];if(l>-1)for(n.queue=n.queue<<6|l,n.queuedBits+=6;n.queuedBits>=8;)a(n.queue>>n.queuedBits-8&255),n.queuedBits-=8;else{if(l===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(i)}"`)}}function Ep(i){const n=[],a=x=>{n.push(String.fromCodePoint(x))},l={utf8seq:0,codepoint:0},d={queue:0,queuedBits:0},f=x=>{HC(x,l,a)};for(let x=0;x<i.length;x+=1)H2(i.charCodeAt(x),d,f);return n.join("")}function zC(i,n){if(i<=127){n(i);return}else if(i<=2047){n(192|i>>6),n(128|i&63);return}else if(i<=65535){n(224|i>>12),n(128|i>>6&63),n(128|i&63);return}else if(i<=1114111){n(240|i>>18),n(128|i>>12&63),n(128|i>>6&63),n(128|i&63);return}throw new Error(`Unrecognized Unicode codepoint: ${i.toString(16)}`)}function FC(i,n){for(let a=0;a<i.length;a+=1){let l=i.charCodeAt(a);if(l>55295&&l<=56319){const d=(l-55296)*1024&65535;l=(i.charCodeAt(a+1)-56320&65535|d)+65536,a+=1}zC(l,n)}}function HC(i,n,a){if(n.utf8seq===0){if(i<=127){a(i);return}for(let l=1;l<6;l+=1)if((i>>7-l&1)===0){n.utf8seq=l;break}if(n.utf8seq===2)n.codepoint=i&31;else if(n.utf8seq===3)n.codepoint=i&15;else if(n.utf8seq===4)n.codepoint=i&7;else throw new Error("Invalid UTF-8 sequence");n.utf8seq-=1}else if(n.utf8seq>0){if(i<=127)throw new Error("Invalid UTF-8 sequence");n.codepoint=n.codepoint<<6|i&63,n.utf8seq-=1,n.utf8seq===0&&a(n.codepoint)}}function Vo(i){const n=[],a={queue:0,queuedBits:0},l=d=>{n.push(d)};for(let d=0;d<i.length;d+=1)H2(i.charCodeAt(d),a,l);return new Uint8Array(n)}function qC(i){const n=[];return FC(i,a=>n.push(a)),new Uint8Array(n)}function Vi(i){const n=[],a={queue:0,queuedBits:0},l=d=>{n.push(d)};return i.forEach(d=>Sp(d,a,l)),Sp(null,a,l),n.join("")}function VC(i){return Math.round(Date.now()/1e3)+i}function GC(){return Symbol("auth-callback")}const vs=()=>typeof window<"u"&&typeof document<"u",Li={tested:!1,writable:!1},q2=()=>{if(!vs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Li.tested)return Li.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Li.tested=!0,Li.writable=!0}catch{Li.tested=!0,Li.writable=!1}return Li.writable};function YC(i){const n={},a=new URL(i);if(a.hash&&a.hash[0]==="#")try{new URLSearchParams(a.hash.substring(1)).forEach((d,f)=>{n[f]=d})}catch{}return a.searchParams.forEach((l,d)=>{n[d]=l}),n}const V2=i=>i?(...n)=>i(...n):(...n)=>fetch(...n),XC=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",Fo=async(i,n,a)=>{await i.setItem(n,JSON.stringify(a))},Bi=async(i,n)=>{const a=await i.getItem(n);if(!a)return null;try{return JSON.parse(a)}catch{return a}},ai=async(i,n)=>{await i.removeItem(n)};class ed{constructor(){this.promise=new ed.promiseConstructor((n,a)=>{this.resolve=n,this.reject=a})}}ed.promiseConstructor=Promise;function pf(i){const n=i.split(".");if(n.length!==3)throw new l0("Invalid JWT structure");for(let l=0;l<n.length;l++)if(!MC.test(n[l]))throw new l0("JWT not in base64url format");return{header:JSON.parse(Ep(n[0])),payload:JSON.parse(Ep(n[1])),signature:Vo(n[2]),raw:{header:n[0],payload:n[1]}}}async function WC(i){return await new Promise(n=>{setTimeout(()=>n(null),i)})}function QC(i,n){return new Promise((l,d)=>{(async()=>{for(let f=0;f<1/0;f++)try{const x=await i(f);if(!n(f,null,x)){l(x);return}}catch(x){if(!n(f,x)){d(x);return}}})()})}function KC(i){return("0"+i.toString(16)).substr(-2)}function ZC(){const n=new Uint32Array(56);if(typeof crypto>"u"){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",l=a.length;let d="";for(let f=0;f<56;f++)d+=a.charAt(Math.floor(Math.random()*l));return d}return crypto.getRandomValues(n),Array.from(n,KC).join("")}async function $C(i){const a=new TextEncoder().encode(i),l=await crypto.subtle.digest("SHA-256",a),d=new Uint8Array(l);return Array.from(d).map(f=>String.fromCharCode(f)).join("")}async function JC(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const a=await $C(i);return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ko(i,n,a=!1){const l=ZC();let d=l;a&&(d+="/PASSWORD_RECOVERY"),await Fo(i,`${n}-code-verifier`,d);const f=await JC(l);return[f,l===f?"plain":"s256"]}const e3=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function t3(i){const n=i.headers.get(i0);if(!n||!n.match(e3))return null;try{return new Date(`${n}T00:00:00.0Z`)}catch{return null}}function n3(i){if(!i)throw new Error("Missing exp claim");const n=Math.floor(Date.now()/1e3);if(i<=n)throw new Error("JWT has expired")}function s3(i){switch(i){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const a3=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Do(i){if(!a3.test(i))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function xf(){const i={};return new Proxy(i,{get:(n,a)=>{if(a==="__isUserNotAvailableProxy")return!0;if(typeof a=="symbol"){const l=a.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${a}" property of the session object is not supported. Please use getUser() instead.`)},set:(n,a)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${a}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(n,a)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${a}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function r3(i,n){return new Proxy(i,{get:(a,l,d)=>{if(l==="__isInsecureUserWarningProxy")return!0;if(typeof l=="symbol"){const f=l.toString();if(f==="Symbol(Symbol.toPrimitive)"||f==="Symbol(Symbol.toStringTag)"||f==="Symbol(util.inspect.custom)"||f==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(a,l,d)}return!n.value&&typeof l=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),n.value=!0),Reflect.get(a,l,d)}})}function Ap(i){return JSON.parse(JSON.stringify(i))}const Pi=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),i3=[502,503,504];async function Np(i){var n;if(!XC(i))throw new o0(Pi(i),0);if(i3.includes(i.status))throw new o0(Pi(i),i.status);let a;try{a=await i.json()}catch(f){throw new Hi(Pi(f),f)}let l;const d=t3(i);if(d&&d.getTime()>=F2["2024-01-01"].timestamp&&typeof a=="object"&&a&&typeof a.code=="string"?l=a.code:typeof a=="object"&&a&&typeof a.error_code=="string"&&(l=a.error_code),l){if(l==="weak_password")throw new Cp(Pi(a),i.status,((n=a.weak_password)===null||n===void 0?void 0:n.reasons)||[]);if(l==="session_not_found")throw new na}else if(typeof a=="object"&&a&&typeof a.weak_password=="object"&&a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.reasons.reduce((f,x)=>f&&typeof x=="string",!0))throw new Cp(Pi(a),i.status,a.weak_password.reasons);throw new DC(Pi(a),i.status||500,l)}const o3=(i,n,a,l)=>{const d={method:i,headers:n?.headers||{}};return i==="GET"?d:(d.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},n?.headers),d.body=JSON.stringify(l),Object.assign(Object.assign({},d),a))};async function dt(i,n,a,l){var d;const f=Object.assign({},l?.headers);f[i0]||(f[i0]=F2["2024-01-01"].name),l?.jwt&&(f.Authorization=`Bearer ${l.jwt}`);const x=(d=l?.query)!==null&&d!==void 0?d:{};l?.redirectTo&&(x.redirect_to=l.redirectTo);const v=Object.keys(x).length?"?"+new URLSearchParams(x).toString():"",C=await l3(i,n,a+v,{headers:f,noResolveJson:l?.noResolveJson},{},l?.body);return l?.xform?l?.xform(C):{data:Object.assign({},C),error:null}}async function l3(i,n,a,l,d,f){const x=o3(n,l,d,f);let v;try{v=await i(a,Object.assign({},x))}catch(C){throw console.error(C),new o0(Pi(C),0)}if(v.ok||await Np(v),l?.noResolveJson)return v;try{return await v.json()}catch(C){await Np(C)}}function Ra(i){var n;let a=null;d3(i)&&(a=Object.assign({},i),i.expires_at||(a.expires_at=VC(i.expires_in)));const l=(n=i.user)!==null&&n!==void 0?n:i;return{data:{session:a,user:l},error:null}}function Tp(i){const n=Ra(i);return!n.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((a,l)=>a&&typeof l=="string",!0)&&(n.data.weak_password=i.weak_password),n}function li(i){var n;return{data:{user:(n=i.user)!==null&&n!==void 0?n:i},error:null}}function c3(i){return{data:i,error:null}}function u3(i){const{action_link:n,email_otp:a,hashed_token:l,redirect_to:d,verification_type:f}=i,x=Ko(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),v={action_link:n,email_otp:a,hashed_token:l,redirect_to:d,verification_type:f},C=Object.assign({},x);return{data:{properties:v,user:C},error:null}}function jp(i){return i}function d3(i){return i.access_token&&i.refresh_token&&i.expires_in}const yf=["global","local","others"];class h3{constructor({url:n="",headers:a={},fetch:l}){this.url=n,this.headers=a,this.fetch=V2(l),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(n,a=yf[0]){if(yf.indexOf(a)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${yf.join(", ")}`);try{return await dt(this.fetch,"POST",`${this.url}/logout?scope=${a}`,{headers:this.headers,jwt:n,noResolveJson:!0}),{data:null,error:null}}catch(l){if(st(l))return{data:null,error:l};throw l}}async inviteUserByEmail(n,a={}){try{return await dt(this.fetch,"POST",`${this.url}/invite`,{body:{email:n,data:a.data},headers:this.headers,redirectTo:a.redirectTo,xform:li})}catch(l){if(st(l))return{data:{user:null},error:l};throw l}}async generateLink(n){try{const{options:a}=n,l=Ko(n,["options"]),d=Object.assign(Object.assign({},l),a);return"newEmail"in l&&(d.new_email=l?.newEmail,delete d.newEmail),await dt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:d,headers:this.headers,xform:u3,redirectTo:a?.redirectTo})}catch(a){if(st(a))return{data:{properties:null,user:null},error:a};throw a}}async createUser(n){try{return await dt(this.fetch,"POST",`${this.url}/admin/users`,{body:n,headers:this.headers,xform:li})}catch(a){if(st(a))return{data:{user:null},error:a};throw a}}async listUsers(n){var a,l,d,f,x,v,C;try{const w={nextPage:null,lastPage:0,total:0},A=await dt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(a=n?.page)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:"",per_page:(f=(d=n?.perPage)===null||d===void 0?void 0:d.toString())!==null&&f!==void 0?f:""},xform:jp});if(A.error)throw A.error;const N=await A.json(),R=(x=A.headers.get("x-total-count"))!==null&&x!==void 0?x:0,T=(C=(v=A.headers.get("link"))===null||v===void 0?void 0:v.split(","))!==null&&C!==void 0?C:[];return T.length>0&&(T.forEach(O=>{const L=parseInt(O.split(";")[0].split("=")[1].substring(0,1)),B=JSON.parse(O.split(";")[1].split("=")[1]);w[`${B}Page`]=L}),w.total=parseInt(R)),{data:Object.assign(Object.assign({},N),w),error:null}}catch(w){if(st(w))return{data:{users:[]},error:w};throw w}}async getUserById(n){Do(n);try{return await dt(this.fetch,"GET",`${this.url}/admin/users/${n}`,{headers:this.headers,xform:li})}catch(a){if(st(a))return{data:{user:null},error:a};throw a}}async updateUserById(n,a){Do(n);try{return await dt(this.fetch,"PUT",`${this.url}/admin/users/${n}`,{body:a,headers:this.headers,xform:li})}catch(l){if(st(l))return{data:{user:null},error:l};throw l}}async deleteUser(n,a=!1){Do(n);try{return await dt(this.fetch,"DELETE",`${this.url}/admin/users/${n}`,{headers:this.headers,body:{should_soft_delete:a},xform:li})}catch(l){if(st(l))return{data:{user:null},error:l};throw l}}async _listFactors(n){Do(n.userId);try{const{data:a,error:l}=await dt(this.fetch,"GET",`${this.url}/admin/users/${n.userId}/factors`,{headers:this.headers,xform:d=>({data:{factors:d},error:null})});return{data:a,error:l}}catch(a){if(st(a))return{data:null,error:a};throw a}}async _deleteFactor(n){Do(n.userId),Do(n.id);try{return{data:await dt(this.fetch,"DELETE",`${this.url}/admin/users/${n.userId}/factors/${n.id}`,{headers:this.headers}),error:null}}catch(a){if(st(a))return{data:null,error:a};throw a}}async _listOAuthClients(n){var a,l,d,f,x,v,C;try{const w={nextPage:null,lastPage:0,total:0},A=await dt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(l=(a=n?.page)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:"",per_page:(f=(d=n?.perPage)===null||d===void 0?void 0:d.toString())!==null&&f!==void 0?f:""},xform:jp});if(A.error)throw A.error;const N=await A.json(),R=(x=A.headers.get("x-total-count"))!==null&&x!==void 0?x:0,T=(C=(v=A.headers.get("link"))===null||v===void 0?void 0:v.split(","))!==null&&C!==void 0?C:[];return T.length>0&&(T.forEach(O=>{const L=parseInt(O.split(";")[0].split("=")[1].substring(0,1)),B=JSON.parse(O.split(";")[1].split("=")[1]);w[`${B}Page`]=L}),w.total=parseInt(R)),{data:Object.assign(Object.assign({},N),w),error:null}}catch(w){if(st(w))return{data:{clients:[]},error:w};throw w}}async _createOAuthClient(n){try{return await dt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:n,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(st(a))return{data:null,error:a};throw a}}async _getOAuthClient(n){try{return await dt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${n}`,{headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(st(a))return{data:null,error:a};throw a}}async _updateOAuthClient(n,a){try{return await dt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${n}`,{body:a,headers:this.headers,xform:l=>({data:l,error:null})})}catch(l){if(st(l))return{data:null,error:l};throw l}}async _deleteOAuthClient(n){try{return await dt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${n}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(a){if(st(a))return{data:null,error:a};throw a}}async _regenerateOAuthClientSecret(n){try{return await dt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${n}/regenerate_secret`,{headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(st(a))return{data:null,error:a};throw a}}}function Rp(i={}){return{getItem:n=>i[n]||null,setItem:(n,a)=>{i[n]=a},removeItem:n=>{delete i[n]}}}const Lo={debug:!!(globalThis&&q2()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class G2 extends Error{constructor(n){super(n),this.isAcquireTimeout=!0}}class f3 extends G2{}async function g3(i,n,a){Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,n);const l=new globalThis.AbortController;return n>0&&setTimeout(()=>{l.abort(),Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},n),await Promise.resolve().then(()=>globalThis.navigator.locks.request(i,n===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:l.signal},async d=>{if(d){Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,d.name);try{return await a()}finally{Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,d.name)}}else{if(n===0)throw Lo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new f3(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(Lo.debug)try{const f=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(f,null,"  "))}catch(f){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",f)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await a()}}))}function m3(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Y2(i){if(!/^0x[a-fA-F0-9]{40}$/.test(i))throw new Error(`@supabase/auth-js: Address "${i}" is invalid.`);return i.toLowerCase()}function p3(i){return parseInt(i,16)}function x3(i){const n=new TextEncoder().encode(i);return"0x"+Array.from(n,l=>l.toString(16).padStart(2,"0")).join("")}function y3(i){var n;const{chainId:a,domain:l,expirationTime:d,issuedAt:f=new Date,nonce:x,notBefore:v,requestId:C,resources:w,scheme:A,uri:N,version:R}=i;{if(!Number.isInteger(a))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${a}`);if(!l)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(x&&x.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${x}`);if(!N)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(R!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${R}`);if(!((n=i.statement)===null||n===void 0)&&n.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${i.statement}`)}const T=Y2(i.address),O=A?`${A}://${l}`:l,L=i.statement?`${i.statement}
`:"",B=`${O} wants you to sign in with your Ethereum account:
${T}

${L}`;let H=`URI: ${N}
Version: ${R}
Chain ID: ${a}${x?`
Nonce: ${x}`:""}
Issued At: ${f.toISOString()}`;if(d&&(H+=`
Expiration Time: ${d.toISOString()}`),v&&(H+=`
Not Before: ${v.toISOString()}`),C&&(H+=`
Request ID: ${C}`),w){let U=`
Resources:`;for(const P of w){if(!P||typeof P!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${P}`);U+=`
- ${P}`}H+=U}return`${B}
${H}`}class es extends Error{constructor({message:n,code:a,cause:l,name:d}){var f;super(n,{cause:l}),this.__isWebAuthnError=!0,this.name=(f=d??(l instanceof Error?l.name:void 0))!==null&&f!==void 0?f:"Unknown Error",this.code=a}}class qu extends es{constructor(n,a){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a,message:n}),this.name="WebAuthnUnknownError",this.originalError=a}}function w3({error:i,options:n}){var a,l,d;const{publicKey:f}=n;if(!f)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(n.signal instanceof AbortSignal)return new es({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else if(i.name==="ConstraintError"){if(((a=f.authenticatorSelection)===null||a===void 0?void 0:a.requireResidentKey)===!0)return new es({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:i});if(n.mediation==="conditional"&&((l=f.authenticatorSelection)===null||l===void 0?void 0:l.userVerification)==="required")return new es({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:i});if(((d=f.authenticatorSelection)===null||d===void 0?void 0:d.userVerification)==="required")return new es({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:i})}else{if(i.name==="InvalidStateError")return new es({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:i});if(i.name==="NotAllowedError")return new es({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="NotSupportedError")return f.pubKeyCredParams.filter(v=>v.type==="public-key").length===0?new es({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:i}):new es({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:i});if(i.name==="SecurityError"){const x=window.location.hostname;if(X2(x)){if(f.rp.id!==x)return new es({message:`The RP ID "${f.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new es({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="TypeError"){if(f.user.id.byteLength<1||f.user.id.byteLength>64)return new es({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:i})}else if(i.name==="UnknownError")return new es({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new es({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}function b3({error:i,options:n}){const{publicKey:a}=n;if(!a)throw Error("options was missing required publicKey property");if(i.name==="AbortError"){if(n.signal instanceof AbortSignal)return new es({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:i})}else{if(i.name==="NotAllowedError")return new es({message:i.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i});if(i.name==="SecurityError"){const l=window.location.hostname;if(X2(l)){if(a.rpId!==l)return new es({message:`The RP ID "${a.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:i})}else return new es({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:i})}else if(i.name==="UnknownError")return new es({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:i})}return new es({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:i})}class v3{createNewAbortSignal(){if(this.controller){const a=new Error("Cancelling existing WebAuthn API call for new one");a.name="AbortError",this.controller.abort(a)}const n=new AbortController;return this.controller=n,n.signal}cancelCeremony(){if(this.controller){const n=new Error("Manually cancelling existing WebAuthn API call");n.name="AbortError",this.controller.abort(n),this.controller=void 0}}}const C3=new v3;function _3(i){if(!i)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(i);const{challenge:n,user:a,excludeCredentials:l}=i,d=Ko(i,["challenge","user","excludeCredentials"]),f=Vo(n).buffer,x=Object.assign(Object.assign({},a),{id:Vo(a.id).buffer}),v=Object.assign(Object.assign({},d),{challenge:f,user:x});if(l&&l.length>0){v.excludeCredentials=new Array(l.length);for(let C=0;C<l.length;C++){const w=l[C];v.excludeCredentials[C]=Object.assign(Object.assign({},w),{id:Vo(w.id).buffer,type:w.type||"public-key",transports:w.transports})}}return v}function S3(i){if(!i)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(i);const{challenge:n,allowCredentials:a}=i,l=Ko(i,["challenge","allowCredentials"]),d=Vo(n).buffer,f=Object.assign(Object.assign({},l),{challenge:d});if(a&&a.length>0){f.allowCredentials=new Array(a.length);for(let x=0;x<a.length;x++){const v=a[x];f.allowCredentials[x]=Object.assign(Object.assign({},v),{id:Vo(v.id).buffer,type:v.type||"public-key",transports:v.transports})}}return f}function E3(i){var n;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const a=i;return{id:i.id,rawId:i.id,response:{attestationObject:Vi(new Uint8Array(i.response.attestationObject)),clientDataJSON:Vi(new Uint8Array(i.response.clientDataJSON))},type:"public-key",clientExtensionResults:i.getClientExtensionResults(),authenticatorAttachment:(n=a.authenticatorAttachment)!==null&&n!==void 0?n:void 0}}function A3(i){var n;if("toJSON"in i&&typeof i.toJSON=="function")return i.toJSON();const a=i,l=i.getClientExtensionResults(),d=i.response;return{id:i.id,rawId:i.id,response:{authenticatorData:Vi(new Uint8Array(d.authenticatorData)),clientDataJSON:Vi(new Uint8Array(d.clientDataJSON)),signature:Vi(new Uint8Array(d.signature)),userHandle:d.userHandle?Vi(new Uint8Array(d.userHandle)):void 0},type:"public-key",clientExtensionResults:l,authenticatorAttachment:(n=a.authenticatorAttachment)!==null&&n!==void 0?n:void 0}}function X2(i){return i==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(i)}function Ip(){var i,n;return!!(vs()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((i=navigator?.credentials)===null||i===void 0?void 0:i.create)=="function"&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.get)=="function")}async function N3(i){try{const n=await navigator.credentials.create(i);return n?n instanceof PublicKeyCredential?{data:n,error:null}:{data:null,error:new qu("Browser returned unexpected credential type",n)}:{data:null,error:new qu("Empty credential response",n)}}catch(n){return{data:null,error:w3({error:n,options:i})}}}async function T3(i){try{const n=await navigator.credentials.get(i);return n?n instanceof PublicKeyCredential?{data:n,error:null}:{data:null,error:new qu("Browser returned unexpected credential type",n)}:{data:null,error:new qu("Empty credential response",n)}}catch(n){return{data:null,error:b3({error:n,options:i})}}}const j3={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},R3={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Vu(...i){const n=d=>d!==null&&typeof d=="object"&&!Array.isArray(d),a=d=>d instanceof ArrayBuffer||ArrayBuffer.isView(d),l={};for(const d of i)if(d)for(const f in d){const x=d[f];if(x!==void 0)if(Array.isArray(x))l[f]=x;else if(a(x))l[f]=x;else if(n(x)){const v=l[f];n(v)?l[f]=Vu(v,x):l[f]=Vu(x)}else l[f]=x}return l}function I3(i,n){return Vu(j3,i,n||{})}function O3(i,n){return Vu(R3,i,n||{})}class M3{constructor(n){this.client=n,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(n){return this.client.mfa.enroll(Object.assign(Object.assign({},n),{factorType:"webauthn"}))}async _challenge({factorId:n,webauthn:a,friendlyName:l,signal:d},f){try{const{data:x,error:v}=await this.client.mfa.challenge({factorId:n,webauthn:a});if(!x)return{data:null,error:v};const C=d??C3.createNewAbortSignal();if(x.webauthn.type==="create"){const{user:w}=x.webauthn.credential_options.publicKey;w.name||(w.name=`${w.id}:${l}`),w.displayName||(w.displayName=w.name)}switch(x.webauthn.type){case"create":{const w=I3(x.webauthn.credential_options.publicKey,f?.create),{data:A,error:N}=await N3({publicKey:w,signal:C});return A?{data:{factorId:n,challengeId:x.id,webauthn:{type:x.webauthn.type,credential_response:A}},error:null}:{data:null,error:N}}case"request":{const w=O3(x.webauthn.credential_options.publicKey,f?.request),{data:A,error:N}=await T3(Object.assign(Object.assign({},x.webauthn.credential_options),{publicKey:w,signal:C}));return A?{data:{factorId:n,challengeId:x.id,webauthn:{type:x.webauthn.type,credential_response:A}},error:null}:{data:null,error:N}}}}catch(x){return st(x)?{data:null,error:x}:{data:null,error:new Hi("Unexpected error in challenge",x)}}}async _verify({challengeId:n,factorId:a,webauthn:l}){return this.client.mfa.verify({factorId:a,challengeId:n,webauthn:l})}async _authenticate({factorId:n,webauthn:{rpId:a=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:d}={}},f){if(!a)return{data:null,error:new ec("rpId is required for WebAuthn authentication")};try{if(!Ip())return{data:null,error:new Hi("Browser does not support WebAuthn",null)};const{data:x,error:v}=await this.challenge({factorId:n,webauthn:{rpId:a,rpOrigins:l},signal:d},{request:f});if(!x)return{data:null,error:v};const{webauthn:C}=x;return this._verify({factorId:n,challengeId:x.challengeId,webauthn:{type:C.type,rpId:a,rpOrigins:l,credential_response:C.credential_response}})}catch(x){return st(x)?{data:null,error:x}:{data:null,error:new Hi("Unexpected error in authenticate",x)}}}async _register({friendlyName:n,webauthn:{rpId:a=typeof window<"u"?window.location.hostname:void 0,rpOrigins:l=typeof window<"u"?[window.location.origin]:void 0,signal:d}={}},f){if(!a)return{data:null,error:new ec("rpId is required for WebAuthn registration")};try{if(!Ip())return{data:null,error:new Hi("Browser does not support WebAuthn",null)};const{data:x,error:v}=await this._enroll({friendlyName:n});if(!x)return await this.client.mfa.listFactors().then(A=>{var N;return(N=A.data)===null||N===void 0?void 0:N.all.find(R=>R.factor_type==="webauthn"&&R.friendly_name===n&&R.status!=="unverified")}).then(A=>A?this.client.mfa.unenroll({factorId:A?.id}):void 0),{data:null,error:v};const{data:C,error:w}=await this._challenge({factorId:x.id,friendlyName:x.friendly_name,webauthn:{rpId:a,rpOrigins:l},signal:d},{create:f});return C?this._verify({factorId:x.id,challengeId:C.challengeId,webauthn:{rpId:a,rpOrigins:l,type:C.webauthn.type,credential_response:C.webauthn.credential_response}}):{data:null,error:w}}catch(x){return st(x)?{data:null,error:x}:{data:null,error:new Hi("Unexpected error in register",x)}}}}m3();const k3={url:RC,storageKey:IC,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:OC,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Op(i,n,a){return await a()}const Bo={};class tc{get jwks(){var n,a;return(a=(n=Bo[this.storageKey])===null||n===void 0?void 0:n.jwks)!==null&&a!==void 0?a:{keys:[]}}set jwks(n){Bo[this.storageKey]=Object.assign(Object.assign({},Bo[this.storageKey]),{jwks:n})}get jwks_cached_at(){var n,a;return(a=(n=Bo[this.storageKey])===null||n===void 0?void 0:n.cachedAt)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER}set jwks_cached_at(n){Bo[this.storageKey]=Object.assign(Object.assign({},Bo[this.storageKey]),{cachedAt:n})}constructor(n){var a,l,d;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const f=Object.assign(Object.assign({},k3),n);if(this.storageKey=f.storageKey,this.instanceID=(a=tc.nextInstanceID[this.storageKey])!==null&&a!==void 0?a:0,tc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!f.debug,typeof f.debug=="function"&&(this.logger=f.debug),this.instanceID>0&&vs()){const x=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(x),this.logDebugMessages&&console.trace(x)}if(this.persistSession=f.persistSession,this.autoRefreshToken=f.autoRefreshToken,this.admin=new h3({url:f.url,headers:f.headers,fetch:f.fetch}),this.url=f.url,this.headers=f.headers,this.fetch=V2(f.fetch),this.lock=f.lock||Op,this.detectSessionInUrl=f.detectSessionInUrl,this.flowType=f.flowType,this.hasCustomAuthorizationHeader=f.hasCustomAuthorizationHeader,this.throwOnError=f.throwOnError,f.lock?this.lock=f.lock:vs()&&(!((l=globalThis?.navigator)===null||l===void 0)&&l.locks)?this.lock=g3:this.lock=Op,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new M3(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(f.storage?this.storage=f.storage:q2()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Rp(this.memoryStorage)),f.userStorage&&(this.userStorage=f.userStorage)):(this.memoryStorage={},this.storage=Rp(this.memoryStorage)),vs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(x){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",x)}(d=this.broadcastChannel)===null||d===void 0||d.addEventListener("message",async x=>{this._debug("received broadcast notification from other tab or client",x),await this._notifyAllSubscribers(x.data.event,x.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(n){if(this.throwOnError&&n&&n.error)throw n.error;return n}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${z2}) ${new Date().toISOString()}`}_debug(...n){return this.logDebugMessages&&this.logger(this._logPrefix(),...n),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var n;try{let a={},l="none";if(vs()&&(a=YC(window.location.href),this._isImplicitGrantCallback(a)?l="implicit":await this._isPKCECallback(a)&&(l="pkce")),vs()&&this.detectSessionInUrl&&l!=="none"){const{data:d,error:f}=await this._getSessionFromURL(a,l);if(f){if(this._debug("#_initialize()","error detecting session from URL",f),UC(f)){const C=(n=f.details)===null||n===void 0?void 0:n.code;if(C==="identity_already_exists"||C==="identity_not_found"||C==="single_identity_not_deletable")return{error:f}}return await this._removeSession(),{error:f}}const{session:x,redirectType:v}=d;return this._debug("#_initialize()","detected session in URL",x,"redirect type",v),await this._saveSession(x),setTimeout(async()=>{v==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",x):await this._notifyAllSubscribers("SIGNED_IN",x)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(a){return st(a)?this._returnResult({error:a}):this._returnResult({error:new Hi("Unexpected error during initialization",a)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(n){var a,l,d;try{const f=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(l=(a=n?.options)===null||a===void 0?void 0:a.data)!==null&&l!==void 0?l:{},gotrue_meta_security:{captcha_token:(d=n?.options)===null||d===void 0?void 0:d.captchaToken}},xform:Ra}),{data:x,error:v}=f;if(v||!x)return this._returnResult({data:{user:null,session:null},error:v});const C=x.session,w=x.user;return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",C)),this._returnResult({data:{user:w,session:C},error:null})}catch(f){if(st(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async signUp(n){var a,l,d;try{let f;if("email"in n){const{email:A,password:N,options:R}=n;let T=null,O=null;this.flowType==="pkce"&&([T,O]=await ko(this.storage,this.storageKey)),f=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:R?.emailRedirectTo,body:{email:A,password:N,data:(a=R?.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:R?.captchaToken},code_challenge:T,code_challenge_method:O},xform:Ra})}else if("phone"in n){const{phone:A,password:N,options:R}=n;f=await dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:A,password:N,data:(l=R?.data)!==null&&l!==void 0?l:{},channel:(d=R?.channel)!==null&&d!==void 0?d:"sms",gotrue_meta_security:{captcha_token:R?.captchaToken}},xform:Ra})}else throw new Iu("You must provide either an email or phone number and a password");const{data:x,error:v}=f;if(v||!x)return this._returnResult({data:{user:null,session:null},error:v});const C=x.session,w=x.user;return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",C)),this._returnResult({data:{user:w,session:C},error:null})}catch(f){if(st(f))return this._returnResult({data:{user:null,session:null},error:f});throw f}}async signInWithPassword(n){try{let a;if("email"in n){const{email:f,password:x,options:v}=n;a=await dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:f,password:x,gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:Tp})}else if("phone"in n){const{phone:f,password:x,options:v}=n;a=await dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:f,password:x,gotrue_meta_security:{captcha_token:v?.captchaToken}},xform:Tp})}else throw new Iu("You must provide either an email or phone number and a password");const{data:l,error:d}=a;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!l||!l.session||!l.user){const f=new Mo;return this._returnResult({data:{user:null,session:null},error:f})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign({user:l.user,session:l.session},l.weak_password?{weakPassword:l.weak_password}:null),error:d})}catch(a){if(st(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithOAuth(n){var a,l,d,f;return await this._handleProviderSignIn(n.provider,{redirectTo:(a=n.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=n.options)===null||l===void 0?void 0:l.scopes,queryParams:(d=n.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:(f=n.options)===null||f===void 0?void 0:f.skipBrowserRedirect})}async exchangeCodeForSession(n){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(n))}async signInWithWeb3(n){const{chain:a}=n;switch(a){case"ethereum":return await this.signInWithEthereum(n);case"solana":return await this.signInWithSolana(n);default:throw new Error(`@supabase/auth-js: Unsupported chain "${a}"`)}}async signInWithEthereum(n){var a,l,d,f,x,v,C,w,A,N,R;let T,O;if("message"in n)T=n.message,O=n.signature;else{const{chain:L,wallet:B,statement:H,options:U}=n;let P;if(vs())if(typeof B=="object")P=B;else{const q=window;if("ethereum"in q&&typeof q.ethereum=="object"&&"request"in q.ethereum&&typeof q.ethereum.request=="function")P=q.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof B!="object"||!U?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");P=B}const K=new URL((a=U?.url)!==null&&a!==void 0?a:window.location.href),Z=await P.request({method:"eth_requestAccounts"}).then(q=>q).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!Z||Z.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const W=Y2(Z[0]);let X=(l=U?.signInWithEthereum)===null||l===void 0?void 0:l.chainId;if(!X){const q=await P.request({method:"eth_chainId"});X=p3(q)}const J={domain:K.host,address:W,statement:H,uri:K.href,version:"1",chainId:X,nonce:(d=U?.signInWithEthereum)===null||d===void 0?void 0:d.nonce,issuedAt:(x=(f=U?.signInWithEthereum)===null||f===void 0?void 0:f.issuedAt)!==null&&x!==void 0?x:new Date,expirationTime:(v=U?.signInWithEthereum)===null||v===void 0?void 0:v.expirationTime,notBefore:(C=U?.signInWithEthereum)===null||C===void 0?void 0:C.notBefore,requestId:(w=U?.signInWithEthereum)===null||w===void 0?void 0:w.requestId,resources:(A=U?.signInWithEthereum)===null||A===void 0?void 0:A.resources};T=y3(J),O=await P.request({method:"personal_sign",params:[x3(T),W]})}try{const{data:L,error:B}=await dt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:T,signature:O},!((N=n.options)===null||N===void 0)&&N.captchaToken?{gotrue_meta_security:{captcha_token:(R=n.options)===null||R===void 0?void 0:R.captchaToken}}:null),xform:Ra});if(B)throw B;if(!L||!L.session||!L.user){const H=new Mo;return this._returnResult({data:{user:null,session:null},error:H})}return L.session&&(await this._saveSession(L.session),await this._notifyAllSubscribers("SIGNED_IN",L.session)),this._returnResult({data:Object.assign({},L),error:B})}catch(L){if(st(L))return this._returnResult({data:{user:null,session:null},error:L});throw L}}async signInWithSolana(n){var a,l,d,f,x,v,C,w,A,N,R,T;let O,L;if("message"in n)O=n.message,L=n.signature;else{const{chain:B,wallet:H,statement:U,options:P}=n;let K;if(vs())if(typeof H=="object")K=H;else{const W=window;if("solana"in W&&typeof W.solana=="object"&&("signIn"in W.solana&&typeof W.solana.signIn=="function"||"signMessage"in W.solana&&typeof W.solana.signMessage=="function"))K=W.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof H!="object"||!P?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");K=H}const Z=new URL((a=P?.url)!==null&&a!==void 0?a:window.location.href);if("signIn"in K&&K.signIn){const W=await K.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},P?.signInWithSolana),{version:"1",domain:Z.host,uri:Z.href}),U?{statement:U}:null));let X;if(Array.isArray(W)&&W[0]&&typeof W[0]=="object")X=W[0];else if(W&&typeof W=="object"&&"signedMessage"in W&&"signature"in W)X=W;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in X&&"signature"in X&&(typeof X.signedMessage=="string"||X.signedMessage instanceof Uint8Array)&&X.signature instanceof Uint8Array)O=typeof X.signedMessage=="string"?X.signedMessage:new TextDecoder().decode(X.signedMessage),L=X.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in K)||typeof K.signMessage!="function"||!("publicKey"in K)||typeof K!="object"||!K.publicKey||!("toBase58"in K.publicKey)||typeof K.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");O=[`${Z.host} wants you to sign in with your Solana account:`,K.publicKey.toBase58(),...U?["",U,""]:[""],"Version: 1",`URI: ${Z.href}`,`Issued At: ${(d=(l=P?.signInWithSolana)===null||l===void 0?void 0:l.issuedAt)!==null&&d!==void 0?d:new Date().toISOString()}`,...!((f=P?.signInWithSolana)===null||f===void 0)&&f.notBefore?[`Not Before: ${P.signInWithSolana.notBefore}`]:[],...!((x=P?.signInWithSolana)===null||x===void 0)&&x.expirationTime?[`Expiration Time: ${P.signInWithSolana.expirationTime}`]:[],...!((v=P?.signInWithSolana)===null||v===void 0)&&v.chainId?[`Chain ID: ${P.signInWithSolana.chainId}`]:[],...!((C=P?.signInWithSolana)===null||C===void 0)&&C.nonce?[`Nonce: ${P.signInWithSolana.nonce}`]:[],...!((w=P?.signInWithSolana)===null||w===void 0)&&w.requestId?[`Request ID: ${P.signInWithSolana.requestId}`]:[],...!((N=(A=P?.signInWithSolana)===null||A===void 0?void 0:A.resources)===null||N===void 0)&&N.length?["Resources",...P.signInWithSolana.resources.map(X=>`- ${X}`)]:[]].join(`
`);const W=await K.signMessage(new TextEncoder().encode(O),"utf8");if(!W||!(W instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");L=W}}try{const{data:B,error:H}=await dt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:O,signature:Vi(L)},!((R=n.options)===null||R===void 0)&&R.captchaToken?{gotrue_meta_security:{captcha_token:(T=n.options)===null||T===void 0?void 0:T.captchaToken}}:null),xform:Ra});if(H)throw H;if(!B||!B.session||!B.user){const U=new Mo;return this._returnResult({data:{user:null,session:null},error:U})}return B.session&&(await this._saveSession(B.session),await this._notifyAllSubscribers("SIGNED_IN",B.session)),this._returnResult({data:Object.assign({},B),error:H})}catch(B){if(st(B))return this._returnResult({data:{user:null,session:null},error:B});throw B}}async _exchangeCodeForSession(n){const a=await Bi(this.storage,`${this.storageKey}-code-verifier`),[l,d]=(a??"").split("/");try{const{data:f,error:x}=await dt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:n,code_verifier:l},xform:Ra});if(await ai(this.storage,`${this.storageKey}-code-verifier`),x)throw x;if(!f||!f.session||!f.user){const v=new Mo;return this._returnResult({data:{user:null,session:null,redirectType:null},error:v})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:Object.assign(Object.assign({},f),{redirectType:d??null}),error:x})}catch(f){if(st(f))return this._returnResult({data:{user:null,session:null,redirectType:null},error:f});throw f}}async signInWithIdToken(n){try{const{options:a,provider:l,token:d,access_token:f,nonce:x}=n,v=await dt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:l,id_token:d,access_token:f,nonce:x,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Ra}),{data:C,error:w}=v;if(w)return this._returnResult({data:{user:null,session:null},error:w});if(!C||!C.session||!C.user){const A=new Mo;return this._returnResult({data:{user:null,session:null},error:A})}return C.session&&(await this._saveSession(C.session),await this._notifyAllSubscribers("SIGNED_IN",C.session)),this._returnResult({data:C,error:w})}catch(a){if(st(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithOtp(n){var a,l,d,f,x;try{if("email"in n){const{email:v,options:C}=n;let w=null,A=null;this.flowType==="pkce"&&([w,A]=await ko(this.storage,this.storageKey));const{error:N}=await dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:v,data:(a=C?.data)!==null&&a!==void 0?a:{},create_user:(l=C?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:C?.captchaToken},code_challenge:w,code_challenge_method:A},redirectTo:C?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:N})}if("phone"in n){const{phone:v,options:C}=n,{data:w,error:A}=await dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:v,data:(d=C?.data)!==null&&d!==void 0?d:{},create_user:(f=C?.shouldCreateUser)!==null&&f!==void 0?f:!0,gotrue_meta_security:{captcha_token:C?.captchaToken},channel:(x=C?.channel)!==null&&x!==void 0?x:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:w?.message_id},error:A})}throw new Iu("You must provide either an email or phone number.")}catch(v){if(st(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async verifyOtp(n){var a,l;try{let d,f;"options"in n&&(d=(a=n.options)===null||a===void 0?void 0:a.redirectTo,f=(l=n.options)===null||l===void 0?void 0:l.captchaToken);const{data:x,error:v}=await dt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},n),{gotrue_meta_security:{captcha_token:f}}),redirectTo:d,xform:Ra});if(v)throw v;if(!x)throw new Error("An error occurred on token verification.");const C=x.session,w=x.user;return C?.access_token&&(await this._saveSession(C),await this._notifyAllSubscribers(n.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",C)),this._returnResult({data:{user:w,session:C},error:null})}catch(d){if(st(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async signInWithSSO(n){var a,l,d,f,x;try{let v=null,C=null;this.flowType==="pkce"&&([v,C]=await ko(this.storage,this.storageKey));const w=await dt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in n?{provider_id:n.providerId}:null),"domain"in n?{domain:n.domain}:null),{redirect_to:(l=(a=n.options)===null||a===void 0?void 0:a.redirectTo)!==null&&l!==void 0?l:void 0}),!((d=n?.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:n.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:v,code_challenge_method:C}),headers:this.headers,xform:c3});return!((f=w.data)===null||f===void 0)&&f.url&&vs()&&!(!((x=n.options)===null||x===void 0)&&x.skipBrowserRedirect)&&window.location.assign(w.data.url),this._returnResult(w)}catch(v){if(st(v))return this._returnResult({data:null,error:v});throw v}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async n=>{const{data:{session:a},error:l}=n;if(l)throw l;if(!a)throw new na;const{error:d}=await dt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:a.access_token});return this._returnResult({data:{user:null,session:null},error:d})})}catch(n){if(st(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async resend(n){try{const a=`${this.url}/resend`;if("email"in n){const{email:l,type:d,options:f}=n,{error:x}=await dt(this.fetch,"POST",a,{headers:this.headers,body:{email:l,type:d,gotrue_meta_security:{captcha_token:f?.captchaToken}},redirectTo:f?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:x})}else if("phone"in n){const{phone:l,type:d,options:f}=n,{data:x,error:v}=await dt(this.fetch,"POST",a,{headers:this.headers,body:{phone:l,type:d,gotrue_meta_security:{captcha_token:f?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:x?.message_id},error:v})}throw new Iu("You must provide either an email or phone number and a type")}catch(a){if(st(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async a=>a))}async _acquireLock(n,a){this._debug("#_acquireLock","begin",n);try{if(this.lockAcquired){const l=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),d=(async()=>(await l,await a()))();return this.pendingInLock.push((async()=>{try{await d}catch{}})()),d}return await this.lock(`lock:${this.storageKey}`,n,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const l=a();for(this.pendingInLock.push((async()=>{try{await l}catch{}})()),await l;this.pendingInLock.length;){const d=[...this.pendingInLock];await Promise.all(d),this.pendingInLock.splice(0,d.length)}return await l}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(n){this._debug("#_useSession","begin");try{const a=await this.__loadSession();return await n(a)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let n=null;const a=await Bi(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",a),a!==null&&(this._isValidSession(a)?n=a:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!n)return{data:{session:null},error:null};const l=n.expires_at?n.expires_at*1e3-Date.now()<gf:!1;if(this._debug("#__loadSession()",`session has${l?"":" not"} expired`,"expires_at",n.expires_at),!l){if(this.userStorage){const x=await Bi(this.userStorage,this.storageKey+"-user");x?.user?n.user=x.user:n.user=xf()}if(this.storage.isServer&&n.user&&!n.user.__isUserNotAvailableProxy){const x={value:this.suppressGetSessionWarning};n.user=r3(n.user,x),x.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:n},error:null}}const{data:d,error:f}=await this._callRefreshToken(n.refresh_token);return f?this._returnResult({data:{session:null},error:f}):this._returnResult({data:{session:d},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(n){return n?await this._getUser(n):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(n){try{return n?await dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:n,xform:li}):await this._useSession(async a=>{var l,d,f;const{data:x,error:v}=a;if(v)throw v;return!(!((l=x.session)===null||l===void 0)&&l.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new na}:await dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(f=(d=x.session)===null||d===void 0?void 0:d.access_token)!==null&&f!==void 0?f:void 0,xform:li})})}catch(a){if(st(a))return BC(a)&&(await this._removeSession(),await ai(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:a});throw a}}async updateUser(n,a={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(n,a))}async _updateUser(n,a={}){try{return await this._useSession(async l=>{const{data:d,error:f}=l;if(f)throw f;if(!d.session)throw new na;const x=d.session;let v=null,C=null;this.flowType==="pkce"&&n.email!=null&&([v,C]=await ko(this.storage,this.storageKey));const{data:w,error:A}=await dt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:a?.emailRedirectTo,body:Object.assign(Object.assign({},n),{code_challenge:v,code_challenge_method:C}),jwt:x.access_token,xform:li});if(A)throw A;return x.user=w.user,await this._saveSession(x),await this._notifyAllSubscribers("USER_UPDATED",x),this._returnResult({data:{user:x.user},error:null})})}catch(l){if(st(l))return this._returnResult({data:{user:null},error:l});throw l}}async setSession(n){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(n))}async _setSession(n){try{if(!n.access_token||!n.refresh_token)throw new na;const a=Date.now()/1e3;let l=a,d=!0,f=null;const{payload:x}=pf(n.access_token);if(x.exp&&(l=x.exp,d=l<=a),d){const{data:v,error:C}=await this._callRefreshToken(n.refresh_token);if(C)return this._returnResult({data:{user:null,session:null},error:C});if(!v)return{data:{user:null,session:null},error:null};f=v}else{const{data:v,error:C}=await this._getUser(n.access_token);if(C)throw C;f={access_token:n.access_token,refresh_token:n.refresh_token,user:v.user,token_type:"bearer",expires_in:l-a,expires_at:l},await this._saveSession(f),await this._notifyAllSubscribers("SIGNED_IN",f)}return this._returnResult({data:{user:f.user,session:f},error:null})}catch(a){if(st(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}}async refreshSession(n){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(n))}async _refreshSession(n){try{return await this._useSession(async a=>{var l;if(!n){const{data:x,error:v}=a;if(v)throw v;n=(l=x.session)!==null&&l!==void 0?l:void 0}if(!n?.refresh_token)throw new na;const{data:d,error:f}=await this._callRefreshToken(n.refresh_token);return f?this._returnResult({data:{user:null,session:null},error:f}):d?this._returnResult({data:{user:d.user,session:d},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(a){if(st(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async _getSessionFromURL(n,a){try{if(!vs())throw new Ou("No browser detected.");if(n.error||n.error_description||n.error_code)throw new Ou(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});switch(a){case"implicit":if(this.flowType==="pkce")throw new vp("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ou("Not a valid implicit grant flow url.");break;default:}if(a==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!n.code)throw new vp("No code detected.");const{data:U,error:P}=await this._exchangeCodeForSession(n.code);if(P)throw P;const K=new URL(window.location.href);return K.searchParams.delete("code"),window.history.replaceState(window.history.state,"",K.toString()),{data:{session:U.session,redirectType:null},error:null}}const{provider_token:l,provider_refresh_token:d,access_token:f,refresh_token:x,expires_in:v,expires_at:C,token_type:w}=n;if(!f||!v||!x||!w)throw new Ou("No session defined in URL");const A=Math.round(Date.now()/1e3),N=parseInt(v);let R=A+N;C&&(R=parseInt(C));const T=R-A;T*1e3<=zo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${T}s, should have been closer to ${N}s`);const O=R-N;A-O>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",O,R,A):A-O<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",O,R,A);const{data:L,error:B}=await this._getUser(f);if(B)throw B;const H={provider_token:l,provider_refresh_token:d,access_token:f,expires_in:N,expires_at:R,refresh_token:x,token_type:w,user:L.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:H,redirectType:n.type},error:null})}catch(l){if(st(l))return this._returnResult({data:{session:null,redirectType:null},error:l});throw l}}_isImplicitGrantCallback(n){return!!(n.access_token||n.error_description)}async _isPKCECallback(n){const a=await Bi(this.storage,`${this.storageKey}-code-verifier`);return!!(n.code&&a)}async signOut(n={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(n))}async _signOut({scope:n}={scope:"global"}){return await this._useSession(async a=>{var l;const{data:d,error:f}=a;if(f)return this._returnResult({error:f});const x=(l=d.session)===null||l===void 0?void 0:l.access_token;if(x){const{error:v}=await this.admin.signOut(x,n);if(v&&!(LC(v)&&(v.status===404||v.status===401||v.status===403)))return this._returnResult({error:v})}return n!=="others"&&(await this._removeSession(),await ai(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(n){const a=GC(),l={id:a,callback:n,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",a),this.stateChangeEmitters.delete(a)}};return this._debug("#onAuthStateChange()","registered callback with id",a),this.stateChangeEmitters.set(a,l),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(a)})))(),{data:{subscription:l}}}async _emitInitialSession(n){return await this._useSession(async a=>{var l,d;try{const{data:{session:f},error:x}=a;if(x)throw x;await((l=this.stateChangeEmitters.get(n))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",f)),this._debug("INITIAL_SESSION","callback id",n,"session",f)}catch(f){await((d=this.stateChangeEmitters.get(n))===null||d===void 0?void 0:d.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",n,"error",f),console.error(f)}})}async resetPasswordForEmail(n,a={}){let l=null,d=null;this.flowType==="pkce"&&([l,d]=await ko(this.storage,this.storageKey,!0));try{return await dt(this.fetch,"POST",`${this.url}/recover`,{body:{email:n,code_challenge:l,code_challenge_method:d,gotrue_meta_security:{captcha_token:a.captchaToken}},headers:this.headers,redirectTo:a.redirectTo})}catch(f){if(st(f))return this._returnResult({data:null,error:f});throw f}}async getUserIdentities(){var n;try{const{data:a,error:l}=await this.getUser();if(l)throw l;return this._returnResult({data:{identities:(n=a.user.identities)!==null&&n!==void 0?n:[]},error:null})}catch(a){if(st(a))return this._returnResult({data:null,error:a});throw a}}async linkIdentity(n){return"token"in n?this.linkIdentityIdToken(n):this.linkIdentityOAuth(n)}async linkIdentityOAuth(n){var a;try{const{data:l,error:d}=await this._useSession(async f=>{var x,v,C,w,A;const{data:N,error:R}=f;if(R)throw R;const T=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,n.provider,{redirectTo:(x=n.options)===null||x===void 0?void 0:x.redirectTo,scopes:(v=n.options)===null||v===void 0?void 0:v.scopes,queryParams:(C=n.options)===null||C===void 0?void 0:C.queryParams,skipBrowserRedirect:!0});return await dt(this.fetch,"GET",T,{headers:this.headers,jwt:(A=(w=N.session)===null||w===void 0?void 0:w.access_token)!==null&&A!==void 0?A:void 0})});if(d)throw d;return vs()&&!(!((a=n.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(l?.url),this._returnResult({data:{provider:n.provider,url:l?.url},error:null})}catch(l){if(st(l))return this._returnResult({data:{provider:n.provider,url:null},error:l});throw l}}async linkIdentityIdToken(n){return await this._useSession(async a=>{var l;try{const{error:d,data:{session:f}}=a;if(d)throw d;const{options:x,provider:v,token:C,access_token:w,nonce:A}=n,N=await dt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(l=f?.access_token)!==null&&l!==void 0?l:void 0,body:{provider:v,id_token:C,access_token:w,nonce:A,link_identity:!0,gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:Ra}),{data:R,error:T}=N;return T?this._returnResult({data:{user:null,session:null},error:T}):!R||!R.session||!R.user?this._returnResult({data:{user:null,session:null},error:new Mo}):(R.session&&(await this._saveSession(R.session),await this._notifyAllSubscribers("USER_UPDATED",R.session)),this._returnResult({data:R,error:T}))}catch(d){if(st(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}})}async unlinkIdentity(n){try{return await this._useSession(async a=>{var l,d;const{data:f,error:x}=a;if(x)throw x;return await dt(this.fetch,"DELETE",`${this.url}/user/identities/${n.identity_id}`,{headers:this.headers,jwt:(d=(l=f.session)===null||l===void 0?void 0:l.access_token)!==null&&d!==void 0?d:void 0})})}catch(a){if(st(a))return this._returnResult({data:null,error:a});throw a}}async _refreshAccessToken(n){const a=`#_refreshAccessToken(${n.substring(0,5)}...)`;this._debug(a,"begin");try{const l=Date.now();return await QC(async d=>(d>0&&await WC(200*Math.pow(2,d-1)),this._debug(a,"refreshing attempt",d),await dt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:n},headers:this.headers,xform:Ra})),(d,f)=>{const x=200*Math.pow(2,d);return f&&mf(f)&&Date.now()+x-l<zo})}catch(l){if(this._debug(a,"error",l),st(l))return this._returnResult({data:{session:null,user:null},error:l});throw l}finally{this._debug(a,"end")}}_isValidSession(n){return typeof n=="object"&&n!==null&&"access_token"in n&&"refresh_token"in n&&"expires_at"in n}async _handleProviderSignIn(n,a){const l=await this._getUrlForProvider(`${this.url}/authorize`,n,{redirectTo:a.redirectTo,scopes:a.scopes,queryParams:a.queryParams});return this._debug("#_handleProviderSignIn()","provider",n,"options",a,"url",l),vs()&&!a.skipBrowserRedirect&&window.location.assign(l),{data:{provider:n,url:l},error:null}}async _recoverAndRefresh(){var n,a;const l="#_recoverAndRefresh()";this._debug(l,"begin");try{const d=await Bi(this.storage,this.storageKey);if(d&&this.userStorage){let x=await Bi(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!x&&(x={user:d.user},await Fo(this.userStorage,this.storageKey+"-user",x)),d.user=(n=x?.user)!==null&&n!==void 0?n:xf()}else if(d&&!d.user&&!d.user){const x=await Bi(this.storage,this.storageKey+"-user");x&&x?.user?(d.user=x.user,await ai(this.storage,this.storageKey+"-user"),await Fo(this.storage,this.storageKey,d)):d.user=xf()}if(this._debug(l,"session from storage",d),!this._isValidSession(d)){this._debug(l,"session is not valid"),d!==null&&await this._removeSession();return}const f=((a=d.expires_at)!==null&&a!==void 0?a:1/0)*1e3-Date.now()<gf;if(this._debug(l,`session has${f?"":" not"} expired with margin of ${gf}s`),f){if(this.autoRefreshToken&&d.refresh_token){const{error:x}=await this._callRefreshToken(d.refresh_token);x&&(console.error(x),mf(x)||(this._debug(l,"refresh failed with a non-retryable error, removing the session",x),await this._removeSession()))}}else if(d.user&&d.user.__isUserNotAvailableProxy===!0)try{const{data:x,error:v}=await this._getUser(d.access_token);!v&&x?.user?(d.user=x.user,await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)):this._debug(l,"could not get user data, skipping SIGNED_IN notification")}catch(x){console.error("Error getting user data:",x),this._debug(l,"error getting user data, skipping SIGNED_IN notification",x)}else await this._notifyAllSubscribers("SIGNED_IN",d)}catch(d){this._debug(l,"error",d),console.error(d);return}finally{this._debug(l,"end")}}async _callRefreshToken(n){var a,l;if(!n)throw new na;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const d=`#_callRefreshToken(${n.substring(0,5)}...)`;this._debug(d,"begin");try{this.refreshingDeferred=new ed;const{data:f,error:x}=await this._refreshAccessToken(n);if(x)throw x;if(!f.session)throw new na;await this._saveSession(f.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",f.session);const v={data:f.session,error:null};return this.refreshingDeferred.resolve(v),v}catch(f){if(this._debug(d,"error",f),st(f)){const x={data:null,error:f};return mf(f)||await this._removeSession(),(a=this.refreshingDeferred)===null||a===void 0||a.resolve(x),x}throw(l=this.refreshingDeferred)===null||l===void 0||l.reject(f),f}finally{this.refreshingDeferred=null,this._debug(d,"end")}}async _notifyAllSubscribers(n,a,l=!0){const d=`#_notifyAllSubscribers(${n})`;this._debug(d,"begin",a,`broadcast = ${l}`);try{this.broadcastChannel&&l&&this.broadcastChannel.postMessage({event:n,session:a});const f=[],x=Array.from(this.stateChangeEmitters.values()).map(async v=>{try{await v.callback(n,a)}catch(C){f.push(C)}});if(await Promise.all(x),f.length>0){for(let v=0;v<f.length;v+=1)console.error(f[v]);throw f[0]}}finally{this._debug(d,"end")}}async _saveSession(n){this._debug("#_saveSession()",n),this.suppressGetSessionWarning=!0;const a=Object.assign({},n),l=a.user&&a.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!l&&a.user&&await Fo(this.userStorage,this.storageKey+"-user",{user:a.user});const d=Object.assign({},a);delete d.user;const f=Ap(d);await Fo(this.storage,this.storageKey,f)}else{const d=Ap(a);await Fo(this.storage,this.storageKey,d)}}async _removeSession(){this._debug("#_removeSession()"),await ai(this.storage,this.storageKey),await ai(this.storage,this.storageKey+"-code-verifier"),await ai(this.storage,this.storageKey+"-user"),this.userStorage&&await ai(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const n=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{n&&vs()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",n)}catch(a){console.error("removing visibilitychange callback failed",a)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const n=setInterval(()=>this._autoRefreshTokenTick(),zo);this.autoRefreshTicker=n,n&&typeof n=="object"&&typeof n.unref=="function"?n.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(n),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const n=this.autoRefreshTicker;this.autoRefreshTicker=null,n&&clearInterval(n)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const n=Date.now();try{return await this._useSession(async a=>{const{data:{session:l}}=a;if(!l||!l.refresh_token||!l.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const d=Math.floor((l.expires_at*1e3-n)/zo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${d} ticks, a tick lasts ${zo}ms, refresh threshold is ${r0} ticks`),d<=r0&&await this._callRefreshToken(l.refresh_token)})}catch(a){console.error("Auto refresh tick failed with error. This is likely a transient error.",a)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(n){if(n.isAcquireTimeout||n instanceof G2)this._debug("auto refresh token tick lock not available");else throw n}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!vs()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(n){console.error("_handleVisibilityChange",n)}}async _onVisibilityChanged(n){const a=`#_onVisibilityChanged(${n})`;this._debug(a,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),n||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(a,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(n,a,l){const d=[`provider=${encodeURIComponent(a)}`];if(l?.redirectTo&&d.push(`redirect_to=${encodeURIComponent(l.redirectTo)}`),l?.scopes&&d.push(`scopes=${encodeURIComponent(l.scopes)}`),this.flowType==="pkce"){const[f,x]=await ko(this.storage,this.storageKey),v=new URLSearchParams({code_challenge:`${encodeURIComponent(f)}`,code_challenge_method:`${encodeURIComponent(x)}`});d.push(v.toString())}if(l?.queryParams){const f=new URLSearchParams(l.queryParams);d.push(f.toString())}return l?.skipBrowserRedirect&&d.push(`skip_http_redirect=${l.skipBrowserRedirect}`),`${n}?${d.join("&")}`}async _unenroll(n){try{return await this._useSession(async a=>{var l;const{data:d,error:f}=a;return f?this._returnResult({data:null,error:f}):await dt(this.fetch,"DELETE",`${this.url}/factors/${n.factorId}`,{headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token})})}catch(a){if(st(a))return this._returnResult({data:null,error:a});throw a}}async _enroll(n){try{return await this._useSession(async a=>{var l,d;const{data:f,error:x}=a;if(x)return this._returnResult({data:null,error:x});const v=Object.assign({friendly_name:n.friendlyName,factor_type:n.factorType},n.factorType==="phone"?{phone:n.phone}:n.factorType==="totp"?{issuer:n.issuer}:{}),{data:C,error:w}=await dt(this.fetch,"POST",`${this.url}/factors`,{body:v,headers:this.headers,jwt:(l=f?.session)===null||l===void 0?void 0:l.access_token});return w?this._returnResult({data:null,error:w}):(n.factorType==="totp"&&C.type==="totp"&&(!((d=C?.totp)===null||d===void 0)&&d.qr_code)&&(C.totp.qr_code=`data:image/svg+xml;utf-8,${C.totp.qr_code}`),this._returnResult({data:C,error:null}))})}catch(a){if(st(a))return this._returnResult({data:null,error:a});throw a}}async _verify(n){return this._acquireLock(-1,async()=>{try{return await this._useSession(async a=>{var l;const{data:d,error:f}=a;if(f)return this._returnResult({data:null,error:f});const x=Object.assign({challenge_id:n.challengeId},"webauthn"in n?{webauthn:Object.assign(Object.assign({},n.webauthn),{credential_response:n.webauthn.type==="create"?E3(n.webauthn.credential_response):A3(n.webauthn.credential_response)})}:{code:n.code}),{data:v,error:C}=await dt(this.fetch,"POST",`${this.url}/factors/${n.factorId}/verify`,{body:x,headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});return C?this._returnResult({data:null,error:C}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+v.expires_in},v)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",v),this._returnResult({data:v,error:C}))})}catch(a){if(st(a))return this._returnResult({data:null,error:a});throw a}})}async _challenge(n){return this._acquireLock(-1,async()=>{try{return await this._useSession(async a=>{var l;const{data:d,error:f}=a;if(f)return this._returnResult({data:null,error:f});const x=await dt(this.fetch,"POST",`${this.url}/factors/${n.factorId}/challenge`,{body:n,headers:this.headers,jwt:(l=d?.session)===null||l===void 0?void 0:l.access_token});if(x.error)return x;const{data:v}=x;if(v.type!=="webauthn")return{data:v,error:null};switch(v.webauthn.type){case"create":return{data:Object.assign(Object.assign({},v),{webauthn:Object.assign(Object.assign({},v.webauthn),{credential_options:Object.assign(Object.assign({},v.webauthn.credential_options),{publicKey:_3(v.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},v),{webauthn:Object.assign(Object.assign({},v.webauthn),{credential_options:Object.assign(Object.assign({},v.webauthn.credential_options),{publicKey:S3(v.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(a){if(st(a))return this._returnResult({data:null,error:a});throw a}})}async _challengeAndVerify(n){const{data:a,error:l}=await this._challenge({factorId:n.factorId});return l?this._returnResult({data:null,error:l}):await this._verify({factorId:n.factorId,challengeId:a.id,code:n.code})}async _listFactors(){var n;const{data:{user:a},error:l}=await this.getUser();if(l)return{data:null,error:l};const d={all:[],phone:[],totp:[],webauthn:[]};for(const f of(n=a?.factors)!==null&&n!==void 0?n:[])d.all.push(f),f.status==="verified"&&d[f.factor_type].push(f);return{data:d,error:null}}async _getAuthenticatorAssuranceLevel(){var n,a;const{data:{session:l},error:d}=await this.getSession();if(d)return this._returnResult({data:null,error:d});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:f}=pf(l.access_token);let x=null;f.aal&&(x=f.aal);let v=x;((a=(n=l.user.factors)===null||n===void 0?void 0:n.filter(A=>A.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(v="aal2");const w=f.amr||[];return{data:{currentLevel:x,nextLevel:v,currentAuthenticationMethods:w},error:null}}async _getAuthorizationDetails(n){try{return await this._useSession(async a=>{const{data:{session:l},error:d}=a;return d?this._returnResult({data:null,error:d}):l?await dt(this.fetch,"GET",`${this.url}/oauth/authorizations/${n}`,{headers:this.headers,jwt:l.access_token,xform:f=>({data:f,error:null})}):this._returnResult({data:null,error:new na})})}catch(a){if(st(a))return this._returnResult({data:null,error:a});throw a}}async _approveAuthorization(n,a){try{return await this._useSession(async l=>{const{data:{session:d},error:f}=l;if(f)return this._returnResult({data:null,error:f});if(!d)return this._returnResult({data:null,error:new na});const x=await dt(this.fetch,"POST",`${this.url}/oauth/authorizations/${n}/consent`,{headers:this.headers,jwt:d.access_token,body:{action:"approve"},xform:v=>({data:v,error:null})});return x.data&&x.data.redirect_url&&vs()&&!a?.skipBrowserRedirect&&window.location.assign(x.data.redirect_url),x})}catch(l){if(st(l))return this._returnResult({data:null,error:l});throw l}}async _denyAuthorization(n,a){try{return await this._useSession(async l=>{const{data:{session:d},error:f}=l;if(f)return this._returnResult({data:null,error:f});if(!d)return this._returnResult({data:null,error:new na});const x=await dt(this.fetch,"POST",`${this.url}/oauth/authorizations/${n}/consent`,{headers:this.headers,jwt:d.access_token,body:{action:"deny"},xform:v=>({data:v,error:null})});return x.data&&x.data.redirect_url&&vs()&&!a?.skipBrowserRedirect&&window.location.assign(x.data.redirect_url),x})}catch(l){if(st(l))return this._returnResult({data:null,error:l});throw l}}async _listOAuthGrants(){try{return await this._useSession(async n=>{const{data:{session:a},error:l}=n;return l?this._returnResult({data:null,error:l}):a?await dt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,xform:d=>({data:d,error:null})}):this._returnResult({data:null,error:new na})})}catch(n){if(st(n))return this._returnResult({data:null,error:n});throw n}}async _revokeOAuthGrant(n){try{return await this._useSession(async a=>{const{data:{session:l},error:d}=a;return d?this._returnResult({data:null,error:d}):l?await dt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:l.access_token,query:{client_id:n.clientId},xform:()=>({data:{},error:null})}):this._returnResult({data:null,error:new na})})}catch(a){if(st(a))return this._returnResult({data:null,error:a});throw a}}async fetchJwk(n,a={keys:[]}){let l=a.keys.find(v=>v.kid===n);if(l)return l;const d=Date.now();if(l=this.jwks.keys.find(v=>v.kid===n),l&&this.jwks_cached_at+kC>d)return l;const{data:f,error:x}=await dt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(x)throw x;return!f.keys||f.keys.length===0||(this.jwks=f,this.jwks_cached_at=d,l=f.keys.find(v=>v.kid===n),!l)?null:l}async getClaims(n,a={}){try{let l=n;if(!l){const{data:T,error:O}=await this.getSession();if(O||!T.session)return this._returnResult({data:null,error:O});l=T.session.access_token}const{header:d,payload:f,signature:x,raw:{header:v,payload:C}}=pf(l);a?.allowExpired||n3(f.exp);const w=!d.alg||d.alg.startsWith("HS")||!d.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(d.kid,a?.keys?{keys:a.keys}:a?.jwks);if(!w){const{error:T}=await this.getUser(l);if(T)throw T;return{data:{claims:f,header:d,signature:x},error:null}}const A=s3(d.alg),N=await crypto.subtle.importKey("jwk",w,A,!0,["verify"]);if(!await crypto.subtle.verify(A,N,x,qC(`${v}.${C}`)))throw new l0("Invalid JWT signature");return{data:{claims:f,header:d,signature:x},error:null}}catch(l){if(st(l))return this._returnResult({data:null,error:l});throw l}}}tc.nextInstanceID={};const D3=tc;class L3 extends D3{constructor(n){super(n)}}class B3{constructor(n,a,l){var d,f,x;this.supabaseUrl=n,this.supabaseKey=a;const v=jC(n);if(!a)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",v),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",v),this.storageUrl=new URL("storage/v1",v),this.functionsUrl=new URL("functions/v1",v);const C=`sb-${v.hostname.split(".")[0]}-auth-token`,w={db:vC,realtime:_C,auth:Object.assign(Object.assign({},CC),{storageKey:C}),global:bC},A=TC(l??{},w);this.storageKey=(d=A.auth.storageKey)!==null&&d!==void 0?d:"",this.headers=(f=A.global.headers)!==null&&f!==void 0?f:{},A.accessToken?(this.accessToken=A.accessToken,this.auth=new Proxy({},{get:(N,R)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(R)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((x=A.auth)!==null&&x!==void 0?x:{},this.headers,A.global.fetch),this.fetch=AC(a,this._getAccessToken.bind(this),A.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},A.realtime)),this.accessToken&&this.accessToken().then(N=>this.realtime.setAuth(N)).catch(N=>console.warn("Failed to set initial Realtime auth token:",N)),this.rest=new Rv(new URL("rest/v1",v).href,{headers:this.headers,schema:A.db.schema,fetch:this.fetch}),this.storage=new xC(this.storageUrl.href,this.headers,this.fetch,l?.storage),A.accessToken||this._listenForAuthEvents()}get functions(){return new Av(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(n){return this.rest.from(n)}schema(n){return this.rest.schema(n)}rpc(n,a={},l={head:!1,get:!1,count:void 0}){return this.rest.rpc(n,a,l)}channel(n,a={config:{}}){return this.realtime.channel(n,a)}getChannels(){return this.realtime.getChannels()}removeChannel(n){return this.realtime.removeChannel(n)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var n,a;if(this.accessToken)return await this.accessToken();const{data:l}=await this.auth.getSession();return(a=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:n,persistSession:a,detectSessionInUrl:l,storage:d,userStorage:f,storageKey:x,flowType:v,lock:C,debug:w,throwOnError:A},N,R){const T={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new L3({url:this.authUrl.href,headers:Object.assign(Object.assign({},T),N),storageKey:x,autoRefreshToken:n,persistSession:a,detectSessionInUrl:l,storage:d,userStorage:f,flowType:v,lock:C,debug:w,throwOnError:A,fetch:R,hasCustomAuthorizationHeader:Object.keys(this.headers).some(O=>O.toLowerCase()==="authorization")})}_initRealtimeClient(n){return new Xv(this.realtimeUrl.href,Object.assign(Object.assign({},n),{params:Object.assign({apikey:this.supabaseKey},n?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((a,l)=>{this._handleTokenChanged(a,"CLIENT",l?.access_token)})}_handleTokenChanged(n,a,l){(n==="TOKEN_REFRESHED"||n==="SIGNED_IN")&&this.changedAccessToken!==l?(this.changedAccessToken=l,this.realtime.setAuth(l)):n==="SIGNED_OUT"&&(this.realtime.setAuth(),a=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const U3=(i,n,a)=>new B3(i,n,a);function P3(){if(typeof window<"u"||typeof process>"u")return!1;const i=process.version;if(i==null)return!1;const n=i.match(/^v(\d+)\./);return n?parseInt(n[1],10)<=18:!1}P3()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const z3="https://riekjnqllkrqkmqxmtfu.supabase.co",F3="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJpZWtqbnFsbGtycWttcXhtdGZ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE4ODc3MjQsImV4cCI6MjA3NzQ2MzcyNH0.heQABR_DZFWZ_UIb38Tzdgcy-5z5LSUob0icnqsiiQY",vt=U3(z3,F3,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}}}),Mp=i=>{if(!i)return null;const n=String(i).trim();if(n==="1"||n==="/1"||n==="null"||n==="undefined"||n==="")return null;const a=parseInt(n);if(!isNaN(a)&&a>=1&&a<=28){const d=[{id:1,path:"assets/images/dp-options/00701602b0eac0390b3107b9e2a665e0.jpg"},{id:2,path:"assets/images/dp-options/1691130988954.jpg"},{id:3,path:"assets/images/dp-options/aesthetic-cartoon-funny-dp-for-instagram.webp"},{id:4,path:"assets/images/dp-options/boy-cartoon-dp-with-hoodie.webp"},{id:5,path:"assets/images/dp-options/download (1).jpg"},{id:6,path:"assets/images/dp-options/download.jpg"},{id:7,path:"assets/images/dp-options/funny-profile-picture-wd195eo9rpjy7ax1.jpg"},{id:8,path:"assets/images/dp-options/funny-whatsapp-dp-for-girls.webp"},{id:9,path:"assets/images/dp-options/photo_5230962651624575118_y.jpg"},{id:10,path:"assets/images/dp-options/photo_5230962651624575119_y.jpg"},{id:11,path:"assets/images/dp-options/photo_5230962651624575120_y.jpg"},{id:12,path:"assets/images/dp-options/photo_5230962651624575121_y.jpg"},{id:13,path:"assets/images/dp-options/photo_5230962651624575122_y.jpg"},{id:14,path:"assets/images/dp-options/photo_5230962651624575123_y.jpg"},{id:15,path:"assets/images/dp-options/photo_5230962651624575124_y.jpg"},{id:16,path:"assets/images/dp-options/photo_5230962651624575125_y.jpg"},{id:17,path:"assets/images/dp-options/photo_5230962651624575126_y.jpg"},{id:18,path:"assets/images/dp-options/photo_5230962651624575127_y.jpg"},{id:19,path:"assets/images/dp-options/photo_5235923888607267708_w.jpg"},{id:20,path:"assets/images/dp-options/photo_5235923888607267709_w.jpg"},{id:21,path:"assets/images/dp-options/photo_5235923888607267710_w.jpg"},{id:22,path:"assets/images/dp-options/photo_5235923888607267711_w.jpg"},{id:23,path:"assets/images/dp-options/photo_5235923888607267712_w.jpg"},{id:24,path:"assets/images/dp-options/photo_5235923888607267713_w.jpg"},{id:25,path:"assets/images/dp-options/photo_5235923888607267714_w.jpg"},{id:26,path:"assets/images/dp-options/photo_5235923888607267715_w.jpg"},{id:27,path:"assets/images/dp-options/photo_5235923888607267716_w.jpg"},{id:28,path:"assets/images/dp-options/photo_5235923888607267717_w.jpg"}].find(f=>f.id===a);return d?d.path:null}return n.startsWith("http")||n.startsWith("/assets/")||n.startsWith("assets/"),n},H3=({callData:i,onAccept:n,onReject:a,onClose:l})=>{const[d,f]=M.useState(null),[x,v]=M.useState(!0);M.useEffect(()=>{C()},[]);const C=async()=>{try{const{data:N,error:R}=await vt.from("users").select("*").eq("id",i.caller_id).single();if(R)throw R;f(N)}catch(N){console.error("Error loading caller info:",N)}},w=()=>{v(!1),n(i)},A=()=>{v(!1),a(i.id)};return d?o.jsx("div",{className:"incoming-call-overlay",children:o.jsxs("div",{className:"incoming-call",children:[o.jsxs("div",{className:"caller-info",children:[o.jsx("div",{className:"caller-avatar",children:o.jsx("div",{className:"avatar-circle-large",children:Mp(d.avatar)?o.jsx("img",{src:Mp(d.avatar),alt:d.name}):d.name.split(" ").map(N=>N[0]).join("").toUpperCase().slice(0,2)})}),o.jsx("h3",{children:d.name}),o.jsx("p",{className:"call-type",children:i.call_type==="video"?" Video call":" Voice call"}),o.jsx("p",{className:"ringing-text",children:"is calling..."})]}),o.jsxs("div",{className:"call-actions",children:[o.jsxs("button",{className:"reject-btn",onClick:A,disabled:!x,children:[o.jsx("i",{className:"fas fa-phone-slash"}),o.jsx("span",{children:"Decline"})]}),o.jsxs("button",{className:"accept-btn",onClick:w,disabled:!x,children:[o.jsx("i",{className:"fas fa-phone"}),o.jsx("span",{children:"Accept"})]})]})]})}):o.jsx("div",{className:"incoming-call-overlay",children:o.jsx("div",{className:"incoming-call",children:o.jsx("p",{children:"Loading caller info..."})})})},q3=({text:i="Connecting..."})=>{const n={position:"fixed",top:0,left:0,right:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",gap:8,padding:"8px 12px",background:"rgba(25,118,210,0.95)",color:"#fff",fontSize:14,fontWeight:500,boxShadow:"0 2px 6px rgba(0,0,0,0.15)"},a={width:8,height:8,borderRadius:4,background:"#fff",animation:"blink 1s infinite"};return o.jsxs("div",{style:n,children:["      ",o.jsx("style",{children:"@keyframes blink{0%{opacity:.2}50%{opacity:1}100%{opacity:.2}}"}),"      ",o.jsx("span",{style:a}),"      ",o.jsx("span",{children:i}),"    "]})},W2=M.createContext(),V3=({children:i})=>{const[n,a]=M.useState(null),[l,d]=M.useState(null),[f,x]=M.useState(!0),[v,C]=M.useState(!1),[w,A]=M.useState(null),[N,R]=M.useState(null),[T,O]=M.useState(!1),[L,B]=M.useState(!1),[H,U]=M.useState(null);M.useEffect(()=>{(async()=>{const{data:{session:ge},error:ie}=await vt.auth.getSession();ie?console.error("Error getting session:",ie):(d(ge),a(ge?.user??null)),x(!1)})();const{data:{subscription:he}}=vt.auth.onAuthStateChange(async(ge,ie)=>{if(console.log("Auth state changed:",ge,ie),d(ie),a(ie?.user??null),x(!1),ie?.user){const be={id:ie.user.id,name:ie.user.user_metadata?.name||"User",email:ie.user.email,phone:ie.user.user_metadata?.phone||"",avatar:ie.user.user_metadata?.avatar||null};localStorage.setItem("currentUser",JSON.stringify(be)),localStorage.setItem("authType","google")}else localStorage.removeItem("currentUser"),localStorage.removeItem("authType")});return()=>he.unsubscribe()},[]),M.useEffect(()=>{const q=he=>{if(he.key==="currentUser"||he.key==="authType"){const ge=localStorage.getItem("currentUser");if(ge)try{const ie=JSON.parse(ge);a(ie),C(!0)}catch(ie){console.error("Error parsing user data:",ie),a(null),C(!1)}else a(null),C(!1)}};return window.addEventListener("storage",q),()=>window.removeEventListener("storage",q)},[]),M.useEffect(()=>(n&&!N&&P(),()=>{N&&(vt.removeChannel(N),R(null))}),[n]);const P=()=>{console.log(" Setting up global incoming call listener for user:",n.id);const q=vt.channel("global-incoming-calls").on("postgres_changes",{event:"INSERT",schema:"public",table:"call_history",filter:`receiver_id=eq.${n.id}`},he=>{console.log(" Global incoming call event received:",he);const ge=he.new;console.log(" Call data:",ge),ge.call_status==="initiated"&&(console.log(" Showing global incoming call popup for call:",ge.id),A(ge))}).subscribe(he=>{console.log(" Global incoming call listener status:",he),he==="SUBSCRIBED"&&R(q)})},K=async q=>{console.log(" Accepting call:",q.id),A(null),window.location.href=`#/calls?incoming=true&callId=${q.call_id}&roomId=${q.call_id}&callType=${q.call_type}`},Z=async q=>{console.log(" Rejecting call:",q);try{window.WebRTCCall&&await new window.WebRTCCall().rejectCall(q)}catch(he){console.error("Error rejecting call:",he)}A(null)},J={supabase:vt,user:n,session:l,loading:f,signOut:()=>vt.auth.signOut(),isConnecting:T,lastResumeAt:H,validateSessionAndRefresh:async()=>{if(console.log("Starting validateSessionAndRefresh"),T){console.log("Already connecting, skipping");return}O(!0);try{const{data:{session:q},error:he}=await vt.auth.getSession();he&&console.warn("Session check error:",he);let ge=q;console.log("Current session:",!!ge),console.log("Refreshing session on resume...");try{const{data:ie,error:be}=await vt.auth.refreshSession();be?console.error("Refresh session error:",be):(ge=ie?.session||ge,console.log("Session refreshed"))}catch(ie){console.error("Refresh session exception:",ie)}console.log("Disconnecting realtime...");try{await vt.realtime.disconnect()}catch(ie){console.log("Disconnect error:",ie)}console.log("Connecting realtime...");try{await vt.realtime.connect(),console.log("Realtime connected successfully")}catch(ie){console.log("Connect error:",ie)}try{const ie=vt.getChannels?vt.getChannels():[];console.log("Re-subscribing channels:",ie.length),ie.forEach(be=>{try{be.subscribe(),console.log("Re-subscribed channel:",be.topic)}catch(Ie){console.log("Subscribe error:",Ie)}})}catch(ie){console.log("Get channels error:",ie)}U(Date.now()),console.log("validateSessionAndRefresh completed")}finally{O(!1)}},ensureConnected:()=>T?(B(!0),setTimeout(()=>B(!1),1500),!1):!0};return o.jsxs(W2.Provider,{value:J,children:[i,(T||L)&&o.jsx(q3,{text:"Connecting..."}),w&&o.jsx(H3,{callData:w,onAccept:K,onReject:Z,onClose:()=>A(null)})]})},ds=()=>{const i=M.useContext(W2);if(!i)throw new Error("useSupabase must be used within a SupabaseProvider");return i},G3="modulepreload",Y3=function(i,n){return new URL(i,n).href},kp={},td=function(n,a,l){let d=Promise.resolve();if(a&&a.length>0){let w=function(A){return Promise.all(A.map(N=>Promise.resolve(N).then(R=>({status:"fulfilled",value:R}),R=>({status:"rejected",reason:R}))))};const x=document.getElementsByTagName("link"),v=document.querySelector("meta[property=csp-nonce]"),C=v?.nonce||v?.getAttribute("nonce");d=w(a.map(A=>{if(A=Y3(A,l),A in kp)return;kp[A]=!0;const N=A.endsWith(".css"),R=N?'[rel="stylesheet"]':"";if(l)for(let O=x.length-1;O>=0;O--){const L=x[O];if(L.href===A&&(!N||L.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${A}"]${R}`))return;const T=document.createElement("link");if(T.rel=N?"stylesheet":G3,N||(T.as="script"),T.crossOrigin="",T.href=A,C&&T.setAttribute("nonce",C),document.head.appendChild(T),N)return new Promise((O,L)=>{T.addEventListener("load",O),T.addEventListener("error",()=>L(new Error(`Unable to preload CSS for ${A}`)))})}))}function f(x){const v=new Event("vite:preloadError",{cancelable:!0});if(v.payload=x,window.dispatchEvent(v),!v.defaultPrevented)throw x}return d.then(x=>{for(const v of x||[])v.status==="rejected"&&f(v.reason);return n().catch(f)})};var Xo;(function(i){i.Unimplemented="UNIMPLEMENTED",i.Unavailable="UNAVAILABLE"})(Xo||(Xo={}));class Go extends Error{constructor(n,a,l){super(n),this.message=n,this.code=a,this.data=l}}const X3=i=>{var n,a;return i?.androidBridge?"android":!((a=(n=i?.webkit)===null||n===void 0?void 0:n.messageHandlers)===null||a===void 0)&&a.bridge?"ios":"web"},W3=i=>{const n=i.CapacitorCustomPlatform||null,a=i.Capacitor||{},l=a.Plugins=a.Plugins||{},d=()=>n!==null?n.name:X3(i),f=()=>d()!=="web",x=N=>{const R=w.get(N);return!!(R?.platforms.has(d())||v(N))},v=N=>{var R;return(R=a.PluginHeaders)===null||R===void 0?void 0:R.find(T=>T.name===N)},C=N=>i.console.error(N),w=new Map,A=(N,R={})=>{const T=w.get(N);if(T)return console.warn(`Capacitor plugin "${N}" already registered. Cannot register plugins twice.`),T.proxy;const O=d(),L=v(N);let B;const H=async()=>(!B&&O in R?B=typeof R[O]=="function"?B=await R[O]():B=R[O]:n!==null&&!B&&"web"in R&&(B=typeof R.web=="function"?B=await R.web():B=R.web),B),U=(J,q)=>{var he,ge;if(L){const ie=L?.methods.find(be=>q===be.name);if(ie)return ie.rtype==="promise"?be=>a.nativePromise(N,q.toString(),be):(be,Ie)=>a.nativeCallback(N,q.toString(),be,Ie);if(J)return(he=J[q])===null||he===void 0?void 0:he.bind(J)}else{if(J)return(ge=J[q])===null||ge===void 0?void 0:ge.bind(J);throw new Go(`"${N}" plugin is not implemented on ${O}`,Xo.Unimplemented)}},P=J=>{let q;const he=(...ge)=>{const ie=H().then(be=>{const Ie=U(be,J);if(Ie){const V=Ie(...ge);return q=V?.remove,V}else throw new Go(`"${N}.${J}()" is not implemented on ${O}`,Xo.Unimplemented)});return J==="addListener"&&(ie.remove=async()=>q()),ie};return he.toString=()=>`${J.toString()}() { [capacitor code] }`,Object.defineProperty(he,"name",{value:J,writable:!1,configurable:!1}),he},K=P("addListener"),Z=P("removeListener"),W=(J,q)=>{const he=K({eventName:J},q),ge=async()=>{const be=await he;Z({eventName:J,callbackId:be},q)},ie=new Promise(be=>he.then(()=>be({remove:ge})));return ie.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await ge()},ie},X=new Proxy({},{get(J,q){switch(q){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return L?W:K;case"removeListener":return Z;default:return P(q)}}});return l[N]=X,w.set(N,{name:N,proxy:X,platforms:new Set([...Object.keys(R),...L?[O]:[]])}),X};return a.convertFileSrc||(a.convertFileSrc=N=>N),a.getPlatform=d,a.handleError=C,a.isNativePlatform=f,a.isPluginAvailable=x,a.registerPlugin=A,a.Exception=Go,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a},Q3=i=>i.Capacitor=W3(i),ui=Q3(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Xi=ui.registerPlugin;class nd{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(n,a){let l=!1;this.listeners[n]||(this.listeners[n]=[],l=!0),this.listeners[n].push(a);const f=this.windowListeners[n];f&&!f.registered&&this.addWindowListener(f),l&&this.sendRetainedArgumentsForEvent(n);const x=async()=>this.removeListener(n,a);return Promise.resolve({remove:x})}async removeAllListeners(){this.listeners={};for(const n in this.windowListeners)this.removeWindowListener(this.windowListeners[n]);this.windowListeners={}}notifyListeners(n,a,l){const d=this.listeners[n];if(!d){if(l){let f=this.retainedEventArguments[n];f||(f=[]),f.push(a),this.retainedEventArguments[n]=f}return}d.forEach(f=>f(a))}hasListeners(n){var a;return!!(!((a=this.listeners[n])===null||a===void 0)&&a.length)}registerWindowListener(n,a){this.windowListeners[a]={registered:!1,windowEventName:n,pluginEventName:a,handler:l=>{this.notifyListeners(a,l)}}}unimplemented(n="not implemented"){return new ui.Exception(n,Xo.Unimplemented)}unavailable(n="not available"){return new ui.Exception(n,Xo.Unavailable)}async removeListener(n,a){const l=this.listeners[n];if(!l)return;const d=l.indexOf(a);this.listeners[n].splice(d,1),this.listeners[n].length||this.removeWindowListener(this.windowListeners[n])}addWindowListener(n){window.addEventListener(n.windowEventName,n.handler),n.registered=!0}removeWindowListener(n){n&&(window.removeEventListener(n.windowEventName,n.handler),n.registered=!1)}sendRetainedArgumentsForEvent(n){const a=this.retainedEventArguments[n];a&&(delete this.retainedEventArguments[n],a.forEach(l=>{this.notifyListeners(n,l)}))}}const Dp=i=>encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Lp=i=>i.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class K3 extends nd{async getCookies(){const n=document.cookie,a={};return n.split(";").forEach(l=>{if(l.length<=0)return;let[d,f]=l.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");d=Lp(d).trim(),f=Lp(f).trim(),a[d]=f}),a}async setCookie(n){try{const a=Dp(n.key),l=Dp(n.value),d=`; expires=${(n.expires||"").replace("expires=","")}`,f=(n.path||"/").replace("path=",""),x=n.url!=null&&n.url.length>0?`domain=${n.url}`:"";document.cookie=`${a}=${l||""}${d}; path=${f}; ${x};`}catch(a){return Promise.reject(a)}}async deleteCookie(n){try{document.cookie=`${n.key}=; Max-Age=0`}catch(a){return Promise.reject(a)}}async clearCookies(){try{const n=document.cookie.split(";")||[];for(const a of n)document.cookie=a.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(n){return Promise.reject(n)}}async clearAllCookies(){try{await this.clearCookies()}catch(n){return Promise.reject(n)}}}Xi("CapacitorCookies",{web:()=>new K3});const Z3=async i=>new Promise((n,a)=>{const l=new FileReader;l.onload=()=>{const d=l.result;n(d.indexOf(",")>=0?d.split(",")[1]:d)},l.onerror=d=>a(d),l.readAsDataURL(i)}),$3=(i={})=>{const n=Object.keys(i);return Object.keys(i).map(d=>d.toLocaleLowerCase()).reduce((d,f,x)=>(d[f]=i[n[x]],d),{})},J3=(i,n=!0)=>i?Object.entries(i).reduce((l,d)=>{const[f,x]=d;let v,C;return Array.isArray(x)?(C="",x.forEach(w=>{v=n?encodeURIComponent(w):w,C+=`${f}=${v}&`}),C.slice(0,-1)):(v=n?encodeURIComponent(x):x,C=`${f}=${v}`),`${l}&${C}`},"").substr(1):null,e_=(i,n={})=>{const a=Object.assign({method:i.method||"GET",headers:i.headers},n),d=$3(i.headers)["content-type"]||"";if(typeof i.data=="string")a.body=i.data;else if(d.includes("application/x-www-form-urlencoded")){const f=new URLSearchParams;for(const[x,v]of Object.entries(i.data||{}))f.set(x,v);a.body=f.toString()}else if(d.includes("multipart/form-data")||i.data instanceof FormData){const f=new FormData;if(i.data instanceof FormData)i.data.forEach((v,C)=>{f.append(C,v)});else for(const v of Object.keys(i.data))f.append(v,i.data[v]);a.body=f;const x=new Headers(a.headers);x.delete("content-type"),a.headers=x}else(d.includes("application/json")||typeof i.data=="object")&&(a.body=JSON.stringify(i.data));return a};class t_ extends nd{async request(n){const a=e_(n,n.webFetchExtra),l=J3(n.params,n.shouldEncodeUrlParams),d=l?`${n.url}?${l}`:n.url,f=await fetch(d,a),x=f.headers.get("content-type")||"";let{responseType:v="text"}=f.ok?n:{};x.includes("application/json")&&(v="json");let C,w;switch(v){case"arraybuffer":case"blob":w=await f.blob(),C=await Z3(w);break;case"json":C=await f.json();break;case"document":case"text":default:C=await f.text()}const A={};return f.headers.forEach((N,R)=>{A[R]=N}),{data:C,headers:A,status:f.status,url:f.url}}async get(n){return this.request(Object.assign(Object.assign({},n),{method:"GET"}))}async post(n){return this.request(Object.assign(Object.assign({},n),{method:"POST"}))}async put(n){return this.request(Object.assign(Object.assign({},n),{method:"PUT"}))}async patch(n){return this.request(Object.assign(Object.assign({},n),{method:"PATCH"}))}async delete(n){return this.request(Object.assign(Object.assign({},n),{method:"DELETE"}))}}Xi("CapacitorHttp",{web:()=>new t_});var Bp;(function(i){i.Dark="DARK",i.Light="LIGHT",i.Default="DEFAULT"})(Bp||(Bp={}));var Up;(function(i){i.StatusBar="StatusBar",i.NavigationBar="NavigationBar"})(Up||(Up={}));class n_ extends nd{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}Xi("SystemBars",{web:()=>new n_});const wf=Xi("GoogleAuth",{web:()=>td(()=>import("./web-DmFb29a5.js"),[],import.meta.url).then(i=>new i.GoogleAuthWeb)}),Q2=M.createContext({}),s_=({children:i})=>{const{supabase:n}=ds(),a=us(),[l,d]=M.useState(null),[f,x]=M.useState(null),[v,C]=M.useState(!0),[w,A]=M.useState(!1);M.useEffect(()=>{if(!n)return;(async()=>{try{ui.isNativePlatform()&&await wf.initialize({clientId:"335571630396-g270djndvqsj8p00kfgoq98995p1l3bm.apps.googleusercontent.com",scopes:["profile","email"],grantOfflineAccess:!0});const{data:{session:H}}=await n.auth.getSession();if(H?.user)await N(H.user);else{const P=sessionStorage.getItem("_auth_user");P&&(x(JSON.parse(P)),A(!0))}const{data:{subscription:U}}=n.auth.onAuthStateChange(async(P,K)=>{console.log(" Auth state changed:",P),P==="SIGNED_IN"&&K?.user?await N(K.user):P==="SIGNED_OUT"&&R()});return C(!1),()=>{U?.unsubscribe()}}catch(H){console.error("Auth context initialization error:",H),C(!1)}})()},[n]);const N=async B=>{try{const{data:H,error:U}=await n.from("users").select("*").eq("email",B.email).single();let P;const K=B.user_metadata?.full_name||B.user_metadata?.name||B.email.split("@")[0],Z=B.user_metadata?.avatar_url||null;if(U&&U.code==="PGRST116"){const{data:W,error:X}=await n.from("users").insert([{id:B.id,email:B.email,name:K,phone:"",avatar:Z,is_online:!0}]).select().single();if(X)throw X;P=W}else H&&(await n.from("users").update({is_online:!0,last_seen:new Date().toISOString()}).eq("id",H.id),P=H);sessionStorage.setItem("_auth_user",JSON.stringify(P||B)),x(P||B),A(!0),a("/",{replace:!0})}catch(H){console.error("Error handling user session:",H)}},R=()=>{sessionStorage.removeItem("_auth_user"),localStorage.removeItem("sb-riekjnqllkrqkmqxmtfu-auth-token"),x(null),A(!1),a("/login",{replace:!0})},L={user:f,loading:v,isAuthenticated:w,signInWithGoogle:async()=>{try{if(ui.isNativePlatform()){const B=await wf.signIn(),{error:H}=await n.auth.signInWithIdToken({provider:"google",token:B.authentication.idToken});if(H)throw H;return{success:!0}}else{const B=window.location.origin+window.location.pathname;console.log("Redirecting to:",B);const{error:H}=await n.auth.signInWithOAuth({provider:"google",options:{redirectTo:B,queryParams:{access_type:"offline",prompt:"consent"}}});if(H)throw H;return{success:!0}}}catch(B){return console.error("Google Sign In Error:",B),{success:!1,error:B.message}}},signOut:async()=>{try{ui.isNativePlatform()&&await wf.signOut(),await n.auth.signOut(),R()}catch(B){console.error("Sign out error:",B)}}};return o.jsx(Q2.Provider,{value:L,children:!v&&i})},K2=()=>M.useContext(Q2),Xa=()=>K2();class a_{async createCall(n,a,l,d="video"){const{data:f,error:x}=await vt.from("call_history").insert({caller_id:n,receiver_id:a,call_id:l,call_type:d,call_status:"initiated",started_at:new Date().toISOString()}).select().single();if(x)throw x;return f}async updateCallStatus(n,a,l={}){const d={call_status:a,updated_at:new Date().toISOString(),...l};a==="answered"&&(d.answered_at=new Date().toISOString()),["ended","missed","rejected","failed"].includes(a)&&(d.ended_at=new Date().toISOString());const{data:f,error:x}=await vt.from("call_history").update(d).eq("call_id",n).select().single();if(x)throw x;return f}async endCall(n,a){const{data:l,error:d}=await vt.from("call_history").update({call_status:"ended",call_duration:a,ended_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("call_id",n).select().single();if(d)throw d;return l}async getCallHistory(n,a=50){const{data:l,error:d}=await vt.rpc("get_user_call_history",{user_id_param:n,limit_count:a});if(d)throw d;return l}async getMissedCallsCount(n){const{data:a,error:l}=await vt.rpc("get_missed_calls_count",{user_uuid:n});if(l)throw l;return a}async getCallById(n){const{data:a,error:l}=await vt.from("call_history").select("*").eq("call_id",n).single();if(l&&l.code!=="PGRST116")throw l;return a}async sendSignal(n,a,l,d,f){const{data:x,error:v}=await vt.from("call_signaling").insert({call_id:n,from_user_id:a,to_user_id:l,signal_type:d,signal_data:f,is_processed:!1}).select().single();if(v)throw v;return x}async getPendingSignals(n){const{data:a,error:l}=await vt.from("call_signaling").select("*").eq("to_user_id",n).eq("is_processed",!1).order("created_at",{ascending:!0});if(l)throw l;return a}async markSignalProcessed(n){const{error:a}=await vt.from("call_signaling").update({is_processed:!0}).eq("id",n);if(a)throw a}async deleteCallSignals(n){const{error:a}=await vt.from("call_signaling").delete().eq("call_id",n);if(a)throw a}subscribeToSignals(n,a){return vt.channel(`signals:${n}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"call_signaling",filter:`to_user_id=eq.${n}`},d=>{console.log(" New signal received:",d.new),a(d.new)}).subscribe()}subscribeToCallHistory(n,a){return vt.channel(`calls:${n}`).on("postgres_changes",{event:"*",schema:"public",table:"call_history",filter:`receiver_id=eq.${n}`},d=>{console.log(" Call update:",d),a(d)}).subscribe()}unsubscribe(n){n&&vt.removeChannel(n)}async getCallSettings(n){const{data:a,error:l}=await vt.from("user_call_settings").select("*").eq("user_id",n).single();if(l&&l.code!=="PGRST116")throw l;return a}async updateCallSettings(n,a){const{data:l,error:d}=await vt.from("user_call_settings").upsert({user_id:n,...a,updated_at:new Date().toISOString()}).select().single();if(d)throw d;return l}async getUserById(n){const{data:a,error:l}=await vt.from("users").select("id, name, phone, avatar").eq("id",n).single();if(l)throw l;return a}}const ls=new a_;class r_{constructor(){this.peerConnection=null,this.localStream=null,this.remoteStream=null,this.callId=null,this.currentUserId=null,this.remoteUserId=null,this.onRemoteStream=null,this.onCallEnd=null,this.onConnectionStateChange=null,this.iceCandidatesQueue=[],this.loadTurnConfig()}loadTurnConfig(){try{if(window.FREE_TURN_SERVERS){this.rtcConfig=window.FREE_TURN_SERVERS,console.log(" Loaded TURN servers from global config");return}this.rtcConfig={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"},{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443?transport=tcp",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:a.relay.metered.ca:80",username:"df4e050fc5de5dc26b25b85a",credential:"Pxdp2PK0b5ZXljOm"},{urls:"turn:a.relay.metered.ca:80?transport=tcp",username:"df4e050fc5de5dc26b25b85a",credential:"Pxdp2PK0b5ZXljOm"},{urls:"turn:a.relay.metered.ca:443",username:"df4e050fc5de5dc26b25b85a",credential:"Pxdp2PK0b5ZXljOm"},{urls:"turn:a.relay.metered.ca:443?transport=tcp",username:"df4e050fc5de5dc26b25b85a",credential:"Pxdp2PK0b5ZXljOm"},{urls:"stun:global.stun.twilio.com:3478"},{urls:"stun:stun.services.mozilla.com"},{urls:"stun:stun.ekiga.net"}],iceCandidatePoolSize:10},console.log(" Loaded fallback TURN/STUN configuration")}catch(n){console.error(" Error loading TURN config:",n),this.rtcConfig={iceServers:[{urls:"stun:stun.l.google.com:19302"}]}}}generateCallId(){return`call_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async getLocalStream(n=!0,a=!0){try{const l={audio:a?{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}:!1,video:n?{width:{ideal:1280},height:{ideal:720},facingMode:"user"}:!1};return this.localStream=await navigator.mediaDevices.getUserMedia(l),console.log(" Local stream acquired"),this.localStream}catch(l){throw console.error(" Error getting local stream:",l),l}}initializePeerConnection(){return this.peerConnection&&this.peerConnection.close(),this.peerConnection=new RTCPeerConnection(this.rtcConfig),this.remoteStream=new MediaStream,this.localStream&&this.localStream.getTracks().forEach(n=>{this.peerConnection.addTrack(n,this.localStream)}),this.peerConnection.ontrack=n=>{console.log(" Remote track received"),n.streams[0].getTracks().forEach(a=>{this.remoteStream.addTrack(a)}),this.onRemoteStream&&this.onRemoteStream(this.remoteStream)},this.peerConnection.onicecandidate=async n=>{n.candidate&&(console.log(" ICE candidate generated"),await this.sendIceCandidate(n.candidate))},this.peerConnection.onconnectionstatechange=()=>{console.log(" Connection state:",this.peerConnection.connectionState),this.onConnectionStateChange&&this.onConnectionStateChange(this.peerConnection.connectionState),["disconnected","failed","closed"].includes(this.peerConnection.connectionState)&&this.onCallEnd&&this.onCallEnd("connection_failed")},this.peerConnection.oniceconnectionstatechange=()=>{console.log(" ICE connection state:",this.peerConnection.iceConnectionState)},this.peerConnection}async startCall(n,a,l="video"){try{this.currentUserId=n,this.remoteUserId=a,this.callId=this.generateCallId(),console.log(" Starting call:",this.callId,"from:",n,"to:",a),await this.getLocalStream(l==="video",!0),this.initializePeerConnection(),await ls.createCall(n,a,this.callId,l);const d=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:l==="video"});return await this.peerConnection.setLocalDescription(d),await ls.sendSignal(this.callId,n,a,"offer",{sdp:d.sdp,type:d.type,callType:l}),console.log(" Offer sent for call:",this.callId),{callId:this.callId,localStream:this.localStream}}catch(d){throw console.error(" Error starting call:",d),this.cleanup(),d}}async answerCall(n,a,l,d){try{this.callId=n,this.currentUserId=l,this.remoteUserId=a,console.log(" Answering call:",n,"from:",a,"to:",l);const f=d.callType||"video";await this.getLocalStream(f==="video",!0),this.initializePeerConnection(),await this.peerConnection.setRemoteDescription(new RTCSessionDescription({type:d.type,sdp:d.sdp})),await this.processQueuedIceCandidates();const x=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(x),await ls.sendSignal(n,l,a,"answer",{sdp:x.sdp,type:x.type}),await ls.updateCallStatus(n,"answered"),console.log(" Answer sent for call:",n),{localStream:this.localStream,remoteStream:this.remoteStream}}catch(f){throw console.error(" Error answering call:",f),this.cleanup(),f}}async handleAnswer(n){try{if(!this.peerConnection){console.error("No peer connection");return}console.log(" Processing answer"),await this.peerConnection.setRemoteDescription(new RTCSessionDescription({type:n.type,sdp:n.sdp})),await this.processQueuedIceCandidates(),await ls.updateCallStatus(this.callId,"answered")}catch(a){throw console.error(" Error handling answer:",a),a}}async sendIceCandidate(n){try{await ls.sendSignal(this.callId,this.currentUserId,this.remoteUserId,"ice_candidate",{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex})}catch(a){console.error(" Error sending ICE candidate:",a)}}async handleIceCandidate(n){try{const a=new RTCIceCandidate({candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex});this.peerConnection&&this.peerConnection.remoteDescription?(await this.peerConnection.addIceCandidate(a),console.log(" ICE candidate added")):(this.iceCandidatesQueue.push(a),console.log(" ICE candidate queued"))}catch(a){console.error(" Error handling ICE candidate:",a)}}async processQueuedIceCandidates(){for(;this.iceCandidatesQueue.length>0;){const n=this.iceCandidatesQueue.shift();try{await this.peerConnection.addIceCandidate(n),console.log(" Queued ICE candidate added")}catch(a){console.error(" Error adding queued candidate:",a)}}}async rejectCall(n,a,l){try{await ls.sendSignal(n,a,l,"call_end",{reason:"rejected"}),await ls.updateCallStatus(n,"rejected")}catch(d){console.error(" Error rejecting call:",d)}}async endCall(n=0){try{this.callId&&this.remoteUserId&&(await ls.sendSignal(this.callId,this.currentUserId,this.remoteUserId,"call_end",{reason:"ended",duration:n}),await ls.endCall(this.callId,n)),this.cleanup()}catch(a){console.error(" Error ending call:",a),this.cleanup()}}toggleMicrophone(){if(this.localStream){const n=this.localStream.getAudioTracks()[0];if(n)return n.enabled=!n.enabled,n.enabled}return!1}toggleCamera(){if(this.localStream){const n=this.localStream.getVideoTracks()[0];if(n)return n.enabled=!n.enabled,n.enabled}return!1}async switchCamera(){if(this.localStream){const n=this.localStream.getVideoTracks()[0];if(n){const l=n.getSettings().facingMode==="user"?"environment":"user";try{const f=(await navigator.mediaDevices.getUserMedia({video:{facingMode:l}})).getVideoTracks()[0],x=this.peerConnection?.getSenders().find(v=>v.track?.kind==="video");return x&&await x.replaceTrack(f),n.stop(),this.localStream.removeTrack(n),this.localStream.addTrack(f),this.localStream}catch(d){console.error(" Error switching camera:",d)}}}return null}cleanup(){console.log(" Cleaning up WebRTC resources"),this.localStream&&(this.localStream.getTracks().forEach(n=>n.stop()),this.localStream=null),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.remoteStream=null,this.callId=null,this.remoteUserId=null,this.iceCandidatesQueue=[]}async handleSignal(n){const{signal_type:a,signal_data:l,call_id:d,from_user_id:f}=n;if(console.log(" Handling signal:",a,"for call:",d),d&&this.callId&&d!==this.callId){console.log(" Ignoring signal for different call:",d,"current:",this.callId);return}switch(a){case"offer":return{type:"incoming_call",data:n};case"answer":console.log(" Processing answer for call:",d),await this.handleAnswer(l);break;case"ice_candidate":console.log(" Processing ICE candidate"),await this.handleIceCandidate(l);break;case"call_end":console.log(" Call ended with reason:",l.reason),this.onCallEnd&&this.onCallEnd(l.reason),this.cleanup();break;case"busy":this.onCallEnd&&this.onCallEnd("busy"),this.cleanup();break;case"ringing":console.log(" Ringing signal received");break;default:console.warn("Unknown signal type:",a)}}}const wa=new r_,Z2=M.createContext(null),Bt={SET_CALL_STATE:"SET_CALL_STATE",SET_LOCAL_STREAM:"SET_LOCAL_STREAM",SET_REMOTE_STREAM:"SET_REMOTE_STREAM",SET_INCOMING_CALL:"SET_INCOMING_CALL",SET_CALL_DURATION:"SET_CALL_DURATION",TOGGLE_MUTE:"TOGGLE_MUTE",TOGGLE_VIDEO:"TOGGLE_VIDEO",TOGGLE_SPEAKER:"TOGGLE_SPEAKER",RESET_CALL:"RESET_CALL",SET_ERROR:"SET_ERROR",SET_CALLER_INFO:"SET_CALLER_INFO"},$2={callState:"idle",callType:null,callId:null,localStream:null,remoteStream:null,incomingCall:null,callerInfo:null,receiverInfo:null,isMuted:!1,isVideoOff:!1,isSpeakerOn:!0,callDuration:0,error:null};function i_(i,n){switch(n.type){case Bt.SET_CALL_STATE:return{...i,callState:n.payload.state,...n.payload.data};case Bt.SET_LOCAL_STREAM:return{...i,localStream:n.payload};case Bt.SET_REMOTE_STREAM:return{...i,remoteStream:n.payload};case Bt.SET_INCOMING_CALL:return{...i,incomingCall:n.payload,callState:"ringing"};case Bt.SET_CALL_DURATION:return{...i,callDuration:n.payload};case Bt.TOGGLE_MUTE:return{...i,isMuted:n.payload};case Bt.TOGGLE_VIDEO:return{...i,isVideoOff:n.payload};case Bt.TOGGLE_SPEAKER:return{...i,isSpeakerOn:n.payload};case Bt.SET_CALLER_INFO:return{...i,callerInfo:n.payload};case Bt.SET_ERROR:return{...i,error:n.payload};case Bt.RESET_CALL:return{...$2};default:return i}}function o_({children:i,currentUser:n}){const[a,l]=M.useReducer(i_,$2),d=M.useRef(null),f=M.useRef(null),x=M.useRef(null),v=M.useCallback(()=>{x.current=Date.now(),f.current=setInterval(()=>{const U=Math.floor((Date.now()-x.current)/1e3);l({type:Bt.SET_CALL_DURATION,payload:U})},1e3)},[]),C=M.useCallback(()=>{f.current&&(clearInterval(f.current),f.current=null)},[]),w=M.useCallback(async U=>{if(console.log(" Signal received in context:",U.signal_type,"Call ID:",U.call_id),U.signal_type==="offer")try{const P=await ls.getUserById(U.from_user_id);l({type:Bt.SET_INCOMING_CALL,payload:{...U,callerInfo:P}}),l({type:Bt.SET_CALLER_INFO,payload:P})}catch(P){console.error("Error fetching caller info:",P)}else try{const P=await wa.handleSignal(U);await ls.markSignalProcessed(U.id),U.signal_type==="answer"&&wa.callId===U.call_id&&console.log(" Answer received, call should connect now")}catch(P){console.error("Error handling signal:",P)}},[]);M.useEffect(()=>{wa.onRemoteStream=U=>{console.log(" Remote stream received in context"),l({type:Bt.SET_REMOTE_STREAM,payload:U})},wa.onCallEnd=U=>{console.log(" Call ended:",U),C(),l({type:Bt.RESET_CALL})},wa.onConnectionStateChange=U=>{U==="connected"&&(v(),l({type:Bt.SET_CALL_STATE,payload:{state:"connected"}}))}},[v,C]),M.useEffect(()=>{if(n?.id){if(n.id.startsWith("phone_")){console.log(" Skipping signal subscription for phone user:",n.id);return}return console.log(" Setting up signal subscription for:",n.id),d.current=ls.subscribeToSignals(n.id,w),()=>{d.current&&ls.unsubscribe(d.current)}}},[n?.id,w]);const A=M.useCallback(async(U,P="video")=>{try{l({type:Bt.SET_CALL_STATE,payload:{state:"calling",data:{callType:P}}});const K=await ls.getUserById(U);l({type:Bt.SET_CALL_STATE,payload:{state:"calling",data:{receiverInfo:K}}});const{callId:Z,localStream:W}=await wa.startCall(n.id,U,P);return l({type:Bt.SET_LOCAL_STREAM,payload:W}),l({type:Bt.SET_CALL_STATE,payload:{state:"calling",data:{callId:Z}}}),{callId:Z,localStream:W}}catch(K){throw console.error(" Error starting call:",K),l({type:Bt.SET_ERROR,payload:K.message}),l({type:Bt.RESET_CALL}),K}},[n?.id]),N=M.useCallback(async()=>{try{const{incomingCall:U}=a;if(!U)throw new Error("No incoming call to answer");l({type:Bt.SET_CALL_STATE,payload:{state:"connecting"}});const{localStream:P,remoteStream:K}=await wa.answerCall(U.call_id,U.from_user_id,n.id,U.signal_data);l({type:Bt.SET_LOCAL_STREAM,payload:P}),l({type:Bt.SET_REMOTE_STREAM,payload:K}),l({type:Bt.SET_CALL_STATE,payload:{state:"connected",data:{callId:U.call_id,callType:U.signal_data.callType}}}),await ls.markSignalProcessed(U.id),v()}catch(U){throw console.error(" Error answering call:",U),l({type:Bt.SET_ERROR,payload:U.message}),l({type:Bt.RESET_CALL}),U}},[a,n?.id,v]),R=M.useCallback(async()=>{try{const{incomingCall:U}=a;U&&(await wa.rejectCall(U.call_id,n.id,U.from_user_id),await ls.markSignalProcessed(U.id)),l({type:Bt.RESET_CALL})}catch(U){console.error(" Error rejecting call:",U),l({type:Bt.RESET_CALL})}},[a,n?.id]),T=M.useCallback(async()=>{try{C(),await wa.endCall(a.callDuration),l({type:Bt.RESET_CALL})}catch(U){console.error(" Error ending call:",U),l({type:Bt.RESET_CALL})}},[a.callDuration,C]),O=M.useCallback(()=>{const U=!wa.toggleMicrophone();return l({type:Bt.TOGGLE_MUTE,payload:U}),U},[]),L=M.useCallback(()=>{const U=!wa.toggleCamera();return l({type:Bt.TOGGLE_VIDEO,payload:U}),U},[]),B=M.useCallback(async()=>{const U=await wa.switchCamera();U&&l({type:Bt.SET_LOCAL_STREAM,payload:U})},[]),H={...a,startCall:A,answerCall:N,rejectCall:R,endCall:T,toggleMute:O,toggleVideo:L,switchCamera:B};return o.jsx(Z2.Provider,{value:H,children:i})}function hi(){const i=M.useContext(Z2);if(!i)throw new Error("useCall must be used within a CallProvider");return i}const l_=()=>{const{signInWithGoogle:i}=K2(),[n,a]=M.useState(!1),[l,d]=M.useState(""),[f,x]=M.useState(!1);M.useEffect(()=>{x(!0)},[]);const v=async()=>{try{a(!0),d("");const C=await i();C.success||d(C.error||"Google sign in failed")}catch{d("An error occurred. Please try again.")}finally{a(!1)}};return o.jsxs("div",{className:"auth-page login-page",children:[o.jsxs("div",{className:`auth-container ${f?"visible":""}`,children:[o.jsxs("div",{className:"auth-header",children:[o.jsx("h1",{children:"Welcome Back"}),o.jsx("p",{children:"Sign in to continue your conversations"})]}),o.jsxs("div",{className:"auth-form",children:[l&&o.jsx("div",{className:"error-message animate-shake",children:l}),o.jsxs("button",{type:"button",className:`btn btn-google ${n?"loading":""}`,onClick:v,disabled:n,children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),n?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"spinner"}),"Signing in..."]}):"Continue with Google"]})]})]}),o.jsx("style",{children:`
        @keyframes bounce {
          0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
          40% { transform: translateY(-10px); }
          60% { transform: translateY(-5px); }
        }

        @keyframes pulse {
          0% { transform: scale(1); }
          50% { transform: scale(1.05); }
          100% { transform: scale(1); }
        }

        .auth-container.visible {
          animation: slideIn 0.6s ease-out;
        }

        @keyframes slideIn {
          from {
            opacity: 0;
            transform: translateY(50px) scale(0.9);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        .animate-shake {
          animation: shake 0.5s ease-in-out;
        }

        .btn-google.loading {
          position: relative;
          overflow: hidden;
        }

        .btn-google.loading::before {
          content: '';
          position: absolute;
          top: 0;
          left: -100%;
          width: 100%;
          height: 100%;
          background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
          animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
          0% { left: -100%; }
          100% { left: 100%; }
        }
      `})]})},c_=()=>{const{signUpWithGoogle:i}=Xa(),[n,a]=M.useState(!1),[l,d]=M.useState(""),f=async()=>{try{a(!0),d("");const x=await i();x.success||d(x.error||"Google sign up failed")}catch{d("An error occurred. Please try again.")}finally{a(!1)}};return o.jsx("div",{className:"auth-page",children:o.jsxs("div",{className:"auth-container",children:[o.jsxs("div",{className:"auth-header",children:[o.jsx("h1",{children:"Create Account"}),o.jsx("p",{children:"Join CaBa messaging platform"})]}),o.jsxs("div",{className:"auth-form",children:[l&&o.jsx("div",{className:"error-message",children:l}),o.jsxs("button",{type:"button",className:"btn btn-google",onClick:f,disabled:n,children:[o.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),n?"Signing up...":"Sign up with Google"]}),o.jsx("div",{className:"auth-footer",children:o.jsxs("p",{children:["Already have an account? ",o.jsx(rc,{to:"/login",children:"Login"})]})})]})]})})},u_=()=>{const{supabase:i}=ds(),[n,a]=M.useState(""),[l,d]=M.useState(!1),[f,x]=M.useState({text:"",type:""}),v=R=>R?R.startsWith("+")?R:"+"+R.replace(/\D/g,""):"",C=R=>R?/^(\+)?\d{1,15}$/.test(R):!1,w=async R=>{try{const T=R.startsWith("+")?R.substring(1):R,{data:O,error:L}=await i.from("users").select("*").eq("phone",T).single();return L?(console.error("Error getting user by phone:",L),null):O||null}catch(T){return console.error("Error in getUserByPhone:",T),null}},A=R=>{if(!R)return"";const[T,O]=R.split("@");return T.length<=2?R:T[0]+"*".repeat(T.length-2)+T[T.length-1]+"@"+O},N=async R=>{R.preventDefault();const T=v(n.trim());if(!C(T)){x({text:"Invalid phone number",type:"error"});return}d(!0),x({text:"",type:""});try{const O=await w(T);if(!O){x({text:"Phone number not registered",type:"error"}),d(!1);return}if(!O.email){x({text:"No email found. Please contact support.",type:"error"}),d(!1);return}const{error:L}=await i.auth.resetPasswordForEmail(O.email,{redirectTo:`${window.location.origin}/CaBa/reset-password`});if(L)throw L;x({text:` Password reset link sent to ${A(O.email)}. Check your email inbox!`,type:"success"}),a("")}catch(O){console.error("Forgot password error:",O),x({text:O.message,type:"error"})}finally{d(!1)}};return o.jsx("div",{className:"container",children:o.jsxs("div",{className:"card",children:[o.jsxs("div",{className:"logo",children:[o.jsx("div",{className:"logo-icon",children:"lock"}),o.jsx("h1",{children:"DigiDad"})]}),o.jsx("h2",{children:"Forgot Password"}),o.jsx("p",{className:"subtitle",children:"Enter your phone number"}),o.jsxs("form",{id:"forgotPasswordForm",onSubmit:N,children:[o.jsxs("div",{className:"input-group",children:[o.jsxs("label",{htmlFor:"phone",children:[o.jsx("span",{className:"icon",children:"phone"}),"Phone Number"]}),o.jsx("input",{type:"tel",id:"phone",placeholder:"+911234567890",required:!0,autoComplete:"tel",value:n,onChange:R=>a(R.target.value)}),o.jsx("small",{children:"We'll send a reset link to your registered email"})]}),o.jsx("button",{type:"submit",id:"submitBtn",className:"btn-primary",disabled:l,children:l?"Sending...":"Send Reset Link"}),o.jsx("div",{id:"message",className:"message",style:{display:f.text?"block":"none"},children:f.text})]}),o.jsx("div",{className:"footer",children:o.jsx(rc,{to:"/login",children:" Back to Login"})})]})})},d_=()=>{const{supabase:i}=ds(),n=us(),[a,l]=M.useState(""),[d,f]=M.useState(""),[x,v]=M.useState(!1),[C,w]=M.useState({text:"",type:""}),[A,N]=M.useState(!1);M.useEffect(()=>{const O=window.location.hash,B=new URLSearchParams(window.location.search).get("recovery");console.log("ResetPassword: Current hash:",O),console.log("ResetPassword: Recovery param:",B);let H,U="";if(O&&O.includes("access_token")?(H=new URLSearchParams(O.substring(1)),U="hash"):B&&(H=new URLSearchParams(decodeURIComponent(B)),U="query"),H){const P=H.get("access_token"),K=H.get("refresh_token"),Z=H.get("type");console.log(`ResetPassword: Extracted params from ${U}:`,{accessToken:!!P,refreshToken:!!K,type:Z}),Z==="recovery"&&P&&K?(console.log("ResetPassword: Setting recovery session..."),i.auth.setSession({access_token:P,refresh_token:K}).then(({data:W,error:X})=>{X?(console.error("Error setting recovery session:",X),w({text:"Invalid or expired reset link",type:"error"})):(console.log("Recovery session set successfully"),N(!0),w({text:"Please enter your new password",type:"success"}),window.history.replaceState(null,"",window.location.pathname))})):(console.log("ResetPassword: Invalid recovery parameters"),w({text:"Invalid reset link. Please request a new password reset.",type:"error"}))}else console.log("ResetPassword: No recovery parameters found"),w({text:"Invalid reset link. Please request a new password reset.",type:"error"})},[i.auth]);const R=async O=>{if(O.preventDefault(),a.length<6){w({text:"Password must be at least 6 characters",type:"error"});return}if(a!==d){w({text:"Passwords do not match",type:"error"});return}v(!0),w({text:"",type:""});try{const{error:L}=await i.auth.updateUser({password:a});if(L)throw L;w({text:"Password updated successfully! Redirecting to login...",type:"success"}),setTimeout(async()=>{await i.auth.signOut(),n("/login")},2e3)}catch(L){console.error("Error updating password:",L),w({text:L.message||"Failed to update password. Please try again.",type:"error"})}finally{v(!1)}},T=O=>{const L=document.getElementById(O),B=L.nextElementSibling;L.type==="password"?(L.type="text",B&&(B.querySelector(".eye-icon i").className="fas fa-eye-slash")):(L.type="password",B&&(B.querySelector(".eye-icon i").className="fas fa-eye"))};return o.jsx("div",{className:"auth-page",children:o.jsxs("div",{className:"auth-container",children:[o.jsxs("div",{className:"auth-header",children:[o.jsx("div",{className:"app-logo",children:o.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 80 80",children:[o.jsx("circle",{cx:"40",cy:"40",r:"35",fill:"var(--primary-color)"}),o.jsx("text",{x:"40",y:"52",fontSize:"35",fill:"white",textAnchor:"middle",fontWeight:"bold",children:"DD"})]})}),o.jsx("h1",{className:"app-name",children:"DigiDad"}),o.jsx("p",{className:"app-tagline",children:"Reset your password"})]}),o.jsxs("form",{id:"resetPasswordForm",className:"auth-form",onSubmit:R,children:[o.jsx("h2",{children:"Reset Password"}),o.jsx("p",{className:"form-subtitle",children:"Enter your new password"}),o.jsxs("div",{className:"input-group",children:[o.jsx("label",{htmlFor:"password",children:"New Password"}),o.jsxs("div",{className:"password-input",children:[o.jsx("input",{type:"password",id:"password",placeholder:"Enter new password",required:!0,minLength:"6",value:a,onChange:O=>l(O.target.value),disabled:!A}),o.jsx("button",{type:"button",className:"toggle-password",onClick:()=>T("password"),disabled:!A,children:o.jsx("span",{className:"eye-icon",children:o.jsx("i",{className:"fas fa-eye"})})})]}),o.jsx("small",{className:"input-hint",children:"At least 6 characters"})]}),o.jsxs("div",{className:"input-group",children:[o.jsx("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),o.jsxs("div",{className:"password-input",children:[o.jsx("input",{type:"password",id:"confirmPassword",placeholder:"Confirm new password",required:!0,minLength:"6",value:d,onChange:O=>f(O.target.value),disabled:!A}),o.jsx("button",{type:"button",className:"toggle-password",onClick:()=>T("confirmPassword"),disabled:!A,children:o.jsx("span",{className:"eye-icon",children:o.jsx("i",{className:"fas fa-eye"})})})]})]}),o.jsxs("button",{type:"submit",className:"btn-primary",disabled:x||!A,children:[o.jsx("span",{className:"btn-text",children:x?"Updating...":"Update Password"}),x&&o.jsx("span",{className:"btn-loader",style:{display:"inline-block"},children:o.jsx("div",{className:"spinner"})})]}),o.jsx("div",{id:"message",className:"message",style:{display:C.text?"block":"none"},children:C.text})]}),o.jsxs("div",{className:"auth-switch",children:["Remember your password? ",o.jsx(rc,{to:"/login",children:"Login"})]})]})})},Uo={classic_purple:{name:"Classic Purple",category:"Default",background:`
      radial-gradient(circle at 25% 75%, rgba(139, 92, 246, 0.15) 0%, transparent 60%),
      radial-gradient(circle at 75% 25%, rgba(168, 85, 247, 0.12) 0%, transparent 55%),
      radial-gradient(circle at 50% 50%, rgba(124, 58, 237, 0.08) 0%, transparent 70%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #8b5cf6 0%, #7c3aed 50%, #6d28d9 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%)",text:"#f8fafc"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #f1f5f9 100%)",text:"#0f172a"},header:{background:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",text:"#ffffff",iconColor:"#f1f5f9"},input:{background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",text:"#1e293b",iconColor:"#8b5cf6"},buttons:{background:"linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)",text:"#ffffff",iconColor:"#ffffff"}},electric_dreams:{name:"Electric Dreams",category:"Futuristic",background:`
      radial-gradient(circle at 20% 80%, rgba(6, 182, 212, 0.2) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(59, 130, 246, 0.25) 0%, transparent 55%),
      radial-gradient(circle at 50% 50%, rgba(168, 85, 247, 0.15) 0%, transparent 60%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #0c4a6e 0%, #1e40af 50%, #581c87 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #0ea5e9 0%, #3b82f6 100%)",text:"#f0f9ff"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%)",text:"#0c4a6e"},header:{background:"linear-gradient(135deg, #0ea5e9 0%, #3b82f6 100%)",text:"#ffffff",iconColor:"#f0f9ff"},input:{background:"linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%)",text:"#0c4a6e",iconColor:"#0ea5e9"},buttons:{background:"linear-gradient(135deg, #0ea5e9 0%, #3b82f6 100%)",text:"#ffffff",iconColor:"#ffffff"}},dark_professional:{name:"Dark Professional",category:"Dark",background:`
      radial-gradient(circle at 30% 70%, rgba(15, 23, 42, 0.4) 0%, transparent 60%),
      radial-gradient(circle at 70% 30%, rgba(30, 41, 59, 0.3) 0%, transparent 55%),
      radial-gradient(circle at 50% 50%, rgba(51, 65, 85, 0.2) 0%, transparent 70%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #0f172a 0%, #1e293b 50%, #334155 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #475569 0%, #64748b 100%)",text:"#f8fafc"},receivedMessage:{background:"linear-gradient(135deg, #1e293b 0%, #334155 100%)",text:"#e2e8f0"},header:{background:"linear-gradient(135deg, #0f172a 0%, #1e293b 100%)",text:"#ffffff",iconColor:"#e2e8f0"},input:{background:"linear-gradient(135deg, #334155 0%, #475569 100%)",text:"#f8fafc",iconColor:"#94a3b8"},buttons:{background:"linear-gradient(135deg, #475569 0%, #64748b 100%)",text:"#f8fafc",iconColor:"#f8fafc"}},ocean_depths:{name:"Ocean Depths",category:"Nature",background:`
      radial-gradient(circle at 25% 75%, rgba(14, 165, 233, 0.18) 0%, transparent 55%),
      radial-gradient(circle at 75% 25%, rgba(2, 132, 199, 0.22) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(6, 182, 212, 0.12) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #0c4a6e 0%, #075985 50%, #0369a1 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #0284c7 0%, #0369a1 100%)",text:"#f0f9ff"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%)",text:"#0c4a6e"},header:{background:"linear-gradient(135deg, #0c4a6e 0%, #075985 100%)",text:"#ffffff",iconColor:"#f0f9ff"},input:{background:"linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%)",text:"#0c4a6e",iconColor:"#0284c7"},buttons:{background:"linear-gradient(135deg, #0c4a6e 0%, #075985 100%)",text:"#ffffff",iconColor:"#ffffff"}},forest_mist:{name:"Forest Mist",category:"Nature",background:`
      radial-gradient(circle at 20% 80%, rgba(34, 197, 94, 0.15) 0%, transparent 55%),
      radial-gradient(circle at 80% 20%, rgba(22, 163, 74, 0.18) 0%, transparent 60%),
      radial-gradient(circle at 60% 40%, rgba(74, 222, 128, 0.10) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #14532d 0%, #166534 50%, #15803d 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #16a34a 0%, #15803d 100%)",text:"#f0fdf4"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%)",text:"#14532d"},header:{background:"linear-gradient(135deg, #14532d 0%, #166534 100%)",text:"#ffffff",iconColor:"#f0fdf4"},input:{background:"linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%)",text:"#14532d",iconColor:"#16a34a"},buttons:{background:"linear-gradient(135deg, #14532d 0%, #166534 100%)",text:"#ffffff",iconColor:"#ffffff"}},sunset_glow:{name:"Sunset Glow",category:"Colorful",background:`
      radial-gradient(circle at 25% 75%, rgba(251, 146, 60, 0.16) 0%, transparent 55%),
      radial-gradient(circle at 75% 25%, rgba(234, 88, 12, 0.20) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(249, 115, 22, 0.12) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #c2410c 0%, #ea580c 50%, #f97316 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #ea580c 0%, #dc2626 100%)",text:"#fff7ed"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #fff7ed 100%)",text:"#9a3412"},header:{background:"linear-gradient(135deg, #c2410c 0%, #ea580c 100%)",text:"#ffffff",iconColor:"#fff7ed"},input:{background:"linear-gradient(135deg, #ffffff 0%, #fff7ed 100%)",text:"#9a3412",iconColor:"#ea580c"},buttons:{background:"linear-gradient(135deg, #c2410c 0%, #ea580c 100%)",text:"#ffffff",iconColor:"#ffffff"}},cosmic_purple:{name:"Cosmic Purple",category:"Elegant",background:`
      radial-gradient(circle at 30% 70%, rgba(147, 51, 234, 0.18) 0%, transparent 55%),
      radial-gradient(circle at 70% 30%, rgba(124, 58, 237, 0.22) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(168, 85, 247, 0.14) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #581c87 0%, #6b21a8 50%, #7c3aed 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #7c3aed 0%, #6b21a8 100%)",text:"#f3e8ff"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #faf5ff 100%)",text:"#581c87"},header:{background:"linear-gradient(135deg, #581c87 0%, #6b21a8 100%)",text:"#ffffff",iconColor:"#f3e8ff"},input:{background:"linear-gradient(135deg, #ffffff 0%, #faf5ff 100%)",text:"#581c87",iconColor:"#8b5cf6"},buttons:{background:"linear-gradient(135deg, #581c87 0%, #6b21a8 100%)",text:"#ffffff",iconColor:"#ffffff"}},golden_hour:{name:"Golden Hour",category:"Colorful",background:`
      radial-gradient(circle at 20% 80%, rgba(245, 158, 11, 0.15) 0%, transparent 55%),
      radial-gradient(circle at 80% 20%, rgba(217, 119, 6, 0.18) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(251, 191, 36, 0.10) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #92400e 0%, #b45309 50%, #d97706 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #d97706 0%, #b45309 100%)",text:"#fffbeb"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #fffbeb 100%)",text:"#92400e"},header:{background:"linear-gradient(135deg, #92400e 0%, #b45309 100%)",text:"#ffffff",iconColor:"#fffbeb"},input:{background:"linear-gradient(135deg, #ffffff 0%, #fffbeb 100%)",text:"#92400e",iconColor:"#d97706"},buttons:{background:"linear-gradient(135deg, #92400e 0%, #b45309 100%)",text:"#ffffff",iconColor:"#ffffff"}},midnight_city:{name:"Midnight City",category:"Dark",background:`
      radial-gradient(circle at 30% 70%, rgba(30, 27, 75, 0.25) 0%, transparent 55%),
      radial-gradient(circle at 70% 30%, rgba(49, 46, 129, 0.30) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(79, 70, 229, 0.15) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #0f0f23 0%, #1e1b4b 50%, #312e81 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #4338ca 0%, #3730a3 100%)",text:"#e0e7ff"},receivedMessage:{background:"linear-gradient(135deg, #1e1b4b 0%, #312e81 100%)",text:"#c7d2fe"},header:{background:"linear-gradient(135deg, #0f0f23 0%, #1e1b4b 100%)",text:"#ffffff",iconColor:"#e0e7ff"},input:{background:"linear-gradient(135deg, #312e81 0%, #4338ca 100%)",text:"#e0e7ff",iconColor:"#a5b4fc"},buttons:{background:"linear-gradient(135deg, #4338ca 0%, #3730a3 100%)",text:"#e0e7ff",iconColor:"#e0e7ff"}},rose_garden:{name:"Rose Garden",category:"Colorful",background:`
      radial-gradient(circle at 25% 75%, rgba(244, 63, 94, 0.16) 0%, transparent 55%),
      radial-gradient(circle at 75% 25%, rgba(219, 39, 119, 0.20) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(236, 72, 153, 0.12) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #be185d 0%, #db2777 50%, #ec4899 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #db2777 0%, #be185d 100%)",text:"#fdf2f8"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #fdf2f8 100%)",text:"#be185d"},header:{background:"linear-gradient(135deg, #be185d 0%, #db2777 100%)",text:"#ffffff",iconColor:"#fdf2f8"},input:{background:"linear-gradient(135deg, #ffffff 0%, #fdf2f8 100%)",text:"#be185d",iconColor:"#ec4899"},buttons:{background:"linear-gradient(135deg, #be185d 0%, #db2777 100%)",text:"#ffffff",iconColor:"#ffffff"}},emerald_forest:{name:"Emerald Forest",category:"Nature",background:`
      radial-gradient(circle at 20% 80%, rgba(16, 185, 129, 0.14) 0%, transparent 55%),
      radial-gradient(circle at 80% 20%, rgba(5, 150, 105, 0.18) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(52, 211, 153, 0.10) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #047857 0%, #059669 50%, #10b981 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #059669 0%, #047857 100%)",text:"#ecfdf5"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #ecfdf5 100%)",text:"#14532d"},header:{background:"linear-gradient(135deg, #047857 0%, #059669 100%)",text:"#ffffff",iconColor:"#ecfdf5"},input:{background:"linear-gradient(135deg, #ffffff 0%, #ecfdf5 100%)",text:"#14532d",iconColor:"#10b981"},buttons:{background:"linear-gradient(135deg, #047857 0%, #059669 100%)",text:"#ffffff",iconColor:"#ffffff"}},nebula:{name:"Nebula",category:"Elegant",background:`
      radial-gradient(circle at 30% 70%, rgba(236, 72, 153, 0.16) 0%, transparent 55%),
      radial-gradient(circle at 70% 30%, rgba(139, 92, 246, 0.20) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(168, 85, 247, 0.12) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #831843 0%, #a21caf 50%, #7c3aed 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #a21caf 0%, #7c3aed 100%)",text:"#fdf2f8"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #fdf2f8 100%)",text:"#831843"},header:{background:"linear-gradient(135deg, #831843 0%, #a21caf 100%)",text:"#ffffff",iconColor:"#fdf2f8"},input:{background:"linear-gradient(135deg, #ffffff 0%, #fdf2f8 100%)",text:"#831843",iconColor:"#ec4899"},buttons:{background:"linear-gradient(135deg, #831843 0%, #a21caf 100%)",text:"#ffffff",iconColor:"#ffffff"}},cyberpunk:{name:"Cyberpunk",category:"Dark",background:`
      radial-gradient(circle at 25% 75%, rgba(0, 255, 255, 0.08) 0%, transparent 50%),
      radial-gradient(circle at 75% 25%, rgba(255, 0, 255, 0.06) 0%, transparent 55%),
      radial-gradient(circle at 50% 50%, rgba(0, 255, 0, 0.04) 0%, transparent 60%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #000000 0%, #0a0a0a 50%, #1a1a1a 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #00ffff 0%, #0080ff 100%)",text:"#000000"},receivedMessage:{background:"linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)",text:"#00ff00"},header:{background:"linear-gradient(135deg, #000000 0%, #1a1a1a 100%)",text:"#00ffff",iconColor:"#00ff00"},input:{background:"linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%)",text:"#00ff00",iconColor:"#00ffff"},buttons:{background:"linear-gradient(135deg, #00ffff 0%, #0080ff 100%)",text:"#000000",iconColor:"#000000"}},telegram_blue:{name:"Telegram Blue",category:"Professional",background:`
      radial-gradient(circle at 30% 70%, rgba(0, 136, 204, 0.15) 0%, transparent 55%),
      radial-gradient(circle at 70% 30%, rgba(0, 95, 153, 0.18) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(59, 130, 246, 0.10) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #003d5b 0%, #0088cc 50%, #3b82f6 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #0088cc 0%, #0369a1 100%)",text:"#f0f9ff"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%)",text:"#003d5b"},header:{background:"linear-gradient(135deg, #003d5b 0%, #0088cc 100%)",text:"#ffffff",iconColor:"#f0f9ff"},input:{background:"linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%)",text:"#003d5b",iconColor:"#0088cc"},buttons:{background:"linear-gradient(135deg, #003d5b 0%, #0088cc 100%)",text:"#ffffff",iconColor:"#ffffff"}},spring_vibes:{name:"Spring Vibes",category:"Nature",background:`
      radial-gradient(circle at 20% 80%, rgba(255, 222, 233, 0.25) 0%, transparent 55%),
      radial-gradient(circle at 80% 20%, rgba(181, 255, 252, 0.30) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(236, 252, 203, 0.20) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #fce7f3 0%, #ecfdf5 50%, #f0fdfa 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #059669 0%, #047857 100%)",text:"#ffffff",shadow:"0 3px 12px rgba(5, 150, 105, 0.3)",border:"1px solid rgba(255,255,255,0.2)"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",text:"#1e293b",shadow:"0 2px 8px rgba(0,0,0,0.1)",border:"1px solid rgba(30, 41, 59, 0.1)"},header:{background:"linear-gradient(135deg, #047857 0%, #059669 100%)",text:"#ffffff",iconColor:"#ffffff",shadow:"0 2px 8px rgba(4, 120, 87, 0.3)"},input:{background:"linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%)",text:"#1e293b",iconColor:"#059669",border:"1px solid rgba(5, 150, 105, 0.2)",shadow:"0 2px 8px rgba(0,0,0,0.1)"},buttons:{background:"linear-gradient(135deg, #047857 0%, #059669 100%)",text:"#ffffff",iconColor:"#ffffff"}},autumn_leaves:{name:"Autumn Leaves",category:"Nature",background:`
      radial-gradient(circle at 25% 75%, rgba(234, 88, 12, 0.16) 0%, transparent 55%),
      radial-gradient(circle at 75% 25%, rgba(154, 52, 18, 0.20) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(245, 158, 11, 0.12) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #7c2d12 0%, #9a3412 50%, #ea580c 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #ea580c 0%, #dc2626 100%)",text:"#fff7ed"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #fff7ed 100%)",text:"#7c2d12"},header:{background:"linear-gradient(135deg, #7c2d12 0%, #ea580c 100%)",text:"#ffffff",iconColor:"#fff7ed"},input:{background:"linear-gradient(135deg, #ffffff 0%, #fff7ed 100%)",text:"#7c2d12",iconColor:"#ea580c"},buttons:{background:"linear-gradient(135deg, #7c2d12 0%, #ea580c 100%)",text:"#ffffff",iconColor:"#ffffff"}},winter_calm:{name:"Winter Calm",category:"Nature",background:`
      radial-gradient(circle at 30% 70%, rgba(137, 247, 254, 0.22) 0%, transparent 55%),
      radial-gradient(circle at 70% 30%, rgba(102, 166, 255, 0.18) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(59, 130, 246, 0.12) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #e0f2fe 0%, #bae6fd 50%, #7dd3fc 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #0284c7 0%, #0369a1 100%)",text:"#ffffff",shadow:"0 3px 12px rgba(2, 132, 199, 0.3)",border:"1px solid rgba(255,255,255,0.2)"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%)",text:"#0c4a6e",shadow:"0 2px 8px rgba(0,0,0,0.1)",border:"1px solid rgba(12, 74, 110, 0.1)"},header:{background:"linear-gradient(135deg, #0c4a6e 0%, #0284c7 100%)",text:"#ffffff",iconColor:"#ffffff",shadow:"0 2px 8px rgba(12, 74, 110, 0.3)"},input:{background:"linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%)",text:"#0c4a6e",iconColor:"#0284c7",border:"1px solid rgba(2, 132, 199, 0.2)",shadow:"0 2px 8px rgba(0,0,0,0.1)"},buttons:{background:"linear-gradient(135deg, #0c4a6e 0%, #0284c7 100%)",text:"#ffffff",iconColor:"#ffffff"}},desert_dunes:{name:"Desert Dunes",category:"Nature",background:`
      radial-gradient(circle at 20% 80%, rgba(253, 230, 138, 0.18) 0%, transparent 55%),
      radial-gradient(circle at 80% 20%, rgba(245, 158, 11, 0.22) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(251, 191, 36, 0.15) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #fef3c7 0%, #fde68a 50%, #facc15 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #ca8a04 0%, #a16207 100%)",text:"#ffffff",shadow:"0 3px 12px rgba(202, 138, 4, 0.3)",border:"1px solid rgba(255,255,255,0.2)"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #fffbeb 100%)",text:"#78350f",shadow:"0 2px 8px rgba(0,0,0,0.1)",border:"1px solid rgba(120, 53, 15, 0.1)"},header:{background:"linear-gradient(135deg, #78350f 0%, #ca8a04 100%)",text:"#ffffff",iconColor:"#ffffff",shadow:"0 2px 8px rgba(120, 53, 15, 0.3)"},input:{background:"linear-gradient(135deg, #ffffff 0%, #fffbeb 100%)",text:"#78350f",iconColor:"#ca8a04",border:"1px solid rgba(202, 138, 4, 0.2)",shadow:"0 2px 8px rgba(0,0,0,0.1)"},buttons:{background:"linear-gradient(135deg, #78350f 0%, #ca8a04 100%)",text:"#ffffff",iconColor:"#ffffff"}},lavender_fields:{name:"Lavender Fields",category:"Nature",background:`
      radial-gradient(circle at 25% 75%, rgba(196, 181, 253, 0.18) 0%, transparent 55%),
      radial-gradient(circle at 75% 25%, rgba(139, 92, 246, 0.15) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(167, 139, 250, 0.12) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #ede9fe 0%, #c4b5fd 50%, #a78bfa 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%)",text:"#f3e8ff"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #faf5ff 100%)",text:"#581c87"},header:{background:"linear-gradient(135deg, #581c87 0%, #7c3aed 100%)",text:"#ffffff",iconColor:"#f3e8ff"},input:{background:"linear-gradient(135deg, #ffffff 0%, #faf5ff 100%)",text:"#581c87",iconColor:"#8b5cf6"},buttons:{background:"linear-gradient(135deg, #581c87 0%, #7c3aed 100%)",text:"#ffffff",iconColor:"#ffffff"}},cherry_blossom:{name:"Cherry Blossom",category:"Nature",background:`
      radial-gradient(circle at 30% 70%, rgba(253, 164, 175, 0.22) 0%, transparent 55%),
      radial-gradient(circle at 70% 30%, rgba(244, 63, 94, 0.18) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(251, 113, 133, 0.14) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #fce7f3 0%, #fda4af 50%, #fb7185 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #e11d48 0%, #be185d 100%)",text:"#ffffff",shadow:"0 3px 12px rgba(225, 29, 72, 0.3)",border:"1px solid rgba(255,255,255,0.2)"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #fdf2f8 100%)",text:"#9f1239",shadow:"0 2px 8px rgba(0,0,0,0.1)",border:"1px solid rgba(159, 18, 57, 0.1)"},header:{background:"linear-gradient(135deg, #9f1239 0%, #e11d48 100%)",text:"#ffffff",iconColor:"#ffffff",shadow:"0 2px 8px rgba(159, 18, 57, 0.3)"},input:{background:"linear-gradient(135deg, #ffffff 0%, #fdf2f8 100%)",text:"#9f1239",iconColor:"#f43f5e",border:"1px solid rgba(244, 63, 94, 0.2)",shadow:"0 2px 8px rgba(0,0,0,0.1)"},buttons:{background:"linear-gradient(135deg, #9f1239 0%, #e11d48 100%)",text:"#ffffff",iconColor:"#ffffff"}},rainy_day:{name:"Rainy Day",category:"Nature",background:`
      radial-gradient(circle at 20% 80%, rgba(156, 163, 175, 0.15) 0%, transparent 55%),
      radial-gradient(circle at 80% 20%, rgba(75, 85, 99, 0.18) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(107, 114, 128, 0.12) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #f3f4f6 0%, #d1d5db 50%, #9ca3af 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #4b5563 0%, #374151 100%)",text:"#f9fafb"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #f9fafb 100%)",text:"#1f2937"},header:{background:"linear-gradient(135deg, #1f2937 0%, #4b5563 100%)",text:"#ffffff",iconColor:"#f9fafb"},input:{background:"linear-gradient(135deg, #ffffff 0%, #f9fafb 100%)",text:"#1f2937",iconColor:"#6b7280"},buttons:{background:"linear-gradient(135deg, #1f2937 0%, #4b5563 100%)",text:"#ffffff",iconColor:"#ffffff"}},sunset_bliss:{name:"Sunset Bliss",category:"Colorful",background:`
      radial-gradient(circle at 25% 75%, rgba(251, 146, 60, 0.18) 0%, transparent 55%),
      radial-gradient(circle at 75% 25%, rgba(239, 68, 68, 0.22) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(245, 158, 11, 0.14) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #fed7aa 0%, #fb923c 50%, #f97316 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)",text:"#fef2f2"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #fff7ed 100%)",text:"#9a3412"},header:{background:"linear-gradient(135deg, #9a3412 0%, #dc2626 100%)",text:"#ffffff",iconColor:"#fff7ed"},input:{background:"linear-gradient(135deg, #ffffff 0%, #fff7ed 100%)",text:"#9a3412",iconColor:"#f97316"},buttons:{background:"linear-gradient(135deg, #9a3412 0%, #dc2626 100%)",text:"#ffffff",iconColor:"#ffffff"}},mint_fresh:{name:"Mint Fresh",category:"Nature",background:`
      radial-gradient(circle at 20% 80%, rgba(16, 185, 129, 0.15) 0%, transparent 55%),
      radial-gradient(circle at 80% 20%, rgba(52, 211, 153, 0.18) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(134, 239, 172, 0.12) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #d1fae5 0%, #86efac 50%, #4ade80 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #059669 0%, #047857 100%)",text:"#f0fdf4"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%)",text:"#14532d"},header:{background:"linear-gradient(135deg, #14532d 0%, #059669 100%)",text:"#ffffff",iconColor:"#f0fdf4"},input:{background:"linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%)",text:"#14532d",iconColor:"#10b981"},buttons:{background:"linear-gradient(135deg, #14532d 0%, #059669 100%)",text:"#ffffff",iconColor:"#ffffff"}},royal_elegance:{name:"Royal Elegance",category:"Elegant",background:`
      radial-gradient(circle at 30% 70%, rgba(124, 58, 237, 0.18) 0%, transparent 55%),
      radial-gradient(circle at 70% 30%, rgba(139, 92, 246, 0.22) 0%, transparent 60%),
      radial-gradient(circle at 50% 50%, rgba(168, 85, 247, 0.14) 0%, transparent 65%),
      linear-gradient(calc(135deg + var(--scroll-percentage, 0) * 1.8deg), #ede9fe 0%, #c4b5fd 50%, #a78bfa 100%)
    `,sentMessage:{background:"linear-gradient(135deg, #6b21a8 0%, #581c87 100%)",text:"#f3e8ff"},receivedMessage:{background:"linear-gradient(135deg, #ffffff 0%, #faf5ff 100%)",text:"#581c87"},header:{background:"linear-gradient(135deg, #581c87 0%, #6b21a8 100%)",text:"#ffffff",iconColor:"#f3e8ff"},input:{background:"linear-gradient(135deg, #ffffff 0%, #faf5ff 100%)",text:"#581c87",iconColor:"#8b5cf6"},buttons:{background:"linear-gradient(135deg, #581c87 0%, #6b21a8 100%)",text:"#ffffff",iconColor:"#ffffff"}}},J2=M.createContext(),h_=({children:i})=>{const{supabase:n}=ds(),[a,l]=M.useState("classic_purple"),[d,f]=M.useState(null),[x,v]=M.useState(!0),[C,w]=M.useState(0);M.useEffect(()=>{document.documentElement.style.setProperty("--scroll-percentage",C)},[C]);const A=async H=>{if(!H){l("classic_purple"),v(!1);return}const U=`digidad_theme_debounce_${H}`,P=Date.now(),K=parseInt(localStorage.getItem(U)||"0");if(P-K<1e3){v(!1);return}localStorage.setItem(U,P.toString());const Z=localStorage.getItem(`digidad_chat_theme_${H}`);Z&&Uo[Z]?l(Z):Z||(l("classic_purple"),localStorage.setItem(`digidad_chat_theme_${H}`,"classic_purple")),v(!1)},N=async(H,U,P)=>{if(U)try{localStorage.setItem(`digidad_chat_theme_${U}`,H)}catch{try{localStorage.setItem(`digidad_chat_theme_${U}`,H)}catch{}}},R=H=>{f(H),v(!0),A(H)},T=async(H,U)=>{if(!Uo[H])return;const P=U||d;if(!P){console.error("No chat ID available for theme selection");return}l(H);const K=JSON.parse(localStorage.getItem("currentUser"));await N(H,P,K?.id),L(H)},O=H=>{if(!H)return!1;let U=H;for(;U&&U!==document.body;){const P=U.className||"",K=typeof P=="string"?P:P.toString?P.toString():"";if(K.includes("home-container")||K.includes("chat-list")||K.includes("chat-item")||K.includes("chat-name")||K.includes("chat-time")||K.includes("last-message")||K.includes("chat-info")||K.includes("chat-header")||K.includes("main-content")||K.includes("sidebar"))return!0;U=U.parentElement}return!1},L=H=>{const U=Uo[H];if(!U)return;const P=document.documentElement;P.style.setProperty("--chat-bg-gradient",U.background),P.style.setProperty("--sent-message-bg",U.sentMessage.background),P.style.setProperty("--sent-message-text",U.sentMessage.text),P.style.setProperty("--sent-message-shadow",U.sentMessage.shadow||"0 2px 8px rgba(0,0,0,0.15)"),P.style.setProperty("--sent-message-border",U.sentMessage.border||"none"),P.style.setProperty("--received-message-bg",U.receivedMessage.background),P.style.setProperty("--received-message-text",U.receivedMessage.text),P.style.setProperty("--received-message-shadow",U.receivedMessage.shadow||"0 2px 8px rgba(0,0,0,0.1)"),P.style.setProperty("--received-message-border",U.receivedMessage.border||"none"),P.style.setProperty("--chat-header-bg",U.header.background),P.style.setProperty("--chat-header-text",U.header.text),P.style.setProperty("--chat-header-icon-color",U.header.iconColor),P.style.setProperty("--chat-header-shadow",U.header.shadow||"0 2px 8px rgba(0,0,0,0.15)"),P.style.setProperty("--chat-input-bg",U.input.background),P.style.setProperty("--chat-input-text",U.input.text),P.style.setProperty("--chat-input-icon-color",U.input.iconColor),P.style.setProperty("--chat-input-border",U.input.border||"none"),P.style.setProperty("--chat-input-shadow",U.input.shadow||"0 2px 8px rgba(0,0,0,0.1)"),P.style.setProperty("--chat-buttons-bg",U.buttons.background),P.style.setProperty("--chat-buttons-text",U.buttons.text),P.style.setProperty("--chat-buttons-icon-color",U.buttons.iconColor);const K=(W,X,J)=>{document.querySelectorAll(W).forEach(he=>{O(he)||(he.style[X]=J)})};K(".chat-container","background",U.background),K("#messagesContainer","background",U.background),K(".chat-header","background",U.header.background),K(".chat-header","color",U.header.text),K(".chat-header","boxShadow",U.header.shadow||"0 2px 8px rgba(0,0,0,0.15)"),K(".chat-header","textShadow","0 1px 2px rgba(0,0,0,0.3)"),K(".message-input-area","background",U.input.background),K(".message-input-area","color",U.input.text),K(".message-input-area","border",U.input.border||"none"),K(".message-input-area","boxShadow",U.input.shadow||"0 2px 8px rgba(0,0,0,0.1)"),K(".input-wrapper","background",U.input.background),K(".input-wrapper","border",U.input.border||"none"),K(".input-wrapper","boxShadow",U.input.shadow||"0 2px 8px rgba(0,0,0,0.1)"),K("#messageInput","color",U.input.text),K("#messageInput","textShadow","0 1px 2px rgba(0,0,0,0.1)"),document.querySelectorAll("*").forEach(W=>{if(O(W))return;const X=W.className||"",J=typeof X=="string"?X:X.toString?X.toString():"",q=W.tagName;if(J.includes("chat")&&!J.includes("chat-list")&&!J.includes("chat-item")||q==="BUTTON"&&W.closest(".chat-container")||J.includes("message")&&W.closest(".chat-container")){if(q==="BUTTON"&&(W.style.background=U.buttons.background,W.style.color=U.buttons.text,W.style.border="none",W.style.textShadow="0 1px 2px rgba(0,0,0,0.2)",W.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",W.style.transition="all 0.3s ease"),W.tagName==="I"||W.tagName==="SVG"){const he=W.parentElement?.className||"",ge=typeof he=="string"?he:he.toString?he.toString():"";ge.includes("chat")&&!ge.includes("chat-list")&&(W.style.color=U.header.iconColor,W.style.stroke=U.header.iconColor,W.style.filter="drop-shadow(0 1px 3px rgba(0,0,0,0.4))",W.style.transition="all 0.3s ease")}(J.includes("message-bubble")||J.includes("message"))&&(J.includes("sent")?(W.style.background=U.sentMessage.background,W.style.color=U.sentMessage.text,W.style.border=U.sentMessage.border||"none",W.style.boxShadow=U.sentMessage.shadow||"0 2px 8px rgba(0,0,0,0.15)",W.style.textShadow="0 1px 2px rgba(0,0,0,0.2)"):J.includes("received")&&(W.style.background=U.receivedMessage.background,W.style.color=U.receivedMessage.text,W.style.border=U.receivedMessage.border||"none",W.style.boxShadow=U.receivedMessage.shadow||"0 2px 8px rgba(0,0,0,0.1)",W.style.textShadow="0 1px 2px rgba(0,0,0,0.1)"))}}),document.body.className=document.body.className.replace(/theme-\w+/g,""),document.body.classList.add(`theme-${H.replace("_","-")}`)};M.useEffect(()=>{!x&&d&&L(a)},[a,d,x]);const B={chatTheme:a,chatThemes:Uo,selectTheme:T,setChatId:R,loading:x,currentThemeData:Uo[a]||Uo.classic_purple,setScrollPercentage:w,currentChatId:d};return o.jsx(J2.Provider,{value:B,children:i})},M0=()=>{const i=M.useContext(J2);if(!i)throw new Error("useChatTheme must be used within a ChatThemeProvider");return i},xt="./",Rs=[{id:1,path:`${xt}assets/images/dp-options/00701602b0eac0390b3107b9e2a665e0.jpg`},{id:2,path:`${xt}assets/images/dp-options/1691130988954.jpg`},{id:3,path:`${xt}assets/images/dp-options/aesthetic-cartoon-funny-dp-for-instagram.webp`},{id:4,path:`${xt}assets/images/dp-options/boy-cartoon-dp-with-hoodie.webp`},{id:5,path:`${xt}assets/images/dp-options/download (1).jpg`},{id:6,path:`${xt}assets/images/dp-options/download.jpg`},{id:7,path:`${xt}assets/images/dp-options/funny-profile-picture-wd195eo9rpjy7ax1.jpg`},{id:8,path:`${xt}assets/images/dp-options/funny-whatsapp-dp-for-girls.webp`},{id:9,path:`${xt}assets/images/dp-options/photo_5230962651624575118_y.jpg`},{id:10,path:`${xt}assets/images/dp-options/photo_5230962651624575119_y.jpg`},{id:11,path:`${xt}assets/images/dp-options/photo_5230962651624575120_y.jpg`},{id:12,path:`${xt}assets/images/dp-options/photo_5230962651624575121_y.jpg`},{id:13,path:`${xt}assets/images/dp-options/photo_5230962651624575122_y.jpg`},{id:14,path:`${xt}assets/images/dp-options/photo_5230962651624575123_y.jpg`},{id:15,path:`${xt}assets/images/dp-options/photo_5230962651624575124_y.jpg`},{id:16,path:`${xt}assets/images/dp-options/photo_5230962651624575125_y.jpg`},{id:17,path:`${xt}assets/images/dp-options/photo_5230962651624575126_y.jpg`},{id:18,path:`${xt}assets/images/dp-options/photo_5230962651624575127_y.jpg`},{id:19,path:`${xt}assets/images/dp-options/photo_5235923888607267708_w.jpg`},{id:20,path:`${xt}assets/images/dp-options/photo_5235923888607267709_w.jpg`},{id:21,path:`${xt}assets/images/dp-options/photo_5235923888607267710_w.jpg`},{id:22,path:`${xt}assets/images/dp-options/photo_5235923888607267711_w.jpg`},{id:23,path:`${xt}assets/images/dp-options/photo_5235923888607267712_w.jpg`},{id:24,path:`${xt}assets/images/dp-options/photo_5235923888607267713_w.jpg`},{id:25,path:`${xt}assets/images/dp-options/photo_5235923888607267714_w.jpg`},{id:26,path:`${xt}assets/images/dp-options/photo_5235923888607267715_w.jpg`},{id:27,path:`${xt}assets/images/dp-options/photo_5235923888607267716_w.jpg`},{id:28,path:`${xt}assets/images/dp-options/photo_5235923888607267717_w.jpg`},{id:29,path:`${xt}assets/images/dp-options/photo_5257989785601641848_w.jpg`},{id:30,path:`${xt}assets/images/dp-options/photo_5257989785601641845_w.jpg`},{id:31,path:`${xt}assets/images/dp-options/photo_5257989785601641846_w.jpg`},{id:32,path:`${xt}assets/images/dp-options/photo_5257989785601641850_w.jpg`},{id:33,path:`${xt}assets/images/dp-options/photo_5257989785601641853_w.jpg`},{id:34,path:`${xt}assets/images/dp-options/photo_5257989785601641852_w.jpg`},{id:35,path:`${xt}assets/images/dp-options/photo_5257989785601641849_w.jpg`},{id:36,path:`${xt}assets/images/dp-options/photo_5257989785601641851_w.jpg`},{id:37,path:`${xt}assets/images/dp-options/photo_5257989785601641844_w.jpg`},{id:38,path:`${xt}assets/images/dp-options/photo_5257989785601641779_w.jpg`},{id:39,path:`${xt}assets/images/dp-options/photo_5257989785601641784_w.jpg`},{id:40,path:`${xt}assets/images/dp-options/photo_5257989785601641785_w.jpg`},{id:41,path:`${xt}assets/images/dp-options/photo_5257989785601641781_w.jpg`},{id:42,path:`${xt}assets/images/dp-options/photo_5257989785601641780_w.jpg`},{id:43,path:`${xt}assets/images/dp-options/photo_5257989785601641777_w.jpg`},{id:44,path:`${xt}assets/images/dp-options/photo_5257989785601641778_w.jpg`},{id:45,path:`${xt}assets/images/dp-options/photo_5257989785601641776_w.jpg`},{id:46,path:`${xt}assets/images/dp-options/photo_5257989785601641783_w.jpg`}];const f_=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),g_=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,a,l)=>l?l.toUpperCase():a.toLowerCase()),Pp=i=>{const n=g_(i);return n.charAt(0).toUpperCase()+n.slice(1)},ey=(...i)=>i.filter((n,a,l)=>!!n&&n.trim()!==""&&l.indexOf(n)===a).join(" ").trim(),m_=i=>{for(const n in i)if(n.startsWith("aria-")||n==="role"||n==="title")return!0};var p_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const x_=M.forwardRef(({color:i="currentColor",size:n=24,strokeWidth:a=2,absoluteStrokeWidth:l,className:d="",children:f,iconNode:x,...v},C)=>M.createElement("svg",{ref:C,...p_,width:n,height:n,stroke:i,strokeWidth:l?Number(a)*24/Number(n):a,className:ey("lucide",d),...!f&&!m_(v)&&{"aria-hidden":"true"},...v},[...x.map(([w,A])=>M.createElement(w,A)),...Array.isArray(f)?f:[f]]));const Xe=(i,n)=>{const a=M.forwardRef(({className:l,...d},f)=>M.createElement(x_,{ref:f,iconNode:n,className:ey(`lucide-${f_(Pp(i))}`,`lucide-${i}`,l),...d}));return a.displayName=Pp(i),a};const y_=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],bf=Xe("activity",y_);const w_=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],vf=Xe("archive",w_);const b_=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],v_=Xe("arrow-down",b_);const C_=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],$o=Xe("arrow-left",C_);const __=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],S_=Xe("arrow-right",__);const E_=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Gu=Xe("ban",E_);const A_=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M17 17H4a1 1 0 0 1-.74-1.673C4.59 13.956 6 12.499 6 8a6 6 0 0 1 .258-1.742",key:"178tsu"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.668 3.01A6 6 0 0 1 18 8c0 2.687.77 4.653 1.707 6.05",key:"1hqiys"}]],ty=Xe("bell-off",A_);const N_=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Yu=Xe("bell",N_);const T_=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],c0=Xe("calendar",T_);const j_=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],zp=Xe("chart-column",j_);const R_=[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]],u0=Xe("check-check",R_);const I_=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ny=Xe("check",I_);const O_=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Cf=Xe("circle-check-big",O_);const M_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],k_=Xe("circle-question-mark",M_);const D_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],L_=Xe("circle-x",D_);const B_=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],d0=Xe("clock",B_);const U_=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],sy=Xe("copy",U_);const P_=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],z_=Xe("crown",P_);const F_=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],H_=Xe("database",F_);const q_=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],V_=Xe("download",q_);const G_=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],sd=Xe("ellipsis-vertical",G_);const Y_=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Mu=Xe("eye-off",Y_);const X_=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ya=Xe("eye",X_);const W_=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],k0=Xe("file-text",W_);const Q_=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],h0=Xe("flag",Q_);const K_=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Z_=Xe("heart",K_);const $_=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],ay=Xe("image",$_);const J_=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],eS=Xe("info",J_);const tS=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],nS=Xe("link",tS);const sS=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Fp=Xe("lock",sS);const aS=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],rS=Xe("log-out",aS);const iS=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],oS=Xe("map-pin",iS);const lS=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Ma=Xe("message-circle",lS);const cS=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],ku=Xe("message-square",cS);const uS=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],dS=Xe("mic-off",uS);const hS=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],fS=Xe("mic",hS);const gS=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],mS=Xe("music",gS);const pS=[["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-4 0v-9a2 2 0 0 1 2-2h2",key:"39pd36"}],["rect",{width:"8",height:"4",x:"10",y:"6",rx:"1",key:"aywv1n"}]],ci=Xe("newspaper",pS);const xS=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],yS=Xe("palette",xS);const wS=[["path",{d:"M16 2v6h6",key:"1mfrl5"}],["path",{d:"m22 2-6 6",key:"6f0sa0"}],["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],bS=Xe("phone-incoming",wS);const vS=[["path",{d:"m16 2 6 6",key:"1gw87d"}],["path",{d:"m22 2-6 6",key:"6f0sa0"}],["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],CS=Xe("phone-missed",vS);const _S=[["path",{d:"M10.1 13.9a14 14 0 0 0 3.732 2.668 1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2 18 18 0 0 1-12.728-5.272",key:"1wngk7"}],["path",{d:"M22 2 2 22",key:"y4kqgn"}],["path",{d:"M4.76 13.582A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 .244.473",key:"10hv5p"}]],D0=Xe("phone-off",_S);const SS=[["path",{d:"m16 8 6-6",key:"oawc05"}],["path",{d:"M22 8V2h-6",key:"oqy2zc"}],["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],ES=Xe("phone-outgoing",SS);const AS=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Hs=Xe("phone",AS);const NS=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Hp=Xe("plus",NS);const TS=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],ry=Xe("qr-code",TS);const jS=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ui=Xe("refresh-cw",jS);const RS=[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]],qp=Xe("reply",RS);const IS=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],OS=Xe("rotate-ccw",IS);const MS=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],nc=Xe("search",MS);const kS=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],DS=Xe("send",kS);const LS=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Kl=Xe("settings",LS);const BS=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],iy=Xe("share-2",BS);const US=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],oi=Xe("shield",US);const PS=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ad=Xe("square-pen",PS);const zS=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],js=Xe("trash-2",zS);const FS=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],HS=Xe("upload",FS);const qS=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],VS=Xe("user-check",qS);const GS=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],YS=Xe("user-plus",GS);const XS=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],WS=Xe("user-x",XS);const QS=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],L0=Xe("user",QS);const KS=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],qi=Xe("users",KS);const ZS=[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Vp=Xe("video-off",ZS);const $S=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],fi=Xe("video",$S);const JS=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],eE=Xe("volume-2",JS);const tE=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],nE=Xe("volume-x",tE);const sE=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],rd=Xe("x",sE),B0=({items:i=[],icon:n=o.jsx(sd,{size:20}),buttonClassName:a="",menuClassName:l="",align:d="right"})=>{const[f,x]=M.useState(!1),v=M.useRef(null),{currentThemeData:C}=M0();M.useEffect(()=>{const A=R=>{v.current&&!v.current.contains(R.target)&&x(!1)},N=R=>{const T=R.touches[0]||R.changedTouches[0];T&&v.current&&!v.current.contains(T.target)&&x(!1)};return f&&(document.addEventListener("mousedown",A),document.addEventListener("touchstart",N,{passive:!0})),()=>{document.removeEventListener("mousedown",A),document.removeEventListener("touchstart",N)}},[f]);const w=(A,N)=>{N.preventDefault(),N.stopPropagation(),A.onClick&&A.onClick(),x(!1)};return o.jsxs("div",{className:"dropdown",ref:v,children:[o.jsx("button",{className:`icon-btn ${a}`,onClick:A=>{A.preventDefault(),A.stopPropagation(),x(!f)},onMouseEnter:()=>{},title:"Menu",children:n}),f&&o.jsx("div",{className:`dropdown-menu ${d==="left"?"dropdown-menu-left":""} ${l}`,children:i.map((A,N)=>o.jsx(Px.Fragment,{children:A.divider?o.jsx("div",{className:"dropdown-divider"}):o.jsxs("button",{className:`dropdown-item ${A.danger?"danger":""} ${A.className||""}`,onClick:R=>w(A,R),disabled:A.disabled,style:{...A.style,color:A.danger?"#dc3545":"var(--chat-input-text, #212529)"},children:[A.icon&&o.jsx("span",{className:"dropdown-item-icon",style:{color:A.danger?"#dc3545":"var(--chat-input-icon-color, #667eea)"},children:A.icon}),o.jsx("span",{className:"dropdown-item-label",children:A.label}),A.badge&&o.jsx("span",{className:"dropdown-item-badge",children:A.badge})]})},N))})]})},wr=({isOpen:i,onClose:n,title:a,children:l,size:d="medium",showCloseButton:f=!0,closeOnOverlayClick:x=!0,className:v=""})=>{if(M.useEffect(()=>(i?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[i]),M.useEffect(()=>{const w=A=>{A.key==="Escape"&&i&&n()};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[i,n]),!i)return null;const C=w=>{x&&w.target===w.currentTarget&&n()};return o.jsx("div",{className:"modal-overlay",onClick:C,children:o.jsxs("div",{className:`modal-container modal-${d} ${v}`,children:[(a||f)&&o.jsxs("div",{className:"modal-header",children:[a&&o.jsx("h2",{className:"modal-title",children:a}),f&&o.jsx("button",{className:"modal-close-btn",onClick:n,children:o.jsx(rd,{size:24})})]}),o.jsx("div",{className:"modal-body",children:l})]})})},aE=({message:i,isSent:n,onDownload:a,onView:l})=>{const[d,f]=M.useState(!1),[x,v]=M.useState(0),C=R=>({image:"fas fa-image",video:"fas fa-video",audio:"fas fa-microphone",document:"fas fa-file-pdf",avatar:"fas fa-user-circle"})[R]||"fas fa-file",w=R=>{if(!R||R===0)return"";const T=1024,O=["Bytes","KB","MB","GB"],L=Math.floor(Math.log(R)/Math.log(T));return Math.round(R/Math.pow(T,L)*100)/100+" "+O[L]},A=async()=>{if(i.media_url){f(!0),v(0);try{const R=setInterval(()=>{v(T=>T>=90?(clearInterval(R),T):T+10)},200);await a(i.media_url,i.id),v(100),setTimeout(()=>{f(!1),v(0)},1e3)}catch(R){console.error("Download failed:",R),f(!1),v(0)}}},N=()=>{if(!i.media_url)return o.jsxs("div",{className:"media-unavailable",children:[o.jsx("i",{className:"fas fa-exclamation-circle"}),o.jsx("span",{children:"Media not available"})]});switch(i.message_type){case"image":return o.jsx("div",{className:"image-preview",style:{backgroundImage:`url(${i.media_url})`},onClick:()=>l(i.media_url,"image"),children:o.jsx("div",{className:"image-overlay",children:o.jsx("i",{className:"fas fa-search-plus"})})});case"video":return o.jsx("div",{className:"video-preview",onClick:()=>l(i.media_url,"video"),children:o.jsx("div",{className:"video-overlay",children:o.jsx("i",{className:"fas fa-play-circle"})})});case"audio":return o.jsx("div",{className:"audio-preview",children:o.jsx("i",{className:"fas fa-music"})});case"document":return o.jsx("div",{className:"document-preview",onClick:()=>l(i.media_url,"document"),children:o.jsx("i",{className:"fas fa-file-pdf"})});default:return o.jsx("div",{className:"file-preview",children:o.jsx("i",{className:"fas fa-file"})})}};return n?o.jsxs("div",{className:"media-message sent",children:[o.jsx("div",{className:"media-preview",children:N()}),o.jsxs("div",{className:"media-details",children:[o.jsx("div",{className:"media-name",children:i.content}),o.jsx("div",{className:"media-size",children:w(i.file_size)})]})]}):o.jsx("div",{className:"media-message received",children:d?o.jsxs("div",{className:"download-progress-container",children:[o.jsx("div",{className:"download-progress-bar",children:o.jsx("div",{className:"download-progress-fill",style:{width:`${x}%`}})}),o.jsxs("div",{className:"download-progress-text",children:[x,"%"]})]}):o.jsxs("div",{className:"media-download-container",children:[o.jsx("div",{className:"media-icon",children:o.jsx("i",{className:C(i.message_type)})}),o.jsxs("div",{className:"media-info",children:[o.jsx("div",{className:"media-name",children:i.content}),o.jsx("div",{className:"media-status",children:"Click to download"})]}),o.jsx("button",{className:"btn-download",onClick:A,children:o.jsx("i",{className:"fas fa-download"})})]})})},rE=({message:i,currentUser:n,isSelected:a,isSelectionMode:l,onSelect:d,onReply:f,onDelete:x,onMediaView:v,onMediaDownload:C})=>{const[w,A]=M.useState(!1),[N,R]=M.useState(!1),[T,O]=M.useState(i.content),[L,B]=M.useState(0),[H,U]=M.useState(0),[P,K]=M.useState(0),[Z,W]=M.useState(!1),X=M.useRef(null),J=M.useRef(null),q=i.sender_id===n.id,he=i.reply_to,ge=De=>{De.preventDefault(),l||d()},ie=()=>{l&&d()},be=()=>{f(i),A(!1)},Ie=async()=>{try{await navigator.clipboard.writeText(i.content),A(!1)}catch(De){console.error("Failed to copy message:",De)}},V=()=>{navigator.clipboard.writeText(`Forwarded message:
"${i.content}"`),A(!1)},$=()=>{R(!0),A(!1)},oe=async()=>{if(T.trim()&&T!==i.content)try{const{error:De}=await vt.from("messages").update({content:T.trim(),edited_at:new Date().toISOString()}).eq("id",i.id);if(De)throw De;i.content=T.trim(),i.edited_at=new Date().toISOString()}catch(De){console.error("Error editing message:",De)}R(!1)},ke=()=>{O(i.content),R(!1)},Ge=()=>{W(!0),A(!1)},Ke=async()=>{W(!1);try{const{error:De}=await vt.from("messages").delete().eq("id",i.id);if(De)throw De;x&&x(i.id)}catch(De){console.error("Error deleting message:",De)}},ne=()=>{W(!1)},ye=De=>new Date(De).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),Le=De=>{B(Date.now()),U(De.touches[0].clientX),K(De.touches[0].clientY)},Ue=De=>{const Je=Date.now()-L,mt=De.changedTouches[0].clientX,Wt=De.changedTouches[0].clientY,ft=mt-H,Mt=Wt-P,xn=Math.abs(ft),cn=Math.abs(Mt);if(xn>50&&xn>cn&&ft>0&&!l){be();return}Je>500&&!l&&ge(De)},We=async(De,Ce)=>{C&&await C(De,Ce)},Ne=(De,Ce)=>{v&&v(De,Ce,i)},$e=()=>{let De;if(i.message_type==="news_share")try{const Ce=JSON.parse(i.content);De=o.jsxs("div",{className:"news-share-message",onClick:()=>window.open(Ce.link,"_blank"),children:[o.jsxs("div",{className:"news-share-header",children:[o.jsx(ci,{size:16}),o.jsx("span",{children:"Shared News"})]}),o.jsxs("div",{className:"news-share-content",children:[o.jsx("h4",{children:Ce.title}),o.jsx("p",{children:o.jsx("strong",{children:Ce.source})}),o.jsx("div",{className:"news-share-link",children:"Read Full Article "})]})]})}catch{De=o.jsx("p",{className:"message-text",children:i.content})}else if(i.message_type==="reminder")try{const Ce=JSON.parse(i.content);Ce.type==="reminder_request"&&(De=o.jsxs("div",{className:"reminder-message-card",children:[o.jsxs("div",{className:"reminder-header",children:[o.jsx(Yu,{size:16,className:"reminder-icon"}),o.jsx("span",{className:"reminder-label",children:"REMINDER REQUEST"})]}),o.jsxs("div",{className:"reminder-content",children:[o.jsx("h4",{className:"reminder-title",children:Ce.title}),Ce.description&&o.jsx("p",{className:"reminder-description",children:Ce.description}),o.jsxs("div",{className:"reminder-details",children:[o.jsxs("div",{className:"reminder-time",children:[o.jsx(d0,{size:16}),new Date(Ce.reminder_time).toLocaleString()]}),Ce.location&&o.jsxs("div",{className:"reminder-location",children:[o.jsx(oS,{size:16}),Ce.location]})]})]})]}))}catch{De=o.jsxs("p",{children:[o.jsx(c0,{size:16})," Reminder message"]})}else["image","video","audio","document"].includes(i.message_type)?De=o.jsx(aE,{message:i,isSent:q,onDownload:We,onView:Ne}):De=o.jsx("p",{className:"message-text",children:i.content});return De};return o.jsxs("div",{ref:J,className:`message ${q?"sent":"received"} ${a?"selected":""} ${he?"replied":""} ${i.is_vanished?"vanished":""}`,onClick:ie,onTouchStart:Le,onTouchEnd:Ue,onContextMenu:De=>{De.preventDefault(),l||A(!w)},children:[l&&o.jsx("div",{className:`selection-indicator ${a?"selected":""}`,children:a&&o.jsx("span",{children:""})}),o.jsxs("div",{className:"message-content",children:[o.jsxs("div",{className:"message-bubble",ref:X,children:[he&&o.jsxs("div",{className:"replied-message-container",children:[o.jsxs("div",{className:"replied-message-header",children:[o.jsx(qp,{size:16}),o.jsx("span",{className:"replied-message-user",children:q?"You":"Them"})]}),o.jsx("div",{className:"replied-message-content",children:"Replied message"})]}),N?o.jsxs("div",{className:"message-edit",children:[o.jsx("input",{type:"text",value:T,onChange:De=>O(De.target.value),onKeyDown:De=>{De.key==="Enter"&&oe(),De.key==="Escape"&&ke()},autoFocus:!0}),o.jsxs("div",{className:"edit-actions",children:[o.jsx("button",{onClick:oe,children:"Save"}),o.jsx("button",{onClick:ke,children:"Cancel"})]})]}):$e(),i.vanish_at&&!i.is_vanished&&o.jsxs("div",{className:"vanish-timer",children:[o.jsx(d0,{size:16}),o.jsx("span",{children:"Timer"})]}),q&&o.jsx("span",{className:"message-status",children:i.is_read?o.jsx(u0,{size:16}):o.jsx(ny,{size:16})})]}),o.jsx("div",{className:"message-meta",children:o.jsxs("span",{className:"message-time",children:[ye(i.created_at),i.edited_at&&" (edited)"]})}),w&&!l&&o.jsxs("div",{className:"message-actions",children:[o.jsx("button",{className:"message-arrow-btn",children:o.jsx(sd,{size:16})}),o.jsxs("div",{className:"message-dropdown",children:[o.jsxs("div",{className:"message-option",onClick:be,children:[o.jsx(qp,{size:16,className:"icon"})," Reply"]}),o.jsxs("div",{className:"message-option",onClick:Ie,children:[o.jsx(sy,{size:16,className:"icon"})," Copy"]}),o.jsxs("div",{className:"message-option",onClick:V,children:[o.jsx(iy,{size:16,className:"icon"})," Forward"]}),q&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"message-option",onClick:$,children:[o.jsx(ad,{size:16,className:"icon"})," Edit"]}),o.jsxs("div",{className:"message-option danger",onClick:Ge,children:[o.jsx(js,{size:16,className:"icon"})," Delete"]})]})]})]})]}),Z&&o.jsx("div",{className:"delete-modal-overlay",onClick:ne,children:o.jsxs("div",{className:"delete-modal",onClick:De=>De.stopPropagation(),children:[o.jsx("div",{className:"delete-modal-header",children:o.jsx("h3",{children:"Delete Message"})}),o.jsx("div",{className:"delete-modal-body",children:o.jsx("p",{children:"Are you sure you want to delete this message? This action cannot be undone."})}),o.jsxs("div",{className:"delete-modal-actions",children:[o.jsx("button",{className:"delete-cancel-btn",onClick:ne,style:{padding:"10px 20px",marginRight:"10px"},children:"Cancel"}),o.jsx("button",{className:"delete-confirm-btn",onClick:Ke,style:{padding:"10px 20px",background:"#dc3545",color:"white",border:"none",borderRadius:"4px"},children:"Confirm Delete"})]})]})})]})},iE=({messages:i,currentUser:n,selectedMessages:a,isSelectionMode:l,onMessageSelect:d,onReply:f,onDelete:x,onMediaView:v,onMediaDownload:C})=>{const A=(N=>{const R={};return N.forEach(T=>{const L=new Date(T.created_at).toDateString();R[L]||(R[L]=[]),R[L].push(T)}),R})(i);return!i||i.length===0?o.jsx("div",{className:"messages-wrapper",children:o.jsx("div",{className:"no-messages-placeholder",children:o.jsxs("div",{className:"no-messages-content",children:[o.jsx("div",{className:"no-messages-icon",children:""}),o.jsx("h3",{children:"No messages yet"}),o.jsx("p",{children:"Start the conversation by sending a message!"})]})})}):o.jsx("div",{className:"messages-wrapper",children:Object.entries(A).map(([N,R])=>o.jsxs(Px.Fragment,{children:[o.jsx("div",{className:"date-separator",children:o.jsx("span",{children:new Date(R[0].created_at).toLocaleDateString()})}),R.map(T=>o.jsx(rE,{message:T,currentUser:n,isSelected:a.has(T.id),isSelectionMode:l,onSelect:()=>d(T.id),onReply:()=>f(T),onDelete:x,onMediaView:v,onMediaDownload:C},T.id))]},N))})},oE=({isVisible:i,onClose:n,onFileSelect:a})=>{const l=[{id:"camera",name:"Camera",icon:"fas fa-camera",color:"#E91E63"},{id:"gallery",name:"Gallery",icon:"fas fa-images",color:"#9C27B0"},{id:"video",name:"Video",icon:"fas fa-video",color:"#FF5722"},{id:"audio",name:"Audio",icon:"fas fa-microphone",color:"#FF9800"},{id:"location",name:"Location",icon:"fas fa-map-marker-alt",color:"#4CAF50"},{id:"reminder",name:"Reminder",icon:"fas fa-bell",color:"#00BCD4"}],d=f=>{console.log("Option clicked:",f.name),a&&a({type:f.id,name:f.name}),n&&n()};return i?o.jsx("div",{className:"whatsapp-attachment-overlay",children:o.jsxs("div",{className:`whatsapp-attachment-popup ${i?"open":""}`,children:[o.jsxs("div",{className:"whatsapp-attachment-header",children:[o.jsx("h3",{children:"Share"}),o.jsx("button",{onClick:n,className:"whatsapp-attachment-close",children:o.jsx("i",{className:"fas fa-times"})})]}),o.jsx("div",{className:"whatsapp-menu-grid",children:l.map(f=>o.jsxs("div",{className:"whatsapp-menu-item",onClick:()=>d(f),children:[o.jsx("div",{className:"whatsapp-icon-circle",style:{backgroundColor:f.color},children:o.jsx("i",{className:f.icon})}),o.jsx("span",{className:"whatsapp-item-name",children:f.name})]},f.id))})]})}):null},lE=({onSendMessage:i,onTyping:n,replyingTo:a,onCancelReply:l,chatId:d,receiverId:f})=>{const[x,v]=M.useState(""),[C,w]=M.useState(!1),[A,N]=M.useState(!1),[R,T]=M.useState(null),[O,L]=M.useState(!1),B=M.useRef(null),H=["Hello!","How are you?","Thank you!","Sorry","Okay","Yes","No","Please","Good morning","Good night"],U=q=>{v(q.target.value);const he=B.current;he&&(he.style.height="auto",he.style.height=Math.min(he.scrollHeight,160)+"px"),n()},P=q=>{q.key==="Enter"&&!q.shiftKey&&(q.preventDefault(),K())},K=()=>{if(x.trim()){i(x.trim()),v("");const q=B.current;q&&(q.style.height="auto")}},Z=()=>{console.log("Attachment button clicked! Current state:",C),w(!C),N(!1),console.log("New state:",!C)},W=async q=>{L(!0);try{if(q.type==="location"){const he=` Location: ${q.address}`;i(he)}else if(q.type==="contact"){const he=` Contact: ${q.name}${q.phones.length>0?` (${q.phones[0]})`:""}`;i(he)}else if(q.type==="reminder"){const he=` Reminder: ${q.message}`;i(he)}else{const he=q.fileName||"File";i(he,{mediaUrl:q.mediaUrl,mediaType:q.mediaType,fileName:q.fileName,fileSize:q.fileSize,mimeType:q.mimeType})}v(""),B.current&&(B.current.style.height="auto")}catch(he){console.error("Error handling file selection:",he),alert("Failed to process file: "+he.message)}finally{L(!1)}},X=q=>{i(q),N(!1)},J=()=>{N(!A),w(!1)};return o.jsxs("div",{className:"chat-input-container",children:[a&&o.jsxs("div",{className:"reply-preview-bar",children:[o.jsxs("div",{className:"reply-preview-content",children:[o.jsxs("div",{className:"reply-author",children:["Replying to ",a.sender_id===JSON.parse(localStorage.getItem("currentUser")).id?"You":"Them"]}),o.jsx("div",{className:"reply-text",children:a.content})]}),o.jsx("button",{className:"reply-close-btn",onClick:l,children:o.jsx("i",{className:"fas fa-times"})})]}),o.jsxs("div",{className:"input-row",children:[o.jsx("button",{className:"btn-attach",onClick:Z,title:"Attach Media",children:o.jsx("i",{className:"fas fa-paperclip"})}),o.jsx("button",{className:"btn-quick-reply",onClick:J,title:"Quick Replies",children:o.jsx("i",{className:"fas fa-comment-dots"})}),o.jsx("textarea",{ref:B,className:"chat-input",placeholder:"Type a message...",value:x,onChange:U,onKeyPress:P,rows:2,disabled:O}),o.jsx("button",{className:"btn-send",onClick:K,disabled:!x.trim()||O,children:o.jsx("span",{id:"sendIcon",children:O?o.jsx("i",{className:"fas fa-spinner fa-spin"}):o.jsx("i",{className:"fas fa-paper-plane"})})})]}),o.jsx(oE,{isVisible:C,onFileSelect:W,onClose:()=>w(!1),chatId:d,receiverId:f}),A&&o.jsx("div",{className:"quick-replies-menu",children:H.map((q,he)=>o.jsx("button",{className:"quick-reply-option",onClick:()=>X(q),children:q},he))})]})},cE=({isVisible:i})=>i?o.jsxs("div",{className:"typing-indicator",children:[o.jsxs("span",{className:"typing-dots",children:[o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{})]}),o.jsx("span",{className:"typing-text",children:"typing..."})]}):null,uE=()=>{const[i,n]=M.useState(new Map),[a,l]=M.useState(new Map),d=M.useCallback(async(R,T={})=>(console.log("MediaDownloader: Starting download for mediaUrl:",R),a.has(R)&&!T.forceDownload?(console.log("MediaDownloader: Returning cached media"),a.get(R)):new Promise(async(O,L)=>{try{if(console.log("MediaDownloader: Processing URL..."),!R||R==="undefined"||R==="null"){console.error("MediaDownloader: Invalid media URL"),L(new Error("Invalid media URL"));return}const B=f(R);console.log("MediaDownloader: Created fileInfo:",B);const H={mediaId:R,fileInfo:B,progress:0,status:"downloading"};n(Z=>new Map(Z).set(R,H)),v(H,0),console.log("MediaDownloader: Fetching file from:",B.storage_url);const U=await x(B,H);console.log("MediaDownloader: File fetched, size:",U.size);const P=URL.createObjectURL(U),K={mediaId:R,objectUrl:P,blob:U,fileInfo:B};l(Z=>new Map(Z).set(R,K)),v(H,100),H.status="completed",console.log("MediaDownloader: Download completed successfully"),O(K)}catch(B){console.error("MediaDownloader: Download failed:",B),L(B)}finally{n(B=>{const H=new Map(B);return H.delete(R),H})}})),[a]),f=M.useCallback(R=>{const T=R.split("/"),O=T[T.length-1]||"unknown";let L="application/octet-stream";R.includes("/images/")?L="image/jpeg":R.includes("/videos/")?L="video/mp4":R.includes("/audios/")?L="audio/mpeg":R.includes("/documents/")&&(L="application/pdf");let B="unknown";return R.includes("/images/")?B="image":R.includes("/videos/")?B="video":R.includes("/audios/")?B="audio":R.includes("/documents/")&&(B="document"),{id:R,file_name:O,filename:O,file_size:0,mime_type:L,storage_url:R,storage_path:"",storage_bucket:"media",file_type:B}},[]),x=M.useCallback(async(R,T)=>{const O=await fetch(R.storage_url);if(!O.ok)throw new Error("Download failed");const L=O.headers.get("content-length"),B=parseInt(L,10);let H=0;const U=O.body.getReader(),P=[];for(;;){const{done:Z,value:W}=await U.read();if(Z)break;if(P.push(W),H+=W.length,B>0){const X=Math.round(H/B*100);v(T,X)}}return new Blob(P,{type:R.mime_type})},[]),v=M.useCallback((R,T)=>{R.progress=T,window.dispatchEvent(new CustomEvent("download-progress",{detail:{mediaId:R.mediaId,progress:T,status:R.status,fileInfo:R.fileInfo}}))},[]),C=M.useCallback(R=>{const T=i.get(R);return T?{progress:T.progress,status:T.status,fileInfo:T.fileInfo}:null},[i]),w=M.useCallback(()=>{a.forEach(R=>{R.objectUrl&&URL.revokeObjectURL(R.objectUrl)}),l(new Map)},[a]),A=M.useCallback(async R=>{try{console.log("MediaDownloader: Getting file info for mediaId:",R);const{data:T,error:O}=await vt.from("media").select("*").eq("id",R).single();if(O||!T)return console.error("MediaDownloader: Error fetching media record:",O),{success:!1,error:O?.message||"Media not found"};const L={id:T.id,file_name:T.file_name,filename:T.file_name,file_size:T.file_size||0,mime_type:T.mime_type,storage_url:T.storage_url,storage_path:T.storage_path,storage_bucket:T.storage_bucket,file_type:T.file_type};return console.log("MediaDownloader: File info retrieved:",L),{success:!0,data:L}}catch(T){return console.error("MediaDownloader: Error in getFileInfo:",T),{success:!1,error:T.message}}},[]),N=M.useCallback(R=>{const T=a.get(R);T&&T.objectUrl&&URL.revokeObjectURL(T.objectUrl),l(O=>{const L=new Map(O);return L.delete(R),L})},[a]);return{downloadMedia:d,activeDownloads:i,cache:a,getDownloadStatus:C,clearCache:w,getFileInfo:A,removeFromCache:N}},dE=()=>{const[i,n]=M.useState(null),[a,l]=M.useState(!1),[d,f]=M.useState(null),{downloadMedia:x}=uE(),v=M.useCallback(async(T,O=null,L={})=>{try{if(l(!0),f(null),!O){const U=await A(T);if(!U.success)throw new Error(U.error);O=U.data}n({mediaId:T,fileInfo:O,options:L});const H={...await x(O.storage_url),fileInfo:O};n(U=>({...U,media:H})),l(!1)}catch(B){console.error("Error opening media:",B),f("Failed to load media"),l(!1)}},[x]),C=M.useCallback(()=>{n(null),f(null),l(!1)},[]),w=M.useCallback(()=>{if(!i?.fileInfo)return;const{fileInfo:T}=i,O=document.createElement("a");O.href=T.storage_url,O.download=T.file_name,O.click()},[i]),A=M.useCallback(async T=>{try{console.log("MediaViewer: Getting file info for mediaId:",T);const{data:O,error:L}=await vt.from("media").select("*").eq("id",T).single();if(L||!O)return console.error("MediaViewer: Error fetching media record:",L),{success:!1,error:L?.message||"Media not found"};const B={id:O.id,file_name:O.file_name,filename:O.file_name,file_size:O.file_size||0,mime_type:O.mime_type,storage_url:O.storage_url,storage_path:O.storage_path,storage_bucket:O.storage_bucket,file_type:O.file_type};return console.log("MediaViewer: File info retrieved:",B),{success:!0,data:B}}catch(O){return console.error("MediaViewer: Error in getFileInfo:",O),{success:!1,error:O.message}}},[]),N=M.useCallback(T=>{if(T===0)return"0 Bytes";const O=1024,L=["Bytes","KB","MB","GB"],B=Math.floor(Math.log(T)/Math.log(O));return Math.round(T/Math.pow(O,B)*100)/100+" "+L[B]},[]),R=M.useCallback(T=>{if(isNaN(T))return"0:00";const O=Math.floor(T/60),L=Math.floor(T%60);return`${O}:${L.toString().padStart(2,"0")}`},[]);return M.useEffect(()=>()=>{i?.media?.objectUrl&&URL.revokeObjectURL(i.media.objectUrl)},[i]),{currentMedia:i,isLoading:a,error:d,openMedia:v,closeMedia:C,downloadCurrent:w,formatFileSize:N,formatTime:R}},hE=({isOpen:i,onClose:n,mediaId:a,fileInfo:l,options:d={}})=>{const{currentMedia:f,isLoading:x,error:v,openMedia:C,closeMedia:w,downloadCurrent:A,formatFileSize:N}=dE(),[R,T]=M.useState(null),O=M.useRef(null);M.useEffect(()=>{i&&a?C(a,l,d):i||w()},[i,a,l,d,C,w]),M.useEffect(()=>{const H=U=>{U.key==="Escape"&&i&&n()};return document.addEventListener("keydown",H),()=>document.removeEventListener("keydown",H)},[i,n]);const L=H=>{H.target===H.currentTarget&&n()},B=()=>{if(!f?.media)return null;const{fileInfo:H,objectUrl:U}=f.media;switch(H.file_type){case"image":case"avatar":return o.jsx("img",{src:U,alt:H.file_name,className:"media-viewer-image",onLoad:()=>console.log("Image loaded"),onError:()=>console.error("Image failed to load")});case"video":return o.jsxs("div",{className:"media-viewer-video-container",children:[o.jsx("video",{ref:O,src:U,controls:!0,className:"media-viewer-video",autoPlay:!1,onLoadedData:()=>console.log("Video loaded"),onError:()=>console.error("Video failed to load")}),R&&o.jsx("div",{className:"media-viewer-controls",children:R})]});case"audio":return o.jsxs("div",{className:"media-viewer-audio-container",children:[o.jsx("div",{className:"audio-icon",children:o.jsx("i",{className:"fas fa-music"})}),o.jsxs("div",{className:"audio-info",children:[o.jsx("h3",{children:H.file_name}),o.jsx("p",{children:N(H.file_size)})]}),o.jsx("audio",{src:U,controls:!0,className:"media-viewer-audio",onLoadedData:()=>console.log("Audio loaded"),onError:()=>console.error("Audio failed to load")})]});case"document":return H.mime_type==="application/pdf"?o.jsx("iframe",{src:U,className:"media-viewer-pdf",title:H.file_name}):o.jsx("div",{className:"media-viewer-document-container",children:o.jsxs("div",{className:"document-preview",children:[o.jsx("i",{className:"fas fa-file-alt fa-5x"}),o.jsx("h3",{children:H.file_name}),o.jsx("p",{children:N(H.file_size)}),o.jsxs("button",{className:"btn-primary",onClick:A,children:[o.jsx("i",{className:"fas fa-download"})," Download"]})]})});default:return o.jsxs("div",{className:"media-viewer-error",children:[o.jsx("i",{className:"fas fa-exclamation-circle"}),o.jsx("p",{children:"Unsupported media type"})]})}};return i?o.jsx("div",{className:"media-viewer-overlay",onClick:L,children:o.jsxs("div",{className:"media-viewer-content",children:[o.jsxs("div",{className:"media-viewer-header",children:[o.jsx("button",{className:"media-viewer-close",onClick:n,title:"Close",children:o.jsx("i",{className:"fas fa-times"})}),o.jsx("div",{className:"media-viewer-info",children:f?.fileInfo&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"media-filename",children:f.fileInfo.file_name}),o.jsx("span",{className:"media-filesize",children:N(f.fileInfo.file_size)})]})}),f?.fileInfo?.file_type!=="avatar"&&!d.hideDownload&&o.jsx("button",{className:"media-viewer-download",onClick:A,title:"Download",children:o.jsx("i",{className:"fas fa-download"})})]}),o.jsxs("div",{className:"media-viewer-body",children:[x&&o.jsxs("div",{className:"media-viewer-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading..."})]}),v&&o.jsxs("div",{className:"media-viewer-error",children:[o.jsx("i",{className:"fas fa-exclamation-circle"}),o.jsx("p",{children:v})]}),o.jsx("div",{className:"media-viewer-container",children:B()})]})]})}):null},oy=M.createContext(),fE=({children:i})=>{const[n,a]=M.useState(()=>localStorage.getItem("theme")||"light"),l=()=>{a(f=>f==="light"?"dark":"light")};M.useEffect(()=>{document.documentElement.setAttribute("data-theme",n),n==="dark"?(document.body.classList.add("dark-mode"),document.body.classList.remove("light-mode")):(document.body.classList.add("light-mode"),document.body.classList.remove("dark-mode")),localStorage.setItem("theme",n)},[n]);const d={theme:n,toggleTheme:l,isDark:n==="dark",isLight:n==="light"};return o.jsx(oy.Provider,{value:d,children:i})},Jo=()=>{const i=M.useContext(oy);if(!i)throw new Error("useTheme must be used within a ThemeProvider");return i},Gi=()=>{const{isDark:i}=Jo(),n=i;return o.jsxs("div",{className:`messaging-loader-overlay transition-colors duration-300 ${n?"bg-slate-900":"bg-gray-100"}`,children:[o.jsx("style",{children:`
        @keyframes simpleBounce {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-5px); }
        }
        @keyframes floatCloud {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-6px); }
        }
        @keyframes shadowPulse {
          0%, 100% { transform: scaleX(1); opacity: 0.3; }
          50% { transform: scaleX(0.8); opacity: 0.1; }
        }
        @keyframes signalBlink {
          0%, 100% { opacity: 0.3; }
          50% { opacity: 1; }
        }
      `}),o.jsx("div",{className:"relative flex flex-col items-center",children:o.jsxs("svg",{width:"120",height:"80",viewBox:"0 0 120 80",className:"overflow-visible",children:[o.jsxs("g",{style:{animation:"floatCloud 3s ease-in-out infinite"},children:[o.jsx("path",{d:"M85 20 Q92 15 99 20",fill:"none",stroke:n?"#3b82f6":"#2563eb",strokeWidth:"2.5",strokeLinecap:"round",style:{animation:"signalBlink 2s infinite",animationDelay:"0s"}}),o.jsx("path",{d:"M88 28 Q92 25 96 28",fill:"none",stroke:n?"#3b82f6":"#2563eb",strokeWidth:"2.5",strokeLinecap:"round",style:{animation:"signalBlink 2s infinite",animationDelay:"0.5s"}}),o.jsx("path",{d:"M35,55 L85,55 C96.046,55 105,46.046 105,35 C105,23.954 96.046,15 85,15 C82.5,15 80.15,15.5 78,16.5 C74.5,9.5 67.5,5 59,5 C48,5 39,13 37.5,23.5 C36.5,23.2 35.5,23 34.5,23 C21,23 10,34 10,47.5 C10,51.6 13.4,55 17.5,55 L35,55 Z",fill:n?"#1e293b":"#ffffff",stroke:n?"#3b82f6":"#2563eb",strokeWidth:"3",strokeLinejoin:"round",className:"drop-shadow-lg"}),o.jsx("circle",{cx:"40",cy:"37",r:"4",fill:n?"#60a5fa":"#3b82f6",style:{animation:"simpleBounce 1s infinite ease-in-out",animationDelay:"0s"}}),o.jsx("circle",{cx:"60",cy:"37",r:"4",fill:n?"#60a5fa":"#3b82f6",style:{animation:"simpleBounce 1s infinite ease-in-out",animationDelay:"0.2s"}}),o.jsx("circle",{cx:"80",cy:"37",r:"4",fill:n?"#60a5fa":"#3b82f6",style:{animation:"simpleBounce 1s infinite ease-in-out",animationDelay:"0.4s"}})]}),o.jsx("ellipse",{cx:"60",cy:"70",rx:"35",ry:"4",fill:n?"#0f172a":"#cbd5e1",style:{animation:"shadowPulse 3s ease-in-out infinite"}})]})}),o.jsx("div",{className:"mt-6 flex flex-col items-center",children:o.jsx("p",{className:`text-sm font-bold tracking-[0.2em] ${n?"text-blue-400":"text-blue-600"}`,children:"CONNECTING"})})]})},gE=(i,n,a)=>{const{supabase:l}=ds(),d=M.useCallback(f=>{n(f.new)},[n,a]);M.useEffect(()=>{if(!i||!l)return;const f=l.channel(`chat_messages_${i}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`chat_id=eq.${i}`},d).subscribe();return()=>{f.unsubscribe()}},[i,l,d])},mE=(i,n)=>{const{supabase:a}=ds(),[l,d]=M.useState(!1);M.useEffect(()=>{if(!i||!a)return;const x=a.channel(`typing_${i}`).on("broadcast",{event:"typing"},v=>{v.payload.userId!==n&&(d(v.payload.isTyping),v.payload.isTyping&&setTimeout(()=>d(!1),3e3))}).subscribe();return()=>x.unsubscribe()},[i,n,a]);const f=M.useCallback(x=>{if(!a||!i)return;a.channel(`typing_${i}`).send({type:"broadcast",event:"typing",payload:{userId:n,isTyping:x}})},[a,i,n]);return{isOtherUserTyping:l,sendTypingStatus:f}},pE=(i,n)=>{const{supabase:a}=ds();M.useEffect(()=>{if(!i||!a)return;const l=a.channel(`message_status_${i}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"messages",filter:`chat_id=eq.${i}`},d=>{n(d.new)}).subscribe();return()=>l.unsubscribe()},[i,n,a])};class Gp{static play(n="default"){try{const a={default:"/assets/audio/nice_ring_tones.mp3",message:"/assets/audio/linkedin_notification.mp3",call:"/assets/audio/professional.mp3",reminder:"/assets/audio/Sakura-Girl-Wake-Up-chosic.com_.mp3"},l=a[n]||a.default,d=new Audio(l);d.volume=.5;const f=d.play();return f!==void 0&&f.catch(x=>{console.log("Audio play failed:",x)}),!0}catch(a){return console.error("Error playing notification sound:",a),!1}}static playMessageNotification(){return this.play("message")}static playCallNotification(){return this.play("call")}static playReminderNotification(){return this.play("reminder")}}const f0=()=>{const{chatId:i,otherUserId:n,userId:a}=Zu(),l=us(),{supabase:d}=ds(),{chatTheme:f,chatThemes:x,selectTheme:v,setChatId:C,setScrollPercentage:w}=M0(),{startCall:A}=hi(),{user:N,loading:R,isAuthenticated:T}=Xa();M.useEffect(()=>{i&&C(i)},[i,C]);const[O,L]=M.useState([]),[B,H]=M.useState(null),[U,P]=M.useState(null),[K,Z]=M.useState(new Set),[W,X]=M.useState(!1),[J,q]=M.useState(!1),[he,ge]=M.useState(!1),[ie,be]=M.useState(!1),[Ie,V]=M.useState(0),[$,oe]=M.useState(!0),[ke,Ge]=M.useState(!1),[Ke,ne]=M.useState(!1),[ye,Le]=M.useState(!1),[Ue,We]=M.useState(""),[Ne,$e]=M.useState([]),[De,Ce]=M.useState(!1),[Je,mt]=M.useState(!1),[Wt,ft]=M.useState(null),Mt=M.useRef(null),xn=M.useRef(null),cn=M.useRef(null),qt=i&&i!=="new"?i:null,Nt=M.useCallback(Ee=>{L(_e=>[..._e,Ee]),Ee.sender_id!==N?.id&&!J&&Gp.playMessageNotification(),$?jn():V(_e=>_e+1)},[$,N?.id,J]);gE(qt,Nt,N?.id);const{isOtherUserTyping:ht,sendTypingStatus:Hn}=mE(qt,N?.id),ze=M.useCallback(Ee=>{L(_e=>_e.map(Ve=>Ve.id===Ee.id?Ee:Ve))},[]);pE(qt,ze),M.useEffect(()=>{if(!R&&!T){l("/login");return}return!R&&T&&N&&Is(),()=>{Me()}},[i,n,a,R,T,N]),M.useEffect(()=>{qn()},[O]),M.useEffect(()=>{const Ee=JSON.parse(localStorage.getItem("mutedChats")||"{}");q(!!Ee[i]);const _e=JSON.parse(localStorage.getItem("tempChats")||"{}");ge(!!_e[i])},[i,N]);const Is=async()=>{try{a&&(!i||i==="new")?await Fe(N,a):i&&n&&(await nt(n),await _t())}catch(Ee){console.error("Error initializing chat:",Ee)}},Me=()=>{cn.current&&clearTimeout(cn.current)},Fe=async(Ee,_e)=>{try{const{data:Ve,error:Dn}=await d.from("chats").select("id").or(`and(user1_id.eq.${Ee.id},user2_id.eq.${_e}),and(user1_id.eq.${_e},user2_id.eq.${Ee.id})`).single();if(Ve&&!Dn){l(`/chat/${Ve.id}/${_e}`,{replace:!0});return}const{data:Vs,error:gs}=await d.from("chats").insert([{user1_id:Ee.id,user2_id:_e,last_message:null,last_message_time:new Date().toISOString()}]).select().single();if(gs)throw gs;l(`/chat/${Vs.id}/${_e}`,{replace:!0})}catch(Ve){console.error("Error handling new chat:",Ve),l("/",{replace:!0})}},nt=async Ee=>{try{const{data:_e,error:Ve}=await d.from("users").select("*").eq("id",Ee).single();if(Ve)throw Ve;H(_e)}catch(_e){console.error("Error loading user info:",_e)}},_t=async()=>{try{const{data:Ee,error:_e}=await d.from("messages").select("*").limit(10),{data:Ve,error:Dn}=await d.from("messages").select("*").eq("chat_id",i).order("created_at",{ascending:!0});if(Dn)throw Dn;L(Ve||[]),await jn()}catch(Ee){console.error("Error loading messages:",Ee)}},Tn=async()=>{if(!(!window.confirm(`Block ${B.name}? They won't be able to message or call you.`)||!N))try{const{error:_e}=await d.from("blocked_users").insert([{blocker_id:N.id,blocked_id:B.id}]);if(_e)throw _e;l("/")}catch(_e){console.error("Error blocking user:",_e)}},sn=async(Ee,_e=null)=>{if(!(!Ee.trim()&&!_e||!N))try{const Ve={id:crypto.randomUUID(),chat_id:i,sender_id:N.id,receiver_id:n,content:Ee.trim()||(_e?_e.fileName:""),message_type:_e?_e.mediaType:"text",is_read:!1};_e&&(Ve.media_url=_e.mediaUrl,Ve.media_type=_e.mediaType,Ve.file_name=_e.fileName,Ve.file_size=_e.fileSize);const{data:Dn,error:Vs}=await d.from("messages").insert([Ve]).select();if(Vs)throw Vs;Dn&&Dn[0]&&L(Ki=>[...Ki,Dn[0]]);const gs=_e?` ${_e.fileName}`:Ee.substring(0,50);await d.from("chats").update({last_message:gs,last_message_time:new Date().toISOString()}).eq("id",i),P(null),Gp.playMessageNotification()}catch(Ve){console.error("Error sending message:",Ve)}},Vt=()=>{Hn(!0),cn.current&&clearTimeout(cn.current),cn.current=setTimeout(()=>{Hn(!1)},3e3)},qn=()=>{Mt.current?.scrollIntoView({behavior:"smooth"}),oe(!0)},jn=M.useCallback(async()=>{try{if(!N||!i||i==="new")return;await d.from("messages").update({is_read:!0}).eq("chat_id",i).eq("receiver_id",N.id).eq("is_read",!1)}catch(Ee){console.error("Error marking messages as read:",Ee)}},[N,i,d]),ts=Ee=>{P(Ee)},Ut=()=>{P(null)},je=Ee=>{Z(_e=>{const Ve=new Set(_e);return Ve.has(Ee)?Ve.delete(Ee):Ve.add(Ee),X(Ve.size>0),Ve})},lt=()=>{Z(new Set),X(!1)},gt=()=>{K.size!==0&&Le(!0)},Qt=async()=>{Le(!1);try{const{error:Ee}=await d.from("messages").delete().in("id",Array.from(K));if(Ee)throw Ee;L(_e=>_e.filter(Ve=>!K.has(Ve.id))),lt()}catch(Ee){console.error("Error deleting messages:",Ee),alert("Failed to delete messages")}},Os=()=>{Le(!1)},va=()=>{const _e=O.filter(Ve=>K.has(Ve.id)).map(Ve=>`${Ve.sender_id===N.id?"You":B.name}: ${Ve.content}`).join(`

`);navigator.clipboard.writeText(`Forwarded messages:

${_e}`),lt(),alert("Messages copied to clipboard for forwarding")},qs=()=>{const _e=O.filter(Ve=>K.has(Ve.id)).map(Ve=>Ve.content).join(`

`);navigator.clipboard.writeText(_e),lt(),alert("Messages copied to clipboard")},wt=()=>{if(!n||n==="undefined"){alert("User information not available");return}l(`/user-details/${n}`)},Rn=()=>{l(`/create-reminder?userId=${n}`)},me=async()=>{try{const Ee=!J,_e=JSON.parse(localStorage.getItem("mutedChats")||"{}");Ee?_e[i]=!0:delete _e[i],localStorage.setItem("mutedChats",JSON.stringify(_e)),q(Ee)}catch(Ee){console.error("Error toggling mute:",Ee)}},qe=()=>{ne(!0)},ct=async Ee=>{if(!(!Ee.trim()||!i)){Ce(!0);try{const{data:_e,error:Ve}=await d.from("messages").select("*").eq("chat_id",i).ilike("content",`%${Ee}%`).order("created_at",{ascending:!1}).limit(50);if(Ve)throw Ve;$e(_e||[])}catch(_e){console.error("Error searching messages:",_e),$e([])}finally{Ce(!1)}}},an=Ee=>{const _e=Ee.target.value;We(_e),_e.trim()?ct(_e):$e([])},Pt=Ee=>{const _e=document.getElementById(`message-${Ee}`);_e&&(_e.scrollIntoView({behavior:"smooth",block:"center"}),_e.style.backgroundColor="rgba(76, 175, 80, 0.2)",setTimeout(()=>{_e.style.backgroundColor=""},2e3)),ne(!1),We(""),$e([])},In=()=>{Ge(!0)},G=async Ee=>{await v(Ee),Ge(!1)},Te=async()=>{try{const Ee=!he,_e=JSON.parse(localStorage.getItem("tempChats")||"{}");Ee?_e[i]={enabled:!0,duration:1440*60*1e3}:delete _e[i],localStorage.setItem("tempChats",JSON.stringify(_e)),ge(Ee)}catch(Ee){console.error("Error toggling temp chat:",Ee)}},jt=()=>{alert("Temp chat settings coming soon!")},On=async()=>{if(window.confirm("Clear all messages in this chat? This cannot be undone."))try{const{error:_e}=await d.from("messages").delete().eq("chat_id",i);if(_e)throw _e;L([]),await d.from("chats").update({last_message:null,last_message_time:new Date().toISOString()}).eq("id",i)}catch(_e){console.error("Error clearing chat:",_e),alert("Failed to clear chat. Please try again.")}},hs=async()=>{try{const{callId:Ee}=await A(B.id,"voice");l(`/call/${Ee}`)}catch(Ee){console.error("Failed to start voice call:",Ee),alert("Failed to start call: "+Ee.message)}},yn=async()=>{try{const{callId:Ee}=await A(B.id,"video");l(`/call/${Ee}`)}catch(Ee){console.error("Failed to start video call:",Ee),alert("Failed to start call: "+Ee.message)}},Kt=Ee=>{const _e=Ee.target,Ve=_e.scrollHeight-_e.scrollTop-_e.clientHeight,Dn=Ve<50;if(be(Ve>300),oe(Dn),_e.scrollHeight>_e.clientHeight){const Vs=_e.scrollTop/(_e.scrollHeight-_e.clientHeight)*100;w(Vs)}else w(0);Dn&&Ie>0&&(V(0),jn())},ns=()=>{Mt.current?.scrollIntoView({behavior:"smooth"}),be(!1),V(0),oe(!0),jn()},He=(Ee,_e,Ve)=>{const Dn={file_name:Ve.file_name||"Unknown",file_size:Ve.file_size||0,mime_type:Ve.media_type||"image/jpeg",storage_url:Ee,file_type:_e};ft({fileInfo:Dn}),mt(!0)},fs=async(Ee,_e)=>{try{const Ve=document.createElement("a");Ve.href=Ee,Ve.download=`media_${_e}`,Ve.target="_blank",document.body.appendChild(Ve),Ve.click(),document.body.removeChild(Ve)}catch(Ve){console.error("Download failed:",Ve),alert("Failed to download media")}};return!B||!N?o.jsx(Gi,{}):o.jsxs("div",{className:"chat-screen",children:[o.jsxs("header",{className:"chat-header",children:[o.jsx("button",{className:"back-btn",onClick:()=>l("/"),children:o.jsx($o,{size:20})}),o.jsxs("div",{className:"chat-user-info",onClick:wt,style:{cursor:"pointer"},children:[o.jsx("div",{className:"user-avatar",children:B.avatar?parseInt(B.avatar)?o.jsx("img",{src:Rs.find(Ee=>Ee.id===parseInt(B.avatar))?.path||B.avatar,alt:B.name}):o.jsx("img",{src:B.avatar,alt:B.name}):B.name.charAt(0).toUpperCase()}),o.jsxs("div",{className:"user-details",children:[o.jsx("h3",{className:"user-name",children:B.name}),o.jsx("p",{className:"user-status",children:ht?"typing...":B.is_online?"Online":"Offline"})]})]}),o.jsxs("div",{className:"chat-actions",children:[o.jsx("button",{className:"icon-btn",onClick:hs,title:"Voice Call",children:o.jsx(Hs,{size:20})}),o.jsx("button",{className:"icon-btn",onClick:yn,title:"Video Call",children:o.jsx(fi,{size:20})}),o.jsx(B0,{items:[{icon:o.jsx(L0,{size:16}),label:"View Contact",onClick:wt},{icon:o.jsx(Yu,{size:16}),label:"Create Reminder",onClick:Rn},{icon:J?o.jsx(Yu,{size:16}):o.jsx(ty,{size:16}),label:J?"Unmute Notifications":"Mute Notifications",onClick:me},{icon:o.jsx(nc,{size:16}),label:"Search Messages",onClick:qe},{icon:o.jsx(yS,{size:16}),label:"Themes",onClick:In},{divider:!0},{icon:o.jsx(d0,{size:16}),label:he?"Disable Temporary Chat":"Enable Temporary Chat",onClick:Te},{icon:o.jsx(Kl,{size:16}),label:"Temp Chat Settings",onClick:jt,disabled:!he},{icon:o.jsx(js,{size:16}),label:"Clear Chat",onClick:On},{divider:!0},{icon:o.jsx(Gu,{size:16}),label:"Block User",onClick:Tn,danger:!0}]})]})]}),W&&o.jsxs("div",{className:"selection-toolbar",children:[o.jsx("button",{className:"selection-close-btn",onClick:lt,children:""}),o.jsxs("div",{className:"selection-info",children:[K.size," selected"]}),o.jsxs("div",{className:"selection-actions",children:[o.jsx("button",{className:"selection-action-btn",title:"Copy",onClick:qs,children:o.jsx(sy,{size:16})}),o.jsx("button",{className:"selection-action-btn",title:"Forward",onClick:va,children:o.jsx(S_,{size:16})}),o.jsx("button",{className:"selection-action-btn",title:"Delete",onClick:gt,children:o.jsx(js,{size:16})})]})]}),o.jsxs("div",{className:"messages-container",onScroll:Kt,ref:xn,children:[o.jsx(iE,{messages:O,currentUser:N,selectedMessages:K,isSelectionMode:W,onMessageSelect:je,onReply:ts,onDelete:Ee=>L(_e=>_e.filter(Ve=>Ve.id!==Ee)),onMediaView:He,onMediaDownload:fs}),o.jsx(cE,{isVisible:ht}),o.jsx("div",{ref:Mt}),ie&&o.jsxs("button",{className:"scroll-bottom-btn",onClick:ns,children:[o.jsx(v_,{size:20}),Ie>0&&o.jsx("span",{className:"unread-count",children:Ie})]})]}),o.jsx(lE,{onSendMessage:sn,onTyping:Vt,replyingTo:U,onCancelReply:Ut,chatId:i,receiverId:n}),o.jsx(wr,{isOpen:Ke,onClose:()=>{ne(!1),We(""),$e([])},title:"Search Messages",size:"medium",children:o.jsxs("div",{className:"search-modal-content",children:[o.jsx("div",{className:"search-input-container",children:o.jsx("input",{type:"text",placeholder:"Search messages...",value:Ue,onChange:an,className:"search-input",autoFocus:!0})}),o.jsx("div",{className:"search-results",children:De?o.jsx(Gi,{}):Ne.length>0?Ne.map(Ee=>o.jsxs("div",{className:"search-result-item",onClick:()=>Pt(Ee.id),children:[o.jsx("div",{className:"search-result-content",children:Ee.content}),o.jsx("div",{className:"search-result-time",children:new Date(Ee.created_at).toLocaleDateString()})]},Ee.id)):Ue.trim()?o.jsx("div",{className:"no-results",children:"No messages found"}):o.jsx("div",{className:"search-placeholder",children:"Type to search messages"})})]})}),o.jsx(wr,{isOpen:ye,onClose:Os,title:`Delete ${K.size} message(s)?`,size:"small",children:o.jsxs("div",{className:"delete-confirmation-content",children:[o.jsx("p",{children:"Are you sure you want to delete the selected messages? This action cannot be undone."}),o.jsxs("div",{className:"delete-modal-actions",children:[o.jsx("button",{className:"delete-cancel-btn",onClick:Os,children:"Cancel"}),o.jsx("button",{className:"delete-confirm-btn",onClick:Qt,children:"Confirm Delete"})]})]})}),o.jsx(wr,{isOpen:ke,onClose:()=>Ge(!1),title:"Choose Theme",size:"large",children:o.jsx("div",{className:"theme-selector",children:o.jsx("div",{className:"theme-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:"20px"},children:Object.entries(x).map(([Ee,_e])=>o.jsxs("div",{className:`theme-card ${f===Ee?"active":""}`,onClick:()=>G(Ee),style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"pointer",transition:"all 0.3s ease",transform:f===Ee?"scale(1.05)":"scale(1)",filter:f===Ee?"brightness(1.1)":"brightness(1)"},children:[o.jsxs("div",{className:"theme-preview-card",style:{width:"120px",height:"80px",borderRadius:"12px",overflow:"hidden",border:f===Ee?"3px solid #25d366":"2px solid rgba(0,0,0,0.1)",boxShadow:f===Ee?"0 8px 25px rgba(37, 211, 102, 0.3)":"0 4px 15px rgba(0,0,0,0.1)",position:"relative",background:"white"},children:[o.jsx("div",{style:{width:"100%",height:"65%",background:_e.background,backgroundSize:"cover",backgroundPosition:"center"}}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 10px",height:"35%",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)"},children:[o.jsx("div",{style:{width:"32px",height:"10px",borderRadius:"6px",background:_e.sentMessage.background,boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),o.jsx("div",{style:{width:"32px",height:"10px",borderRadius:"6px",background:_e.receivedMessage.background,boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}})]}),f===Ee&&o.jsx("div",{style:{position:"absolute",top:"8px",right:"8px",width:"20px",height:"20px",borderRadius:"50%",background:"linear-gradient(135deg, #25d366, #128c7e)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"12px",fontWeight:"bold",boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:""})]}),o.jsx("div",{className:"theme-name",style:{marginTop:"12px",fontSize:"13px",fontWeight:"600",color:f===Ee?"#25d366":"#374151",textAlign:"center",fontFamily:'"Inter", "SF Pro Display", -apple-system, BlinkMacSystemFont, sans-serif',letterSpacing:"0.3px",lineHeight:"1.2",textShadow:f===Ee?"0 1px 3px rgba(37, 211, 102, 0.2)":"none",transition:"all 0.3s ease"},children:_e.name})]},Ee))})})}),o.jsx(hE,{isOpen:Je,onClose:()=>{mt(!1),ft(null)},mediaId:Wt?.mediaId,fileInfo:Wt?.fileInfo})]})},xE=i=>{const{supabase:n}=ds(),[a,l]=M.useState([]),[d,f]=M.useState(!0),x=M.useCallback(async C=>{if(!C){f(!1);return}try{const{data:w,error:A}=await n.from("chat_list_view").select("*").or(`user1_id.eq.${C},user2_id.eq.${C}`).order("last_message_time",{ascending:!1});if(A){console.error("Error loading chats from view:",A);const R=localStorage.getItem(`chats_${C}`),T=R?JSON.parse(R):[];l(T),f(!1);return}const N=(w||[]).map(R=>{const T=R.user1_id===C,O={id:T?R.user2_id:R.user1_id,name:T?R.user2_name:R.user1_name,phone:T?R.user2_id:R.user1_id,avatar:T?R.user2_avatar:R.user1_avatar,is_online:T?R.user2_online:R.user1_online};return{id:R.chat_id,otherUser:O,last_message:R.last_message,last_message_time:R.last_message_time,unreadCount:parseInt(R.unread_count)||0}});l(N)}catch(w){console.error("Error loading chats:",w),l([])}finally{f(!1)}},[n]),v=M.useCallback(async C=>{const{data:w}=await n.from("chat_list_view").select("*").eq("chat_id",C).single();if(w&&(w.user1_id===i||w.user2_id===i)){const A=w.user1_id===i,N={id:A?w.user2_id:w.user1_id,name:A?w.user2_name:w.user1_name,phone:A?w.user2_id:w.user1_id,avatar:A?w.user2_avatar:w.user1_avatar,is_online:A?w.user2_online:w.user1_online},R={id:w.chat_id,otherUser:N,last_message:w.last_message,last_message_time:w.last_message_time,unreadCount:parseInt(w.unread_count)||0};l(T=>{const O=T.findIndex(L=>L.id===C);if(O>=0){const L=[...T];return L[O]=R,L.sort((B,H)=>new Date(H.last_message_time)-new Date(B.last_message_time))}else return[R,...T]})}},[i,n]);return M.useEffect(()=>{i?x(i):(l([]),f(!1))},[i,x]),M.useEffect(()=>{if(!i)return;const C=n.channel("chat_list_messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},async A=>{const N=A.new;(N.sender_id===i||N.receiver_id===i)&&await v(N.chat_id)}).subscribe(),w=n.channel("chat_list_chats").on("postgres_changes",{event:"UPDATE",schema:"public",table:"chats"},A=>{(A.new.user1_id===i||A.new.user2_id===i)&&v(A.new.id)}).subscribe();return()=>{C&&C.unsubscribe(),w&&w.unsubscribe()}},[i,v,n]),{chats:a,setChats:l,loading:d}},yE=()=>{const{supabase:i}=ds(),{user:n,loading:a,signOut:l}=Xa(),{theme:d}=Jo(),f=us(),{chatId:x,otherUserId:v}=Zu(),[C,w]=M.useState(null),[A,N]=M.useState(""),[R,T]=M.useState(!1),[O,L]=M.useState([]),[B,H]=M.useState(!1),[U,P]=M.useState(!0),[K,Z]=M.useState(!1),[W,X]=M.useState(!1),[J,q]=M.useState(!1),[he,ge]=M.useState(""),[ie,be]=M.useState(""),[Ie,V]=M.useState([]),[$,oe]=M.useState(!1),[ke,Ge]=M.useState(!1),[Ke,ne]=M.useState(null),[ye,Le]=M.useState(!1),[Ue,We]=M.useState(""),[Ne,$e]=M.useState(""),[De,Ce]=M.useState(""),[Je,mt]=M.useState(!1),[Wt,ft]=M.useState(!1),[Mt,xn]=M.useState(!1),[cn,qt]=M.useState(null),{chats:Nt,loading:ht}=xE(C?.id?C.id:null),Hn=Nt.filter(me=>!me.otherUser?.phone?.includes("1234")&&me.otherUser?.id!=="support-account");M.useEffect(()=>{a||ze()},[a,n]),M.useEffect(()=>{K&&C&&Me()},[K]);const ze=async()=>{try{if(!n){console.log(" No valid user found, redirecting to login"),P(!1),f("/login");return}console.log(" Google auth user detected, using user data");const me={id:n.id,name:n.name,email:n.email,phone:n.phone||"",avatar:n.avatar};w(me),localStorage.setItem("currentUser",JSON.stringify(me)),oe(n.is_admin||!1),await Is(n.id),P(!1)}catch(me){console.error("Error initializing home:",me),P(!1)}},Is=async me=>{try{const{data:qe,error:ct}=await i.from("users").select("phone").eq("id",me).single();if(ct){console.error("Error checking profile completion:",ct);return}(!qe||!qe.phone||qe.phone.trim()==="")&&Ge(!0)}catch(qe){console.error("Error in checkProfileCompletion:",qe)}},Me=async()=>{try{if(!C||!C.id){V([]);return}console.log("Loading saved contacts for user:",C.id);const{data:me,error:qe}=await i.from("contacts").select(`
          *,
          contact_user:users!contacts_contact_user_id_fkey(*)
        `).eq("user_id",C.id);if(qe){console.error("Error loading contacts from database:",qe),V([]);return}console.log("Loaded contacts:",me);const ct=me?me.map(an=>({id:an.contact_user.id,name:an.contact_user.name,phone:an.contact_user.phone,avatar:an.contact_user.avatar})):[];V(ct)}catch(me){console.error("Error loading saved contacts:",me),V([])}},Fe=me=>{f(`/chat/${me.id}/${me.otherUser.id}`)},nt=me=>{f(me)},_t=()=>{l(),f("/login")},Tn=async me=>{me.preventDefault();const qe=Ue.trim();if(!/^[0-9]{10}$/.test(qe)){alert("Please enter a valid 10-digit phone number");return}if(!Ne||Ne.length<6){alert("Password is required and must be at least 6 characters long");return}if(Ne!==De){alert("Passwords do not match");return}try{xn(!0);const{data:an}=await i.from("users").select("id").eq("id",n.id).single(),Pt={id:n.id,name:n.user_metadata?.full_name||n.user_metadata?.name||"User",email:n.email,phone:qe,avatar:n.user_metadata?.avatar_url||null,created_at:new Date().toISOString()};if(Ne&&Ne.length>0&&(Pt.password=Ne),an){const{error:G}=await i.from("users").update(Pt).eq("id",n.id);if(G){console.error("Database error:",G),alert("Failed to save phone number and password. Please try again.");return}}else{const{error:G}=await i.from("users").insert([Pt]);if(G){console.error("Database error:",G),alert("Failed to create account. Please try again.");return}}const In={id:n.id,name:n.user_metadata?.full_name||n.user_metadata?.name||"User",email:n.email,phone:qe,avatar:n.user_metadata?.avatar_url||null};localStorage.setItem("currentUser",JSON.stringify(In)),w(In),Ge(!1),We(""),$e(""),Ce("")}catch(an){console.error("Phone submission error:",an),alert("An error occurred. Please try again.")}finally{xn(!1)}},sn=()=>{f("/about")},Vt=()=>{f("/support")},qn=async()=>{try{if(!he.trim()||!ie.trim()){alert("Please enter both name and phone number");return}if(ie.length!==10){alert("Please enter a valid 10-digit phone number");return}const me=ie.startsWith("+")?ie.substring(1):ie,{data:qe,error:ct}=await i.from("users").select("id, name, phone").eq("phone",me).neq("id",C.id).single();if(ct||!qe){alert("No user found with this phone number");return}const{data:an,error:Pt}=await i.from("contacts").select("id").eq("user_id",C.id).eq("contact_user_id",qe.id).single();if(an&&!Pt){alert("Contact already exists"),X(!1),ge(""),be("");return}const{error:In}=await i.from("contacts").insert([{user_id:C.id,contact_user_id:qe.id}]);if(In){console.error("Error saving contact:",In),alert("Failed to save contact");return}alert("Contact saved successfully!"),ge(""),be(""),X(!1),await Me()}catch(me){console.error("Error in handleSaveContact:",me),alert("Failed to save contact")}},jn=async me=>{try{if(!window.confirm("Delete this contact?"))return;const{error:ct}=await i.from("contacts").delete().eq("user_id",C.id).eq("contact_user_id",me);if(ct){console.error("Error deleting contact:",ct),alert("Failed to delete contact");return}alert("Contact deleted successfully"),await Me(),qt(null)}catch(qe){console.error("Error in handleDeleteContact:",qe),alert("Failed to delete contact")}},ts=(me,qe,ct)=>{qe.stopPropagation();const an=ct<3;qt({id:cn?.id===me?null:me,showAbove:an})},Ut=me=>{cn?qt(null):wt(me)},je=me=>{alert(`Edit functionality for ${me.name} coming soon!`),qt(null)},lt=me=>me.split(" ").map(qe=>qe[0]).join("").toUpperCase().slice(0,2),gt=me=>{if(!me)return"";const qe=new Date(me),an=new Date-qe,Pt=Math.floor(an/6e4),In=Math.floor(an/36e5),G=Math.floor(an/864e5);return Pt<1?"now":Pt<60?`${Pt}m`:In<24?`${In}h`:`${G}d`},Qt=M.useMemo(()=>Hn.filter(me=>{if(!A)return!0;const qe=A.toLowerCase();return me.otherUser.name.toLowerCase().includes(qe)||me.otherUser.phone&&me.otherUser.phone.includes(qe)}),[Hn,A]),Os=async me=>{try{if(me==="1234"){L([{id:"support-account",name:"CaBa Support",phone:"1234",avatar:null,is_online:!0}]),H(!0);return}const qe=me.startsWith("+")?me.substring(1):me,{data:ct,error:an}=await i.from("users").select("id, name, phone, avatar, is_online").eq("phone",qe).neq("id",C?.id).eq("is_admin",!1).limit(1);if(an)throw an;L(ct||[]),H(ct&&ct.length>0)}catch(qe){console.error("Error searching users:",qe),L([]),H(!1)}},va=me=>{const qe=me.target.value;N(qe),/^\d{10}$/.test(qe)?Os(qe):(L([]),H(!1))},qs=me=>{if(me.id==="support-account"){f("/support"),T(!1),N(""),L([]),H(!1);return}const qe=Hn.find(ct=>ct.otherUser.id===me.id);qe?Fe(qe):f(`/chat/new/${me.id}`),T(!1),N(""),L([]),H(!1)},wt=me=>{const qe=Hn.find(ct=>ct.otherUser.id===me.id);qe?Fe(qe):f(`/chat/new/${me.id}`),Z(!1),q(!1)};if(a||U)return o.jsx(Gi,{});if(ke)return o.jsx("div",{className:"home-container",children:o.jsx(wr,{isOpen:ke,onClose:()=>{},title:"Complete Your Profile",size:"medium",children:o.jsxs("div",{className:"phone-completion-modal",children:[o.jsxs("div",{className:"phone-modal-header",children:[o.jsx("h3",{children:"Complete Your Profile"}),o.jsx("p",{children:"Please provide your phone number and create a password to complete your account setup."})]}),o.jsxs("form",{onSubmit:Tn,className:"phone-form",children:[o.jsxs("div",{className:"input-group",children:[o.jsx("label",{htmlFor:"phone",children:"Phone Number"}),o.jsx("input",{type:"tel",id:"phone",placeholder:"10 digit mobile number",pattern:"[0-9]{10}",maxLength:"10",required:!0,autoComplete:"tel",value:Ue,onChange:me=>We(me.target.value.replace(/\D/g,"").slice(0,10)),disabled:Mt}),o.jsx("small",{children:"10 digits without country code"})]}),o.jsxs("div",{className:"input-group",children:[o.jsx("label",{htmlFor:"password",children:"Password (Required for backup login)"}),o.jsxs("div",{className:"password-input",children:[o.jsx("input",{type:Je?"text":"password",id:"password",placeholder:"Create a password (min 6 characters)",minLength:"6",required:!0,value:Ne,onChange:me=>$e(me.target.value),disabled:Mt}),o.jsx("button",{type:"button",className:"toggle-password",onClick:()=>mt(!Je),children:Je?o.jsx(Mu,{size:16}):o.jsx(Ya,{size:16})})]}),o.jsx("small",{children:"Required: Create password for backup login"})]}),o.jsxs("div",{className:"input-group",children:[o.jsx("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),o.jsxs("div",{className:"password-input",children:[o.jsx("input",{type:Wt?"text":"password",id:"confirmPassword",placeholder:"Confirm your password",minLength:"6",required:!0,value:De,onChange:me=>Ce(me.target.value),disabled:Mt}),o.jsx("button",{type:"button",className:"toggle-password",onClick:()=>ft(!Wt),children:Wt?o.jsx(Mu,{size:16}):o.jsx(Ya,{size:16})})]})]}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:Mt||Ue.length!==10,children:Mt?"Saving...":"Save Profile"})]}),o.jsx("div",{className:"phone-modal-footer",children:o.jsxs("p",{className:"phone-note",children:[o.jsx("strong",{children:"Note:"})," Your phone number will be visible to other users for contact purposes. The password enables backup login access."]})})]})})});if(ht)return o.jsx(Gi,{});const Rn=!!x&&!!v;return o.jsxs("div",{className:"home-container",children:[o.jsxs("div",{className:`desktop-layout ${Rn?"chat-active":""}`,children:[o.jsxs("aside",{className:`sidebar ${Rn?"visible-on-mobile":"hidden-on-mobile"}`,children:[o.jsxs("div",{className:"sidebar-header",children:[o.jsx("div",{className:"app-logo-small",children:"CB"}),o.jsx("span",{className:"app-name-small",children:"CaBa"})]}),o.jsxs("nav",{className:"sidebar-nav",children:[o.jsxs("button",{className:"sidebar-item active",onClick:()=>nt("/"),children:[o.jsx(Ma,{size:20}),o.jsx("span",{className:"label",children:"Chats"})]}),o.jsxs("button",{className:"sidebar-item",onClick:()=>nt("/calls"),children:[o.jsx(Hs,{size:20}),o.jsx("span",{className:"label",children:"Audio Call"})]}),o.jsxs("button",{className:"sidebar-item",onClick:()=>nt("/qr"),children:[o.jsx(ry,{size:20}),o.jsx("span",{className:"label",children:"QR Code"})]}),o.jsxs("button",{className:"sidebar-item",onClick:()=>nt("/news"),children:[o.jsx(ci,{size:20}),o.jsx("span",{className:"label",children:"News"})]}),o.jsxs("button",{className:"sidebar-item",onClick:()=>nt("/settings"),children:[o.jsx(Kl,{size:20}),o.jsx("span",{className:"label",children:"Settings"})]})]}),o.jsx("div",{className:"sidebar-footer",children:o.jsxs("button",{className:"user-profile-link",onClick:()=>nt("/profile"),children:[o.jsx("div",{className:"sidebar-avatar",children:C?.avatar?o.jsx("img",{src:parseInt(C.avatar)?Rs.find(me=>me.id===parseInt(C.avatar))?.path:C.avatar,alt:C.name}):o.jsx("div",{children:lt(C?.name||"U")})}),o.jsx("span",{className:"user-name",children:C?.name||"User"})]})})]}),o.jsxs("main",{className:`main-content ${Rn?"hidden-on-mobile":""}`,children:[o.jsxs("header",{className:"top-header",children:[o.jsx("div",{className:"header-left",children:o.jsx("h1",{children:"Chats"})}),o.jsxs("div",{className:"header-right",children:[o.jsx("button",{className:"icon-btn",onClick:()=>T(!R),title:"Search",children:o.jsx(nc,{size:20})}),o.jsx(B0,{items:[{icon:o.jsx(L0,{size:16}),label:"Profile",onClick:()=>nt("/profile")},{icon:o.jsx(Kl,{size:16}),label:"Settings",onClick:()=>nt("/settings")},{icon:o.jsx(Yu,{size:16}),label:"Check Reminders",onClick:()=>nt("/reminders")},...$?[{icon:o.jsx(z_,{size:16}),label:"Admin Panel",onClick:()=>nt("/admin")}]:[],{divider:!0},{icon:o.jsx(eS,{size:16}),label:"About App",onClick:sn},{icon:o.jsx(k_,{size:16}),label:"Help",onClick:Vt},{divider:!0},{icon:o.jsx(rS,{size:16}),label:"Logout",onClick:_t}]})]})]}),R&&o.jsxs("div",{className:"search-bar",children:[o.jsx(nc,{size:16}),o.jsx("input",{type:"text",placeholder:"Search by phone number...",value:A,onChange:va}),o.jsx("button",{className:"close-search",onClick:()=>{T(!1),N(""),L([]),H(!1)},children:""})]}),R&&B&&O.length>0&&o.jsx("div",{className:"search-suggestions",children:O.map(me=>o.jsxs("div",{className:"search-suggestion-item",onClick:()=>qs(me),children:[o.jsxs("div",{className:"suggestion-avatar",children:[me.avatar?parseInt(me.avatar)?o.jsx("img",{src:Rs.find(qe=>qe.id===parseInt(me.avatar))?.path||me.avatar,alt:me.name}):o.jsx("img",{src:me.avatar,alt:me.name}):o.jsx("div",{children:lt(me.name)}),o.jsx("span",{className:`online-status ${me.is_online?"online":""}`})]}),o.jsxs("div",{className:"suggestion-info",children:[o.jsx("div",{className:"suggestion-name",children:me.name}),o.jsx("div",{className:"suggestion-phone",children:me.phone})]})]},me.id))}),o.jsx("div",{className:"chat-list-wrapper",children:ht?o.jsx("div",{className:"loading-state",children:o.jsx("p",{children:"Loading chats..."})}):Qt.length>0?Qt.map(me=>o.jsxs("div",{className:"chat-item-card",onClick:()=>Fe(me),children:[o.jsxs("div",{className:"chat-avatar-wrapper",children:[me.otherUser?.avatar?o.jsx("img",{src:parseInt(me.otherUser.avatar)?Rs.find(qe=>qe.id===parseInt(me.otherUser.avatar))?.path:me.otherUser.avatar,alt:me.otherUser.name}):lt(me.otherUser?.name||"U"),o.jsx("span",{className:`online-indicator ${me.otherUser?.is_online?"online":""}`})]}),o.jsxs("div",{className:"chat-content",children:[o.jsxs("div",{className:"chat-top",children:[o.jsx("h3",{className:"chat-name",children:me.otherUser?.name||"Unknown"}),o.jsx("span",{className:"chat-time",children:gt(me.last_message_time)})]}),o.jsxs("div",{className:"chat-bottom",children:[o.jsx("p",{className:"last-message",children:me.last_message||"No messages yet"}),me.unreadCount>0&&o.jsx("span",{className:"unread-badge",children:me.unreadCount})]})]})]},me.id)):o.jsxs("div",{className:"empty-state",children:[o.jsx(Ma,{size:48}),o.jsx("h3",{children:"No conversations yet"}),o.jsx("p",{children:"Start messaging your contacts"})]})}),o.jsx("button",{className:"fab",title:"New Contact",onClick:()=>Z(!0),children:o.jsx(Hp,{size:24})})]}),o.jsx("aside",{className:`right-panel ${Rn?"visible-on-mobile":""}`,children:Rn?o.jsx(f0,{},x):o.jsxs("div",{className:"chat-preview-placeholder",children:[o.jsx(Ma,{size:120}),o.jsx("h3",{children:"Welcome to CaBa"}),o.jsx("p",{children:"Messages are end-to-end encrypted"})]})})]}),o.jsxs("nav",{className:`bottom-nav ${Rn?"hidden":""}`,children:[o.jsxs("button",{className:"nav-item active",onClick:()=>nt("/"),children:[o.jsx(Ma,{size:20}),o.jsx("span",{className:"label",children:"Chats"}),o.jsx("span",{className:"badge",children:"5"})]}),o.jsxs("button",{className:"nav-item",onClick:()=>nt("/news"),children:[o.jsx(ci,{size:20}),o.jsx("span",{className:"label",children:"News"})]}),o.jsxs("button",{className:"nav-item",onClick:()=>nt("/calls"),children:[o.jsx(Hs,{size:20}),o.jsx("span",{className:"label",children:"Audio Call"}),o.jsx("span",{className:"badge",children:"2"})]}),o.jsxs("button",{className:"nav-item",onClick:()=>nt("/settings"),children:[o.jsx(Kl,{size:20}),o.jsx("span",{className:"label",children:"Settings"})]})]}),o.jsx(wr,{isOpen:K,onClose:()=>{Z(!1),X(!1),q(!1),ge(""),be("")},title:J?"Select Contact":"New Contact",size:"medium",children:o.jsxs("div",{className:"new-contact-modal",children:[o.jsxs("div",{className:"modal-mode-toggle",children:[o.jsx("button",{className:`mode-btn ${J?"":"active"}`,onClick:()=>q(!1),children:"Manage Contacts"}),o.jsx("button",{className:`mode-btn ${J?"active":""}`,onClick:()=>q(!0),children:"Select Contact"})]}),J?o.jsxs("div",{className:"select-contact-section",children:[o.jsx("h3",{children:"Start Chat With"}),o.jsx("div",{className:"saved-contacts-list",children:Ie.length>0?Ie.map(me=>o.jsxs("div",{className:"saved-contact-item",children:[o.jsxs("div",{className:"contact-info",children:[o.jsx("div",{className:"contact-avatar",children:me.avatar?parseInt(me.avatar)?o.jsx("img",{src:Rs.find(qe=>qe.id===parseInt(me.avatar))?.path||me.avatar,alt:me.name}):o.jsx("img",{src:me.avatar,alt:me.name}):o.jsx("div",{children:lt(me.name)})}),o.jsxs("div",{children:[o.jsx("div",{className:"contact-name",children:me.name}),o.jsx("div",{className:"contact-phone",children:me.phone})]})]}),o.jsx("button",{className:"start-chat-btn",onClick:()=>wt(me),title:"Start Chat",children:" Chat"})]},me.id)):o.jsx("p",{className:"no-contacts",children:"No saved contacts yet. Add contacts first."})})]}):o.jsxs(o.Fragment,{children:[o.jsxs("button",{className:"add-contact-btn",onClick:()=>X(!W),children:[o.jsx(Hp,{size:20}),"Add New Contact"]}),W&&o.jsxs("div",{className:"contact-form",children:[o.jsx("input",{type:"text",placeholder:"Contact name",value:he,onChange:me=>ge(me.target.value),className:"contact-input"}),o.jsx("input",{type:"tel",placeholder:"Phone number (10 digits)",value:ie,onChange:me=>be(me.target.value.replace(/\D/g,"").slice(0,10)),className:"contact-input"}),o.jsxs("div",{className:"contact-form-actions",children:[o.jsx("button",{className:"btn-primary",onClick:qn,children:"Save Contact"}),o.jsx("button",{className:"btn-secondary",onClick:()=>{X(!1),ge(""),be("")},children:"Cancel"})]})]}),o.jsxs("div",{className:"saved-contacts-section",children:[o.jsx("h3",{children:"Saved Contacts"}),o.jsx("div",{className:"saved-contacts-list",children:Ie.length>0?Ie.map((me,qe)=>o.jsxs("div",{className:`saved-contact-item ${cn?.id===me.id?"menu-open":""}`,onClick:()=>Ut(me),children:[o.jsxs("div",{className:"contact-info",children:[o.jsx("div",{className:"contact-avatar",children:me.avatar?parseInt(me.avatar)?o.jsx("img",{src:Rs.find(ct=>ct.id===parseInt(me.avatar))?.path||me.avatar,alt:me.name}):o.jsx("img",{src:me.avatar,alt:me.name}):o.jsx("div",{children:lt(me.name)})}),o.jsxs("div",{className:"contact-details",children:[o.jsx("div",{className:"contact-name",children:me.name}),o.jsx("div",{className:"contact-phone",children:me.phone})]})]}),o.jsx("button",{className:"contact-menu-btn",onClick:ct=>ts(me.id,ct,qe),title:"Options",children:o.jsx(sd,{size:18})}),cn?.id===me.id&&o.jsxs("div",{className:`contact-menu ${cn.showAbove?"show-above":"show-below"}`,children:[o.jsxs("button",{className:"menu-item edit-item",onClick:ct=>{ct.stopPropagation(),je(me)},children:[o.jsx(ad,{size:16}),"Edit"]}),o.jsxs("button",{className:"menu-item delete-item",onClick:ct=>{ct.stopPropagation(),jn(me.id)},children:[o.jsx(js,{size:16}),"Delete"]})]})]},me.id)):o.jsx("p",{className:"no-contacts",children:"No saved contacts yet"})})]})]})]})}),o.jsx(wr,{isOpen:ke,onClose:()=>{},title:"Complete Your Profile",size:"medium",children:o.jsxs("div",{className:"phone-completion-modal",children:[o.jsxs("div",{className:"phone-modal-header",children:[o.jsx("h3",{children:"Complete Your Profile"}),o.jsx("p",{children:"Please provide your phone number and create a password to complete your account setup."})]}),o.jsxs("form",{onSubmit:Tn,className:"phone-form",children:[o.jsxs("div",{className:"input-group",children:[o.jsx("label",{htmlFor:"phone",children:"Phone Number"}),o.jsx("input",{type:"tel",id:"phone",placeholder:"10 digit mobile number",pattern:"[0-9]{10}",maxLength:"10",required:!0,autoComplete:"tel",value:Ue,onChange:me=>We(me.target.value.replace(/\D/g,"").slice(0,10)),disabled:Mt}),o.jsx("small",{children:"10 digits without country code"})]}),o.jsxs("div",{className:"input-group",children:[o.jsx("label",{htmlFor:"password",children:"Password (Required for backup login)"}),o.jsxs("div",{className:"password-input",children:[o.jsx("input",{type:Je?"text":"password",id:"password",placeholder:"Create a password (min 6 characters)",minLength:"6",required:!0,value:Ne,onChange:me=>$e(me.target.value),disabled:Mt}),o.jsx("button",{type:"button",className:"toggle-password",onClick:()=>mt(!Je),children:Je?o.jsx(Mu,{size:16}):o.jsx(Ya,{size:16})})]}),o.jsx("small",{children:"Required: Create password for backup login"})]}),o.jsxs("div",{className:"input-group",children:[o.jsx("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),o.jsxs("div",{className:"password-input",children:[o.jsx("input",{type:Wt?"text":"password",id:"confirmPassword",placeholder:"Confirm your password",minLength:"6",required:!0,value:De,onChange:me=>Ce(me.target.value),disabled:Mt}),o.jsx("button",{type:"button",className:"toggle-password",onClick:()=>ft(!Wt),children:Wt?o.jsx(Mu,{size:16}):o.jsx(Ya,{size:16})})]})]}),o.jsx("button",{type:"submit",className:"btn btn-primary",disabled:Mt||Ue.length!==10,children:Mt?"Saving...":"Save Profile"})]}),o.jsx("div",{className:"phone-modal-footer",children:o.jsxs("p",{className:"phone-note",children:[o.jsx("strong",{children:"Note:"})," Your phone number will be visible to other users for contact purposes. The password enables backup login access."]})})]})})]})};var Po={},_f,Yp;function wE(){return Yp||(Yp=1,_f=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),_f}var Sf={},ri={},Xp;function Wi(){if(Xp)return ri;Xp=1;let i;const n=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return ri.getSymbolSize=function(l){if(!l)throw new Error('"version" cannot be null or undefined');if(l<1||l>40)throw new Error('"version" should be in range from 1 to 40');return l*4+17},ri.getSymbolTotalCodewords=function(l){return n[l]},ri.getBCHDigit=function(a){let l=0;for(;a!==0;)l++,a>>>=1;return l},ri.setToSJISFunction=function(l){if(typeof l!="function")throw new Error('"toSJISFunc" is not a valid function.');i=l},ri.isKanjiModeEnabled=function(){return typeof i<"u"},ri.toSJIS=function(l){return i(l)},ri}var Ef={},Wp;function U0(){return Wp||(Wp=1,(function(i){i.L={bit:1},i.M={bit:0},i.Q={bit:3},i.H={bit:2};function n(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"l":case"low":return i.L;case"m":case"medium":return i.M;case"q":case"quartile":return i.Q;case"h":case"high":return i.H;default:throw new Error("Unknown EC Level: "+a)}}i.isValid=function(l){return l&&typeof l.bit<"u"&&l.bit>=0&&l.bit<4},i.from=function(l,d){if(i.isValid(l))return l;try{return n(l)}catch{return d}}})(Ef)),Ef}var Af,Qp;function bE(){if(Qp)return Af;Qp=1;function i(){this.buffer=[],this.length=0}return i.prototype={get:function(n){const a=Math.floor(n/8);return(this.buffer[a]>>>7-n%8&1)===1},put:function(n,a){for(let l=0;l<a;l++)this.putBit((n>>>a-l-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const a=Math.floor(this.length/8);this.buffer.length<=a&&this.buffer.push(0),n&&(this.buffer[a]|=128>>>this.length%8),this.length++}},Af=i,Af}var Nf,Kp;function vE(){if(Kp)return Nf;Kp=1;function i(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}return i.prototype.set=function(n,a,l,d){const f=n*this.size+a;this.data[f]=l,d&&(this.reservedBit[f]=!0)},i.prototype.get=function(n,a){return this.data[n*this.size+a]},i.prototype.xor=function(n,a,l){this.data[n*this.size+a]^=l},i.prototype.isReserved=function(n,a){return this.reservedBit[n*this.size+a]},Nf=i,Nf}var Tf={},Zp;function CE(){return Zp||(Zp=1,(function(i){const n=Wi().getSymbolSize;i.getRowColCoords=function(l){if(l===1)return[];const d=Math.floor(l/7)+2,f=n(l),x=f===145?26:Math.ceil((f-13)/(2*d-2))*2,v=[f-7];for(let C=1;C<d-1;C++)v[C]=v[C-1]-x;return v.push(6),v.reverse()},i.getPositions=function(l){const d=[],f=i.getRowColCoords(l),x=f.length;for(let v=0;v<x;v++)for(let C=0;C<x;C++)v===0&&C===0||v===0&&C===x-1||v===x-1&&C===0||d.push([f[v],f[C]]);return d}})(Tf)),Tf}var jf={},$p;function _E(){if($p)return jf;$p=1;const i=Wi().getSymbolSize,n=7;return jf.getPositions=function(l){const d=i(l);return[[0,0],[d-n,0],[0,d-n]]},jf}var Rf={},Jp;function SE(){return Jp||(Jp=1,(function(i){i.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const n={N1:3,N2:3,N3:40,N4:10};i.isValid=function(d){return d!=null&&d!==""&&!isNaN(d)&&d>=0&&d<=7},i.from=function(d){return i.isValid(d)?parseInt(d,10):void 0},i.getPenaltyN1=function(d){const f=d.size;let x=0,v=0,C=0,w=null,A=null;for(let N=0;N<f;N++){v=C=0,w=A=null;for(let R=0;R<f;R++){let T=d.get(N,R);T===w?v++:(v>=5&&(x+=n.N1+(v-5)),w=T,v=1),T=d.get(R,N),T===A?C++:(C>=5&&(x+=n.N1+(C-5)),A=T,C=1)}v>=5&&(x+=n.N1+(v-5)),C>=5&&(x+=n.N1+(C-5))}return x},i.getPenaltyN2=function(d){const f=d.size;let x=0;for(let v=0;v<f-1;v++)for(let C=0;C<f-1;C++){const w=d.get(v,C)+d.get(v,C+1)+d.get(v+1,C)+d.get(v+1,C+1);(w===4||w===0)&&x++}return x*n.N2},i.getPenaltyN3=function(d){const f=d.size;let x=0,v=0,C=0;for(let w=0;w<f;w++){v=C=0;for(let A=0;A<f;A++)v=v<<1&2047|d.get(w,A),A>=10&&(v===1488||v===93)&&x++,C=C<<1&2047|d.get(A,w),A>=10&&(C===1488||C===93)&&x++}return x*n.N3},i.getPenaltyN4=function(d){let f=0;const x=d.data.length;for(let C=0;C<x;C++)f+=d.data[C];return Math.abs(Math.ceil(f*100/x/5)-10)*n.N4};function a(l,d,f){switch(l){case i.Patterns.PATTERN000:return(d+f)%2===0;case i.Patterns.PATTERN001:return d%2===0;case i.Patterns.PATTERN010:return f%3===0;case i.Patterns.PATTERN011:return(d+f)%3===0;case i.Patterns.PATTERN100:return(Math.floor(d/2)+Math.floor(f/3))%2===0;case i.Patterns.PATTERN101:return d*f%2+d*f%3===0;case i.Patterns.PATTERN110:return(d*f%2+d*f%3)%2===0;case i.Patterns.PATTERN111:return(d*f%3+(d+f)%2)%2===0;default:throw new Error("bad maskPattern:"+l)}}i.applyMask=function(d,f){const x=f.size;for(let v=0;v<x;v++)for(let C=0;C<x;C++)f.isReserved(C,v)||f.xor(C,v,a(d,C,v))},i.getBestMask=function(d,f){const x=Object.keys(i.Patterns).length;let v=0,C=1/0;for(let w=0;w<x;w++){f(w),i.applyMask(w,d);const A=i.getPenaltyN1(d)+i.getPenaltyN2(d)+i.getPenaltyN3(d)+i.getPenaltyN4(d);i.applyMask(w,d),A<C&&(C=A,v=w)}return v}})(Rf)),Rf}var Du={},ex;function ly(){if(ex)return Du;ex=1;const i=U0(),n=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],a=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return Du.getBlocksCount=function(d,f){switch(f){case i.L:return n[(d-1)*4+0];case i.M:return n[(d-1)*4+1];case i.Q:return n[(d-1)*4+2];case i.H:return n[(d-1)*4+3];default:return}},Du.getTotalCodewordsCount=function(d,f){switch(f){case i.L:return a[(d-1)*4+0];case i.M:return a[(d-1)*4+1];case i.Q:return a[(d-1)*4+2];case i.H:return a[(d-1)*4+3];default:return}},Du}var If={},Gl={},tx;function EE(){if(tx)return Gl;tx=1;const i=new Uint8Array(512),n=new Uint8Array(256);return(function(){let l=1;for(let d=0;d<255;d++)i[d]=l,n[l]=d,l<<=1,l&256&&(l^=285);for(let d=255;d<512;d++)i[d]=i[d-255]})(),Gl.log=function(l){if(l<1)throw new Error("log("+l+")");return n[l]},Gl.exp=function(l){return i[l]},Gl.mul=function(l,d){return l===0||d===0?0:i[n[l]+n[d]]},Gl}var nx;function AE(){return nx||(nx=1,(function(i){const n=EE();i.mul=function(l,d){const f=new Uint8Array(l.length+d.length-1);for(let x=0;x<l.length;x++)for(let v=0;v<d.length;v++)f[x+v]^=n.mul(l[x],d[v]);return f},i.mod=function(l,d){let f=new Uint8Array(l);for(;f.length-d.length>=0;){const x=f[0];for(let C=0;C<d.length;C++)f[C]^=n.mul(d[C],x);let v=0;for(;v<f.length&&f[v]===0;)v++;f=f.slice(v)}return f},i.generateECPolynomial=function(l){let d=new Uint8Array([1]);for(let f=0;f<l;f++)d=i.mul(d,new Uint8Array([1,n.exp(f)]));return d}})(If)),If}var Of,sx;function NE(){if(sx)return Of;sx=1;const i=AE();function n(a){this.genPoly=void 0,this.degree=a,this.degree&&this.initialize(this.degree)}return n.prototype.initialize=function(l){this.degree=l,this.genPoly=i.generateECPolynomial(this.degree)},n.prototype.encode=function(l){if(!this.genPoly)throw new Error("Encoder not initialized");const d=new Uint8Array(l.length+this.degree);d.set(l);const f=i.mod(d,this.genPoly),x=this.degree-f.length;if(x>0){const v=new Uint8Array(this.degree);return v.set(f,x),v}return f},Of=n,Of}var Mf={},kf={},Df={},ax;function cy(){return ax||(ax=1,Df.isValid=function(n){return!isNaN(n)&&n>=1&&n<=40}),Df}var Va={},rx;function uy(){if(rx)return Va;rx=1;const i="[0-9]+",n="[A-Z $%*+\\-./:]+";let a="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";a=a.replace(/u/g,"\\u");const l="(?:(?![A-Z0-9 $%*+\\-./:]|"+a+`)(?:.|[\r
]))+`;Va.KANJI=new RegExp(a,"g"),Va.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Va.BYTE=new RegExp(l,"g"),Va.NUMERIC=new RegExp(i,"g"),Va.ALPHANUMERIC=new RegExp(n,"g");const d=new RegExp("^"+a+"$"),f=new RegExp("^"+i+"$"),x=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Va.testKanji=function(C){return d.test(C)},Va.testNumeric=function(C){return f.test(C)},Va.testAlphanumeric=function(C){return x.test(C)},Va}var ix;function Qi(){return ix||(ix=1,(function(i){const n=cy(),a=uy();i.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},i.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},i.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},i.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},i.MIXED={bit:-1},i.getCharCountIndicator=function(f,x){if(!f.ccBits)throw new Error("Invalid mode: "+f);if(!n.isValid(x))throw new Error("Invalid version: "+x);return x>=1&&x<10?f.ccBits[0]:x<27?f.ccBits[1]:f.ccBits[2]},i.getBestModeForData=function(f){return a.testNumeric(f)?i.NUMERIC:a.testAlphanumeric(f)?i.ALPHANUMERIC:a.testKanji(f)?i.KANJI:i.BYTE},i.toString=function(f){if(f&&f.id)return f.id;throw new Error("Invalid mode")},i.isValid=function(f){return f&&f.bit&&f.ccBits};function l(d){if(typeof d!="string")throw new Error("Param is not a string");switch(d.toLowerCase()){case"numeric":return i.NUMERIC;case"alphanumeric":return i.ALPHANUMERIC;case"kanji":return i.KANJI;case"byte":return i.BYTE;default:throw new Error("Unknown mode: "+d)}}i.from=function(f,x){if(i.isValid(f))return f;try{return l(f)}catch{return x}}})(kf)),kf}var ox;function TE(){return ox||(ox=1,(function(i){const n=Wi(),a=ly(),l=U0(),d=Qi(),f=cy(),x=7973,v=n.getBCHDigit(x);function C(R,T,O){for(let L=1;L<=40;L++)if(T<=i.getCapacity(L,O,R))return L}function w(R,T){return d.getCharCountIndicator(R,T)+4}function A(R,T){let O=0;return R.forEach(function(L){const B=w(L.mode,T);O+=B+L.getBitsLength()}),O}function N(R,T){for(let O=1;O<=40;O++)if(A(R,O)<=i.getCapacity(O,T,d.MIXED))return O}i.from=function(T,O){return f.isValid(T)?parseInt(T,10):O},i.getCapacity=function(T,O,L){if(!f.isValid(T))throw new Error("Invalid QR Code version");typeof L>"u"&&(L=d.BYTE);const B=n.getSymbolTotalCodewords(T),H=a.getTotalCodewordsCount(T,O),U=(B-H)*8;if(L===d.MIXED)return U;const P=U-w(L,T);switch(L){case d.NUMERIC:return Math.floor(P/10*3);case d.ALPHANUMERIC:return Math.floor(P/11*2);case d.KANJI:return Math.floor(P/13);case d.BYTE:default:return Math.floor(P/8)}},i.getBestVersionForData=function(T,O){let L;const B=l.from(O,l.M);if(Array.isArray(T)){if(T.length>1)return N(T,B);if(T.length===0)return 1;L=T[0]}else L=T;return C(L.mode,L.getLength(),B)},i.getEncodedBits=function(T){if(!f.isValid(T)||T<7)throw new Error("Invalid QR Code version");let O=T<<12;for(;n.getBCHDigit(O)-v>=0;)O^=x<<n.getBCHDigit(O)-v;return T<<12|O}})(Mf)),Mf}var Lf={},lx;function jE(){if(lx)return Lf;lx=1;const i=Wi(),n=1335,a=21522,l=i.getBCHDigit(n);return Lf.getEncodedBits=function(f,x){const v=f.bit<<3|x;let C=v<<10;for(;i.getBCHDigit(C)-l>=0;)C^=n<<i.getBCHDigit(C)-l;return(v<<10|C)^a},Lf}var Bf={},Uf,cx;function RE(){if(cx)return Uf;cx=1;const i=Qi();function n(a){this.mode=i.NUMERIC,this.data=a.toString()}return n.getBitsLength=function(l){return 10*Math.floor(l/3)+(l%3?l%3*3+1:0)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(l){let d,f,x;for(d=0;d+3<=this.data.length;d+=3)f=this.data.substr(d,3),x=parseInt(f,10),l.put(x,10);const v=this.data.length-d;v>0&&(f=this.data.substr(d),x=parseInt(f,10),l.put(x,v*3+1))},Uf=n,Uf}var Pf,ux;function IE(){if(ux)return Pf;ux=1;const i=Qi(),n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function a(l){this.mode=i.ALPHANUMERIC,this.data=l}return a.getBitsLength=function(d){return 11*Math.floor(d/2)+6*(d%2)},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(d){let f;for(f=0;f+2<=this.data.length;f+=2){let x=n.indexOf(this.data[f])*45;x+=n.indexOf(this.data[f+1]),d.put(x,11)}this.data.length%2&&d.put(n.indexOf(this.data[f]),6)},Pf=a,Pf}var zf,dx;function OE(){if(dx)return zf;dx=1;const i=Qi();function n(a){this.mode=i.BYTE,typeof a=="string"?this.data=new TextEncoder().encode(a):this.data=new Uint8Array(a)}return n.getBitsLength=function(l){return l*8},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(a){for(let l=0,d=this.data.length;l<d;l++)a.put(this.data[l],8)},zf=n,zf}var Ff,hx;function ME(){if(hx)return Ff;hx=1;const i=Qi(),n=Wi();function a(l){this.mode=i.KANJI,this.data=l}return a.getBitsLength=function(d){return d*13},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(l){let d;for(d=0;d<this.data.length;d++){let f=n.toSJIS(this.data[d]);if(f>=33088&&f<=40956)f-=33088;else if(f>=57408&&f<=60351)f-=49472;else throw new Error("Invalid SJIS character: "+this.data[d]+`
Make sure your charset is UTF-8`);f=(f>>>8&255)*192+(f&255),l.put(f,13)}},Ff=a,Ff}var Hf={exports:{}},fx;function kE(){return fx||(fx=1,(function(i){var n={single_source_shortest_paths:function(a,l,d){var f={},x={};x[l]=0;var v=n.PriorityQueue.make();v.push(l,0);for(var C,w,A,N,R,T,O,L,B;!v.empty();){C=v.pop(),w=C.value,N=C.cost,R=a[w]||{};for(A in R)R.hasOwnProperty(A)&&(T=R[A],O=N+T,L=x[A],B=typeof x[A]>"u",(B||L>O)&&(x[A]=O,v.push(A,O),f[A]=w))}if(typeof d<"u"&&typeof x[d]>"u"){var H=["Could not find a path from ",l," to ",d,"."].join("");throw new Error(H)}return f},extract_shortest_path_from_predecessor_list:function(a,l){for(var d=[],f=l;f;)d.push(f),a[f],f=a[f];return d.reverse(),d},find_path:function(a,l,d){var f=n.single_source_shortest_paths(a,l,d);return n.extract_shortest_path_from_predecessor_list(f,d)},PriorityQueue:{make:function(a){var l=n.PriorityQueue,d={},f;a=a||{};for(f in l)l.hasOwnProperty(f)&&(d[f]=l[f]);return d.queue=[],d.sorter=a.sorter||l.default_sorter,d},default_sorter:function(a,l){return a.cost-l.cost},push:function(a,l){var d={value:a,cost:l};this.queue.push(d),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};i.exports=n})(Hf)),Hf.exports}var gx;function DE(){return gx||(gx=1,(function(i){const n=Qi(),a=RE(),l=IE(),d=OE(),f=ME(),x=uy(),v=Wi(),C=kE();function w(H){return unescape(encodeURIComponent(H)).length}function A(H,U,P){const K=[];let Z;for(;(Z=H.exec(P))!==null;)K.push({data:Z[0],index:Z.index,mode:U,length:Z[0].length});return K}function N(H){const U=A(x.NUMERIC,n.NUMERIC,H),P=A(x.ALPHANUMERIC,n.ALPHANUMERIC,H);let K,Z;return v.isKanjiModeEnabled()?(K=A(x.BYTE,n.BYTE,H),Z=A(x.KANJI,n.KANJI,H)):(K=A(x.BYTE_KANJI,n.BYTE,H),Z=[]),U.concat(P,K,Z).sort(function(X,J){return X.index-J.index}).map(function(X){return{data:X.data,mode:X.mode,length:X.length}})}function R(H,U){switch(U){case n.NUMERIC:return a.getBitsLength(H);case n.ALPHANUMERIC:return l.getBitsLength(H);case n.KANJI:return f.getBitsLength(H);case n.BYTE:return d.getBitsLength(H)}}function T(H){return H.reduce(function(U,P){const K=U.length-1>=0?U[U.length-1]:null;return K&&K.mode===P.mode?(U[U.length-1].data+=P.data,U):(U.push(P),U)},[])}function O(H){const U=[];for(let P=0;P<H.length;P++){const K=H[P];switch(K.mode){case n.NUMERIC:U.push([K,{data:K.data,mode:n.ALPHANUMERIC,length:K.length},{data:K.data,mode:n.BYTE,length:K.length}]);break;case n.ALPHANUMERIC:U.push([K,{data:K.data,mode:n.BYTE,length:K.length}]);break;case n.KANJI:U.push([K,{data:K.data,mode:n.BYTE,length:w(K.data)}]);break;case n.BYTE:U.push([{data:K.data,mode:n.BYTE,length:w(K.data)}])}}return U}function L(H,U){const P={},K={start:{}};let Z=["start"];for(let W=0;W<H.length;W++){const X=H[W],J=[];for(let q=0;q<X.length;q++){const he=X[q],ge=""+W+q;J.push(ge),P[ge]={node:he,lastCount:0},K[ge]={};for(let ie=0;ie<Z.length;ie++){const be=Z[ie];P[be]&&P[be].node.mode===he.mode?(K[be][ge]=R(P[be].lastCount+he.length,he.mode)-R(P[be].lastCount,he.mode),P[be].lastCount+=he.length):(P[be]&&(P[be].lastCount=he.length),K[be][ge]=R(he.length,he.mode)+4+n.getCharCountIndicator(he.mode,U))}}Z=J}for(let W=0;W<Z.length;W++)K[Z[W]].end=0;return{map:K,table:P}}function B(H,U){let P;const K=n.getBestModeForData(H);if(P=n.from(U,K),P!==n.BYTE&&P.bit<K.bit)throw new Error('"'+H+'" cannot be encoded with mode '+n.toString(P)+`.
 Suggested mode is: `+n.toString(K));switch(P===n.KANJI&&!v.isKanjiModeEnabled()&&(P=n.BYTE),P){case n.NUMERIC:return new a(H);case n.ALPHANUMERIC:return new l(H);case n.KANJI:return new f(H);case n.BYTE:return new d(H)}}i.fromArray=function(U){return U.reduce(function(P,K){return typeof K=="string"?P.push(B(K,null)):K.data&&P.push(B(K.data,K.mode)),P},[])},i.fromString=function(U,P){const K=N(U,v.isKanjiModeEnabled()),Z=O(K),W=L(Z,P),X=C.find_path(W.map,"start","end"),J=[];for(let q=1;q<X.length-1;q++)J.push(W.table[X[q]].node);return i.fromArray(T(J))},i.rawSplit=function(U){return i.fromArray(N(U,v.isKanjiModeEnabled()))}})(Bf)),Bf}var mx;function LE(){if(mx)return Sf;mx=1;const i=Wi(),n=U0(),a=bE(),l=vE(),d=CE(),f=_E(),x=SE(),v=ly(),C=NE(),w=TE(),A=jE(),N=Qi(),R=DE();function T(W,X){const J=W.size,q=f.getPositions(X);for(let he=0;he<q.length;he++){const ge=q[he][0],ie=q[he][1];for(let be=-1;be<=7;be++)if(!(ge+be<=-1||J<=ge+be))for(let Ie=-1;Ie<=7;Ie++)ie+Ie<=-1||J<=ie+Ie||(be>=0&&be<=6&&(Ie===0||Ie===6)||Ie>=0&&Ie<=6&&(be===0||be===6)||be>=2&&be<=4&&Ie>=2&&Ie<=4?W.set(ge+be,ie+Ie,!0,!0):W.set(ge+be,ie+Ie,!1,!0))}}function O(W){const X=W.size;for(let J=8;J<X-8;J++){const q=J%2===0;W.set(J,6,q,!0),W.set(6,J,q,!0)}}function L(W,X){const J=d.getPositions(X);for(let q=0;q<J.length;q++){const he=J[q][0],ge=J[q][1];for(let ie=-2;ie<=2;ie++)for(let be=-2;be<=2;be++)ie===-2||ie===2||be===-2||be===2||ie===0&&be===0?W.set(he+ie,ge+be,!0,!0):W.set(he+ie,ge+be,!1,!0)}}function B(W,X){const J=W.size,q=w.getEncodedBits(X);let he,ge,ie;for(let be=0;be<18;be++)he=Math.floor(be/3),ge=be%3+J-8-3,ie=(q>>be&1)===1,W.set(he,ge,ie,!0),W.set(ge,he,ie,!0)}function H(W,X,J){const q=W.size,he=A.getEncodedBits(X,J);let ge,ie;for(ge=0;ge<15;ge++)ie=(he>>ge&1)===1,ge<6?W.set(ge,8,ie,!0):ge<8?W.set(ge+1,8,ie,!0):W.set(q-15+ge,8,ie,!0),ge<8?W.set(8,q-ge-1,ie,!0):ge<9?W.set(8,15-ge-1+1,ie,!0):W.set(8,15-ge-1,ie,!0);W.set(q-8,8,1,!0)}function U(W,X){const J=W.size;let q=-1,he=J-1,ge=7,ie=0;for(let be=J-1;be>0;be-=2)for(be===6&&be--;;){for(let Ie=0;Ie<2;Ie++)if(!W.isReserved(he,be-Ie)){let V=!1;ie<X.length&&(V=(X[ie]>>>ge&1)===1),W.set(he,be-Ie,V),ge--,ge===-1&&(ie++,ge=7)}if(he+=q,he<0||J<=he){he-=q,q=-q;break}}}function P(W,X,J){const q=new a;J.forEach(function(Ie){q.put(Ie.mode.bit,4),q.put(Ie.getLength(),N.getCharCountIndicator(Ie.mode,W)),Ie.write(q)});const he=i.getSymbolTotalCodewords(W),ge=v.getTotalCodewordsCount(W,X),ie=(he-ge)*8;for(q.getLengthInBits()+4<=ie&&q.put(0,4);q.getLengthInBits()%8!==0;)q.putBit(0);const be=(ie-q.getLengthInBits())/8;for(let Ie=0;Ie<be;Ie++)q.put(Ie%2?17:236,8);return K(q,W,X)}function K(W,X,J){const q=i.getSymbolTotalCodewords(X),he=v.getTotalCodewordsCount(X,J),ge=q-he,ie=v.getBlocksCount(X,J),be=q%ie,Ie=ie-be,V=Math.floor(q/ie),$=Math.floor(ge/ie),oe=$+1,ke=V-$,Ge=new C(ke);let Ke=0;const ne=new Array(ie),ye=new Array(ie);let Le=0;const Ue=new Uint8Array(W.buffer);for(let Ce=0;Ce<ie;Ce++){const Je=Ce<Ie?$:oe;ne[Ce]=Ue.slice(Ke,Ke+Je),ye[Ce]=Ge.encode(ne[Ce]),Ke+=Je,Le=Math.max(Le,Je)}const We=new Uint8Array(q);let Ne=0,$e,De;for($e=0;$e<Le;$e++)for(De=0;De<ie;De++)$e<ne[De].length&&(We[Ne++]=ne[De][$e]);for($e=0;$e<ke;$e++)for(De=0;De<ie;De++)We[Ne++]=ye[De][$e];return We}function Z(W,X,J,q){let he;if(Array.isArray(W))he=R.fromArray(W);else if(typeof W=="string"){let V=X;if(!V){const $=R.rawSplit(W);V=w.getBestVersionForData($,J)}he=R.fromString(W,V||40)}else throw new Error("Invalid data");const ge=w.getBestVersionForData(he,J);if(!ge)throw new Error("The amount of data is too big to be stored in a QR Code");if(!X)X=ge;else if(X<ge)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+ge+`.
`);const ie=P(X,J,he),be=i.getSymbolSize(X),Ie=new l(be);return T(Ie,X),O(Ie),L(Ie,X),H(Ie,J,0),X>=7&&B(Ie,X),U(Ie,ie),isNaN(q)&&(q=x.getBestMask(Ie,H.bind(null,Ie,J))),x.applyMask(q,Ie),H(Ie,J,q),{modules:Ie,version:X,errorCorrectionLevel:J,maskPattern:q,segments:he}}return Sf.create=function(X,J){if(typeof X>"u"||X==="")throw new Error("No input text");let q=n.M,he,ge;return typeof J<"u"&&(q=n.from(J.errorCorrectionLevel,n.M),he=w.from(J.version),ge=x.from(J.maskPattern),J.toSJISFunc&&i.setToSJISFunction(J.toSJISFunc)),Z(X,he,q,ge)},Sf}var qf={},Vf={},px;function dy(){return px||(px=1,(function(i){function n(a){if(typeof a=="number"&&(a=a.toString()),typeof a!="string")throw new Error("Color should be defined as hex string");let l=a.slice().replace("#","").split("");if(l.length<3||l.length===5||l.length>8)throw new Error("Invalid hex color: "+a);(l.length===3||l.length===4)&&(l=Array.prototype.concat.apply([],l.map(function(f){return[f,f]}))),l.length===6&&l.push("F","F");const d=parseInt(l.join(""),16);return{r:d>>24&255,g:d>>16&255,b:d>>8&255,a:d&255,hex:"#"+l.slice(0,6).join("")}}i.getOptions=function(l){l||(l={}),l.color||(l.color={});const d=typeof l.margin>"u"||l.margin===null||l.margin<0?4:l.margin,f=l.width&&l.width>=21?l.width:void 0,x=l.scale||4;return{width:f,scale:f?4:x,margin:d,color:{dark:n(l.color.dark||"#000000ff"),light:n(l.color.light||"#ffffffff")},type:l.type,rendererOpts:l.rendererOpts||{}}},i.getScale=function(l,d){return d.width&&d.width>=l+d.margin*2?d.width/(l+d.margin*2):d.scale},i.getImageWidth=function(l,d){const f=i.getScale(l,d);return Math.floor((l+d.margin*2)*f)},i.qrToImageData=function(l,d,f){const x=d.modules.size,v=d.modules.data,C=i.getScale(x,f),w=Math.floor((x+f.margin*2)*C),A=f.margin*C,N=[f.color.light,f.color.dark];for(let R=0;R<w;R++)for(let T=0;T<w;T++){let O=(R*w+T)*4,L=f.color.light;if(R>=A&&T>=A&&R<w-A&&T<w-A){const B=Math.floor((R-A)/C),H=Math.floor((T-A)/C);L=N[v[B*x+H]?1:0]}l[O++]=L.r,l[O++]=L.g,l[O++]=L.b,l[O]=L.a}}})(Vf)),Vf}var xx;function BE(){return xx||(xx=1,(function(i){const n=dy();function a(d,f,x){d.clearRect(0,0,f.width,f.height),f.style||(f.style={}),f.height=x,f.width=x,f.style.height=x+"px",f.style.width=x+"px"}function l(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}i.render=function(f,x,v){let C=v,w=x;typeof C>"u"&&(!x||!x.getContext)&&(C=x,x=void 0),x||(w=l()),C=n.getOptions(C);const A=n.getImageWidth(f.modules.size,C),N=w.getContext("2d"),R=N.createImageData(A,A);return n.qrToImageData(R.data,f,C),a(N,w,A),N.putImageData(R,0,0),w},i.renderToDataURL=function(f,x,v){let C=v;typeof C>"u"&&(!x||!x.getContext)&&(C=x,x=void 0),C||(C={});const w=i.render(f,x,C),A=C.type||"image/png",N=C.rendererOpts||{};return w.toDataURL(A,N.quality)}})(qf)),qf}var Gf={},yx;function UE(){if(yx)return Gf;yx=1;const i=dy();function n(d,f){const x=d.a/255,v=f+'="'+d.hex+'"';return x<1?v+" "+f+'-opacity="'+x.toFixed(2).slice(1)+'"':v}function a(d,f,x){let v=d+f;return typeof x<"u"&&(v+=" "+x),v}function l(d,f,x){let v="",C=0,w=!1,A=0;for(let N=0;N<d.length;N++){const R=Math.floor(N%f),T=Math.floor(N/f);!R&&!w&&(w=!0),d[N]?(A++,N>0&&R>0&&d[N-1]||(v+=w?a("M",R+x,.5+T+x):a("m",C,0),C=0,w=!1),R+1<f&&d[N+1]||(v+=a("h",A),A=0)):C++}return v}return Gf.render=function(f,x,v){const C=i.getOptions(x),w=f.modules.size,A=f.modules.data,N=w+C.margin*2,R=C.color.light.a?"<path "+n(C.color.light,"fill")+' d="M0 0h'+N+"v"+N+'H0z"/>':"",T="<path "+n(C.color.dark,"stroke")+' d="'+l(A,w,C.margin)+'"/>',O='viewBox="0 0 '+N+" "+N+'"',B='<svg xmlns="http://www.w3.org/2000/svg" '+(C.width?'width="'+C.width+'" height="'+C.width+'" ':"")+O+' shape-rendering="crispEdges">'+R+T+`</svg>
`;return typeof v=="function"&&v(null,B),B},Gf}var wx;function PE(){if(wx)return Po;wx=1;const i=wE(),n=LE(),a=BE(),l=UE();function d(f,x,v,C,w){const A=[].slice.call(arguments,1),N=A.length,R=typeof A[N-1]=="function";if(!R&&!i())throw new Error("Callback required as last argument");if(R){if(N<2)throw new Error("Too few arguments provided");N===2?(w=v,v=x,x=C=void 0):N===3&&(x.getContext&&typeof w>"u"?(w=C,C=void 0):(w=C,C=v,v=x,x=void 0))}else{if(N<1)throw new Error("Too few arguments provided");return N===1?(v=x,x=C=void 0):N===2&&!x.getContext&&(C=v,v=x,x=void 0),new Promise(function(T,O){try{const L=n.create(v,C);T(f(L,x,C))}catch(L){O(L)}})}try{const T=n.create(v,C);w(null,f(T,x,C))}catch(T){w(T)}}return Po.create=n.create,Po.toCanvas=d.bind(null,a.render),Po.toDataURL=d.bind(null,a.renderToDataURL),Po.toString=d.bind(null,function(f,x,v){return l.render(f,v)}),Po}var zE=PE();const FE=Qu(zE),hy=({userId:i,userName:n,userPhone:a,onDownload:l,onClose:d})=>{const[f,x]=M.useState(""),[v,C]=M.useState(!0),[w,A]=M.useState(null);M.useEffect(()=>{N()},[i,n,a]);const N=async()=>{try{if(C(!0),A(null),!i)throw new Error("User ID is required");const T=`https://mishra-aashu.github.io/CaBa/shared-profile.html?userId=${i}`;console.log("Generating QR code with URL:",T);const O=await FE.toDataURL(T,{width:256,margin:2,color:{dark:"#000000",light:"#FFFFFF"}});x(O),C(!1)}catch(T){console.error("Error generating QR code:",T),A("Failed to generate QR code. Please try again."),C(!1)}},R=()=>{try{if(f){const T=document.createElement("a");T.download=`${n||"User"}-CaBa-QR.png`,T.href=f,T.click(),l&&l()}}catch(T){console.error("Error downloading QR code:",T),alert("Failed to download QR code")}};return o.jsx("div",{className:"qr-generator-modal",children:o.jsxs("div",{className:"qr-generator-content",children:[o.jsxs("div",{className:"qr-generator-header",children:[o.jsx("h3",{children:"My QR Code"}),o.jsx("button",{className:"qr-close-btn",onClick:d,children:o.jsx("i",{className:"fas fa-times"})})]}),o.jsx("div",{className:"qr-generator-body",children:v?o.jsxs("div",{className:"qr-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Generating QR Code..."})]}):w?o.jsxs("div",{className:"qr-error",children:[o.jsx("p",{children:w}),o.jsx("button",{onClick:N,children:"Try Again"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"qr-canvas-container",children:o.jsx("img",{src:f,alt:"QR Code",className:"qr-canvas",style:{width:"256px",height:"256px"}})}),o.jsxs("div",{className:"qr-info",children:[o.jsx("p",{className:"qr-title",children:n}),a&&o.jsxs("p",{className:"qr-phone",children:[" ",a]}),o.jsx("p",{className:"qr-description",children:"Scan this QR code to view my CaBa profile"})]}),o.jsxs("div",{className:"qr-actions",children:[o.jsxs("button",{className:"qr-download-btn",onClick:R,children:[o.jsx("i",{className:"fas fa-download"}),"Download QR"]}),o.jsxs("button",{className:"qr-share-btn",onClick:()=>{navigator.share?navigator.share({title:`${n} - CaBa Profile`,text:`Connect with ${n} on CaBa!`,url:`${window.location.origin}/shared-profile.html?userId=${i}`}):navigator.clipboard.writeText(`${window.location.origin}/shared-profile.html?userId=${i}`).then(()=>alert("Profile link copied to clipboard!"))},children:[o.jsx("i",{className:"fas fa-share"}),"Share Link"]})]})]})})]})})};var Ye;(function(i){i[i.QR_CODE=0]="QR_CODE",i[i.AZTEC=1]="AZTEC",i[i.CODABAR=2]="CODABAR",i[i.CODE_39=3]="CODE_39",i[i.CODE_93=4]="CODE_93",i[i.CODE_128=5]="CODE_128",i[i.DATA_MATRIX=6]="DATA_MATRIX",i[i.MAXICODE=7]="MAXICODE",i[i.ITF=8]="ITF",i[i.EAN_13=9]="EAN_13",i[i.EAN_8=10]="EAN_8",i[i.PDF_417=11]="PDF_417",i[i.RSS_14=12]="RSS_14",i[i.RSS_EXPANDED=13]="RSS_EXPANDED",i[i.UPC_A=14]="UPC_A",i[i.UPC_E=15]="UPC_E",i[i.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ye||(Ye={}));var bx=new Map([[Ye.QR_CODE,"QR_CODE"],[Ye.AZTEC,"AZTEC"],[Ye.CODABAR,"CODABAR"],[Ye.CODE_39,"CODE_39"],[Ye.CODE_93,"CODE_93"],[Ye.CODE_128,"CODE_128"],[Ye.DATA_MATRIX,"DATA_MATRIX"],[Ye.MAXICODE,"MAXICODE"],[Ye.ITF,"ITF"],[Ye.EAN_13,"EAN_13"],[Ye.EAN_8,"EAN_8"],[Ye.PDF_417,"PDF_417"],[Ye.RSS_14,"RSS_14"],[Ye.RSS_EXPANDED,"RSS_EXPANDED"],[Ye.UPC_A,"UPC_A"],[Ye.UPC_E,"UPC_E"],[Ye.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),vx;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.URL=1]="URL"})(vx||(vx={}));function HE(i){return Object.values(Ye).includes(i)}var vr;(function(i){i[i.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",i[i.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(vr||(vr={}));var Oa=(function(){function i(){}return i.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",i.SCAN_DEFAULT_FPS=2,i.DEFAULT_DISABLE_FLIP=!1,i.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,i.DEFAULT_SUPPORTED_SCAN_TYPE=[vr.SCAN_TYPE_CAMERA,vr.SCAN_TYPE_FILE],i})(),fy=(function(){function i(n,a){this.format=n,this.formatName=a}return i.prototype.toString=function(){return this.formatName},i.create=function(n){if(!bx.has(n))throw"".concat(n," not in html5QrcodeSupportedFormatsTextMap");return new i(n,bx.get(n))},i})(),Cx=(function(){function i(){}return i.createFromText=function(n){var a={text:n};return{decodedText:n,result:a}},i.createFromQrcodeResult=function(n){return{decodedText:n.text,result:n}},i})(),g0;(function(i){i[i.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",i[i.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",i[i.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(g0||(g0={}));var gy=(function(){function i(){}return i.createFrom=function(n){return{errorMessage:n,type:g0.UNKWOWN_ERROR}},i})(),my=(function(){function i(n){this.verbose=n}return i.prototype.log=function(n){this.verbose&&console.log(n)},i.prototype.warn=function(n){this.verbose&&console.warn(n)},i.prototype.logError=function(n,a){(this.verbose||a===!0)&&console.error(n)},i.prototype.logErrors=function(n){if(n.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(n)},i})();function Ga(i){return typeof i>"u"||i===null}function qE(i,n,a){return i>a?a:i<n?n:i}var Ho=(function(){function i(){}return i.codeParseError=function(n){return"QR code parse error, error = ".concat(n)},i.errorGettingUserMedia=function(n){return"Error getting userMedia, error = ".concat(n)},i.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},i.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},i.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},i.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},i.scannerPaused=function(){return"Scanner paused"},i})(),ln=(function(){function i(){}return i.scanningStatus=function(){return"Scanning"},i.idleStatus=function(){return"Idle"},i.errorStatus=function(){return"Error"},i.permissionStatus=function(){return"Permission"},i.noCameraFoundErrorStatus=function(){return"No Cameras"},i.lastMatch=function(n){return"Last Match: ".concat(n)},i.codeScannerTitle=function(){return"Code Scanner"},i.cameraPermissionTitle=function(){return"Request Camera Permissions"},i.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},i.noCameraFound=function(){return"No camera found"},i.scanButtonStopScanningText=function(){return"Stop Scanning"},i.scanButtonStartScanningText=function(){return"Start Scanning"},i.torchOnButton=function(){return"Switch On Torch"},i.torchOffButton=function(){return"Switch Off Torch"},i.torchOnFailedMessage=function(){return"Failed to turn on torch"},i.torchOffFailedMessage=function(){return"Failed to turn off torch"},i.scanButtonScanningStarting=function(){return"Launching Camera..."},i.textIfCameraScanSelected=function(){return"Scan an Image File"},i.textIfFileScanSelected=function(){return"Scan using camera directly"},i.selectCamera=function(){return"Select Camera"},i.fileSelectionChooseImage=function(){return"Choose Image"},i.fileSelectionChooseAnother=function(){return"Choose Another"},i.fileSelectionNoImageSelected=function(){return"No image choosen"},i.anonymousCameraPrefix=function(){return"Anonymous Camera"},i.dragAndDropMessage=function(){return"Or drop an image to scan"},i.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},i.zoom=function(){return"zoom"},i.loadingImage=function(){return"Loading image..."},i.cameraScanAltText=function(){return"Camera based scan"},i.fileScanAltText=function(){return"Fule based scan"},i})(),_x=(function(){function i(){}return i.poweredBy=function(){return"Powered by "},i.reportIssues=function(){return"Report issues"},i})(),py=(function(){function i(){}return i.isMediaStreamConstraintsValid=function(n,a){if(typeof n!="object"){var l=typeof n;return a.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(l,"."),!0),!1}for(var d=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],f=new Set(d),x=Object.keys(n),v=0,C=x;v<C.length;v++){var w=C[v];if(f.has(w))return a.logError("".concat(w," is not supported videoConstaints."),!0),!1}return!0},i})(),Xl={exports:{}},VE=Xl.exports,Sx;function GE(){return Sx||(Sx=1,(function(i,n){(function(a,l){l(n)})(VE,(function(a){function l(k){return k==null}var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(k,t){k.__proto__=t}||function(k,t){for(var r in t)t.hasOwnProperty(r)&&(k[r]=t[r])};function f(k,t){d(k,t);function r(){this.constructor=k}k.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function x(k,t){var r=Object.setPrototypeOf;r?r(k,t):k.__proto__=t}function v(k,t){t===void 0&&(t=k.constructor);var r=Error.captureStackTrace;r&&r(k,t)}var C=(function(k){f(t,k);function t(r){var c=this.constructor,h=k.call(this,r)||this;return Object.defineProperty(h,"name",{value:c.name,enumerable:!1}),x(h,c.prototype),v(h),h}return t})(Error);class w extends C{constructor(t=void 0){super(t),this.message=t}getKind(){return this.constructor.kind}}w.kind="Exception";class A extends w{}A.kind="ArgumentException";class N extends w{}N.kind="IllegalArgumentException";class R{constructor(t){if(this.binarizer=t,t===null)throw new N("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(t,r){return this.binarizer.getBlackRow(t,r)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(t,r,c,h){const g=this.binarizer.getLuminanceSource().crop(t,r,c,h);return new R(this.binarizer.createBinarizer(g))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const t=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new R(this.binarizer.createBinarizer(t))}rotateCounterClockwise45(){const t=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new R(this.binarizer.createBinarizer(t))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class T extends w{static getChecksumInstance(){return new T}}T.kind="ChecksumException";class O{constructor(t){this.source=t}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class L{static arraycopy(t,r,c,h,g){for(;g--;)c[h++]=t[r++]}static currentTimeMillis(){return Date.now()}}class B extends w{}B.kind="IndexOutOfBoundsException";class H extends B{constructor(t=void 0,r=void 0){super(r),this.index=t,this.message=r}}H.kind="ArrayIndexOutOfBoundsException";class U{static fill(t,r){for(let c=0,h=t.length;c<h;c++)t[c]=r}static fillWithin(t,r,c,h){U.rangeCheck(t.length,r,c);for(let g=r;g<c;g++)t[g]=h}static rangeCheck(t,r,c){if(r>c)throw new N("fromIndex("+r+") > toIndex("+c+")");if(r<0)throw new H(r);if(c>t)throw new H(c)}static asList(...t){return t}static create(t,r,c){return Array.from({length:t}).map(g=>Array.from({length:r}).fill(c))}static createInt32Array(t,r,c){return Array.from({length:t}).map(g=>Int32Array.from({length:r}).fill(c))}static equals(t,r){if(!t||!r||!t.length||!r.length||t.length!==r.length)return!1;for(let c=0,h=t.length;c<h;c++)if(t[c]!==r[c])return!1;return!0}static hashCode(t){if(t===null)return 0;let r=1;for(const c of t)r=31*r+c;return r}static fillUint8Array(t,r){for(let c=0;c!==t.length;c++)t[c]=r}static copyOf(t,r){return t.slice(0,r)}static copyOfUint8Array(t,r){if(t.length<=r){const c=new Uint8Array(r);return c.set(t),c}return t.slice(0,r)}static copyOfRange(t,r,c){const h=c-r,g=new Int32Array(h);return L.arraycopy(t,r,g,0,h),g}static binarySearch(t,r,c){c===void 0&&(c=U.numberComparator);let h=0,g=t.length-1;for(;h<=g;){const p=g+h>>1,y=c(r,t[p]);if(y>0)h=p+1;else if(y<0)g=p-1;else return p}return-h-1}static numberComparator(t,r){return t-r}}class P{static numberOfTrailingZeros(t){let r;if(t===0)return 32;let c=31;return r=t<<16,r!==0&&(c-=16,t=r),r=t<<8,r!==0&&(c-=8,t=r),r=t<<4,r!==0&&(c-=4,t=r),r=t<<2,r!==0&&(c-=2,t=r),c-(t<<1>>>31)}static numberOfLeadingZeros(t){if(t===0)return 32;let r=1;return t>>>16||(r+=16,t<<=16),t>>>24||(r+=8,t<<=8),t>>>28||(r+=4,t<<=4),t>>>30||(r+=2,t<<=2),r-=t>>>31,r}static toHexString(t){return t.toString(16)}static toBinaryString(t){return String(parseInt(String(t),2))}static bitCount(t){return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),t=t+(t>>>4)&252645135,t=t+(t>>>8),t=t+(t>>>16),t&63}static truncDivision(t,r){return Math.trunc(t/r)}static parseInt(t,r=void 0){return parseInt(t,r)}}P.MIN_VALUE_32_BITS=-2147483648,P.MAX_VALUE=Number.MAX_SAFE_INTEGER;class K{constructor(t,r){t===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=t,r==null?this.bits=K.makeArray(t):this.bits=r)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(t){if(t>this.bits.length*32){const r=K.makeArray(t);L.arraycopy(this.bits,0,r,0,this.bits.length),this.bits=r}}get(t){return(this.bits[Math.floor(t/32)]&1<<(t&31))!==0}set(t){this.bits[Math.floor(t/32)]|=1<<(t&31)}flip(t){this.bits[Math.floor(t/32)]^=1<<(t&31)}getNextSet(t){const r=this.size;if(t>=r)return r;const c=this.bits;let h=Math.floor(t/32),g=c[h];g&=~((1<<(t&31))-1);const p=c.length;for(;g===0;){if(++h===p)return r;g=c[h]}const y=h*32+P.numberOfTrailingZeros(g);return y>r?r:y}getNextUnset(t){const r=this.size;if(t>=r)return r;const c=this.bits;let h=Math.floor(t/32),g=~c[h];g&=~((1<<(t&31))-1);const p=c.length;for(;g===0;){if(++h===p)return r;g=~c[h]}const y=h*32+P.numberOfTrailingZeros(g);return y>r?r:y}setBulk(t,r){this.bits[Math.floor(t/32)]=r}setRange(t,r){if(r<t||t<0||r>this.size)throw new N;if(r===t)return;r--;const c=Math.floor(t/32),h=Math.floor(r/32),g=this.bits;for(let p=c;p<=h;p++){const y=p>c?0:t&31,E=(2<<(p<h?31:r&31))-(1<<y);g[p]|=E}}clear(){const t=this.bits.length,r=this.bits;for(let c=0;c<t;c++)r[c]=0}isRange(t,r,c){if(r<t||t<0||r>this.size)throw new N;if(r===t)return!0;r--;const h=Math.floor(t/32),g=Math.floor(r/32),p=this.bits;for(let y=h;y<=g;y++){const _=y>h?0:t&31,j=(2<<(y<g?31:r&31))-(1<<_)&4294967295;if((p[y]&j)!==(c?j:0))return!1}return!0}appendBit(t){this.ensureCapacity(this.size+1),t&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(t,r){if(r<0||r>32)throw new N("Num bits must be between 0 and 32");this.ensureCapacity(this.size+r);for(let c=r;c>0;c--)this.appendBit((t>>c-1&1)===1)}appendBitArray(t){const r=t.size;this.ensureCapacity(this.size+r);for(let c=0;c<r;c++)this.appendBit(t.get(c))}xor(t){if(this.size!==t.size)throw new N("Sizes don't match");const r=this.bits;for(let c=0,h=r.length;c<h;c++)r[c]^=t.bits[c]}toBytes(t,r,c,h){for(let g=0;g<h;g++){let p=0;for(let y=0;y<8;y++)this.get(t)&&(p|=1<<7-y),t++;r[c+g]=p}}getBitArray(){return this.bits}reverse(){const t=new Int32Array(this.bits.length),r=Math.floor((this.size-1)/32),c=r+1,h=this.bits;for(let g=0;g<c;g++){let p=h[g];p=p>>1&1431655765|(p&1431655765)<<1,p=p>>2&858993459|(p&858993459)<<2,p=p>>4&252645135|(p&252645135)<<4,p=p>>8&16711935|(p&16711935)<<8,p=p>>16&65535|(p&65535)<<16,t[r-g]=p}if(this.size!==c*32){const g=c*32-this.size;let p=t[0]>>>g;for(let y=1;y<c;y++){const _=t[y];p|=_<<32-g,t[y-1]=p,p=_>>>g}t[c-1]=p}this.bits=t}static makeArray(t){return new Int32Array(Math.floor((t+31)/32))}equals(t){if(!(t instanceof K))return!1;const r=t;return this.size===r.size&&U.equals(this.bits,r.bits)}hashCode(){return 31*this.size+U.hashCode(this.bits)}toString(){let t="";for(let r=0,c=this.size;r<c;r++)(r&7)===0&&(t+=" "),t+=this.get(r)?"X":".";return t}clone(){return new K(this.size,this.bits.slice())}}var Z;(function(k){k[k.OTHER=0]="OTHER",k[k.PURE_BARCODE=1]="PURE_BARCODE",k[k.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",k[k.TRY_HARDER=3]="TRY_HARDER",k[k.CHARACTER_SET=4]="CHARACTER_SET",k[k.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",k[k.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",k[k.ASSUME_GS1=7]="ASSUME_GS1",k[k.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",k[k.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",k[k.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(Z||(Z={}));var W=Z;class X extends w{static getFormatInstance(){return new X}}X.kind="FormatException";var J;(function(k){k[k.Cp437=0]="Cp437",k[k.ISO8859_1=1]="ISO8859_1",k[k.ISO8859_2=2]="ISO8859_2",k[k.ISO8859_3=3]="ISO8859_3",k[k.ISO8859_4=4]="ISO8859_4",k[k.ISO8859_5=5]="ISO8859_5",k[k.ISO8859_6=6]="ISO8859_6",k[k.ISO8859_7=7]="ISO8859_7",k[k.ISO8859_8=8]="ISO8859_8",k[k.ISO8859_9=9]="ISO8859_9",k[k.ISO8859_10=10]="ISO8859_10",k[k.ISO8859_11=11]="ISO8859_11",k[k.ISO8859_13=12]="ISO8859_13",k[k.ISO8859_14=13]="ISO8859_14",k[k.ISO8859_15=14]="ISO8859_15",k[k.ISO8859_16=15]="ISO8859_16",k[k.SJIS=16]="SJIS",k[k.Cp1250=17]="Cp1250",k[k.Cp1251=18]="Cp1251",k[k.Cp1252=19]="Cp1252",k[k.Cp1256=20]="Cp1256",k[k.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",k[k.UTF8=22]="UTF8",k[k.ASCII=23]="ASCII",k[k.Big5=24]="Big5",k[k.GB18030=25]="GB18030",k[k.EUC_KR=26]="EUC_KR"})(J||(J={}));class q{constructor(t,r,c,...h){this.valueIdentifier=t,this.name=c,typeof r=="number"?this.values=Int32Array.from([r]):this.values=r,this.otherEncodingNames=h,q.VALUE_IDENTIFIER_TO_ECI.set(t,this),q.NAME_TO_ECI.set(c,this);const g=this.values;for(let p=0,y=g.length;p!==y;p++){const _=g[p];q.VALUES_TO_ECI.set(_,this)}for(const p of h)q.NAME_TO_ECI.set(p,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(t){if(t<0||t>=900)throw new X("incorect value");const r=q.VALUES_TO_ECI.get(t);if(r===void 0)throw new X("incorect value");return r}static getCharacterSetECIByName(t){const r=q.NAME_TO_ECI.get(t);if(r===void 0)throw new X("incorect value");return r}equals(t){if(!(t instanceof q))return!1;const r=t;return this.getName()===r.getName()}}q.VALUE_IDENTIFIER_TO_ECI=new Map,q.VALUES_TO_ECI=new Map,q.NAME_TO_ECI=new Map,q.Cp437=new q(J.Cp437,Int32Array.from([0,2]),"Cp437"),q.ISO8859_1=new q(J.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),q.ISO8859_2=new q(J.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),q.ISO8859_3=new q(J.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),q.ISO8859_4=new q(J.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),q.ISO8859_5=new q(J.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),q.ISO8859_6=new q(J.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),q.ISO8859_7=new q(J.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),q.ISO8859_8=new q(J.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),q.ISO8859_9=new q(J.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),q.ISO8859_10=new q(J.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),q.ISO8859_11=new q(J.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),q.ISO8859_13=new q(J.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),q.ISO8859_14=new q(J.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),q.ISO8859_15=new q(J.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),q.ISO8859_16=new q(J.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),q.SJIS=new q(J.SJIS,20,"SJIS","Shift_JIS"),q.Cp1250=new q(J.Cp1250,21,"Cp1250","windows-1250"),q.Cp1251=new q(J.Cp1251,22,"Cp1251","windows-1251"),q.Cp1252=new q(J.Cp1252,23,"Cp1252","windows-1252"),q.Cp1256=new q(J.Cp1256,24,"Cp1256","windows-1256"),q.UnicodeBigUnmarked=new q(J.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),q.UTF8=new q(J.UTF8,26,"UTF8","UTF-8"),q.ASCII=new q(J.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),q.Big5=new q(J.Big5,28,"Big5"),q.GB18030=new q(J.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),q.EUC_KR=new q(J.EUC_KR,30,"EUC_KR","EUC-KR");class he extends w{}he.kind="UnsupportedOperationException";class ge{static decode(t,r){const c=this.encodingName(r);return this.customDecoder?this.customDecoder(t,c):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(c)?this.decodeFallback(t,c):new TextDecoder(c).decode(t)}static shouldDecodeOnFallback(t){return!ge.isBrowser()&&t==="ISO-8859-1"}static encode(t,r){const c=this.encodingName(r);return this.customEncoder?this.customEncoder(t,c):typeof TextEncoder>"u"?this.encodeFallback(t):new TextEncoder().encode(t)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(t){return typeof t=="string"?t:t.getName()}static encodingCharacterSet(t){return t instanceof q?t:q.getCharacterSetECIByName(t)}static decodeFallback(t,r){const c=this.encodingCharacterSet(r);if(ge.isDecodeFallbackSupported(c)){let h="";for(let g=0,p=t.length;g<p;g++){let y=t[g].toString(16);y.length<2&&(y="0"+y),h+="%"+y}return decodeURIComponent(h)}if(c.equals(q.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(t.buffer));throw new he(`Encoding ${this.encodingName(r)} not supported by fallback.`)}static isDecodeFallbackSupported(t){return t.equals(q.UTF8)||t.equals(q.ISO8859_1)||t.equals(q.ASCII)}static encodeFallback(t){const c=btoa(unescape(encodeURIComponent(t))).split(""),h=[];for(let g=0;g<c.length;g++)h.push(c[g].charCodeAt(0));return new Uint8Array(h)}}class ie{static castAsNonUtf8Char(t,r=null){const c=r?r.getName():this.ISO88591;return ge.decode(new Uint8Array([t]),c)}static guessEncoding(t,r){if(r!=null&&r.get(W.CHARACTER_SET)!==void 0)return r.get(W.CHARACTER_SET).toString();const c=t.length;let h=!0,g=!0,p=!0,y=0,_=0,E=0,j=0,D=0,z=0,Q=0,te=0,se=0,le=0,pe=0;const Pe=t.length>3&&t[0]===239&&t[1]===187&&t[2]===191;for(let Be=0;Be<c&&(h||g||p);Be++){const Oe=t[Be]&255;p&&(y>0?(Oe&128)===0?p=!1:y--:(Oe&128)!==0&&((Oe&64)===0?p=!1:(y++,(Oe&32)===0?_++:(y++,(Oe&16)===0?E++:(y++,(Oe&8)===0?j++:p=!1))))),h&&(Oe>127&&Oe<160?h=!1:Oe>159&&(Oe<192||Oe===215||Oe===247)&&pe++),g&&(D>0?Oe<64||Oe===127||Oe>252?g=!1:D--:Oe===128||Oe===160||Oe>239?g=!1:Oe>160&&Oe<224?(z++,te=0,Q++,Q>se&&(se=Q)):Oe>127?(D++,Q=0,te++,te>le&&(le=te)):(Q=0,te=0))}return p&&y>0&&(p=!1),g&&D>0&&(g=!1),p&&(Pe||_+E+j>0)?ie.UTF8:g&&(ie.ASSUME_SHIFT_JIS||se>=3||le>=3)?ie.SHIFT_JIS:h&&g?se===2&&z===2||pe*10>=c?ie.SHIFT_JIS:ie.ISO88591:h?ie.ISO88591:g?ie.SHIFT_JIS:p?ie.UTF8:ie.PLATFORM_DEFAULT_ENCODING}static format(t,...r){let c=-1;function h(p,y,_,E,j,D){if(p==="%%")return"%";if(r[++c]===void 0)return;p=E?parseInt(E.substr(1)):void 0;let z=j?parseInt(j.substr(1)):void 0,Q;switch(D){case"s":Q=r[c];break;case"c":Q=r[c][0];break;case"f":Q=parseFloat(r[c]).toFixed(p);break;case"p":Q=parseFloat(r[c]).toPrecision(p);break;case"e":Q=parseFloat(r[c]).toExponential(p);break;case"x":Q=parseInt(r[c]).toString(z||16);break;case"d":Q=parseFloat(parseInt(r[c],z||10).toPrecision(p)).toFixed(0);break}Q=typeof Q=="object"?JSON.stringify(Q):(+Q).toString(z);let te=parseInt(_),se=_&&_[0]+""=="0"?"0":" ";for(;Q.length<te;)Q=y!==void 0?Q+se:se+Q;return Q}let g=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(g,h)}static getBytes(t,r){return ge.encode(t,r)}static getCharCode(t,r=0){return t.charCodeAt(r)}static getCharAt(t){return String.fromCharCode(t)}}ie.SHIFT_JIS=q.SJIS.getName(),ie.GB2312="GB2312",ie.ISO88591=q.ISO8859_1.getName(),ie.EUC_JP="EUC_JP",ie.UTF8=q.UTF8.getName(),ie.PLATFORM_DEFAULT_ENCODING=ie.UTF8,ie.ASSUME_SHIFT_JIS=!1;class be{constructor(t=""){this.value=t}enableDecoding(t){return this.encoding=t,this}append(t){return typeof t=="string"?this.value+=t.toString():this.encoding?this.value+=ie.castAsNonUtf8Char(t,this.encoding):this.value+=String.fromCharCode(t),this}appendChars(t,r,c){for(let h=r;r<r+c;h++)this.append(t[h]);return this}length(){return this.value.length}charAt(t){return this.value.charAt(t)}deleteCharAt(t){this.value=this.value.substr(0,t)+this.value.substring(t+1)}setCharAt(t,r){this.value=this.value.substr(0,t)+r+this.value.substr(t+1)}substring(t,r){return this.value.substring(t,r)}setLengthToZero(){this.value=""}toString(){return this.value}insert(t,r){this.value=this.value.substr(0,t)+r+this.value.substr(t+r.length)}}class Ie{constructor(t,r,c,h){if(this.width=t,this.height=r,this.rowSize=c,this.bits=h,r==null&&(r=t),this.height=r,t<1||r<1)throw new N("Both dimensions must be greater than 0");c==null&&(c=Math.floor((t+31)/32)),this.rowSize=c,h==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(t){const r=t.length,c=t[0].length,h=new Ie(c,r);for(let g=0;g<r;g++){const p=t[g];for(let y=0;y<c;y++)p[y]&&h.set(y,g)}return h}static parseFromString(t,r,c){if(t===null)throw new N("stringRepresentation cannot be null");const h=new Array(t.length);let g=0,p=0,y=-1,_=0,E=0;for(;E<t.length;)if(t.charAt(E)===`
`||t.charAt(E)==="\r"){if(g>p){if(y===-1)y=g-p;else if(g-p!==y)throw new N("row lengths do not match");p=g,_++}E++}else if(t.substring(E,E+r.length)===r)E+=r.length,h[g]=!0,g++;else if(t.substring(E,E+c.length)===c)E+=c.length,h[g]=!1,g++;else throw new N("illegal character encountered: "+t.substring(E));if(g>p){if(y===-1)y=g-p;else if(g-p!==y)throw new N("row lengths do not match");_++}const j=new Ie(y,_);for(let D=0;D<g;D++)h[D]&&j.set(Math.floor(D%y),Math.floor(D/y));return j}get(t,r){const c=r*this.rowSize+Math.floor(t/32);return(this.bits[c]>>>(t&31)&1)!==0}set(t,r){const c=r*this.rowSize+Math.floor(t/32);this.bits[c]|=1<<(t&31)&4294967295}unset(t,r){const c=r*this.rowSize+Math.floor(t/32);this.bits[c]&=~(1<<(t&31)&4294967295)}flip(t,r){const c=r*this.rowSize+Math.floor(t/32);this.bits[c]^=1<<(t&31)&4294967295}xor(t){if(this.width!==t.getWidth()||this.height!==t.getHeight()||this.rowSize!==t.getRowSize())throw new N("input matrix dimensions do not match");const r=new K(Math.floor(this.width/32)+1),c=this.rowSize,h=this.bits;for(let g=0,p=this.height;g<p;g++){const y=g*c,_=t.getRow(g,r).getBitArray();for(let E=0;E<c;E++)h[y+E]^=_[E]}}clear(){const t=this.bits,r=t.length;for(let c=0;c<r;c++)t[c]=0}setRegion(t,r,c,h){if(r<0||t<0)throw new N("Left and top must be nonnegative");if(h<1||c<1)throw new N("Height and width must be at least 1");const g=t+c,p=r+h;if(p>this.height||g>this.width)throw new N("The region must fit inside the matrix");const y=this.rowSize,_=this.bits;for(let E=r;E<p;E++){const j=E*y;for(let D=t;D<g;D++)_[j+Math.floor(D/32)]|=1<<(D&31)&4294967295}}getRow(t,r){r==null||r.getSize()<this.width?r=new K(this.width):r.clear();const c=this.rowSize,h=this.bits,g=t*c;for(let p=0;p<c;p++)r.setBulk(p*32,h[g+p]);return r}setRow(t,r){L.arraycopy(r.getBitArray(),0,this.bits,t*this.rowSize,this.rowSize)}rotate180(){const t=this.getWidth(),r=this.getHeight();let c=new K(t),h=new K(t);for(let g=0,p=Math.floor((r+1)/2);g<p;g++)c=this.getRow(g,c),h=this.getRow(r-1-g,h),c.reverse(),h.reverse(),this.setRow(g,h),this.setRow(r-1-g,c)}getEnclosingRectangle(){const t=this.width,r=this.height,c=this.rowSize,h=this.bits;let g=t,p=r,y=-1,_=-1;for(let E=0;E<r;E++)for(let j=0;j<c;j++){const D=h[E*c+j];if(D!==0){if(E<p&&(p=E),E>_&&(_=E),j*32<g){let z=0;for(;(D<<31-z&4294967295)===0;)z++;j*32+z<g&&(g=j*32+z)}if(j*32+31>y){let z=31;for(;!(D>>>z);)z--;j*32+z>y&&(y=j*32+z)}}}return y<g||_<p?null:Int32Array.from([g,p,y-g+1,_-p+1])}getTopLeftOnBit(){const t=this.rowSize,r=this.bits;let c=0;for(;c<r.length&&r[c]===0;)c++;if(c===r.length)return null;const h=c/t;let g=c%t*32;const p=r[c];let y=0;for(;(p<<31-y&4294967295)===0;)y++;return g+=y,Int32Array.from([g,h])}getBottomRightOnBit(){const t=this.rowSize,r=this.bits;let c=r.length-1;for(;c>=0&&r[c]===0;)c--;if(c<0)return null;const h=Math.floor(c/t);let g=Math.floor(c%t)*32;const p=r[c];let y=31;for(;!(p>>>y);)y--;return g+=y,Int32Array.from([g,h])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(t){if(!(t instanceof Ie))return!1;const r=t;return this.width===r.width&&this.height===r.height&&this.rowSize===r.rowSize&&U.equals(this.bits,r.bits)}hashCode(){let t=this.width;return t=31*t+this.width,t=31*t+this.height,t=31*t+this.rowSize,t=31*t+U.hashCode(this.bits),t}toString(t="X ",r="  ",c=`
`){return this.buildToString(t,r,c)}buildToString(t,r,c){let h=new be;for(let g=0,p=this.height;g<p;g++){for(let y=0,_=this.width;y<_;y++)h.append(this.get(y,g)?t:r);h.append(c)}return h.toString()}clone(){return new Ie(this.width,this.height,this.rowSize,this.bits.slice())}}class V extends w{static getNotFoundInstance(){return new V}}V.kind="NotFoundException";class $ extends O{constructor(t){super(t),this.luminances=$.EMPTY,this.buckets=new Int32Array($.LUMINANCE_BUCKETS)}getBlackRow(t,r){const c=this.getLuminanceSource(),h=c.getWidth();r==null||r.getSize()<h?r=new K(h):r.clear(),this.initArrays(h);const g=c.getRow(t,this.luminances),p=this.buckets;for(let _=0;_<h;_++)p[(g[_]&255)>>$.LUMINANCE_SHIFT]++;const y=$.estimateBlackPoint(p);if(h<3)for(let _=0;_<h;_++)(g[_]&255)<y&&r.set(_);else{let _=g[0]&255,E=g[1]&255;for(let j=1;j<h-1;j++){const D=g[j+1]&255;(E*4-_-D)/2<y&&r.set(j),_=E,E=D}}return r}getBlackMatrix(){const t=this.getLuminanceSource(),r=t.getWidth(),c=t.getHeight(),h=new Ie(r,c);this.initArrays(r);const g=this.buckets;for(let _=1;_<5;_++){const E=Math.floor(c*_/5),j=t.getRow(E,this.luminances),D=Math.floor(r*4/5);for(let z=Math.floor(r/5);z<D;z++){const Q=j[z]&255;g[Q>>$.LUMINANCE_SHIFT]++}}const p=$.estimateBlackPoint(g),y=t.getMatrix();for(let _=0;_<c;_++){const E=_*r;for(let j=0;j<r;j++)(y[E+j]&255)<p&&h.set(j,_)}return h}createBinarizer(t){return new $(t)}initArrays(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));const r=this.buckets;for(let c=0;c<$.LUMINANCE_BUCKETS;c++)r[c]=0}static estimateBlackPoint(t){const r=t.length;let c=0,h=0,g=0;for(let j=0;j<r;j++)t[j]>g&&(h=j,g=t[j]),t[j]>c&&(c=t[j]);let p=0,y=0;for(let j=0;j<r;j++){const D=j-h,z=t[j]*D*D;z>y&&(p=j,y=z)}if(h>p){const j=h;h=p,p=j}if(p-h<=r/16)throw new V;let _=p-1,E=-1;for(let j=p-1;j>h;j--){const D=j-h,z=D*D*(p-j)*(c-t[j]);z>E&&(_=j,E=z)}return _<<$.LUMINANCE_SHIFT}}$.LUMINANCE_BITS=5,$.LUMINANCE_SHIFT=8-$.LUMINANCE_BITS,$.LUMINANCE_BUCKETS=1<<$.LUMINANCE_BITS,$.EMPTY=Uint8ClampedArray.from([0]);class oe extends ${constructor(t){super(t),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const t=this.getLuminanceSource(),r=t.getWidth(),c=t.getHeight();if(r>=oe.MINIMUM_DIMENSION&&c>=oe.MINIMUM_DIMENSION){const h=t.getMatrix();let g=r>>oe.BLOCK_SIZE_POWER;(r&oe.BLOCK_SIZE_MASK)!==0&&g++;let p=c>>oe.BLOCK_SIZE_POWER;(c&oe.BLOCK_SIZE_MASK)!==0&&p++;const y=oe.calculateBlackPoints(h,g,p,r,c),_=new Ie(r,c);oe.calculateThresholdForBlock(h,g,p,r,c,y,_),this.matrix=_}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(t){return new oe(t)}static calculateThresholdForBlock(t,r,c,h,g,p,y){const _=g-oe.BLOCK_SIZE,E=h-oe.BLOCK_SIZE;for(let j=0;j<c;j++){let D=j<<oe.BLOCK_SIZE_POWER;D>_&&(D=_);const z=oe.cap(j,2,c-3);for(let Q=0;Q<r;Q++){let te=Q<<oe.BLOCK_SIZE_POWER;te>E&&(te=E);const se=oe.cap(Q,2,r-3);let le=0;for(let Pe=-2;Pe<=2;Pe++){const Be=p[z+Pe];le+=Be[se-2]+Be[se-1]+Be[se]+Be[se+1]+Be[se+2]}const pe=le/25;oe.thresholdBlock(t,te,D,pe,h,y)}}}static cap(t,r,c){return t<r?r:t>c?c:t}static thresholdBlock(t,r,c,h,g,p){for(let y=0,_=c*g+r;y<oe.BLOCK_SIZE;y++,_+=g)for(let E=0;E<oe.BLOCK_SIZE;E++)(t[_+E]&255)<=h&&p.set(r+E,c+y)}static calculateBlackPoints(t,r,c,h,g){const p=g-oe.BLOCK_SIZE,y=h-oe.BLOCK_SIZE,_=new Array(c);for(let E=0;E<c;E++){_[E]=new Int32Array(r);let j=E<<oe.BLOCK_SIZE_POWER;j>p&&(j=p);for(let D=0;D<r;D++){let z=D<<oe.BLOCK_SIZE_POWER;z>y&&(z=y);let Q=0,te=255,se=0;for(let pe=0,Pe=j*h+z;pe<oe.BLOCK_SIZE;pe++,Pe+=h){for(let Be=0;Be<oe.BLOCK_SIZE;Be++){const Oe=t[Pe+Be]&255;Q+=Oe,Oe<te&&(te=Oe),Oe>se&&(se=Oe)}if(se-te>oe.MIN_DYNAMIC_RANGE)for(pe++,Pe+=h;pe<oe.BLOCK_SIZE;pe++,Pe+=h)for(let Be=0;Be<oe.BLOCK_SIZE;Be++)Q+=t[Pe+Be]&255}let le=Q>>oe.BLOCK_SIZE_POWER*2;if(se-te<=oe.MIN_DYNAMIC_RANGE&&(le=te/2,E>0&&D>0)){const pe=(_[E-1][D]+2*_[E][D-1]+_[E-1][D-1])/4;te<pe&&(le=pe)}_[E][D]=le}}return _}}oe.BLOCK_SIZE_POWER=3,oe.BLOCK_SIZE=1<<oe.BLOCK_SIZE_POWER,oe.BLOCK_SIZE_MASK=oe.BLOCK_SIZE-1,oe.MINIMUM_DIMENSION=oe.BLOCK_SIZE*5,oe.MIN_DYNAMIC_RANGE=24;class ke{constructor(t,r){this.width=t,this.height=r}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(t,r,c,h){throw new he("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new he("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new he("This luminance source does not support rotation by 45 degrees.")}toString(){const t=new Uint8ClampedArray(this.width);let r=new be;for(let c=0;c<this.height;c++){const h=this.getRow(c,t);for(let g=0;g<this.width;g++){const p=h[g]&255;let y;p<64?y="#":p<128?y="+":p<192?y=".":y=" ",r.append(y)}r.append(`
`)}return r.toString()}}class Ge extends ke{constructor(t){super(t.getWidth(),t.getHeight()),this.delegate=t}getRow(t,r){const c=this.delegate.getRow(t,r),h=this.getWidth();for(let g=0;g<h;g++)c[g]=255-(c[g]&255);return c}getMatrix(){const t=this.delegate.getMatrix(),r=this.getWidth()*this.getHeight(),c=new Uint8ClampedArray(r);for(let h=0;h<r;h++)c[h]=255-(t[h]&255);return c}isCropSupported(){return this.delegate.isCropSupported()}crop(t,r,c,h){return new Ge(this.delegate.crop(t,r,c,h))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new Ge(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new Ge(this.delegate.rotateCounterClockwise45())}}class Ke extends ke{constructor(t){super(t.width,t.height),this.canvas=t,this.tempCanvasElement=null,this.buffer=Ke.makeBufferFromCanvasImageData(t)}static makeBufferFromCanvasImageData(t){const r=t.getContext("2d").getImageData(0,0,t.width,t.height);return Ke.toGrayscaleBuffer(r.data,t.width,t.height)}static toGrayscaleBuffer(t,r,c){const h=new Uint8ClampedArray(r*c);for(let g=0,p=0,y=t.length;g<y;g+=4,p++){let _;if(t[g+3]===0)_=255;else{const j=t[g],D=t[g+1],z=t[g+2];_=306*j+601*D+117*z+512>>10}h[p]=_}return h}getRow(t,r){if(t<0||t>=this.getHeight())throw new N("Requested row is outside the image: "+t);const c=this.getWidth(),h=t*c;return r===null?r=this.buffer.slice(h,h+c):(r.length<c&&(r=new Uint8ClampedArray(c)),r.set(this.buffer.slice(h,h+c))),r}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(t,r,c,h){return super.crop(t,r,c,h),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const t=this.canvas.ownerDocument.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,this.tempCanvasElement=t}return this.tempCanvasElement}rotate(t){const r=this.getTempCanvasElement(),c=r.getContext("2d"),h=t*Ke.DEGREE_TO_RADIANS,g=this.canvas.width,p=this.canvas.height,y=Math.ceil(Math.abs(Math.cos(h))*g+Math.abs(Math.sin(h))*p),_=Math.ceil(Math.abs(Math.sin(h))*g+Math.abs(Math.cos(h))*p);return r.width=y,r.height=_,c.translate(y/2,_/2),c.rotate(h),c.drawImage(this.canvas,g/-2,p/-2),this.buffer=Ke.makeBufferFromCanvasImageData(r),this}invert(){return new Ge(this)}}Ke.DEGREE_TO_RADIANS=Math.PI/180;class ne{constructor(t,r,c){this.deviceId=t,this.label=r,this.kind="videoinput",this.groupId=c||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var ye=(globalThis||Cu||self||window||void 0)&&(globalThis||Cu||self||window||void 0).__awaiter||function(k,t,r,c){function h(g){return g instanceof r?g:new r(function(p){p(g)})}return new(r||(r=Promise))(function(g,p){function y(j){try{E(c.next(j))}catch(D){p(D)}}function _(j){try{E(c.throw(j))}catch(D){p(D)}}function E(j){j.done?g(j.value):h(j.value).then(y,_)}E((c=c.apply(k,t||[])).next())})};class Le{constructor(t,r=500,c){this.reader=t,this.timeBetweenScansMillis=r,this._hints=c,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(t){this._timeBetweenDecodingAttempts=t<0?0:t}set hints(t){this._hints=t||null}get hints(){return this._hints}listVideoInputDevices(){return ye(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const t=yield navigator.mediaDevices.enumerateDevices(),r=[];for(const c of t){const h=c.kind==="video"?"videoinput":c.kind;if(h!=="videoinput")continue;const g=c.deviceId||c.id,p=c.label||`Video device ${r.length+1}`,y=c.groupId,_={deviceId:g,label:p,kind:h,groupId:y};r.push(_)}return r})}getVideoInputDevices(){return ye(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(r=>new ne(r.deviceId,r.label))})}findDeviceById(t){return ye(this,void 0,void 0,function*(){const r=yield this.listVideoInputDevices();return r?r.find(c=>c.deviceId===t):null})}decodeFromInputVideoDevice(t,r){return ye(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(t,r)})}decodeOnceFromVideoDevice(t,r){return ye(this,void 0,void 0,function*(){this.reset();let c;t?c={deviceId:{exact:t}}:c={facingMode:"environment"};const h={video:c};return yield this.decodeOnceFromConstraints(h,r)})}decodeOnceFromConstraints(t,r){return ye(this,void 0,void 0,function*(){const c=yield navigator.mediaDevices.getUserMedia(t);return yield this.decodeOnceFromStream(c,r)})}decodeOnceFromStream(t,r){return ye(this,void 0,void 0,function*(){this.reset();const c=yield this.attachStreamToVideo(t,r);return yield this.decodeOnce(c)})}decodeFromInputVideoDeviceContinuously(t,r,c){return ye(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(t,r,c)})}decodeFromVideoDevice(t,r,c){return ye(this,void 0,void 0,function*(){let h;t?h={deviceId:{exact:t}}:h={facingMode:"environment"};const g={video:h};return yield this.decodeFromConstraints(g,r,c)})}decodeFromConstraints(t,r,c){return ye(this,void 0,void 0,function*(){const h=yield navigator.mediaDevices.getUserMedia(t);return yield this.decodeFromStream(h,r,c)})}decodeFromStream(t,r,c){return ye(this,void 0,void 0,function*(){this.reset();const h=yield this.attachStreamToVideo(t,r);return yield this.decodeContinuously(h,c)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(t,r){return ye(this,void 0,void 0,function*(){const c=this.prepareVideoElement(r);return this.addVideoSource(c,t),this.videoElement=c,this.stream=t,yield this.playVideoOnLoadAsync(c),c})}playVideoOnLoadAsync(t){return new Promise((r,c)=>this.playVideoOnLoad(t,()=>r()))}playVideoOnLoad(t,r){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(t),t.addEventListener("ended",this.videoEndedListener),t.addEventListener("canplay",this.videoCanPlayListener),t.addEventListener("playing",r),this.tryPlayVideo(t)}isVideoPlaying(t){return t.currentTime>0&&!t.paused&&!t.ended&&t.readyState>2}tryPlayVideo(t){return ye(this,void 0,void 0,function*(){if(this.isVideoPlaying(t)){console.warn("Trying to play video that is already playing.");return}try{yield t.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(t,r){const c=document.getElementById(t);if(!c)throw new A(`element with id '${t}' not found`);if(c.nodeName.toLowerCase()!==r.toLowerCase())throw new A(`element with id '${t}' must be an ${r} element`);return c}decodeFromImage(t,r){if(!t&&!r)throw new A("either imageElement with a src set or an url must be provided");return r&&!t?this.decodeFromImageUrl(r):this.decodeFromImageElement(t)}decodeFromVideo(t,r){if(!t&&!r)throw new A("Either an element with a src set or an URL must be provided");return r&&!t?this.decodeFromVideoUrl(r):this.decodeFromVideoElement(t)}decodeFromVideoContinuously(t,r,c){if(t===void 0&&r===void 0)throw new A("Either an element with a src set or an URL must be provided");return r&&!t?this.decodeFromVideoUrlContinuously(r,c):this.decodeFromVideoElementContinuously(t,c)}decodeFromImageElement(t){if(!t)throw new A("An image element must be provided.");this.reset();const r=this.prepareImageElement(t);this.imageElement=r;let c;return this.isImageLoaded(r)?c=this.decodeOnce(r,!1,!0):c=this._decodeOnLoadImage(r),c}decodeFromVideoElement(t){const r=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideo(r)}decodeFromVideoElementContinuously(t,r){const c=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideoContinuously(c,r)}_decodeFromVideoElementSetup(t){if(!t)throw new A("A video element must be provided.");this.reset();const r=this.prepareVideoElement(t);return this.videoElement=r,r}decodeFromImageUrl(t){if(!t)throw new A("An URL must be provided.");this.reset();const r=this.prepareImageElement();this.imageElement=r;const c=this._decodeOnLoadImage(r);return r.src=t,c}decodeFromVideoUrl(t){if(!t)throw new A("An URL must be provided.");this.reset();const r=this.prepareVideoElement(),c=this.decodeFromVideoElement(r);return r.src=t,c}decodeFromVideoUrlContinuously(t,r){if(!t)throw new A("An URL must be provided.");this.reset();const c=this.prepareVideoElement(),h=this.decodeFromVideoElementContinuously(c,r);return c.src=t,h}_decodeOnLoadImage(t){return new Promise((r,c)=>{this.imageLoadedListener=()=>this.decodeOnce(t,!1,!0).then(r,c),t.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(t){return ye(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(t),yield this.decodeOnce(t)})}_decodeOnLoadVideoContinuously(t,r){return ye(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(t),this.decodeContinuously(t,r)})}isImageLoaded(t){return!(!t.complete||t.naturalWidth===0)}prepareImageElement(t){let r;return typeof t>"u"&&(r=document.createElement("img"),r.width=200,r.height=200),typeof t=="string"&&(r=this.getMediaElement(t,"img")),t instanceof HTMLImageElement&&(r=t),r}prepareVideoElement(t){let r;return!t&&typeof document<"u"&&(r=document.createElement("video"),r.width=200,r.height=200),typeof t=="string"&&(r=this.getMediaElement(t,"video")),t instanceof HTMLVideoElement&&(r=t),r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r}decodeOnce(t,r=!0,c=!0){this._stopAsyncDecode=!1;const h=(g,p)=>{if(this._stopAsyncDecode){p(new V("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const y=this.decode(t);g(y)}catch(y){const _=r&&y instanceof V,j=(y instanceof T||y instanceof X)&&c;if(_||j)return setTimeout(h,this._timeBetweenDecodingAttempts,g,p);p(y)}};return new Promise((g,p)=>h(g,p))}decodeContinuously(t,r){this._stopContinuousDecode=!1;const c=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const h=this.decode(t);r(h,null),setTimeout(c,this.timeBetweenScansMillis)}catch(h){r(null,h);const g=h instanceof T||h instanceof X,p=h instanceof V;(g||p)&&setTimeout(c,this._timeBetweenDecodingAttempts)}};c()}decode(t){const r=this.createBinaryBitmap(t);return this.decodeBitmap(r)}_isHTMLVideoElement(t){return t.videoWidth!==0}drawFrameOnCanvas(t,r,c){r||(r={sx:0,sy:0,sWidth:t.videoWidth,sHeight:t.videoHeight,dx:0,dy:0,dWidth:t.videoWidth,dHeight:t.videoHeight}),c||(c=this.captureCanvasContext),c.drawImage(t,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)}drawImageOnCanvas(t,r,c=this.captureCanvasContext){r||(r={sx:0,sy:0,sWidth:t.naturalWidth,sHeight:t.naturalHeight,dx:0,dy:0,dWidth:t.naturalWidth,dHeight:t.naturalHeight}),c||(c=this.captureCanvasContext),c.drawImage(t,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)}createBinaryBitmap(t){this.getCaptureCanvasContext(t),this._isHTMLVideoElement(t)?this.drawFrameOnCanvas(t):this.drawImageOnCanvas(t);const r=this.getCaptureCanvas(t),c=new Ke(r),h=new oe(c);return new R(h)}getCaptureCanvasContext(t){if(!this.captureCanvasContext){const c=this.getCaptureCanvas(t).getContext("2d");this.captureCanvasContext=c}return this.captureCanvasContext}getCaptureCanvas(t){if(!this.captureCanvas){const r=this.createCaptureCanvas(t);this.captureCanvas=r}return this.captureCanvas}decodeBitmap(t){return this.reader.decode(t,this._hints)}createCaptureCanvas(t){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const r=document.createElement("canvas");let c,h;return typeof t<"u"&&(t instanceof HTMLVideoElement?(c=t.videoWidth,h=t.videoHeight):t instanceof HTMLImageElement&&(c=t.naturalWidth||t.width,h=t.naturalHeight||t.height)),r.style.width=c+"px",r.style.height=h+"px",r.width=c,r.height=h,r}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(t=>t.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(t,r){try{t.srcObject=r}catch{t.src=URL.createObjectURL(r)}}cleanVideoSource(t){try{t.srcObject=null}catch{t.src=""}this.videoElement.removeAttribute("src")}}class Ue{constructor(t,r,c=r==null?0:8*r.length,h,g,p=L.currentTimeMillis()){this.text=t,this.rawBytes=r,this.numBits=c,this.resultPoints=h,this.format=g,this.timestamp=p,this.text=t,this.rawBytes=r,c==null?this.numBits=r==null?0:8*r.length:this.numBits=c,this.resultPoints=h,this.format=g,this.resultMetadata=null,p==null?this.timestamp=L.currentTimeMillis():this.timestamp=p}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(t,r){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(t,r)}putAllMetadata(t){t!==null&&(this.resultMetadata===null?this.resultMetadata=t:this.resultMetadata=new Map(t))}addResultPoints(t){const r=this.resultPoints;if(r===null)this.resultPoints=t;else if(t!==null&&t.length>0){const c=new Array(r.length+t.length);L.arraycopy(r,0,c,0,r.length),L.arraycopy(t,0,c,r.length,t.length),this.resultPoints=c}}getTimestamp(){return this.timestamp}toString(){return this.text}}var We;(function(k){k[k.AZTEC=0]="AZTEC",k[k.CODABAR=1]="CODABAR",k[k.CODE_39=2]="CODE_39",k[k.CODE_93=3]="CODE_93",k[k.CODE_128=4]="CODE_128",k[k.DATA_MATRIX=5]="DATA_MATRIX",k[k.EAN_8=6]="EAN_8",k[k.EAN_13=7]="EAN_13",k[k.ITF=8]="ITF",k[k.MAXICODE=9]="MAXICODE",k[k.PDF_417=10]="PDF_417",k[k.QR_CODE=11]="QR_CODE",k[k.RSS_14=12]="RSS_14",k[k.RSS_EXPANDED=13]="RSS_EXPANDED",k[k.UPC_A=14]="UPC_A",k[k.UPC_E=15]="UPC_E",k[k.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(We||(We={}));var Ne=We,$e;(function(k){k[k.OTHER=0]="OTHER",k[k.ORIENTATION=1]="ORIENTATION",k[k.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",k[k.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",k[k.ISSUE_NUMBER=4]="ISSUE_NUMBER",k[k.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",k[k.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",k[k.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",k[k.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",k[k.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",k[k.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})($e||($e={}));var De=$e;class Ce{constructor(t,r,c,h,g=-1,p=-1){this.rawBytes=t,this.text=r,this.byteSegments=c,this.ecLevel=h,this.structuredAppendSequenceNumber=g,this.structuredAppendParity=p,this.numBits=t==null?0:8*t.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(t){this.numBits=t}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(t){this.errorsCorrected=t}getErasures(){return this.erasures}setErasures(t){this.erasures=t}getOther(){return this.other}setOther(t){this.other=t}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Je{exp(t){return this.expTable[t]}log(t){if(t===0)throw new N;return this.logTable[t]}static addOrSubtract(t,r){return t^r}}class mt{constructor(t,r){if(r.length===0)throw new N;this.field=t;const c=r.length;if(c>1&&r[0]===0){let h=1;for(;h<c&&r[h]===0;)h++;h===c?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(c-h),L.arraycopy(r,h,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(t){return this.coefficients[this.coefficients.length-1-t]}evaluateAt(t){if(t===0)return this.getCoefficient(0);const r=this.coefficients;let c;if(t===1){c=0;for(let p=0,y=r.length;p!==y;p++){const _=r[p];c=Je.addOrSubtract(c,_)}return c}c=r[0];const h=r.length,g=this.field;for(let p=1;p<h;p++)c=Je.addOrSubtract(g.multiply(t,c),r[p]);return c}addOrSubtract(t){if(!this.field.equals(t.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero())return t;if(t.isZero())return this;let r=this.coefficients,c=t.coefficients;if(r.length>c.length){const p=r;r=c,c=p}let h=new Int32Array(c.length);const g=c.length-r.length;L.arraycopy(c,0,h,0,g);for(let p=g;p<c.length;p++)h[p]=Je.addOrSubtract(r[p-g],c[p]);return new mt(this.field,h)}multiply(t){if(!this.field.equals(t.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero()||t.isZero())return this.field.getZero();const r=this.coefficients,c=r.length,h=t.coefficients,g=h.length,p=new Int32Array(c+g-1),y=this.field;for(let _=0;_<c;_++){const E=r[_];for(let j=0;j<g;j++)p[_+j]=Je.addOrSubtract(p[_+j],y.multiply(E,h[j]))}return new mt(y,p)}multiplyScalar(t){if(t===0)return this.field.getZero();if(t===1)return this;const r=this.coefficients.length,c=this.field,h=new Int32Array(r),g=this.coefficients;for(let p=0;p<r;p++)h[p]=c.multiply(g[p],t);return new mt(c,h)}multiplyByMonomial(t,r){if(t<0)throw new N;if(r===0)return this.field.getZero();const c=this.coefficients,h=c.length,g=new Int32Array(h+t),p=this.field;for(let y=0;y<h;y++)g[y]=p.multiply(c[y],r);return new mt(p,g)}divide(t){if(!this.field.equals(t.field))throw new N("GenericGFPolys do not have same GenericGF field");if(t.isZero())throw new N("Divide by 0");const r=this.field;let c=r.getZero(),h=this;const g=t.getCoefficient(t.getDegree()),p=r.inverse(g);for(;h.getDegree()>=t.getDegree()&&!h.isZero();){const y=h.getDegree()-t.getDegree(),_=r.multiply(h.getCoefficient(h.getDegree()),p),E=t.multiplyByMonomial(y,_),j=r.buildMonomial(y,_);c=c.addOrSubtract(j),h=h.addOrSubtract(E)}return[c,h]}toString(){let t="";for(let r=this.getDegree();r>=0;r--){let c=this.getCoefficient(r);if(c!==0){if(c<0?(t+=" - ",c=-c):t.length>0&&(t+=" + "),r===0||c!==1){const h=this.field.log(c);h===0?t+="1":h===1?t+="a":(t+="a^",t+=h)}r!==0&&(r===1?t+="x":(t+="x^",t+=r))}}return t}}class Wt extends w{}Wt.kind="ArithmeticException";class ft extends Je{constructor(t,r,c){super(),this.primitive=t,this.size=r,this.generatorBase=c;const h=new Int32Array(r);let g=1;for(let y=0;y<r;y++)h[y]=g,g*=2,g>=r&&(g^=t,g&=r-1);this.expTable=h;const p=new Int32Array(r);for(let y=0;y<r-1;y++)p[h[y]]=y;this.logTable=p,this.zero=new mt(this,Int32Array.from([0])),this.one=new mt(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(t,r){if(t<0)throw new N;if(r===0)return this.zero;const c=new Int32Array(t+1);return c[0]=r,new mt(this,c)}inverse(t){if(t===0)throw new Wt;return this.expTable[this.size-this.logTable[t]-1]}multiply(t,r){return t===0||r===0?0:this.expTable[(this.logTable[t]+this.logTable[r])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+P.toHexString(this.primitive)+","+this.size+")"}equals(t){return t===this}}ft.AZTEC_DATA_12=new ft(4201,4096,1),ft.AZTEC_DATA_10=new ft(1033,1024,1),ft.AZTEC_DATA_6=new ft(67,64,1),ft.AZTEC_PARAM=new ft(19,16,1),ft.QR_CODE_FIELD_256=new ft(285,256,0),ft.DATA_MATRIX_FIELD_256=new ft(301,256,1),ft.AZTEC_DATA_8=ft.DATA_MATRIX_FIELD_256,ft.MAXICODE_FIELD_64=ft.AZTEC_DATA_6;class Mt extends w{}Mt.kind="ReedSolomonException";class xn extends w{}xn.kind="IllegalStateException";class cn{constructor(t){this.field=t}decode(t,r){const c=this.field,h=new mt(c,t),g=new Int32Array(r);let p=!0;for(let Q=0;Q<r;Q++){const te=h.evaluateAt(c.exp(Q+c.getGeneratorBase()));g[g.length-1-Q]=te,te!==0&&(p=!1)}if(p)return;const y=new mt(c,g),_=this.runEuclideanAlgorithm(c.buildMonomial(r,1),y,r),E=_[0],j=_[1],D=this.findErrorLocations(E),z=this.findErrorMagnitudes(j,D);for(let Q=0;Q<D.length;Q++){const te=t.length-1-c.log(D[Q]);if(te<0)throw new Mt("Bad error location");t[te]=ft.addOrSubtract(t[te],z[Q])}}runEuclideanAlgorithm(t,r,c){if(t.getDegree()<r.getDegree()){const Q=t;t=r,r=Q}const h=this.field;let g=t,p=r,y=h.getZero(),_=h.getOne();for(;p.getDegree()>=(c/2|0);){let Q=g,te=y;if(g=p,y=_,g.isZero())throw new Mt("r_{i-1} was zero");p=Q;let se=h.getZero();const le=g.getCoefficient(g.getDegree()),pe=h.inverse(le);for(;p.getDegree()>=g.getDegree()&&!p.isZero();){const Pe=p.getDegree()-g.getDegree(),Be=h.multiply(p.getCoefficient(p.getDegree()),pe);se=se.addOrSubtract(h.buildMonomial(Pe,Be)),p=p.addOrSubtract(g.multiplyByMonomial(Pe,Be))}if(_=se.multiply(y).addOrSubtract(te),p.getDegree()>=g.getDegree())throw new xn("Division algorithm failed to reduce polynomial?")}const E=_.getCoefficient(0);if(E===0)throw new Mt("sigmaTilde(0) was zero");const j=h.inverse(E),D=_.multiplyScalar(j),z=p.multiplyScalar(j);return[D,z]}findErrorLocations(t){const r=t.getDegree();if(r===1)return Int32Array.from([t.getCoefficient(1)]);const c=new Int32Array(r);let h=0;const g=this.field;for(let p=1;p<g.getSize()&&h<r;p++)t.evaluateAt(p)===0&&(c[h]=g.inverse(p),h++);if(h!==r)throw new Mt("Error locator degree does not match number of roots");return c}findErrorMagnitudes(t,r){const c=r.length,h=new Int32Array(c),g=this.field;for(let p=0;p<c;p++){const y=g.inverse(r[p]);let _=1;for(let E=0;E<c;E++)if(p!==E){const j=g.multiply(r[E],y),D=(j&1)===0?j|1:j&-2;_=g.multiply(_,D)}h[p]=g.multiply(t.evaluateAt(y),g.inverse(_)),g.getGeneratorBase()!==0&&(h[p]=g.multiply(h[p],y))}return h}}var qt;(function(k){k[k.UPPER=0]="UPPER",k[k.LOWER=1]="LOWER",k[k.MIXED=2]="MIXED",k[k.DIGIT=3]="DIGIT",k[k.PUNCT=4]="PUNCT",k[k.BINARY=5]="BINARY"})(qt||(qt={}));class Nt{decode(t){this.ddata=t;let r=t.getBits(),c=this.extractBits(r),h=this.correctBits(c),g=Nt.convertBoolArrayToByteArray(h),p=Nt.getEncodedData(h),y=new Ce(g,p,null,null);return y.setNumBits(h.length),y}static highLevelDecode(t){return this.getEncodedData(t)}static getEncodedData(t){let r=t.length,c=qt.UPPER,h=qt.UPPER,g="",p=0;for(;p<r;)if(h===qt.BINARY){if(r-p<5)break;let y=Nt.readCode(t,p,5);if(p+=5,y===0){if(r-p<11)break;y=Nt.readCode(t,p,11)+31,p+=11}for(let _=0;_<y;_++){if(r-p<8){p=r;break}const E=Nt.readCode(t,p,8);g+=ie.castAsNonUtf8Char(E),p+=8}h=c}else{let y=h===qt.DIGIT?4:5;if(r-p<y)break;let _=Nt.readCode(t,p,y);p+=y;let E=Nt.getCharacter(h,_);E.startsWith("CTRL_")?(c=h,h=Nt.getTable(E.charAt(5)),E.charAt(6)==="L"&&(c=h)):(g+=E,h=c)}return g}static getTable(t){switch(t){case"L":return qt.LOWER;case"P":return qt.PUNCT;case"M":return qt.MIXED;case"D":return qt.DIGIT;case"B":return qt.BINARY;case"U":default:return qt.UPPER}}static getCharacter(t,r){switch(t){case qt.UPPER:return Nt.UPPER_TABLE[r];case qt.LOWER:return Nt.LOWER_TABLE[r];case qt.MIXED:return Nt.MIXED_TABLE[r];case qt.PUNCT:return Nt.PUNCT_TABLE[r];case qt.DIGIT:return Nt.DIGIT_TABLE[r];default:throw new xn("Bad table")}}correctBits(t){let r,c;this.ddata.getNbLayers()<=2?(c=6,r=ft.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(c=8,r=ft.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(c=10,r=ft.AZTEC_DATA_10):(c=12,r=ft.AZTEC_DATA_12);let h=this.ddata.getNbDatablocks(),g=t.length/c;if(g<h)throw new X;let p=t.length%c,y=new Int32Array(g);for(let z=0;z<g;z++,p+=c)y[z]=Nt.readCode(t,p,c);try{new cn(r).decode(y,g-h)}catch(z){throw new X(z)}let _=(1<<c)-1,E=0;for(let z=0;z<h;z++){let Q=y[z];if(Q===0||Q===_)throw new X;(Q===1||Q===_-1)&&E++}let j=new Array(h*c-E),D=0;for(let z=0;z<h;z++){let Q=y[z];if(Q===1||Q===_-1)j.fill(Q>1,D,D+c-1),D+=c-1;else for(let te=c-1;te>=0;--te)j[D++]=(Q&1<<te)!==0}return j}extractBits(t){let r=this.ddata.isCompact(),c=this.ddata.getNbLayers(),h=(r?11:14)+c*4,g=new Int32Array(h),p=new Array(this.totalBitsInLayer(c,r));if(r)for(let y=0;y<g.length;y++)g[y]=y;else{let y=h+1+2*P.truncDivision(P.truncDivision(h,2)-1,15),_=h/2,E=P.truncDivision(y,2);for(let j=0;j<_;j++){let D=j+P.truncDivision(j,15);g[_-j-1]=E-D-1,g[_+j]=E+D+1}}for(let y=0,_=0;y<c;y++){let E=(c-y)*4+(r?9:12),j=y*2,D=h-1-j;for(let z=0;z<E;z++){let Q=z*2;for(let te=0;te<2;te++)p[_+Q+te]=t.get(g[j+te],g[j+z]),p[_+2*E+Q+te]=t.get(g[j+z],g[D-te]),p[_+4*E+Q+te]=t.get(g[D-te],g[D-z]),p[_+6*E+Q+te]=t.get(g[D-z],g[j+te])}_+=E*8}return p}static readCode(t,r,c){let h=0;for(let g=r;g<r+c;g++)h<<=1,t[g]&&(h|=1);return h}static readByte(t,r){let c=t.length-r;return c>=8?Nt.readCode(t,r,8):Nt.readCode(t,r,c)<<8-c}static convertBoolArrayToByteArray(t){let r=new Uint8Array((t.length+7)/8);for(let c=0;c<r.length;c++)r[c]=Nt.readByte(t,8*c);return r}totalBitsInLayer(t,r){return((r?88:112)+16*t)*t}}Nt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Nt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Nt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Nt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Nt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class ht{constructor(){}static round(t){return t===NaN?0:t<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:t>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:t+(t<0?-.5:.5)|0}static distance(t,r,c,h){const g=t-c,p=r-h;return Math.sqrt(g*g+p*p)}static sum(t){let r=0;for(let c=0,h=t.length;c!==h;c++){const g=t[c];r+=g}return r}}class Hn{static floatToIntBits(t){return t}}Hn.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ze{constructor(t,r){this.x=t,this.y=r}getX(){return this.x}getY(){return this.y}equals(t){if(t instanceof ze){const r=t;return this.x===r.x&&this.y===r.y}return!1}hashCode(){return 31*Hn.floatToIntBits(this.x)+Hn.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(t){const r=this.distance(t[0],t[1]),c=this.distance(t[1],t[2]),h=this.distance(t[0],t[2]);let g,p,y;if(c>=r&&c>=h?(p=t[0],g=t[1],y=t[2]):h>=c&&h>=r?(p=t[1],g=t[0],y=t[2]):(p=t[2],g=t[0],y=t[1]),this.crossProductZ(g,p,y)<0){const _=g;g=y,y=_}t[0]=g,t[1]=p,t[2]=y}static distance(t,r){return ht.distance(t.x,t.y,r.x,r.y)}static crossProductZ(t,r,c){const h=r.x,g=r.y;return(c.x-h)*(t.y-g)-(c.y-g)*(t.x-h)}}class Is{constructor(t,r){this.bits=t,this.points=r}getBits(){return this.bits}getPoints(){return this.points}}class Me extends Is{constructor(t,r,c,h,g){super(t,r),this.compact=c,this.nbDatablocks=h,this.nbLayers=g}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Fe{constructor(t,r,c,h){this.image=t,this.height=t.getHeight(),this.width=t.getWidth(),r==null&&(r=Fe.INIT_SIZE),c==null&&(c=t.getWidth()/2|0),h==null&&(h=t.getHeight()/2|0);const g=r/2|0;if(this.leftInit=c-g,this.rightInit=c+g,this.upInit=h-g,this.downInit=h+g,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new V}detect(){let t=this.leftInit,r=this.rightInit,c=this.upInit,h=this.downInit,g=!1,p=!0,y=!1,_=!1,E=!1,j=!1,D=!1;const z=this.width,Q=this.height;for(;p;){p=!1;let te=!0;for(;(te||!_)&&r<z;)te=this.containsBlackPoint(c,h,r,!1),te?(r++,p=!0,_=!0):_||r++;if(r>=z){g=!0;break}let se=!0;for(;(se||!E)&&h<Q;)se=this.containsBlackPoint(t,r,h,!0),se?(h++,p=!0,E=!0):E||h++;if(h>=Q){g=!0;break}let le=!0;for(;(le||!j)&&t>=0;)le=this.containsBlackPoint(c,h,t,!1),le?(t--,p=!0,j=!0):j||t--;if(t<0){g=!0;break}let pe=!0;for(;(pe||!D)&&c>=0;)pe=this.containsBlackPoint(t,r,c,!0),pe?(c--,p=!0,D=!0):D||c--;if(c<0){g=!0;break}p&&(y=!0)}if(!g&&y){const te=r-t;let se=null;for(let Be=1;se===null&&Be<te;Be++)se=this.getBlackPointOnSegment(t,h-Be,t+Be,h);if(se==null)throw new V;let le=null;for(let Be=1;le===null&&Be<te;Be++)le=this.getBlackPointOnSegment(t,c+Be,t+Be,c);if(le==null)throw new V;let pe=null;for(let Be=1;pe===null&&Be<te;Be++)pe=this.getBlackPointOnSegment(r,c+Be,r-Be,c);if(pe==null)throw new V;let Pe=null;for(let Be=1;Pe===null&&Be<te;Be++)Pe=this.getBlackPointOnSegment(r,h-Be,r-Be,h);if(Pe==null)throw new V;return this.centerEdges(Pe,se,pe,le)}else throw new V}getBlackPointOnSegment(t,r,c,h){const g=ht.round(ht.distance(t,r,c,h)),p=(c-t)/g,y=(h-r)/g,_=this.image;for(let E=0;E<g;E++){const j=ht.round(t+E*p),D=ht.round(r+E*y);if(_.get(j,D))return new ze(j,D)}return null}centerEdges(t,r,c,h){const g=t.getX(),p=t.getY(),y=r.getX(),_=r.getY(),E=c.getX(),j=c.getY(),D=h.getX(),z=h.getY(),Q=Fe.CORR;return g<this.width/2?[new ze(D-Q,z+Q),new ze(y+Q,_+Q),new ze(E-Q,j-Q),new ze(g+Q,p-Q)]:[new ze(D+Q,z+Q),new ze(y+Q,_-Q),new ze(E-Q,j+Q),new ze(g-Q,p-Q)]}containsBlackPoint(t,r,c,h){const g=this.image;if(h){for(let p=t;p<=r;p++)if(g.get(p,c))return!0}else for(let p=t;p<=r;p++)if(g.get(c,p))return!0;return!1}}Fe.INIT_SIZE=10,Fe.CORR=1;class nt{static checkAndNudgePoints(t,r){const c=t.getWidth(),h=t.getHeight();let g=!0;for(let p=0;p<r.length&&g;p+=2){const y=Math.floor(r[p]),_=Math.floor(r[p+1]);if(y<-1||y>c||_<-1||_>h)throw new V;g=!1,y===-1?(r[p]=0,g=!0):y===c&&(r[p]=c-1,g=!0),_===-1?(r[p+1]=0,g=!0):_===h&&(r[p+1]=h-1,g=!0)}g=!0;for(let p=r.length-2;p>=0&&g;p-=2){const y=Math.floor(r[p]),_=Math.floor(r[p+1]);if(y<-1||y>c||_<-1||_>h)throw new V;g=!1,y===-1?(r[p]=0,g=!0):y===c&&(r[p]=c-1,g=!0),_===-1?(r[p+1]=0,g=!0):_===h&&(r[p+1]=h-1,g=!0)}}}class _t{constructor(t,r,c,h,g,p,y,_,E){this.a11=t,this.a21=r,this.a31=c,this.a12=h,this.a22=g,this.a32=p,this.a13=y,this.a23=_,this.a33=E}static quadrilateralToQuadrilateral(t,r,c,h,g,p,y,_,E,j,D,z,Q,te,se,le){const pe=_t.quadrilateralToSquare(t,r,c,h,g,p,y,_);return _t.squareToQuadrilateral(E,j,D,z,Q,te,se,le).times(pe)}transformPoints(t){const r=t.length,c=this.a11,h=this.a12,g=this.a13,p=this.a21,y=this.a22,_=this.a23,E=this.a31,j=this.a32,D=this.a33;for(let z=0;z<r;z+=2){const Q=t[z],te=t[z+1],se=g*Q+_*te+D;t[z]=(c*Q+p*te+E)/se,t[z+1]=(h*Q+y*te+j)/se}}transformPointsWithValues(t,r){const c=this.a11,h=this.a12,g=this.a13,p=this.a21,y=this.a22,_=this.a23,E=this.a31,j=this.a32,D=this.a33,z=t.length;for(let Q=0;Q<z;Q++){const te=t[Q],se=r[Q],le=g*te+_*se+D;t[Q]=(c*te+p*se+E)/le,r[Q]=(h*te+y*se+j)/le}}static squareToQuadrilateral(t,r,c,h,g,p,y,_){const E=t-c+g-y,j=r-h+p-_;if(E===0&&j===0)return new _t(c-t,g-c,t,h-r,p-h,r,0,0,1);{const D=c-g,z=y-g,Q=h-p,te=_-p,se=D*te-z*Q,le=(E*te-z*j)/se,pe=(D*j-E*Q)/se;return new _t(c-t+le*c,y-t+pe*y,t,h-r+le*h,_-r+pe*_,r,le,pe,1)}}static quadrilateralToSquare(t,r,c,h,g,p,y,_){return _t.squareToQuadrilateral(t,r,c,h,g,p,y,_).buildAdjoint()}buildAdjoint(){return new _t(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(t){return new _t(this.a11*t.a11+this.a21*t.a12+this.a31*t.a13,this.a11*t.a21+this.a21*t.a22+this.a31*t.a23,this.a11*t.a31+this.a21*t.a32+this.a31*t.a33,this.a12*t.a11+this.a22*t.a12+this.a32*t.a13,this.a12*t.a21+this.a22*t.a22+this.a32*t.a23,this.a12*t.a31+this.a22*t.a32+this.a32*t.a33,this.a13*t.a11+this.a23*t.a12+this.a33*t.a13,this.a13*t.a21+this.a23*t.a22+this.a33*t.a23,this.a13*t.a31+this.a23*t.a32+this.a33*t.a33)}}class Tn extends nt{sampleGrid(t,r,c,h,g,p,y,_,E,j,D,z,Q,te,se,le,pe,Pe,Be){const Oe=_t.quadrilateralToQuadrilateral(h,g,p,y,_,E,j,D,z,Q,te,se,le,pe,Pe,Be);return this.sampleGridWithTransform(t,r,c,Oe)}sampleGridWithTransform(t,r,c,h){if(r<=0||c<=0)throw new V;const g=new Ie(r,c),p=new Float32Array(2*r);for(let y=0;y<c;y++){const _=p.length,E=y+.5;for(let j=0;j<_;j+=2)p[j]=j/2+.5,p[j+1]=E;h.transformPoints(p),nt.checkAndNudgePoints(t,p);try{for(let j=0;j<_;j+=2)t.get(Math.floor(p[j]),Math.floor(p[j+1]))&&g.set(j/2,y)}catch{throw new V}}return g}}class sn{static setGridSampler(t){sn.gridSampler=t}static getInstance(){return sn.gridSampler}}sn.gridSampler=new Tn;class Vt{constructor(t,r){this.x=t,this.y=r}toResultPoint(){return new ze(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class qn{constructor(t){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=t}detect(){return this.detectMirror(!1)}detectMirror(t){let r=this.getMatrixCenter(),c=this.getBullsEyeCorners(r);if(t){let p=c[0];c[0]=c[2],c[2]=p}this.extractParameters(c);let h=this.sampleGrid(this.image,c[this.shift%4],c[(this.shift+1)%4],c[(this.shift+2)%4],c[(this.shift+3)%4]),g=this.getMatrixCornerPoints(c);return new Me(h,g,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(t){if(!this.isValidPoint(t[0])||!this.isValidPoint(t[1])||!this.isValidPoint(t[2])||!this.isValidPoint(t[3]))throw new V;let r=2*this.nbCenterLayers,c=new Int32Array([this.sampleLine(t[0],t[1],r),this.sampleLine(t[1],t[2],r),this.sampleLine(t[2],t[3],r),this.sampleLine(t[3],t[0],r)]);this.shift=this.getRotation(c,r);let h=0;for(let p=0;p<4;p++){let y=c[(this.shift+p)%4];this.compact?(h<<=7,h+=y>>1&127):(h<<=10,h+=(y>>2&992)+(y>>1&31))}let g=this.getCorrectedParameterData(h,this.compact);this.compact?(this.nbLayers=(g>>6)+1,this.nbDataBlocks=(g&63)+1):(this.nbLayers=(g>>11)+1,this.nbDataBlocks=(g&2047)+1)}getRotation(t,r){let c=0;t.forEach((h,g,p)=>{let y=(h>>r-2<<1)+(h&1);c=(c<<3)+y}),c=((c&1)<<11)+(c>>1);for(let h=0;h<4;h++)if(P.bitCount(c^this.EXPECTED_CORNER_BITS[h])<=2)return h;throw new V}getCorrectedParameterData(t,r){let c,h;r?(c=7,h=2):(c=10,h=4);let g=c-h,p=new Int32Array(c);for(let _=c-1;_>=0;--_)p[_]=t&15,t>>=4;try{new cn(ft.AZTEC_PARAM).decode(p,g)}catch{throw new V}let y=0;for(let _=0;_<h;_++)y=(y<<4)+p[_];return y}getBullsEyeCorners(t){let r=t,c=t,h=t,g=t,p=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let D=this.getFirstDifferent(r,p,1,-1),z=this.getFirstDifferent(c,p,1,1),Q=this.getFirstDifferent(h,p,-1,1),te=this.getFirstDifferent(g,p,-1,-1);if(this.nbCenterLayers>2){let se=this.distancePoint(te,D)*this.nbCenterLayers/(this.distancePoint(g,r)*(this.nbCenterLayers+2));if(se<.75||se>1.25||!this.isWhiteOrBlackRectangle(D,z,Q,te))break}r=D,c=z,h=Q,g=te,p=!p}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new V;this.compact=this.nbCenterLayers===5;let y=new ze(r.getX()+.5,r.getY()-.5),_=new ze(c.getX()+.5,c.getY()+.5),E=new ze(h.getX()-.5,h.getY()+.5),j=new ze(g.getX()-.5,g.getY()-.5);return this.expandSquare([y,_,E,j],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let t,r,c,h;try{let y=new Fe(this.image).detect();t=y[0],r=y[1],c=y[2],h=y[3]}catch{let _=this.image.getWidth()/2,E=this.image.getHeight()/2;t=this.getFirstDifferent(new Vt(_+7,E-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new Vt(_+7,E+7),!1,1,1).toResultPoint(),c=this.getFirstDifferent(new Vt(_-7,E+7),!1,-1,1).toResultPoint(),h=this.getFirstDifferent(new Vt(_-7,E-7),!1,-1,-1).toResultPoint()}let g=ht.round((t.getX()+h.getX()+r.getX()+c.getX())/4),p=ht.round((t.getY()+h.getY()+r.getY()+c.getY())/4);try{let y=new Fe(this.image,15,g,p).detect();t=y[0],r=y[1],c=y[2],h=y[3]}catch{t=this.getFirstDifferent(new Vt(g+7,p-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new Vt(g+7,p+7),!1,1,1).toResultPoint(),c=this.getFirstDifferent(new Vt(g-7,p+7),!1,-1,1).toResultPoint(),h=this.getFirstDifferent(new Vt(g-7,p-7),!1,-1,-1).toResultPoint()}return g=ht.round((t.getX()+h.getX()+r.getX()+c.getX())/4),p=ht.round((t.getY()+h.getY()+r.getY()+c.getY())/4),new Vt(g,p)}getMatrixCornerPoints(t){return this.expandSquare(t,2*this.nbCenterLayers,this.getDimension())}sampleGrid(t,r,c,h,g){let p=sn.getInstance(),y=this.getDimension(),_=y/2-this.nbCenterLayers,E=y/2+this.nbCenterLayers;return p.sampleGrid(t,y,y,_,_,E,_,E,E,_,E,r.getX(),r.getY(),c.getX(),c.getY(),h.getX(),h.getY(),g.getX(),g.getY())}sampleLine(t,r,c){let h=0,g=this.distanceResultPoint(t,r),p=g/c,y=t.getX(),_=t.getY(),E=p*(r.getX()-t.getX())/g,j=p*(r.getY()-t.getY())/g;for(let D=0;D<c;D++)this.image.get(ht.round(y+D*E),ht.round(_+D*j))&&(h|=1<<c-D-1);return h}isWhiteOrBlackRectangle(t,r,c,h){let g=3;t=new Vt(t.getX()-g,t.getY()+g),r=new Vt(r.getX()-g,r.getY()-g),c=new Vt(c.getX()+g,c.getY()-g),h=new Vt(h.getX()+g,h.getY()+g);let p=this.getColor(h,t);if(p===0)return!1;let y=this.getColor(t,r);return y!==p||(y=this.getColor(r,c),y!==p)?!1:(y=this.getColor(c,h),y===p)}getColor(t,r){let c=this.distancePoint(t,r),h=(r.getX()-t.getX())/c,g=(r.getY()-t.getY())/c,p=0,y=t.getX(),_=t.getY(),E=this.image.get(t.getX(),t.getY()),j=Math.ceil(c);for(let z=0;z<j;z++)y+=h,_+=g,this.image.get(ht.round(y),ht.round(_))!==E&&p++;let D=p/c;return D>.1&&D<.9?0:D<=.1===E?1:-1}getFirstDifferent(t,r,c,h){let g=t.getX()+c,p=t.getY()+h;for(;this.isValid(g,p)&&this.image.get(g,p)===r;)g+=c,p+=h;for(g-=c,p-=h;this.isValid(g,p)&&this.image.get(g,p)===r;)g+=c;for(g-=c;this.isValid(g,p)&&this.image.get(g,p)===r;)p+=h;return p-=h,new Vt(g,p)}expandSquare(t,r,c){let h=c/(2*r),g=t[0].getX()-t[2].getX(),p=t[0].getY()-t[2].getY(),y=(t[0].getX()+t[2].getX())/2,_=(t[0].getY()+t[2].getY())/2,E=new ze(y+h*g,_+h*p),j=new ze(y-h*g,_-h*p);g=t[1].getX()-t[3].getX(),p=t[1].getY()-t[3].getY(),y=(t[1].getX()+t[3].getX())/2,_=(t[1].getY()+t[3].getY())/2;let D=new ze(y+h*g,_+h*p),z=new ze(y-h*g,_-h*p);return[E,D,j,z]}isValid(t,r){return t>=0&&t<this.image.getWidth()&&r>0&&r<this.image.getHeight()}isValidPoint(t){let r=ht.round(t.getX()),c=ht.round(t.getY());return this.isValid(r,c)}distancePoint(t,r){return ht.distance(t.getX(),t.getY(),r.getX(),r.getY())}distanceResultPoint(t,r){return ht.distance(t.getX(),t.getY(),r.getX(),r.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(P.truncDivision(this.nbLayers-4,8)+1)+15}}class jn{decode(t,r=null){let c=null,h=new qn(t.getBlackMatrix()),g=null,p=null;try{let j=h.detectMirror(!1);g=j.getPoints(),this.reportFoundResultPoints(r,g),p=new Nt().decode(j)}catch(j){c=j}if(p==null)try{let j=h.detectMirror(!0);g=j.getPoints(),this.reportFoundResultPoints(r,g),p=new Nt().decode(j)}catch(j){throw c??j}let y=new Ue(p.getText(),p.getRawBytes(),p.getNumBits(),g,Ne.AZTEC,L.currentTimeMillis()),_=p.getByteSegments();_!=null&&y.putMetadata(De.BYTE_SEGMENTS,_);let E=p.getECLevel();return E!=null&&y.putMetadata(De.ERROR_CORRECTION_LEVEL,E),y}reportFoundResultPoints(t,r){if(t!=null){let c=t.get(W.NEED_RESULT_POINT_CALLBACK);c!=null&&r.forEach((h,g,p)=>{c.foundPossibleResultPoint(h)})}}reset(){}}class ts extends Le{constructor(t=500){super(new jn,t)}}class Ut{decode(t,r){try{return this.doDecode(t,r)}catch{if(r&&r.get(W.TRY_HARDER)===!0&&t.isRotateSupported()){const g=t.rotateCounterClockwise(),p=this.doDecode(g,r),y=p.getResultMetadata();let _=270;y!==null&&y.get(De.ORIENTATION)===!0&&(_=_+y.get(De.ORIENTATION)%360),p.putMetadata(De.ORIENTATION,_);const E=p.getResultPoints();if(E!==null){const j=g.getHeight();for(let D=0;D<E.length;D++)E[D]=new ze(j-E[D].getY()-1,E[D].getX())}return p}else throw new V}}reset(){}doDecode(t,r){const c=t.getWidth(),h=t.getHeight();let g=new K(c);const p=r&&r.get(W.TRY_HARDER)===!0,y=Math.max(1,h>>(p?8:5));let _;p?_=h:_=15;const E=Math.trunc(h/2);for(let j=0;j<_;j++){const D=Math.trunc((j+1)/2),z=(j&1)===0,Q=E+y*(z?D:-D);if(Q<0||Q>=h)break;try{g=t.getBlackRow(Q,g)}catch{continue}for(let te=0;te<2;te++){if(te===1&&(g.reverse(),r&&r.get(W.NEED_RESULT_POINT_CALLBACK)===!0)){const se=new Map;r.forEach((le,pe)=>se.set(pe,le)),se.delete(W.NEED_RESULT_POINT_CALLBACK),r=se}try{const se=this.decodeRow(Q,g,r);if(te===1){se.putMetadata(De.ORIENTATION,180);const le=se.getResultPoints();le!==null&&(le[0]=new ze(c-le[0].getX()-1,le[0].getY()),le[1]=new ze(c-le[1].getX()-1,le[1].getY()))}return se}catch{}}}throw new V}static recordPattern(t,r,c){const h=c.length;for(let E=0;E<h;E++)c[E]=0;const g=t.getSize();if(r>=g)throw new V;let p=!t.get(r),y=0,_=r;for(;_<g;){if(t.get(_)!==p)c[y]++;else{if(++y===h)break;c[y]=1,p=!p}_++}if(!(y===h||y===h-1&&_===g))throw new V}static recordPatternInReverse(t,r,c){let h=c.length,g=t.get(r);for(;r>0&&h>=0;)t.get(--r)!==g&&(h--,g=!g);if(h>=0)throw new V;Ut.recordPattern(t,r+1,c)}static patternMatchVariance(t,r,c){const h=t.length;let g=0,p=0;for(let E=0;E<h;E++)g+=t[E],p+=r[E];if(g<p)return Number.POSITIVE_INFINITY;const y=g/p;c*=y;let _=0;for(let E=0;E<h;E++){const j=t[E],D=r[E]*y,z=j>D?j-D:D-j;if(z>c)return Number.POSITIVE_INFINITY;_+=z}return _/g}}class je extends Ut{static findStartPattern(t){const r=t.getSize(),c=t.getNextSet(0);let h=0,g=Int32Array.from([0,0,0,0,0,0]),p=c,y=!1;const _=6;for(let E=c;E<r;E++)if(t.get(E)!==y)g[h]++;else{if(h===_-1){let j=je.MAX_AVG_VARIANCE,D=-1;for(let z=je.CODE_START_A;z<=je.CODE_START_C;z++){const Q=Ut.patternMatchVariance(g,je.CODE_PATTERNS[z],je.MAX_INDIVIDUAL_VARIANCE);Q<j&&(j=Q,D=z)}if(D>=0&&t.isRange(Math.max(0,p-(E-p)/2),p,!1))return Int32Array.from([p,E,D]);p+=g[0]+g[1],g=g.slice(2,g.length-1),g[h-1]=0,g[h]=0,h--}else h++;g[h]=1,y=!y}throw new V}static decodeCode(t,r,c){Ut.recordPattern(t,c,r);let h=je.MAX_AVG_VARIANCE,g=-1;for(let p=0;p<je.CODE_PATTERNS.length;p++){const y=je.CODE_PATTERNS[p],_=this.patternMatchVariance(r,y,je.MAX_INDIVIDUAL_VARIANCE);_<h&&(h=_,g=p)}if(g>=0)return g;throw new V}decodeRow(t,r,c){const h=c&&c.get(W.ASSUME_GS1)===!0,g=je.findStartPattern(r),p=g[2];let y=0;const _=new Uint8Array(20);_[y++]=p;let E;switch(p){case je.CODE_START_A:E=je.CODE_CODE_A;break;case je.CODE_START_B:E=je.CODE_CODE_B;break;case je.CODE_START_C:E=je.CODE_CODE_C;break;default:throw new X}let j=!1,D=!1,z="",Q=g[0],te=g[1];const se=Int32Array.from([0,0,0,0,0,0]);let le=0,pe=0,Pe=p,Be=0,Oe=!0,At=!1,yt=!1;for(;!j;){const er=D;switch(D=!1,le=pe,pe=je.decodeCode(r,se,te),_[y++]=pe,pe!==je.CODE_STOP&&(Oe=!0),pe!==je.CODE_STOP&&(Be++,Pe+=Be*pe),Q=te,te+=se.reduce((wc,cl)=>wc+cl,0),pe){case je.CODE_START_A:case je.CODE_START_B:case je.CODE_START_C:throw new X}switch(E){case je.CODE_CODE_A:if(pe<64)yt===At?z+=String.fromCharCode(32+pe):z+=String.fromCharCode(32+pe+128),yt=!1;else if(pe<96)yt===At?z+=String.fromCharCode(pe-64):z+=String.fromCharCode(pe+64),yt=!1;else switch(pe!==je.CODE_STOP&&(Oe=!1),pe){case je.CODE_FNC_1:h&&(z.length===0?z+="]C1":z+="");break;case je.CODE_FNC_2:case je.CODE_FNC_3:break;case je.CODE_FNC_4_A:!At&&yt?(At=!0,yt=!1):At&&yt?(At=!1,yt=!1):yt=!0;break;case je.CODE_SHIFT:D=!0,E=je.CODE_CODE_B;break;case je.CODE_CODE_B:E=je.CODE_CODE_B;break;case je.CODE_CODE_C:E=je.CODE_CODE_C;break;case je.CODE_STOP:j=!0;break}break;case je.CODE_CODE_B:if(pe<96)yt===At?z+=String.fromCharCode(32+pe):z+=String.fromCharCode(32+pe+128),yt=!1;else switch(pe!==je.CODE_STOP&&(Oe=!1),pe){case je.CODE_FNC_1:h&&(z.length===0?z+="]C1":z+="");break;case je.CODE_FNC_2:case je.CODE_FNC_3:break;case je.CODE_FNC_4_B:!At&&yt?(At=!0,yt=!1):At&&yt?(At=!1,yt=!1):yt=!0;break;case je.CODE_SHIFT:D=!0,E=je.CODE_CODE_A;break;case je.CODE_CODE_A:E=je.CODE_CODE_A;break;case je.CODE_CODE_C:E=je.CODE_CODE_C;break;case je.CODE_STOP:j=!0;break}break;case je.CODE_CODE_C:if(pe<100)pe<10&&(z+="0"),z+=pe;else switch(pe!==je.CODE_STOP&&(Oe=!1),pe){case je.CODE_FNC_1:h&&(z.length===0?z+="]C1":z+="");break;case je.CODE_CODE_A:E=je.CODE_CODE_A;break;case je.CODE_CODE_B:E=je.CODE_CODE_B;break;case je.CODE_STOP:j=!0;break}break}er&&(E=E===je.CODE_CODE_A?je.CODE_CODE_B:je.CODE_CODE_A)}const Un=te-Q;if(te=r.getNextUnset(te),!r.isRange(te,Math.min(r.getSize(),te+(te-Q)/2),!1))throw new V;if(Pe-=Be*le,Pe%103!==le)throw new T;const Ls=z.length;if(Ls===0)throw new V;Ls>0&&Oe&&(E===je.CODE_CODE_C?z=z.substring(0,Ls-2):z=z.substring(0,Ls-1));const ms=(g[1]+g[0])/2,nn=Q+Un/2,rs=_.length,Ns=new Uint8Array(rs);for(let er=0;er<rs;er++)Ns[er]=_[er];const Dr=[new ze(ms,t),new ze(nn,t)];return new Ue(z,Ns,0,Dr,Ne.CODE_128,new Date().getTime())}}je.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],je.MAX_AVG_VARIANCE=.25,je.MAX_INDIVIDUAL_VARIANCE=.7,je.CODE_SHIFT=98,je.CODE_CODE_C=99,je.CODE_CODE_B=100,je.CODE_CODE_A=101,je.CODE_FNC_1=102,je.CODE_FNC_2=97,je.CODE_FNC_3=96,je.CODE_FNC_4_A=101,je.CODE_FNC_4_B=100,je.CODE_START_A=103,je.CODE_START_B=104,je.CODE_START_C=105,je.CODE_STOP=106;class lt extends Ut{constructor(t=!1,r=!1){super(),this.usingCheckDigit=t,this.extendedMode=r,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(t,r,c){let h=this.counters;h.fill(0),this.decodeRowResult="";let g=lt.findAsteriskPattern(r,h),p=r.getNextSet(g[1]),y=r.getSize(),_,E;do{lt.recordPattern(r,p,h);let se=lt.toNarrowWidePattern(h);if(se<0)throw new V;_=lt.patternToChar(se),this.decodeRowResult+=_,E=p;for(let le of h)p+=le;p=r.getNextSet(p)}while(_!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let j=0;for(let se of h)j+=se;let D=p-E-j;if(p!==y&&D*2<j)throw new V;if(this.usingCheckDigit){let se=this.decodeRowResult.length-1,le=0;for(let pe=0;pe<se;pe++)le+=lt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(pe));if(this.decodeRowResult.charAt(se)!==lt.ALPHABET_STRING.charAt(le%43))throw new T;this.decodeRowResult=this.decodeRowResult.substring(0,se)}if(this.decodeRowResult.length===0)throw new V;let z;this.extendedMode?z=lt.decodeExtended(this.decodeRowResult):z=this.decodeRowResult;let Q=(g[1]+g[0])/2,te=E+j/2;return new Ue(z,null,0,[new ze(Q,t),new ze(te,t)],Ne.CODE_39,new Date().getTime())}static findAsteriskPattern(t,r){let c=t.getSize(),h=t.getNextSet(0),g=0,p=h,y=!1,_=r.length;for(let E=h;E<c;E++)if(t.get(E)!==y)r[g]++;else{if(g===_-1){if(this.toNarrowWidePattern(r)===lt.ASTERISK_ENCODING&&t.isRange(Math.max(0,p-Math.floor((E-p)/2)),p,!1))return[p,E];p+=r[0]+r[1],r.copyWithin(0,2,2+g-1),r[g-1]=0,r[g]=0,g--}else g++;r[g]=1,y=!y}throw new V}static toNarrowWidePattern(t){let r=t.length,c=0,h;do{let g=2147483647;for(let _ of t)_<g&&_>c&&(g=_);c=g,h=0;let p=0,y=0;for(let _=0;_<r;_++){let E=t[_];E>c&&(y|=1<<r-1-_,h++,p+=E)}if(h===3){for(let _=0;_<r&&h>0;_++){let E=t[_];if(E>c&&(h--,E*2>=p))return-1}return y}}while(h>3);return-1}static patternToChar(t){for(let r=0;r<lt.CHARACTER_ENCODINGS.length;r++)if(lt.CHARACTER_ENCODINGS[r]===t)return lt.ALPHABET_STRING.charAt(r);if(t===lt.ASTERISK_ENCODING)return"*";throw new V}static decodeExtended(t){let r=t.length,c="";for(let h=0;h<r;h++){let g=t.charAt(h);if(g==="+"||g==="$"||g==="%"||g==="/"){let p=t.charAt(h+1),y="\0";switch(g){case"+":if(p>="A"&&p<="Z")y=String.fromCharCode(p.charCodeAt(0)+32);else throw new X;break;case"$":if(p>="A"&&p<="Z")y=String.fromCharCode(p.charCodeAt(0)-64);else throw new X;break;case"%":if(p>="A"&&p<="E")y=String.fromCharCode(p.charCodeAt(0)-38);else if(p>="F"&&p<="J")y=String.fromCharCode(p.charCodeAt(0)-11);else if(p>="K"&&p<="O")y=String.fromCharCode(p.charCodeAt(0)+16);else if(p>="P"&&p<="T")y=String.fromCharCode(p.charCodeAt(0)+43);else if(p==="U")y="\0";else if(p==="V")y="@";else if(p==="W")y="`";else if(p==="X"||p==="Y"||p==="Z")y="";else throw new X;break;case"/":if(p>="A"&&p<="O")y=String.fromCharCode(p.charCodeAt(0)-32);else if(p==="Z")y=":";else throw new X;break}c+=y,h++}else c+=g}return c}}lt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",lt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],lt.ASTERISK_ENCODING=148;class gt extends Ut{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(t,r,c){let h=this.decodeStart(r),g=this.decodeEnd(r),p=new be;gt.decodeMiddle(r,h[1],g[0],p);let y=p.toString(),_=null;c!=null&&(_=c.get(W.ALLOWED_LENGTHS)),_==null&&(_=gt.DEFAULT_ALLOWED_LENGTHS);let E=y.length,j=!1,D=0;for(let te of _){if(E===te){j=!0;break}te>D&&(D=te)}if(!j&&E>D&&(j=!0),!j)throw new X;const z=[new ze(h[1],t),new ze(g[0],t)];return new Ue(y,null,0,z,Ne.ITF,new Date().getTime())}static decodeMiddle(t,r,c,h){let g=new Int32Array(10),p=new Int32Array(5),y=new Int32Array(5);for(g.fill(0),p.fill(0),y.fill(0);r<c;){Ut.recordPattern(t,r,g);for(let E=0;E<5;E++){let j=2*E;p[E]=g[j],y[E]=g[j+1]}let _=gt.decodeDigit(p);h.append(_.toString()),_=this.decodeDigit(y),h.append(_.toString()),g.forEach(function(E){r+=E})}}decodeStart(t){let r=gt.skipWhiteSpace(t),c=gt.findGuardPattern(t,r,gt.START_PATTERN);return this.narrowLineWidth=(c[1]-c[0])/4,this.validateQuietZone(t,c[0]),c}validateQuietZone(t,r){let c=this.narrowLineWidth*10;c=c<r?c:r;for(let h=r-1;c>0&&h>=0&&!t.get(h);h--)c--;if(c!==0)throw new V}static skipWhiteSpace(t){const r=t.getSize(),c=t.getNextSet(0);if(c===r)throw new V;return c}decodeEnd(t){t.reverse();try{let r=gt.skipWhiteSpace(t),c;try{c=gt.findGuardPattern(t,r,gt.END_PATTERN_REVERSED[0])}catch(g){g instanceof V&&(c=gt.findGuardPattern(t,r,gt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(t,c[0]);let h=c[0];return c[0]=t.getSize()-c[1],c[1]=t.getSize()-h,c}finally{t.reverse()}}static findGuardPattern(t,r,c){let h=c.length,g=new Int32Array(h),p=t.getSize(),y=!1,_=0,E=r;g.fill(0);for(let j=r;j<p;j++)if(t.get(j)!==y)g[_]++;else{if(_===h-1){if(Ut.patternMatchVariance(g,c,gt.MAX_INDIVIDUAL_VARIANCE)<gt.MAX_AVG_VARIANCE)return[E,j];E+=g[0]+g[1],L.arraycopy(g,2,g,0,_-1),g[_-1]=0,g[_]=0,_--}else _++;g[_]=1,y=!y}throw new V}static decodeDigit(t){let r=gt.MAX_AVG_VARIANCE,c=-1,h=gt.PATTERNS.length;for(let g=0;g<h;g++){let p=gt.PATTERNS[g],y=Ut.patternMatchVariance(t,p,gt.MAX_INDIVIDUAL_VARIANCE);y<r?(r=y,c=g):y===r&&(c=-1)}if(c>=0)return c%10;throw new V}}gt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],gt.MAX_AVG_VARIANCE=.38,gt.MAX_INDIVIDUAL_VARIANCE=.5,gt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],gt.START_PATTERN=Int32Array.from([1,1,1,1]),gt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Qt extends Ut{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(t){let r=!1,c,h=0,g=Int32Array.from([0,0,0]);for(;!r;){g=Int32Array.from([0,0,0]),c=Qt.findGuardPattern(t,h,!1,this.START_END_PATTERN,g);let p=c[0];h=c[1];let y=p-(h-p);y>=0&&(r=t.isRange(y,p,!1))}return c}static checkChecksum(t){return Qt.checkStandardUPCEANChecksum(t)}static checkStandardUPCEANChecksum(t){let r=t.length;if(r===0)return!1;let c=parseInt(t.charAt(r-1),10);return Qt.getStandardUPCEANChecksum(t.substring(0,r-1))===c}static getStandardUPCEANChecksum(t){let r=t.length,c=0;for(let h=r-1;h>=0;h-=2){let g=t.charAt(h).charCodeAt(0)-48;if(g<0||g>9)throw new X;c+=g}c*=3;for(let h=r-2;h>=0;h-=2){let g=t.charAt(h).charCodeAt(0)-48;if(g<0||g>9)throw new X;c+=g}return(1e3-c)%10}static decodeEnd(t,r){return Qt.findGuardPattern(t,r,!1,Qt.START_END_PATTERN,new Int32Array(Qt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(t,r,c,h){return this.findGuardPattern(t,r,c,h,new Int32Array(h.length))}static findGuardPattern(t,r,c,h,g){let p=t.getSize();r=c?t.getNextUnset(r):t.getNextSet(r);let y=0,_=r,E=h.length,j=c;for(let D=r;D<p;D++)if(t.get(D)!==j)g[y]++;else{if(y===E-1){if(Ut.patternMatchVariance(g,h,Qt.MAX_INDIVIDUAL_VARIANCE)<Qt.MAX_AVG_VARIANCE)return Int32Array.from([_,D]);_+=g[0]+g[1];let z=g.slice(2,g.length-1);for(let Q=0;Q<y-1;Q++)g[Q]=z[Q];g[y-1]=0,g[y]=0,y--}else y++;g[y]=1,j=!j}throw new V}static decodeDigit(t,r,c,h){this.recordPattern(t,c,r);let g=this.MAX_AVG_VARIANCE,p=-1,y=h.length;for(let _=0;_<y;_++){let E=h[_],j=Ut.patternMatchVariance(r,E,Qt.MAX_INDIVIDUAL_VARIANCE);j<g&&(g=j,p=_)}if(p>=0)return p;throw new V}}Qt.MAX_AVG_VARIANCE=.48,Qt.MAX_INDIVIDUAL_VARIANCE=.7,Qt.START_END_PATTERN=Int32Array.from([1,1,1]),Qt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Qt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Qt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Os{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(t,r,c){let h=this.decodeRowStringBuffer,g=this.decodeMiddle(r,c,h),p=h.toString(),y=Os.parseExtensionString(p),_=[new ze((c[0]+c[1])/2,t),new ze(g,t)],E=new Ue(p,null,0,_,Ne.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&E.putAllMetadata(y),E}decodeMiddle(t,r,c){let h=this.decodeMiddleCounters;h[0]=0,h[1]=0,h[2]=0,h[3]=0;let g=t.getSize(),p=r[1],y=0;for(let E=0;E<5&&p<g;E++){let j=Qt.decodeDigit(t,h,p,Qt.L_AND_G_PATTERNS);c+=String.fromCharCode(48+j%10);for(let D of h)p+=D;j>=10&&(y|=1<<4-E),E!==4&&(p=t.getNextSet(p),p=t.getNextUnset(p))}if(c.length!==5)throw new V;let _=this.determineCheckDigit(y);if(Os.extensionChecksum(c.toString())!==_)throw new V;return p}static extensionChecksum(t){let r=t.length,c=0;for(let h=r-2;h>=0;h-=2)c+=t.charAt(h).charCodeAt(0)-48;c*=3;for(let h=r-1;h>=0;h-=2)c+=t.charAt(h).charCodeAt(0)-48;return c*=3,c%10}determineCheckDigit(t){for(let r=0;r<10;r++)if(t===this.CHECK_DIGIT_ENCODINGS[r])return r;throw new V}static parseExtensionString(t){if(t.length!==5)return null;let r=Os.parseExtension5String(t);return r==null?null:new Map([[De.SUGGESTED_PRICE,r]])}static parseExtension5String(t){let r;switch(t.charAt(0)){case"0":r="";break;case"5":r="$";break;case"9":switch(t){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}r="";break;default:r="";break}let c=parseInt(t.substring(1)),h=(c/100).toString(),g=c%100,p=g<10?"0"+g:g.toString();return r+h+"."+p}}class va{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(t,r,c){let h=this.decodeRowStringBuffer,g=this.decodeMiddle(r,c,h),p=h.toString(),y=va.parseExtensionString(p),_=[new ze((c[0]+c[1])/2,t),new ze(g,t)],E=new Ue(p,null,0,_,Ne.UPC_EAN_EXTENSION,new Date().getTime());return y!=null&&E.putAllMetadata(y),E}decodeMiddle(t,r,c){let h=this.decodeMiddleCounters;h[0]=0,h[1]=0,h[2]=0,h[3]=0;let g=t.getSize(),p=r[1],y=0;for(let _=0;_<2&&p<g;_++){let E=Qt.decodeDigit(t,h,p,Qt.L_AND_G_PATTERNS);c+=String.fromCharCode(48+E%10);for(let j of h)p+=j;E>=10&&(y|=1<<1-_),_!==1&&(p=t.getNextSet(p),p=t.getNextUnset(p))}if(c.length!==2)throw new V;if(parseInt(c.toString())%4!==y)throw new V;return p}static parseExtensionString(t){return t.length!==2?null:new Map([[De.ISSUE_NUMBER,parseInt(t)]])}}class qs{static decodeRow(t,r,c){let h=Qt.findGuardPattern(r,c,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Os().decodeRow(t,r,h)}catch{return new va().decodeRow(t,r,h)}}}qs.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class wt extends Qt{constructor(){super(),this.decodeRowStringBuffer="",wt.L_AND_G_PATTERNS=wt.L_PATTERNS.map(t=>Int32Array.from(t));for(let t=10;t<20;t++){let r=wt.L_PATTERNS[t-10],c=new Int32Array(r.length);for(let h=0;h<r.length;h++)c[h]=r[r.length-h-1];wt.L_AND_G_PATTERNS[t]=c}}decodeRow(t,r,c){let h=wt.findStartGuardPattern(r),g=c==null?null:c.get(W.NEED_RESULT_POINT_CALLBACK);if(g!=null){const Oe=new ze((h[0]+h[1])/2,t);g.foundPossibleResultPoint(Oe)}let p=this.decodeMiddle(r,h,this.decodeRowStringBuffer),y=p.rowOffset,_=p.resultString;if(g!=null){const Oe=new ze(y,t);g.foundPossibleResultPoint(Oe)}let E=this.decodeEnd(r,y);if(g!=null){const Oe=new ze((E[0]+E[1])/2,t);g.foundPossibleResultPoint(Oe)}let j=E[1],D=j+(j-E[0]);if(D>=r.getSize()||!r.isRange(j,D,!1))throw new V;let z=_.toString();if(z.length<8)throw new X;if(!wt.checkChecksum(z))throw new T;let Q=(h[1]+h[0])/2,te=(E[1]+E[0])/2,se=this.getBarcodeFormat(),le=[new ze(Q,t),new ze(te,t)],pe=new Ue(z,null,0,le,se,new Date().getTime()),Pe=0;try{let Oe=qs.decodeRow(t,r,E[1]);pe.putMetadata(De.UPC_EAN_EXTENSION,Oe.getText()),pe.putAllMetadata(Oe.getResultMetadata()),pe.addResultPoints(Oe.getResultPoints()),Pe=Oe.getText().length}catch{}let Be=c==null?null:c.get(W.ALLOWED_EAN_EXTENSIONS);if(Be!=null){let Oe=!1;for(let At in Be)if(Pe.toString()===At){Oe=!0;break}if(!Oe)throw new V}return pe}decodeEnd(t,r){return wt.findGuardPattern(t,r,!1,wt.START_END_PATTERN,new Int32Array(wt.START_END_PATTERN.length).fill(0))}static checkChecksum(t){return wt.checkStandardUPCEANChecksum(t)}static checkStandardUPCEANChecksum(t){let r=t.length;if(r===0)return!1;let c=parseInt(t.charAt(r-1),10);return wt.getStandardUPCEANChecksum(t.substring(0,r-1))===c}static getStandardUPCEANChecksum(t){let r=t.length,c=0;for(let h=r-1;h>=0;h-=2){let g=t.charAt(h).charCodeAt(0)-48;if(g<0||g>9)throw new X;c+=g}c*=3;for(let h=r-2;h>=0;h-=2){let g=t.charAt(h).charCodeAt(0)-48;if(g<0||g>9)throw new X;c+=g}return(1e3-c)%10}}class Rn extends wt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(t,r,c){let h=this.decodeMiddleCounters;h[0]=0,h[1]=0,h[2]=0,h[3]=0;let g=t.getSize(),p=r[1],y=0;for(let E=0;E<6&&p<g;E++){let j=wt.decodeDigit(t,h,p,wt.L_AND_G_PATTERNS);c+=String.fromCharCode(48+j%10);for(let D of h)p+=D;j>=10&&(y|=1<<5-E)}c=Rn.determineFirstDigit(c,y),p=wt.findGuardPattern(t,p,!0,wt.MIDDLE_PATTERN,new Int32Array(wt.MIDDLE_PATTERN.length).fill(0))[1];for(let E=0;E<6&&p<g;E++){let j=wt.decodeDigit(t,h,p,wt.L_PATTERNS);c+=String.fromCharCode(48+j);for(let D of h)p+=D}return{rowOffset:p,resultString:c}}getBarcodeFormat(){return Ne.EAN_13}static determineFirstDigit(t,r){for(let c=0;c<10;c++)if(r===this.FIRST_DIGIT_ENCODINGS[c])return t=String.fromCharCode(48+c)+t,t;throw new V}}Rn.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class me extends wt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(t,r,c){const h=this.decodeMiddleCounters;h[0]=0,h[1]=0,h[2]=0,h[3]=0;let g=t.getSize(),p=r[1];for(let _=0;_<4&&p<g;_++){let E=wt.decodeDigit(t,h,p,wt.L_PATTERNS);c+=String.fromCharCode(48+E);for(let j of h)p+=j}p=wt.findGuardPattern(t,p,!0,wt.MIDDLE_PATTERN,new Int32Array(wt.MIDDLE_PATTERN.length).fill(0))[1];for(let _=0;_<4&&p<g;_++){let E=wt.decodeDigit(t,h,p,wt.L_PATTERNS);c+=String.fromCharCode(48+E);for(let j of h)p+=j}return{rowOffset:p,resultString:c}}getBarcodeFormat(){return Ne.EAN_8}}class qe extends wt{constructor(){super(...arguments),this.ean13Reader=new Rn}getBarcodeFormat(){return Ne.UPC_A}decode(t,r){return this.maybeReturnResult(this.ean13Reader.decode(t))}decodeRow(t,r,c){return this.maybeReturnResult(this.ean13Reader.decodeRow(t,r,c))}decodeMiddle(t,r,c){return this.ean13Reader.decodeMiddle(t,r,c)}maybeReturnResult(t){let r=t.getText();if(r.charAt(0)==="0"){let c=new Ue(r.substring(1),null,null,t.getResultPoints(),Ne.UPC_A);return t.getResultMetadata()!=null&&c.putAllMetadata(t.getResultMetadata()),c}else throw new V}reset(){this.ean13Reader.reset()}}class ct extends wt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(t,r,c){const h=this.decodeMiddleCounters.map(E=>E);h[0]=0,h[1]=0,h[2]=0,h[3]=0;const g=t.getSize();let p=r[1],y=0;for(let E=0;E<6&&p<g;E++){const j=ct.decodeDigit(t,h,p,ct.L_AND_G_PATTERNS);c+=String.fromCharCode(48+j%10);for(let D of h)p+=D;j>=10&&(y|=1<<5-E)}let _=ct.determineNumSysAndCheckDigit(c,y);return{rowOffset:p,resultString:_}}decodeEnd(t,r){return ct.findGuardPatternWithoutCounters(t,r,!0,ct.MIDDLE_END_PATTERN)}checkChecksum(t){return wt.checkChecksum(ct.convertUPCEtoUPCA(t))}static determineNumSysAndCheckDigit(t,r){for(let c=0;c<=1;c++)for(let h=0;h<10;h++)if(r===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[c][h]){let g=String.fromCharCode(48+c),p=String.fromCharCode(48+h);return g+t+p}throw V.getNotFoundInstance()}getBarcodeFormat(){return Ne.UPC_E}static convertUPCEtoUPCA(t){const r=t.slice(1,7).split("").map(g=>g.charCodeAt(0)),c=new be;c.append(t.charAt(0));let h=r[5];switch(h){case 0:case 1:case 2:c.appendChars(r,0,2),c.append(h),c.append("0000"),c.appendChars(r,2,3);break;case 3:c.appendChars(r,0,3),c.append("00000"),c.appendChars(r,3,2);break;case 4:c.appendChars(r,0,4),c.append("00000"),c.append(r[4]);break;default:c.appendChars(r,0,5),c.append("0000"),c.append(h);break}return t.length>=8&&c.append(t.charAt(7)),c.toString()}}ct.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),ct.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class an extends Ut{constructor(t){super();let r=t==null?null:t.get(W.POSSIBLE_FORMATS),c=[];l(r)?(c.push(new Rn),c.push(new qe),c.push(new me),c.push(new ct)):(r.indexOf(Ne.EAN_13)>-1&&c.push(new Rn),r.indexOf(Ne.UPC_A)>-1&&c.push(new qe),r.indexOf(Ne.EAN_8)>-1&&c.push(new me),r.indexOf(Ne.UPC_E)>-1&&c.push(new ct)),this.readers=c}decodeRow(t,r,c){for(let h of this.readers)try{const g=h.decodeRow(t,r,c),p=g.getBarcodeFormat()===Ne.EAN_13&&g.getText().charAt(0)==="0",y=c==null?null:c.get(W.POSSIBLE_FORMATS),_=y==null||y.includes(Ne.UPC_A);if(p&&_){const E=g.getRawBytes(),j=new Ue(g.getText().substring(1),E,E?E.length:null,g.getResultPoints(),Ne.UPC_A);return j.putAllMetadata(g.getResultMetadata()),j}return g}catch{}throw new V}reset(){for(let t of this.readers)t.reset()}}class Pt extends Ut{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(t,r){for(let c=0;c<r.length;c++)if(Ut.patternMatchVariance(t,r[c],Pt.MAX_INDIVIDUAL_VARIANCE)<Pt.MAX_AVG_VARIANCE)return c;throw new V}static count(t){return ht.sum(new Int32Array(t))}static increment(t,r){let c=0,h=r[0];for(let g=1;g<t.length;g++)r[g]>h&&(h=r[g],c=g);t[c]++}static decrement(t,r){let c=0,h=r[0];for(let g=1;g<t.length;g++)r[g]<h&&(h=r[g],c=g);t[c]--}static isFinderPattern(t){let r=t[0]+t[1],c=r+t[2]+t[3],h=r/c;if(h>=Pt.MIN_FINDER_PATTERN_RATIO&&h<=Pt.MAX_FINDER_PATTERN_RATIO){let g=Number.MAX_SAFE_INTEGER,p=Number.MIN_SAFE_INTEGER;for(let y of t)y>p&&(p=y),y<g&&(g=y);return p<10*g}return!1}}Pt.MAX_AVG_VARIANCE=.2,Pt.MAX_INDIVIDUAL_VARIANCE=.45,Pt.MIN_FINDER_PATTERN_RATIO=9.5/12,Pt.MAX_FINDER_PATTERN_RATIO=12.5/14;class In{constructor(t,r){this.value=t,this.checksumPortion=r}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(t){if(!(t instanceof In))return!1;const r=t;return this.value===r.value&&this.checksumPortion===r.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class G{constructor(t,r,c,h,g){this.value=t,this.startEnd=r,this.value=t,this.startEnd=r,this.resultPoints=new Array,this.resultPoints.push(new ze(c,g)),this.resultPoints.push(new ze(h,g))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(t){if(!(t instanceof G))return!1;const r=t;return this.value===r.value}hashCode(){return this.value}}class Te{constructor(){}static getRSSvalue(t,r,c){let h=0;for(let _ of t)h+=_;let g=0,p=0,y=t.length;for(let _=0;_<y-1;_++){let E;for(E=1,p|=1<<_;E<t[_];E++,p&=~(1<<_)){let j=Te.combins(h-E-1,y-_-2);if(c&&p===0&&h-E-(y-_-1)>=y-_-1&&(j-=Te.combins(h-E-(y-_),y-_-2)),y-_-1>1){let D=0;for(let z=h-E-(y-_-2);z>r;z--)D+=Te.combins(h-E-z-1,y-_-3);j-=D*(y-1-_)}else h-E>r&&j--;g+=j}h-=E}return g}static combins(t,r){let c,h;t-r>r?(h=r,c=t-r):(h=t-r,c=r);let g=1,p=1;for(let y=t;y>c;y--)g*=y,p<=h&&(g/=p,p++);for(;p<=h;)g/=p,p++;return g}}class jt{static buildBitArray(t){let r=t.length*2-1;t[t.length-1].getRightChar()==null&&(r-=1);let c=12*r,h=new K(c),g=0,y=t[0].getRightChar().getValue();for(let _=11;_>=0;--_)(y&1<<_)!=0&&h.set(g),g++;for(let _=1;_<t.length;++_){let E=t[_],j=E.getLeftChar().getValue();for(let D=11;D>=0;--D)(j&1<<D)!=0&&h.set(g),g++;if(E.getRightChar()!=null){let D=E.getRightChar().getValue();for(let z=11;z>=0;--z)(D&1<<z)!=0&&h.set(g),g++}}return h}}class On{constructor(t,r){r?this.decodedInformation=null:(this.finished=t,this.decodedInformation=r)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class hs{constructor(t){this.newPosition=t}getNewPosition(){return this.newPosition}}class yn extends hs{constructor(t,r){super(t),this.value=r}getValue(){return this.value}isFNC1(){return this.value===yn.FNC1}}yn.FNC1="$";class Kt extends hs{constructor(t,r,c){super(t),c?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=r}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class ns extends hs{constructor(t,r,c){if(super(t),r<0||r>10||c<0||c>10)throw new X;this.firstDigit=r,this.secondDigit=c}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===ns.FNC1}isSecondDigitFNC1(){return this.secondDigit===ns.FNC1}isAnyFNC1(){return this.firstDigit===ns.FNC1||this.secondDigit===ns.FNC1}}ns.FNC1=10;class He{constructor(){}static parseFieldsInGeneralPurpose(t){if(!t)return null;if(t.length<2)throw new V;let r=t.substring(0,2);for(let g of He.TWO_DIGIT_DATA_LENGTH)if(g[0]===r)return g[1]===He.VARIABLE_LENGTH?He.processVariableAI(2,g[2],t):He.processFixedAI(2,g[1],t);if(t.length<3)throw new V;let c=t.substring(0,3);for(let g of He.THREE_DIGIT_DATA_LENGTH)if(g[0]===c)return g[1]===He.VARIABLE_LENGTH?He.processVariableAI(3,g[2],t):He.processFixedAI(3,g[1],t);for(let g of He.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(g[0]===c)return g[1]===He.VARIABLE_LENGTH?He.processVariableAI(4,g[2],t):He.processFixedAI(4,g[1],t);if(t.length<4)throw new V;let h=t.substring(0,4);for(let g of He.FOUR_DIGIT_DATA_LENGTH)if(g[0]===h)return g[1]===He.VARIABLE_LENGTH?He.processVariableAI(4,g[2],t):He.processFixedAI(4,g[1],t);throw new V}static processFixedAI(t,r,c){if(c.length<t)throw new V;let h=c.substring(0,t);if(c.length<t+r)throw new V;let g=c.substring(t,t+r),p=c.substring(t+r),y="("+h+")"+g,_=He.parseFieldsInGeneralPurpose(p);return _==null?y:y+_}static processVariableAI(t,r,c){let h=c.substring(0,t),g;c.length<t+r?g=c.length:g=t+r;let p=c.substring(t,g),y=c.substring(g),_="("+h+")"+p,E=He.parseFieldsInGeneralPurpose(y);return E==null?_:_+E}}He.VARIABLE_LENGTH=[],He.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",He.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",He.VARIABLE_LENGTH,20],["22",He.VARIABLE_LENGTH,29],["30",He.VARIABLE_LENGTH,8],["37",He.VARIABLE_LENGTH,8],["90",He.VARIABLE_LENGTH,30],["91",He.VARIABLE_LENGTH,30],["92",He.VARIABLE_LENGTH,30],["93",He.VARIABLE_LENGTH,30],["94",He.VARIABLE_LENGTH,30],["95",He.VARIABLE_LENGTH,30],["96",He.VARIABLE_LENGTH,30],["97",He.VARIABLE_LENGTH,3],["98",He.VARIABLE_LENGTH,30],["99",He.VARIABLE_LENGTH,30]],He.THREE_DIGIT_DATA_LENGTH=[["240",He.VARIABLE_LENGTH,30],["241",He.VARIABLE_LENGTH,30],["242",He.VARIABLE_LENGTH,6],["250",He.VARIABLE_LENGTH,30],["251",He.VARIABLE_LENGTH,30],["253",He.VARIABLE_LENGTH,17],["254",He.VARIABLE_LENGTH,20],["400",He.VARIABLE_LENGTH,30],["401",He.VARIABLE_LENGTH,30],["402",17],["403",He.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",He.VARIABLE_LENGTH,20],["421",He.VARIABLE_LENGTH,15],["422",3],["423",He.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],He.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",He.VARIABLE_LENGTH,15],["391",He.VARIABLE_LENGTH,18],["392",He.VARIABLE_LENGTH,15],["393",He.VARIABLE_LENGTH,18],["703",He.VARIABLE_LENGTH,30]],He.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",He.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",He.VARIABLE_LENGTH,20],["8003",He.VARIABLE_LENGTH,30],["8004",He.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",He.VARIABLE_LENGTH,30],["8008",He.VARIABLE_LENGTH,12],["8018",18],["8020",He.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",He.VARIABLE_LENGTH,70],["8200",He.VARIABLE_LENGTH,70]];class fs{constructor(t){this.buffer=new be,this.information=t}decodeAllCodes(t,r){let c=r,h=null;do{let g=this.decodeGeneralPurposeField(c,h),p=He.parseFieldsInGeneralPurpose(g.getNewString());if(p!=null&&t.append(p),g.isRemaining()?h=""+g.getRemainingValue():h=null,c===g.getNewPosition())break;c=g.getNewPosition()}while(!0);return t.toString()}isStillNumeric(t){if(t+7>this.information.getSize())return t+4<=this.information.getSize();for(let r=t;r<t+3;++r)if(this.information.get(r))return!0;return this.information.get(t+3)}decodeNumeric(t){if(t+7>this.information.getSize()){let g=this.extractNumericValueFromBitArray(t,4);return g===0?new ns(this.information.getSize(),ns.FNC1,ns.FNC1):new ns(this.information.getSize(),g-1,ns.FNC1)}let r=this.extractNumericValueFromBitArray(t,7),c=(r-8)/11,h=(r-8)%11;return new ns(t+7,c,h)}extractNumericValueFromBitArray(t,r){return fs.extractNumericValueFromBitArray(this.information,t,r)}static extractNumericValueFromBitArray(t,r,c){let h=0;for(let g=0;g<c;++g)t.get(r+g)&&(h|=1<<c-g-1);return h}decodeGeneralPurposeField(t,r){this.buffer.setLengthToZero(),r!=null&&this.buffer.append(r),this.current.setPosition(t);let c=this.parseBlocks();return c!=null&&c.isRemaining()?new Kt(this.current.getPosition(),this.buffer.toString(),c.getRemainingValue()):new Kt(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let t,r;do{let c=this.current.getPosition();if(this.current.isAlpha()?(r=this.parseAlphaBlock(),t=r.isFinished()):this.current.isIsoIec646()?(r=this.parseIsoIec646Block(),t=r.isFinished()):(r=this.parseNumericBlock(),t=r.isFinished()),!(c!==this.current.getPosition())&&!t)break}while(!t);return r.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let t=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFirstDigitFNC1()){let r;return t.isSecondDigitFNC1()?r=new Kt(this.current.getPosition(),this.buffer.toString()):r=new Kt(this.current.getPosition(),this.buffer.toString(),t.getSecondDigit()),new On(!0,r)}if(this.buffer.append(t.getFirstDigit()),t.isSecondDigitFNC1()){let r=new Kt(this.current.getPosition(),this.buffer.toString());return new On(!0,r)}this.buffer.append(t.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new On(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let t=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){let r=new Kt(this.current.getPosition(),this.buffer.toString());return new On(!0,r)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new On(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let t=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){let r=new Kt(this.current.getPosition(),this.buffer.toString());return new On(!0,r)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new On(!1)}isStillIsoIec646(t){if(t+5>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(t,5);if(r>=5&&r<16)return!0;if(t+7>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(t,7);if(c>=64&&c<116)return!0;if(t+8>this.information.getSize())return!1;let h=this.extractNumericValueFromBitArray(t,8);return h>=232&&h<253}decodeIsoIec646(t){let r=this.extractNumericValueFromBitArray(t,5);if(r===15)return new yn(t+5,yn.FNC1);if(r>=5&&r<15)return new yn(t+5,"0"+(r-5));let c=this.extractNumericValueFromBitArray(t,7);if(c>=64&&c<90)return new yn(t+7,""+(c+1));if(c>=90&&c<116)return new yn(t+7,""+(c+7));let h=this.extractNumericValueFromBitArray(t,8),g;switch(h){case 232:g="!";break;case 233:g='"';break;case 234:g="%";break;case 235:g="&";break;case 236:g="'";break;case 237:g="(";break;case 238:g=")";break;case 239:g="*";break;case 240:g="+";break;case 241:g=",";break;case 242:g="-";break;case 243:g=".";break;case 244:g="/";break;case 245:g=":";break;case 246:g=";";break;case 247:g="<";break;case 248:g="=";break;case 249:g=">";break;case 250:g="?";break;case 251:g="_";break;case 252:g=" ";break;default:throw new X}return new yn(t+8,g)}isStillAlpha(t){if(t+5>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(t,5);if(r>=5&&r<16)return!0;if(t+6>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(t,6);return c>=16&&c<63}decodeAlphanumeric(t){let r=this.extractNumericValueFromBitArray(t,5);if(r===15)return new yn(t+5,yn.FNC1);if(r>=5&&r<15)return new yn(t+5,"0"+(r-5));let c=this.extractNumericValueFromBitArray(t,6);if(c>=32&&c<58)return new yn(t+6,""+(c+33));let h;switch(c){case 58:h="*";break;case 59:h=",";break;case 60:h="-";break;case 61:h=".";break;case 62:h="/";break;default:throw new xn("Decoding invalid alphanumeric value: "+c)}return new yn(t+6,h)}isAlphaTo646ToAlphaLatch(t){if(t+1>this.information.getSize())return!1;for(let r=0;r<5&&r+t<this.information.getSize();++r)if(r===2){if(!this.information.get(t+2))return!1}else if(this.information.get(t+r))return!1;return!0}isAlphaOr646ToNumericLatch(t){if(t+3>this.information.getSize())return!1;for(let r=t;r<t+3;++r)if(this.information.get(r))return!1;return!0}isNumericToAlphaNumericLatch(t){if(t+1>this.information.getSize())return!1;for(let r=0;r<4&&r+t<this.information.getSize();++r)if(this.information.get(t+r))return!1;return!0}}class Ee{constructor(t){this.information=t,this.generalDecoder=new fs(t)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class _e extends Ee{constructor(t){super(t)}encodeCompressedGtin(t,r){t.append("(01)");let c=t.length();t.append("9"),this.encodeCompressedGtinWithoutAI(t,r,c)}encodeCompressedGtinWithoutAI(t,r,c){for(let h=0;h<4;++h){let g=this.getGeneralDecoder().extractNumericValueFromBitArray(r+10*h,10);g/100===0&&t.append("0"),g/10===0&&t.append("0"),t.append(g)}_e.appendCheckDigit(t,c)}static appendCheckDigit(t,r){let c=0;for(let h=0;h<13;h++){let g=t.charAt(h+r).charCodeAt(0)-48;c+=(h&1)===0?3*g:g}c=10-c%10,c===10&&(c=0),t.append(c)}}_e.GTIN_SIZE=40;class Ve extends _e{constructor(t){super(t)}parseInformation(){let t=new be;t.append("(01)");let r=t.length(),c=this.getGeneralDecoder().extractNumericValueFromBitArray(Ve.HEADER_SIZE,4);return t.append(c),this.encodeCompressedGtinWithoutAI(t,Ve.HEADER_SIZE+4,r),this.getGeneralDecoder().decodeAllCodes(t,Ve.HEADER_SIZE+44)}}Ve.HEADER_SIZE=4;class Dn extends Ee{constructor(t){super(t)}parseInformation(){let t=new be;return this.getGeneralDecoder().decodeAllCodes(t,Dn.HEADER_SIZE)}}Dn.HEADER_SIZE=5;class Vs extends _e{constructor(t){super(t)}encodeCompressedWeight(t,r,c){let h=this.getGeneralDecoder().extractNumericValueFromBitArray(r,c);this.addWeightCode(t,h);let g=this.checkWeight(h),p=1e5;for(let y=0;y<5;++y)g/p===0&&t.append("0"),p/=10;t.append(g)}}class gs extends Vs{constructor(t){super(t)}parseInformation(){if(this.getInformation().getSize()!=gs.HEADER_SIZE+Vs.GTIN_SIZE+gs.WEIGHT_SIZE)throw new V;let t=new be;return this.encodeCompressedGtin(t,gs.HEADER_SIZE),this.encodeCompressedWeight(t,gs.HEADER_SIZE+Vs.GTIN_SIZE,gs.WEIGHT_SIZE),t.toString()}}gs.HEADER_SIZE=5,gs.WEIGHT_SIZE=15;class Ki extends gs{constructor(t){super(t)}addWeightCode(t,r){t.append("(3103)")}checkWeight(t){return t}}class gi extends gs{constructor(t){super(t)}addWeightCode(t,r){r<1e4?t.append("(3202)"):t.append("(3203)")}checkWeight(t){return t<1e4?t:t-1e4}}class Ms extends _e{constructor(t){super(t)}parseInformation(){if(this.getInformation().getSize()<Ms.HEADER_SIZE+_e.GTIN_SIZE)throw new V;let t=new be;this.encodeCompressedGtin(t,Ms.HEADER_SIZE);let r=this.getGeneralDecoder().extractNumericValueFromBitArray(Ms.HEADER_SIZE+_e.GTIN_SIZE,Ms.LAST_DIGIT_SIZE);t.append("(392"),t.append(r),t.append(")");let c=this.getGeneralDecoder().decodeGeneralPurposeField(Ms.HEADER_SIZE+_e.GTIN_SIZE+Ms.LAST_DIGIT_SIZE,null);return t.append(c.getNewString()),t.toString()}}Ms.HEADER_SIZE=8,Ms.LAST_DIGIT_SIZE=2;class Ln extends _e{constructor(t){super(t)}parseInformation(){if(this.getInformation().getSize()<Ln.HEADER_SIZE+_e.GTIN_SIZE)throw new V;let t=new be;this.encodeCompressedGtin(t,Ln.HEADER_SIZE);let r=this.getGeneralDecoder().extractNumericValueFromBitArray(Ln.HEADER_SIZE+_e.GTIN_SIZE,Ln.LAST_DIGIT_SIZE);t.append("(393"),t.append(r),t.append(")");let c=this.getGeneralDecoder().extractNumericValueFromBitArray(Ln.HEADER_SIZE+_e.GTIN_SIZE+Ln.LAST_DIGIT_SIZE,Ln.FIRST_THREE_DIGITS_SIZE);c/100==0&&t.append("0"),c/10==0&&t.append("0"),t.append(c);let h=this.getGeneralDecoder().decodeGeneralPurposeField(Ln.HEADER_SIZE+_e.GTIN_SIZE+Ln.LAST_DIGIT_SIZE+Ln.FIRST_THREE_DIGITS_SIZE,null);return t.append(h.getNewString()),t.toString()}}Ln.HEADER_SIZE=8,Ln.LAST_DIGIT_SIZE=2,Ln.FIRST_THREE_DIGITS_SIZE=10;class Zt extends Vs{constructor(t,r,c){super(t),this.dateCode=c,this.firstAIdigits=r}parseInformation(){if(this.getInformation().getSize()!=Zt.HEADER_SIZE+Zt.GTIN_SIZE+Zt.WEIGHT_SIZE+Zt.DATE_SIZE)throw new V;let t=new be;return this.encodeCompressedGtin(t,Zt.HEADER_SIZE),this.encodeCompressedWeight(t,Zt.HEADER_SIZE+Zt.GTIN_SIZE,Zt.WEIGHT_SIZE),this.encodeCompressedDate(t,Zt.HEADER_SIZE+Zt.GTIN_SIZE+Zt.WEIGHT_SIZE),t.toString()}encodeCompressedDate(t,r){let c=this.getGeneralDecoder().extractNumericValueFromBitArray(r,Zt.DATE_SIZE);if(c==38400)return;t.append("("),t.append(this.dateCode),t.append(")");let h=c%32;c/=32;let g=c%12+1;c/=12;let p=c;p/10==0&&t.append("0"),t.append(p),g/10==0&&t.append("0"),t.append(g),h/10==0&&t.append("0"),t.append(h)}addWeightCode(t,r){t.append("("),t.append(this.firstAIdigits),t.append(r/1e5),t.append(")")}checkWeight(t){return t%1e5}}Zt.HEADER_SIZE=8,Zt.WEIGHT_SIZE=20,Zt.DATE_SIZE=16;function _r(k){try{if(k.get(1))return new Ve(k);if(!k.get(2))return new Dn(k);switch(fs.extractNumericValueFromBitArray(k,1,4)){case 4:return new Ki(k);case 5:return new gi(k)}switch(fs.extractNumericValueFromBitArray(k,1,5)){case 12:return new Ms(k);case 13:return new Ln(k)}switch(fs.extractNumericValueFromBitArray(k,1,7)){case 56:return new Zt(k,"310","11");case 57:return new Zt(k,"320","11");case 58:return new Zt(k,"310","13");case 59:return new Zt(k,"320","13");case 60:return new Zt(k,"310","15");case 61:return new Zt(k,"320","15");case 62:return new Zt(k,"310","17");case 63:return new Zt(k,"320","17")}}catch(t){throw console.log(t),new xn("unknown decoder: "+k)}}class Ss{constructor(t,r,c,h){this.leftchar=t,this.rightchar=r,this.finderpattern=c,this.maybeLast=h}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(t,r){return t instanceof Ss?Ss.equalsOrNull(t.leftchar,r.leftchar)&&Ss.equalsOrNull(t.rightchar,r.rightchar)&&Ss.equalsOrNull(t.finderpattern,r.finderpattern):!1}static equalsOrNull(t,r){return t===null?r===null:Ss.equals(t,r)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Bn{constructor(t,r,c){this.pairs=t,this.rowNumber=r,this.wasReversed=c}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(t){return this.checkEqualitity(this,t)}toString(){return"{ "+this.pairs+" }"}equals(t,r){return t instanceof Bn?this.checkEqualitity(t,r)&&t.wasReversed===r.wasReversed:!1}checkEqualitity(t,r){if(!t||!r)return;let c;return t.forEach((h,g)=>{r.forEach(p=>{h.getLeftChar().getValue()===p.getLeftChar().getValue()&&h.getRightChar().getValue()===p.getRightChar().getValue()&&h.getFinderPatter().getValue()===p.getFinderPatter().getValue()&&(c=!0)})}),c}}class Re extends Pt{constructor(t){super(...arguments),this.pairs=new Array(Re.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=t===!0}decodeRow(t,r,c){this.pairs.length=0,this.startFromEven=!1;try{return Re.constructResult(this.decodeRow2pairs(t,r))}catch(h){this.verbose&&console.log(h)}return this.pairs.length=0,this.startFromEven=!0,Re.constructResult(this.decodeRow2pairs(t,r))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(t,r){let c=!1;for(;!c;)try{this.pairs.push(this.retrieveNextPair(r,this.pairs,t))}catch(g){if(g instanceof V){if(!this.pairs.length)throw new V;c=!0}}if(this.checkChecksum())return this.pairs;let h;if(this.rows.length?h=!0:h=!1,this.storeRow(t,!1),h){let g=this.checkRowsBoolean(!1);if(g!=null||(g=this.checkRowsBoolean(!0),g!=null))return g}throw new V}checkRowsBoolean(t){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,t&&(this.rows=this.rows.reverse());let r=null;try{r=this.checkRows(new Array,0)}catch(c){this.verbose&&console.log(c)}return t&&(this.rows=this.rows.reverse()),r}checkRows(t,r){for(let c=r;c<this.rows.length;c++){let h=this.rows[c];this.pairs.length=0;for(let p of t)this.pairs.push(p.getPairs());if(this.pairs.push(h.getPairs()),!Re.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let g=new Array(t);g.push(h);try{return this.checkRows(g,c+1)}catch(p){this.verbose&&console.log(p)}}throw new V}static isValidSequence(t){for(let r of Re.FINDER_PATTERN_SEQUENCES){if(t.length>r.length)continue;let c=!0;for(let h=0;h<t.length;h++)if(t[h].getFinderPattern().getValue()!=r[h]){c=!1;break}if(c)return!0}return!1}storeRow(t,r){let c=0,h=!1,g=!1;for(;c<this.rows.length;){let p=this.rows[c];if(p.getRowNumber()>t){g=p.isEquivalent(this.pairs);break}h=p.isEquivalent(this.pairs),c++}g||h||Re.isPartialRow(this.pairs,this.rows)||(this.rows.push(c,new Bn(this.pairs,t,r)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(t,r){for(let c of r)if(c.getPairs().length!==t.length){for(let h of c.getPairs())for(let g of t)if(Ss.equals(h,g))break}}static isPartialRow(t,r){for(let c of r){let h=!0;for(let g of t){let p=!1;for(let y of c.getPairs())if(g.equals(y)){p=!0;break}if(!p){h=!1;break}}if(h)return!0}return!1}getRows(){return this.rows}static constructResult(t){let r=jt.buildBitArray(t),h=_r(r).parseInformation(),g=t[0].getFinderPattern().getResultPoints(),p=t[t.length-1].getFinderPattern().getResultPoints(),y=[g[0],g[1],p[0],p[1]];return new Ue(h,null,null,y,Ne.RSS_EXPANDED,null)}checkChecksum(){let t=this.pairs.get(0),r=t.getLeftChar(),c=t.getRightChar();if(c==null)return!1;let h=c.getChecksumPortion(),g=2;for(let y=1;y<this.pairs.size();++y){let _=this.pairs.get(y);h+=_.getLeftChar().getChecksumPortion(),g++;let E=_.getRightChar();E!=null&&(h+=E.getChecksumPortion(),g++)}return h%=211,211*(g-4)+h==r.getValue()}static getNextSecondBar(t,r){let c;return t.get(r)?(c=t.getNextUnset(r),c=t.getNextSet(c)):(c=t.getNextSet(r),c=t.getNextUnset(c)),c}retrieveNextPair(t,r,c){let h=r.length%2==0;this.startFromEven&&(h=!h);let g,p=!0,y=-1;do this.findNextPair(t,r,y),g=this.parseFoundFinderPattern(t,c,h),g==null?y=Re.getNextSecondBar(t,this.startEnd[0]):p=!1;while(p);let _=this.decodeDataCharacter(t,g,h,!0);if(!this.isEmptyPair(r)&&r[r.length-1].mustBeLast())throw new V;let E;try{E=this.decodeDataCharacter(t,g,h,!1)}catch(j){E=null,this.verbose&&console.log(j)}return new Ss(_,E,g,!0)}isEmptyPair(t){return t.length===0}findNextPair(t,r,c){let h=this.getDecodeFinderCounters();h[0]=0,h[1]=0,h[2]=0,h[3]=0;let g=t.getSize(),p;c>=0?p=c:this.isEmptyPair(r)?p=0:p=r[r.length-1].getFinderPattern().getStartEnd()[1];let y=r.length%2!=0;this.startFromEven&&(y=!y);let _=!1;for(;p<g&&(_=!t.get(p),!!_);)p++;let E=0,j=p;for(let D=p;D<g;D++)if(t.get(D)!=_)h[E]++;else{if(E==3){if(y&&Re.reverseCounters(h),Re.isFinderPattern(h)){this.startEnd[0]=j,this.startEnd[1]=D;return}y&&Re.reverseCounters(h),j+=h[0]+h[1],h[0]=h[2],h[1]=h[3],h[2]=0,h[3]=0,E--}else E++;h[E]=1,_=!_}throw new V}static reverseCounters(t){let r=t.length;for(let c=0;c<r/2;++c){let h=t[c];t[c]=t[r-c-1],t[r-c-1]=h}}parseFoundFinderPattern(t,r,c){let h,g,p;if(c){let E=this.startEnd[0]-1;for(;E>=0&&!t.get(E);)E--;E++,h=this.startEnd[0]-E,g=E,p=this.startEnd[1]}else g=this.startEnd[0],p=t.getNextUnset(this.startEnd[1]+1),h=p-this.startEnd[1];let y=this.getDecodeFinderCounters();L.arraycopy(y,0,y,1,y.length-1),y[0]=h;let _;try{_=this.parseFinderValue(y,Re.FINDER_PATTERNS)}catch{return null}return new G(_,[g,p],g,p,r)}decodeDataCharacter(t,r,c,h){let g=this.getDataCharacterCounters();for(let nn=0;nn<g.length;nn++)g[nn]=0;if(h)Re.recordPatternInReverse(t,r.getStartEnd()[0],g);else{Re.recordPattern(t,r.getStartEnd()[1],g);for(let nn=0,rs=g.length-1;nn<rs;nn++,rs--){let Ns=g[nn];g[nn]=g[rs],g[rs]=Ns}}let p=17,y=ht.sum(new Int32Array(g))/p,_=(r.getStartEnd()[1]-r.getStartEnd()[0])/15;if(Math.abs(y-_)/_>.3)throw new V;let E=this.getOddCounts(),j=this.getEvenCounts(),D=this.getOddRoundingErrors(),z=this.getEvenRoundingErrors();for(let nn=0;nn<g.length;nn++){let rs=1*g[nn]/y,Ns=rs+.5;if(Ns<1){if(rs<.3)throw new V;Ns=1}else if(Ns>8){if(rs>8.7)throw new V;Ns=8}let Dr=nn/2;(nn&1)==0?(E[Dr]=Ns,D[Dr]=rs-Ns):(j[Dr]=Ns,z[Dr]=rs-Ns)}this.adjustOddEvenCounts(p);let Q=4*r.getValue()+(c?0:2)+(h?0:1)-1,te=0,se=0;for(let nn=E.length-1;nn>=0;nn--){if(Re.isNotA1left(r,c,h)){let rs=Re.WEIGHTS[Q][2*nn];se+=E[nn]*rs}te+=E[nn]}let le=0;for(let nn=j.length-1;nn>=0;nn--)if(Re.isNotA1left(r,c,h)){let rs=Re.WEIGHTS[Q][2*nn+1];le+=j[nn]*rs}let pe=se+le;if((te&1)!=0||te>13||te<4)throw new V;let Pe=(13-te)/2,Be=Re.SYMBOL_WIDEST[Pe],Oe=9-Be,At=Te.getRSSvalue(E,Be,!0),yt=Te.getRSSvalue(j,Oe,!1),Un=Re.EVEN_TOTAL_SUBSET[Pe],Ls=Re.GSUM[Pe],ms=At*Un+yt+Ls;return new In(ms,pe)}static isNotA1left(t,r,c){return!(t.getValue()==0&&r&&c)}adjustOddEvenCounts(t){let r=ht.sum(new Int32Array(this.getOddCounts())),c=ht.sum(new Int32Array(this.getEvenCounts())),h=!1,g=!1;r>13?g=!0:r<4&&(h=!0);let p=!1,y=!1;c>13?y=!0:c<4&&(p=!0);let _=r+c-t,E=(r&1)==1,j=(c&1)==0;if(_==1)if(E){if(j)throw new V;g=!0}else{if(!j)throw new V;y=!0}else if(_==-1)if(E){if(j)throw new V;h=!0}else{if(!j)throw new V;p=!0}else if(_==0){if(E){if(!j)throw new V;r<c?(h=!0,y=!0):(g=!0,p=!0)}else if(j)throw new V}else throw new V;if(h){if(g)throw new V;Re.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(g&&Re.decrement(this.getOddCounts(),this.getOddRoundingErrors()),p){if(y)throw new V;Re.increment(this.getEvenCounts(),this.getOddRoundingErrors())}y&&Re.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Re.SYMBOL_WIDEST=[7,5,4,3,1],Re.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Re.GSUM=[0,348,1388,2948,3988],Re.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Re.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Re.FINDER_PAT_A=0,Re.FINDER_PAT_B=1,Re.FINDER_PAT_C=2,Re.FINDER_PAT_D=3,Re.FINDER_PAT_E=4,Re.FINDER_PAT_F=5,Re.FINDER_PATTERN_SEQUENCES=[[Re.FINDER_PAT_A,Re.FINDER_PAT_A],[Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B],[Re.FINDER_PAT_A,Re.FINDER_PAT_C,Re.FINDER_PAT_B,Re.FINDER_PAT_D],[Re.FINDER_PAT_A,Re.FINDER_PAT_E,Re.FINDER_PAT_B,Re.FINDER_PAT_D,Re.FINDER_PAT_C],[Re.FINDER_PAT_A,Re.FINDER_PAT_E,Re.FINDER_PAT_B,Re.FINDER_PAT_D,Re.FINDER_PAT_D,Re.FINDER_PAT_F],[Re.FINDER_PAT_A,Re.FINDER_PAT_E,Re.FINDER_PAT_B,Re.FINDER_PAT_D,Re.FINDER_PAT_E,Re.FINDER_PAT_F,Re.FINDER_PAT_F],[Re.FINDER_PAT_A,Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B,Re.FINDER_PAT_C,Re.FINDER_PAT_C,Re.FINDER_PAT_D,Re.FINDER_PAT_D],[Re.FINDER_PAT_A,Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B,Re.FINDER_PAT_C,Re.FINDER_PAT_C,Re.FINDER_PAT_D,Re.FINDER_PAT_E,Re.FINDER_PAT_E],[Re.FINDER_PAT_A,Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B,Re.FINDER_PAT_C,Re.FINDER_PAT_C,Re.FINDER_PAT_D,Re.FINDER_PAT_E,Re.FINDER_PAT_F,Re.FINDER_PAT_F],[Re.FINDER_PAT_A,Re.FINDER_PAT_A,Re.FINDER_PAT_B,Re.FINDER_PAT_B,Re.FINDER_PAT_C,Re.FINDER_PAT_D,Re.FINDER_PAT_D,Re.FINDER_PAT_E,Re.FINDER_PAT_E,Re.FINDER_PAT_F,Re.FINDER_PAT_F]],Re.MAX_PAIRS=11;class oc extends In{constructor(t,r,c){super(t,r),this.count=0,this.finderPattern=c}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class en extends Pt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(t,r,c){const h=this.decodePair(r,!1,t,c);en.addOrTally(this.possibleLeftPairs,h),r.reverse();let g=this.decodePair(r,!0,t,c);en.addOrTally(this.possibleRightPairs,g),r.reverse();for(let p of this.possibleLeftPairs)if(p.getCount()>1){for(let y of this.possibleRightPairs)if(y.getCount()>1&&en.checkChecksum(p,y))return en.constructResult(p,y)}throw new V}static addOrTally(t,r){if(r==null)return;let c=!1;for(let h of t)if(h.getValue()===r.getValue()){h.incrementCount(),c=!0;break}c||t.push(r)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(t,r){let c=4537077*t.getValue()+r.getValue(),h=new String(c).toString(),g=new be;for(let E=13-h.length;E>0;E--)g.append("0");g.append(h);let p=0;for(let E=0;E<13;E++){let j=g.charAt(E).charCodeAt(0)-48;p+=(E&1)===0?3*j:j}p=10-p%10,p===10&&(p=0),g.append(p.toString());let y=t.getFinderPattern().getResultPoints(),_=r.getFinderPattern().getResultPoints();return new Ue(g.toString(),null,0,[y[0],y[1],_[0],_[1]],Ne.RSS_14,new Date().getTime())}static checkChecksum(t,r){let c=(t.getChecksumPortion()+16*r.getChecksumPortion())%79,h=9*t.getFinderPattern().getValue()+r.getFinderPattern().getValue();return h>72&&h--,h>8&&h--,c===h}decodePair(t,r,c,h){try{let g=this.findFinderPattern(t,r),p=this.parseFoundFinderPattern(t,c,r,g),y=h==null?null:h.get(W.NEED_RESULT_POINT_CALLBACK);if(y!=null){let j=(g[0]+g[1])/2;r&&(j=t.getSize()-1-j),y.foundPossibleResultPoint(new ze(j,c))}let _=this.decodeDataCharacter(t,p,!0),E=this.decodeDataCharacter(t,p,!1);return new oc(1597*_.getValue()+E.getValue(),_.getChecksumPortion()+4*E.getChecksumPortion(),p)}catch{return null}}decodeDataCharacter(t,r,c){let h=this.getDataCharacterCounters();for(let le=0;le<h.length;le++)h[le]=0;if(c)Ut.recordPatternInReverse(t,r.getStartEnd()[0],h);else{Ut.recordPattern(t,r.getStartEnd()[1]+1,h);for(let le=0,pe=h.length-1;le<pe;le++,pe--){let Pe=h[le];h[le]=h[pe],h[pe]=Pe}}let g=c?16:15,p=ht.sum(new Int32Array(h))/g,y=this.getOddCounts(),_=this.getEvenCounts(),E=this.getOddRoundingErrors(),j=this.getEvenRoundingErrors();for(let le=0;le<h.length;le++){let pe=h[le]/p,Pe=Math.floor(pe+.5);Pe<1?Pe=1:Pe>8&&(Pe=8);let Be=Math.floor(le/2);(le&1)===0?(y[Be]=Pe,E[Be]=pe-Pe):(_[Be]=Pe,j[Be]=pe-Pe)}this.adjustOddEvenCounts(c,g);let D=0,z=0;for(let le=y.length-1;le>=0;le--)z*=9,z+=y[le],D+=y[le];let Q=0,te=0;for(let le=_.length-1;le>=0;le--)Q*=9,Q+=_[le],te+=_[le];let se=z+3*Q;if(c){if((D&1)!==0||D>12||D<4)throw new V;let le=(12-D)/2,pe=en.OUTSIDE_ODD_WIDEST[le],Pe=9-pe,Be=Te.getRSSvalue(y,pe,!1),Oe=Te.getRSSvalue(_,Pe,!0),At=en.OUTSIDE_EVEN_TOTAL_SUBSET[le],yt=en.OUTSIDE_GSUM[le];return new In(Be*At+Oe+yt,se)}else{if((te&1)!==0||te>10||te<4)throw new V;let le=(10-te)/2,pe=en.INSIDE_ODD_WIDEST[le],Pe=9-pe,Be=Te.getRSSvalue(y,pe,!0),Oe=Te.getRSSvalue(_,Pe,!1),At=en.INSIDE_ODD_TOTAL_SUBSET[le],yt=en.INSIDE_GSUM[le];return new In(Oe*At+Be+yt,se)}}findFinderPattern(t,r){let c=this.getDecodeFinderCounters();c[0]=0,c[1]=0,c[2]=0,c[3]=0;let h=t.getSize(),g=!1,p=0;for(;p<h&&(g=!t.get(p),r!==g);)p++;let y=0,_=p;for(let E=p;E<h;E++)if(t.get(E)!==g)c[y]++;else{if(y===3){if(Pt.isFinderPattern(c))return[_,E];_+=c[0]+c[1],c[0]=c[2],c[1]=c[3],c[2]=0,c[3]=0,y--}else y++;c[y]=1,g=!g}throw new V}parseFoundFinderPattern(t,r,c,h){let g=t.get(h[0]),p=h[0]-1;for(;p>=0&&g!==t.get(p);)p--;p++;const y=h[0]-p,_=this.getDecodeFinderCounters(),E=new Int32Array(_.length);L.arraycopy(_,0,E,1,_.length-1),E[0]=y;const j=this.parseFinderValue(E,en.FINDER_PATTERNS);let D=p,z=h[1];return c&&(D=t.getSize()-1-D,z=t.getSize()-1-z),new G(j,[p,h[1]],D,z,r)}adjustOddEvenCounts(t,r){let c=ht.sum(new Int32Array(this.getOddCounts())),h=ht.sum(new Int32Array(this.getEvenCounts())),g=!1,p=!1,y=!1,_=!1;t?(c>12?p=!0:c<4&&(g=!0),h>12?_=!0:h<4&&(y=!0)):(c>11?p=!0:c<5&&(g=!0),h>10?_=!0:h<4&&(y=!0));let E=c+h-r,j=(c&1)===(t?1:0),D=(h&1)===1;if(E===1)if(j){if(D)throw new V;p=!0}else{if(!D)throw new V;_=!0}else if(E===-1)if(j){if(D)throw new V;g=!0}else{if(!D)throw new V;y=!0}else if(E===0){if(j){if(!D)throw new V;c<h?(g=!0,_=!0):(p=!0,y=!0)}else if(D)throw new V}else throw new V;if(g){if(p)throw new V;Pt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(p&&Pt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),y){if(_)throw new V;Pt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}_&&Pt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}en.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],en.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],en.OUTSIDE_GSUM=[0,161,961,2015,2715],en.INSIDE_GSUM=[0,336,1036,1516],en.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],en.INSIDE_ODD_WIDEST=[2,4,6,8],en.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Gs extends Ut{constructor(t,r){super(),this.readers=[],this.verbose=r===!0;const c=t?t.get(W.POSSIBLE_FORMATS):null,h=t&&t.get(W.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;c?((c.includes(Ne.EAN_13)||c.includes(Ne.UPC_A)||c.includes(Ne.EAN_8)||c.includes(Ne.UPC_E))&&this.readers.push(new an(t)),c.includes(Ne.CODE_39)&&this.readers.push(new lt(h)),c.includes(Ne.CODE_128)&&this.readers.push(new je),c.includes(Ne.ITF)&&this.readers.push(new gt),c.includes(Ne.RSS_14)&&this.readers.push(new en),c.includes(Ne.RSS_EXPANDED)&&this.readers.push(new Re(this.verbose))):(this.readers.push(new an(t)),this.readers.push(new lt),this.readers.push(new an(t)),this.readers.push(new je),this.readers.push(new gt),this.readers.push(new en),this.readers.push(new Re(this.verbose)))}decodeRow(t,r,c){for(let h=0;h<this.readers.length;h++)try{return this.readers[h].decodeRow(t,r,c)}catch{}throw new V}reset(){this.readers.forEach(t=>t.reset())}}class od extends Le{constructor(t=500,r){super(new Gs(r),t,r)}}class Ht{constructor(t,r,c){this.ecCodewords=t,this.ecBlocks=[r],c&&this.ecBlocks.push(c)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Ft{constructor(t,r){this.count=t,this.dataCodewords=r}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Rt{constructor(t,r,c,h,g,p){this.versionNumber=t,this.symbolSizeRows=r,this.symbolSizeColumns=c,this.dataRegionSizeRows=h,this.dataRegionSizeColumns=g,this.ecBlocks=p;let y=0;const _=p.getECCodewords(),E=p.getECBlocks();for(let j of E)y+=j.getCount()*(j.getDataCodewords()+_);this.totalCodewords=y}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(t,r){if((t&1)!==0||(r&1)!==0)throw new X;for(let c of Rt.VERSIONS)if(c.symbolSizeRows===t&&c.symbolSizeColumns===r)return c;throw new X}toString(){return""+this.versionNumber}static buildVersions(){return[new Rt(1,10,10,8,8,new Ht(5,new Ft(1,3))),new Rt(2,12,12,10,10,new Ht(7,new Ft(1,5))),new Rt(3,14,14,12,12,new Ht(10,new Ft(1,8))),new Rt(4,16,16,14,14,new Ht(12,new Ft(1,12))),new Rt(5,18,18,16,16,new Ht(14,new Ft(1,18))),new Rt(6,20,20,18,18,new Ht(18,new Ft(1,22))),new Rt(7,22,22,20,20,new Ht(20,new Ft(1,30))),new Rt(8,24,24,22,22,new Ht(24,new Ft(1,36))),new Rt(9,26,26,24,24,new Ht(28,new Ft(1,44))),new Rt(10,32,32,14,14,new Ht(36,new Ft(1,62))),new Rt(11,36,36,16,16,new Ht(42,new Ft(1,86))),new Rt(12,40,40,18,18,new Ht(48,new Ft(1,114))),new Rt(13,44,44,20,20,new Ht(56,new Ft(1,144))),new Rt(14,48,48,22,22,new Ht(68,new Ft(1,174))),new Rt(15,52,52,24,24,new Ht(42,new Ft(2,102))),new Rt(16,64,64,14,14,new Ht(56,new Ft(2,140))),new Rt(17,72,72,16,16,new Ht(36,new Ft(4,92))),new Rt(18,80,80,18,18,new Ht(48,new Ft(4,114))),new Rt(19,88,88,20,20,new Ht(56,new Ft(4,144))),new Rt(20,96,96,22,22,new Ht(68,new Ft(4,174))),new Rt(21,104,104,24,24,new Ht(56,new Ft(6,136))),new Rt(22,120,120,18,18,new Ht(68,new Ft(6,175))),new Rt(23,132,132,20,20,new Ht(62,new Ft(8,163))),new Rt(24,144,144,22,22,new Ht(62,new Ft(8,156),new Ft(2,155))),new Rt(25,8,18,6,16,new Ht(7,new Ft(1,5))),new Rt(26,8,32,6,14,new Ht(11,new Ft(1,10))),new Rt(27,12,26,10,24,new Ht(14,new Ft(1,16))),new Rt(28,12,36,10,16,new Ht(18,new Ft(1,22))),new Rt(29,16,36,14,16,new Ht(24,new Ft(1,32))),new Rt(30,16,48,14,22,new Ht(28,new Ft(1,49)))]}}Rt.VERSIONS=Rt.buildVersions();class Sr{constructor(t){const r=t.getHeight();if(r<8||r>144||(r&1)!==0)throw new X;this.version=Sr.readVersion(t),this.mappingBitMatrix=this.extractDataRegion(t),this.readMappingMatrix=new Ie(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(t){const r=t.getHeight(),c=t.getWidth();return Rt.getVersionForDimensions(r,c)}readCodewords(){const t=new Int8Array(this.version.getTotalCodewords());let r=0,c=4,h=0;const g=this.mappingBitMatrix.getHeight(),p=this.mappingBitMatrix.getWidth();let y=!1,_=!1,E=!1,j=!1;do if(c===g&&h===0&&!y)t[r++]=this.readCorner1(g,p)&255,c-=2,h+=2,y=!0;else if(c===g-2&&h===0&&(p&3)!==0&&!_)t[r++]=this.readCorner2(g,p)&255,c-=2,h+=2,_=!0;else if(c===g+4&&h===2&&(p&7)===0&&!E)t[r++]=this.readCorner3(g,p)&255,c-=2,h+=2,E=!0;else if(c===g-2&&h===0&&(p&7)===4&&!j)t[r++]=this.readCorner4(g,p)&255,c-=2,h+=2,j=!0;else{do c<g&&h>=0&&!this.readMappingMatrix.get(h,c)&&(t[r++]=this.readUtah(c,h,g,p)&255),c-=2,h+=2;while(c>=0&&h<p);c+=1,h+=3;do c>=0&&h<p&&!this.readMappingMatrix.get(h,c)&&(t[r++]=this.readUtah(c,h,g,p)&255),c+=2,h-=2;while(c<g&&h>=0);c+=3,h+=1}while(c<g||h<p);if(r!==this.version.getTotalCodewords())throw new X;return t}readModule(t,r,c,h){return t<0&&(t+=c,r+=4-(c+4&7)),r<0&&(r+=h,t+=4-(h+4&7)),this.readMappingMatrix.set(r,t),this.mappingBitMatrix.get(r,t)}readUtah(t,r,c,h){let g=0;return this.readModule(t-2,r-2,c,h)&&(g|=1),g<<=1,this.readModule(t-2,r-1,c,h)&&(g|=1),g<<=1,this.readModule(t-1,r-2,c,h)&&(g|=1),g<<=1,this.readModule(t-1,r-1,c,h)&&(g|=1),g<<=1,this.readModule(t-1,r,c,h)&&(g|=1),g<<=1,this.readModule(t,r-2,c,h)&&(g|=1),g<<=1,this.readModule(t,r-1,c,h)&&(g|=1),g<<=1,this.readModule(t,r,c,h)&&(g|=1),g}readCorner1(t,r){let c=0;return this.readModule(t-1,0,t,r)&&(c|=1),c<<=1,this.readModule(t-1,1,t,r)&&(c|=1),c<<=1,this.readModule(t-1,2,t,r)&&(c|=1),c<<=1,this.readModule(0,r-2,t,r)&&(c|=1),c<<=1,this.readModule(0,r-1,t,r)&&(c|=1),c<<=1,this.readModule(1,r-1,t,r)&&(c|=1),c<<=1,this.readModule(2,r-1,t,r)&&(c|=1),c<<=1,this.readModule(3,r-1,t,r)&&(c|=1),c}readCorner2(t,r){let c=0;return this.readModule(t-3,0,t,r)&&(c|=1),c<<=1,this.readModule(t-2,0,t,r)&&(c|=1),c<<=1,this.readModule(t-1,0,t,r)&&(c|=1),c<<=1,this.readModule(0,r-4,t,r)&&(c|=1),c<<=1,this.readModule(0,r-3,t,r)&&(c|=1),c<<=1,this.readModule(0,r-2,t,r)&&(c|=1),c<<=1,this.readModule(0,r-1,t,r)&&(c|=1),c<<=1,this.readModule(1,r-1,t,r)&&(c|=1),c}readCorner3(t,r){let c=0;return this.readModule(t-1,0,t,r)&&(c|=1),c<<=1,this.readModule(t-1,r-1,t,r)&&(c|=1),c<<=1,this.readModule(0,r-3,t,r)&&(c|=1),c<<=1,this.readModule(0,r-2,t,r)&&(c|=1),c<<=1,this.readModule(0,r-1,t,r)&&(c|=1),c<<=1,this.readModule(1,r-3,t,r)&&(c|=1),c<<=1,this.readModule(1,r-2,t,r)&&(c|=1),c<<=1,this.readModule(1,r-1,t,r)&&(c|=1),c}readCorner4(t,r){let c=0;return this.readModule(t-3,0,t,r)&&(c|=1),c<<=1,this.readModule(t-2,0,t,r)&&(c|=1),c<<=1,this.readModule(t-1,0,t,r)&&(c|=1),c<<=1,this.readModule(0,r-2,t,r)&&(c|=1),c<<=1,this.readModule(0,r-1,t,r)&&(c|=1),c<<=1,this.readModule(1,r-1,t,r)&&(c|=1),c<<=1,this.readModule(2,r-1,t,r)&&(c|=1),c<<=1,this.readModule(3,r-1,t,r)&&(c|=1),c}extractDataRegion(t){const r=this.version.getSymbolSizeRows(),c=this.version.getSymbolSizeColumns();if(t.getHeight()!==r)throw new N("Dimension of bitMatrix must match the version size");const h=this.version.getDataRegionSizeRows(),g=this.version.getDataRegionSizeColumns(),p=r/h|0,y=c/g|0,_=p*h,E=y*g,j=new Ie(E,_);for(let D=0;D<p;++D){const z=D*h;for(let Q=0;Q<y;++Q){const te=Q*g;for(let se=0;se<h;++se){const le=D*(h+2)+1+se,pe=z+se;for(let Pe=0;Pe<g;++Pe){const Be=Q*(g+2)+1+Pe;if(t.get(Be,le)){const Oe=te+Pe;j.set(Oe,pe)}}}}}return j}}class Er{constructor(t,r){this.numDataCodewords=t,this.codewords=r}static getDataBlocks(t,r){const c=r.getECBlocks();let h=0;const g=c.getECBlocks();for(let se of g)h+=se.getCount();const p=new Array(h);let y=0;for(let se of g)for(let le=0;le<se.getCount();le++){const pe=se.getDataCodewords(),Pe=c.getECCodewords()+pe;p[y++]=new Er(pe,new Uint8Array(Pe))}const E=p[0].codewords.length-c.getECCodewords(),j=E-1;let D=0;for(let se=0;se<j;se++)for(let le=0;le<y;le++)p[le].codewords[se]=t[D++];const z=r.getVersionNumber()===24,Q=z?8:y;for(let se=0;se<Q;se++)p[se].codewords[E-1]=t[D++];const te=p[0].codewords.length;for(let se=E;se<te;se++)for(let le=0;le<y;le++){const pe=z?(le+8)%y:le,Pe=z&&pe>7?se-1:se;p[pe].codewords[Pe]=t[D++]}if(D!==t.length)throw new N;return p}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Ys{constructor(t){this.bytes=t,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(t){if(t<1||t>32||t>this.available())throw new N(""+t);let r=0,c=this.bitOffset,h=this.byteOffset;const g=this.bytes;if(c>0){const p=8-c,y=t<p?t:p,_=p-y,E=255>>8-y<<_;r=(g[h]&E)>>_,t-=y,c+=y,c===8&&(c=0,h++)}if(t>0){for(;t>=8;)r=r<<8|g[h]&255,h++,t-=8;if(t>0){const p=8-t,y=255>>p<<p;r=r<<t|(g[h]&y)>>p,c+=t}}return this.bitOffset=c,this.byteOffset=h,r}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Gt;(function(k){k[k.PAD_ENCODE=0]="PAD_ENCODE",k[k.ASCII_ENCODE=1]="ASCII_ENCODE",k[k.C40_ENCODE=2]="C40_ENCODE",k[k.TEXT_ENCODE=3]="TEXT_ENCODE",k[k.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",k[k.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",k[k.BASE256_ENCODE=6]="BASE256_ENCODE"})(Gt||(Gt={}));class Ca{static decode(t){const r=new Ys(t),c=new be,h=new be,g=new Array;let p=Gt.ASCII_ENCODE;do if(p===Gt.ASCII_ENCODE)p=this.decodeAsciiSegment(r,c,h);else{switch(p){case Gt.C40_ENCODE:this.decodeC40Segment(r,c);break;case Gt.TEXT_ENCODE:this.decodeTextSegment(r,c);break;case Gt.ANSIX12_ENCODE:this.decodeAnsiX12Segment(r,c);break;case Gt.EDIFACT_ENCODE:this.decodeEdifactSegment(r,c);break;case Gt.BASE256_ENCODE:this.decodeBase256Segment(r,c,g);break;default:throw new X}p=Gt.ASCII_ENCODE}while(p!==Gt.PAD_ENCODE&&r.available()>0);return h.length()>0&&c.append(h.toString()),new Ce(t,c.toString(),g.length===0?null:g,null)}static decodeAsciiSegment(t,r,c){let h=!1;do{let g=t.readBits(8);if(g===0)throw new X;if(g<=128)return h&&(g+=128),r.append(String.fromCharCode(g-1)),Gt.ASCII_ENCODE;if(g===129)return Gt.PAD_ENCODE;if(g<=229){const p=g-130;p<10&&r.append("0"),r.append(""+p)}else switch(g){case 230:return Gt.C40_ENCODE;case 231:return Gt.BASE256_ENCODE;case 232:r.append("");break;case 233:case 234:break;case 235:h=!0;break;case 236:r.append("[)>05"),c.insert(0,"");break;case 237:r.append("[)>06"),c.insert(0,"");break;case 238:return Gt.ANSIX12_ENCODE;case 239:return Gt.TEXT_ENCODE;case 240:return Gt.EDIFACT_ENCODE;case 241:break;default:if(g!==254||t.available()!==0)throw new X;break}}while(t.available()>0);return Gt.ASCII_ENCODE}static decodeC40Segment(t,r){let c=!1;const h=[];let g=0;do{if(t.available()===8)return;const p=t.readBits(8);if(p===254)return;this.parseTwoBytes(p,t.readBits(8),h);for(let y=0;y<3;y++){const _=h[y];switch(g){case 0:if(_<3)g=_+1;else if(_<this.C40_BASIC_SET_CHARS.length){const E=this.C40_BASIC_SET_CHARS[_];c?(r.append(String.fromCharCode(E.charCodeAt(0)+128)),c=!1):r.append(E)}else throw new X;break;case 1:c?(r.append(String.fromCharCode(_+128)),c=!1):r.append(String.fromCharCode(_)),g=0;break;case 2:if(_<this.C40_SHIFT2_SET_CHARS.length){const E=this.C40_SHIFT2_SET_CHARS[_];c?(r.append(String.fromCharCode(E.charCodeAt(0)+128)),c=!1):r.append(E)}else switch(_){case 27:r.append("");break;case 30:c=!0;break;default:throw new X}g=0;break;case 3:c?(r.append(String.fromCharCode(_+224)),c=!1):r.append(String.fromCharCode(_+96)),g=0;break;default:throw new X}}}while(t.available()>0)}static decodeTextSegment(t,r){let c=!1,h=[],g=0;do{if(t.available()===8)return;const p=t.readBits(8);if(p===254)return;this.parseTwoBytes(p,t.readBits(8),h);for(let y=0;y<3;y++){const _=h[y];switch(g){case 0:if(_<3)g=_+1;else if(_<this.TEXT_BASIC_SET_CHARS.length){const E=this.TEXT_BASIC_SET_CHARS[_];c?(r.append(String.fromCharCode(E.charCodeAt(0)+128)),c=!1):r.append(E)}else throw new X;break;case 1:c?(r.append(String.fromCharCode(_+128)),c=!1):r.append(String.fromCharCode(_)),g=0;break;case 2:if(_<this.TEXT_SHIFT2_SET_CHARS.length){const E=this.TEXT_SHIFT2_SET_CHARS[_];c?(r.append(String.fromCharCode(E.charCodeAt(0)+128)),c=!1):r.append(E)}else switch(_){case 27:r.append("");break;case 30:c=!0;break;default:throw new X}g=0;break;case 3:if(_<this.TEXT_SHIFT3_SET_CHARS.length){const E=this.TEXT_SHIFT3_SET_CHARS[_];c?(r.append(String.fromCharCode(E.charCodeAt(0)+128)),c=!1):r.append(E),g=0}else throw new X;break;default:throw new X}}}while(t.available()>0)}static decodeAnsiX12Segment(t,r){const c=[];do{if(t.available()===8)return;const h=t.readBits(8);if(h===254)return;this.parseTwoBytes(h,t.readBits(8),c);for(let g=0;g<3;g++){const p=c[g];switch(p){case 0:r.append("\r");break;case 1:r.append("*");break;case 2:r.append(">");break;case 3:r.append(" ");break;default:if(p<14)r.append(String.fromCharCode(p+44));else if(p<40)r.append(String.fromCharCode(p+51));else throw new X;break}}}while(t.available()>0)}static parseTwoBytes(t,r,c){let h=(t<<8)+r-1,g=Math.floor(h/1600);c[0]=g,h-=g*1600,g=Math.floor(h/40),c[1]=g,c[2]=h-g*40}static decodeEdifactSegment(t,r){do{if(t.available()<=16)return;for(let c=0;c<4;c++){let h=t.readBits(6);if(h===31){const g=8-t.getBitOffset();g!==8&&t.readBits(g);return}(h&32)===0&&(h|=64),r.append(String.fromCharCode(h))}}while(t.available()>0)}static decodeBase256Segment(t,r,c){let h=1+t.getByteOffset();const g=this.unrandomize255State(t.readBits(8),h++);let p;if(g===0?p=t.available()/8|0:g<250?p=g:p=250*(g-249)+this.unrandomize255State(t.readBits(8),h++),p<0)throw new X;const y=new Uint8Array(p);for(let _=0;_<p;_++){if(t.available()<8)throw new X;y[_]=this.unrandomize255State(t.readBits(8),h++)}c.push(y);try{r.append(ge.decode(y,ie.ISO88591))}catch(_){throw new xn("Platform does not support required encoding: "+_.message)}}static unrandomize255State(t,r){const c=149*r%255+1,h=t-c;return h>=0?h:h+256}}Ca.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Ca.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Ca.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Ca.TEXT_SHIFT2_SET_CHARS=Ca.C40_SHIFT2_SET_CHARS,Ca.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class ld{constructor(){this.rsDecoder=new cn(ft.DATA_MATRIX_FIELD_256)}decode(t){const r=new Sr(t),c=r.getVersion(),h=r.readCodewords(),g=Er.getDataBlocks(h,c);let p=0;for(let E of g)p+=E.getNumDataCodewords();const y=new Uint8Array(p),_=g.length;for(let E=0;E<_;E++){const j=g[E],D=j.getCodewords(),z=j.getNumDataCodewords();this.correctErrors(D,z);for(let Q=0;Q<z;Q++)y[Q*_+E]=D[Q]}return Ca.decode(y)}correctErrors(t,r){const c=new Int32Array(t);try{this.rsDecoder.decode(c,t.length-r)}catch{throw new T}for(let h=0;h<r;h++)t[h]=c[h]}}class bn{constructor(t){this.image=t,this.rectangleDetector=new Fe(this.image)}detect(){const t=this.rectangleDetector.detect();let r=this.detectSolid1(t);if(r=this.detectSolid2(r),r[3]=this.correctTopRight(r),!r[3])throw new V;r=this.shiftToModuleCenter(r);const c=r[0],h=r[1],g=r[2],p=r[3];let y=this.transitionsBetween(c,p)+1,_=this.transitionsBetween(g,p)+1;(y&1)===1&&(y+=1),(_&1)===1&&(_+=1),4*y<7*_&&4*_<7*y&&(y=_=Math.max(y,_));let E=bn.sampleGrid(this.image,c,h,g,p,y,_);return new Is(E,[c,h,g,p])}static shiftPoint(t,r,c){let h=(r.getX()-t.getX())/(c+1),g=(r.getY()-t.getY())/(c+1);return new ze(t.getX()+h,t.getY()+g)}static moveAway(t,r,c){let h=t.getX(),g=t.getY();return h<r?h-=1:h+=1,g<c?g-=1:g+=1,new ze(h,g)}detectSolid1(t){let r=t[0],c=t[1],h=t[3],g=t[2],p=this.transitionsBetween(r,c),y=this.transitionsBetween(c,h),_=this.transitionsBetween(h,g),E=this.transitionsBetween(g,r),j=p,D=[g,r,c,h];return j>y&&(j=y,D[0]=r,D[1]=c,D[2]=h,D[3]=g),j>_&&(j=_,D[0]=c,D[1]=h,D[2]=g,D[3]=r),j>E&&(D[0]=h,D[1]=g,D[2]=r,D[3]=c),D}detectSolid2(t){let r=t[0],c=t[1],h=t[2],g=t[3],p=this.transitionsBetween(r,g),y=bn.shiftPoint(c,h,(p+1)*4),_=bn.shiftPoint(h,c,(p+1)*4),E=this.transitionsBetween(y,r),j=this.transitionsBetween(_,g);return E<j?(t[0]=r,t[1]=c,t[2]=h,t[3]=g):(t[0]=c,t[1]=h,t[2]=g,t[3]=r),t}correctTopRight(t){let r=t[0],c=t[1],h=t[2],g=t[3],p=this.transitionsBetween(r,g),y=this.transitionsBetween(c,g),_=bn.shiftPoint(r,c,(y+1)*4),E=bn.shiftPoint(h,c,(p+1)*4);p=this.transitionsBetween(_,g),y=this.transitionsBetween(E,g);let j=new ze(g.getX()+(h.getX()-c.getX())/(p+1),g.getY()+(h.getY()-c.getY())/(p+1)),D=new ze(g.getX()+(r.getX()-c.getX())/(y+1),g.getY()+(r.getY()-c.getY())/(y+1));if(!this.isValid(j))return this.isValid(D)?D:null;if(!this.isValid(D))return j;let z=this.transitionsBetween(_,j)+this.transitionsBetween(E,j),Q=this.transitionsBetween(_,D)+this.transitionsBetween(E,D);return z>Q?j:D}shiftToModuleCenter(t){let r=t[0],c=t[1],h=t[2],g=t[3],p=this.transitionsBetween(r,g)+1,y=this.transitionsBetween(h,g)+1,_=bn.shiftPoint(r,c,y*4),E=bn.shiftPoint(h,c,p*4);p=this.transitionsBetween(_,g)+1,y=this.transitionsBetween(E,g)+1,(p&1)===1&&(p+=1),(y&1)===1&&(y+=1);let j=(r.getX()+c.getX()+h.getX()+g.getX())/4,D=(r.getY()+c.getY()+h.getY()+g.getY())/4;r=bn.moveAway(r,j,D),c=bn.moveAway(c,j,D),h=bn.moveAway(h,j,D),g=bn.moveAway(g,j,D);let z,Q;return _=bn.shiftPoint(r,c,y*4),_=bn.shiftPoint(_,g,p*4),z=bn.shiftPoint(c,r,y*4),z=bn.shiftPoint(z,h,p*4),E=bn.shiftPoint(h,g,y*4),E=bn.shiftPoint(E,c,p*4),Q=bn.shiftPoint(g,h,y*4),Q=bn.shiftPoint(Q,r,p*4),[_,z,E,Q]}isValid(t){return t.getX()>=0&&t.getX()<this.image.getWidth()&&t.getY()>0&&t.getY()<this.image.getHeight()}static sampleGrid(t,r,c,h,g,p,y){return sn.getInstance().sampleGrid(t,p,y,.5,.5,p-.5,.5,p-.5,y-.5,.5,y-.5,r.getX(),r.getY(),g.getX(),g.getY(),h.getX(),h.getY(),c.getX(),c.getY())}transitionsBetween(t,r){let c=Math.trunc(t.getX()),h=Math.trunc(t.getY()),g=Math.trunc(r.getX()),p=Math.trunc(r.getY()),y=Math.abs(p-h)>Math.abs(g-c);if(y){let se=c;c=h,h=se,se=g,g=p,p=se}let _=Math.abs(g-c),E=Math.abs(p-h),j=-_/2,D=h<p?1:-1,z=c<g?1:-1,Q=0,te=this.image.get(y?h:c,y?c:h);for(let se=c,le=h;se!==g;se+=z){let pe=this.image.get(y?le:se,y?se:le);if(pe!==te&&(Q++,te=pe),j+=E,j>0){if(le===p)break;le+=D,j-=_}}return Q}}class _a{constructor(){this.decoder=new ld}decode(t,r=null){let c,h;if(r!=null&&r.has(W.PURE_BARCODE)){const E=_a.extractPureBits(t.getBlackMatrix());c=this.decoder.decode(E),h=_a.NO_POINTS}else{const E=new bn(t.getBlackMatrix()).detect();c=this.decoder.decode(E.getBits()),h=E.getPoints()}const g=c.getRawBytes(),p=new Ue(c.getText(),g,8*g.length,h,Ne.DATA_MATRIX,L.currentTimeMillis()),y=c.getByteSegments();y!=null&&p.putMetadata(De.BYTE_SEGMENTS,y);const _=c.getECLevel();return _!=null&&p.putMetadata(De.ERROR_CORRECTION_LEVEL,_),p}reset(){}static extractPureBits(t){const r=t.getTopLeftOnBit(),c=t.getBottomRightOnBit();if(r==null||c==null)throw new V;const h=this.moduleSize(r,t);let g=r[1];const p=c[1];let y=r[0];const E=(c[0]-y+1)/h,j=(p-g+1)/h;if(E<=0||j<=0)throw new V;const D=h/2;g+=D,y+=D;const z=new Ie(E,j);for(let Q=0;Q<j;Q++){const te=g+Q*h;for(let se=0;se<E;se++)t.get(y+se*h,te)&&z.set(se,Q)}return z}static moduleSize(t,r){const c=r.getWidth();let h=t[0];const g=t[1];for(;h<c&&r.get(h,g);)h++;if(h===c)throw new V;const p=h-t[0];if(p===0)throw new V;return p}}_a.NO_POINTS=[];class Zi extends Le{constructor(t=500){super(new _a,t)}}var Ar;(function(k){k[k.L=0]="L",k[k.M=1]="M",k[k.Q=2]="Q",k[k.H=3]="H"})(Ar||(Ar={}));class Tt{constructor(t,r,c){this.value=t,this.stringValue=r,this.bits=c,Tt.FOR_BITS.set(c,this),Tt.FOR_VALUE.set(t,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(t){switch(t){case"L":return Tt.L;case"M":return Tt.M;case"Q":return Tt.Q;case"H":return Tt.H;default:throw new A(t+"not available")}}toString(){return this.stringValue}equals(t){if(!(t instanceof Tt))return!1;const r=t;return this.value===r.value}static forBits(t){if(t<0||t>=Tt.FOR_BITS.size)throw new N;return Tt.FOR_BITS.get(t)}}Tt.FOR_BITS=new Map,Tt.FOR_VALUE=new Map,Tt.L=new Tt(Ar.L,"L",1),Tt.M=new Tt(Ar.M,"M",0),Tt.Q=new Tt(Ar.Q,"Q",3),Tt.H=new Tt(Ar.H,"H",2);class Wn{constructor(t){this.errorCorrectionLevel=Tt.forBits(t>>3&3),this.dataMask=t&7}static numBitsDiffering(t,r){return P.bitCount(t^r)}static decodeFormatInformation(t,r){const c=Wn.doDecodeFormatInformation(t,r);return c!==null?c:Wn.doDecodeFormatInformation(t^Wn.FORMAT_INFO_MASK_QR,r^Wn.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(t,r){let c=Number.MAX_SAFE_INTEGER,h=0;for(const g of Wn.FORMAT_INFO_DECODE_LOOKUP){const p=g[0];if(p===t||p===r)return new Wn(g[1]);let y=Wn.numBitsDiffering(t,p);y<c&&(h=g[1],c=y),t!==r&&(y=Wn.numBitsDiffering(r,p),y<c&&(h=g[1],c=y))}return c<=3?new Wn(h):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(t){if(!(t instanceof Wn))return!1;const r=t;return this.errorCorrectionLevel===r.errorCorrectionLevel&&this.dataMask===r.dataMask}}Wn.FORMAT_INFO_MASK_QR=21522,Wn.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class ce{constructor(t,...r){this.ecCodewordsPerBlock=t,this.ecBlocks=r}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let t=0;const r=this.ecBlocks;for(const c of r)t+=c.getCount();return t}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class Y{constructor(t,r){this.count=t,this.dataCodewords=r}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ze{constructor(t,r,...c){this.versionNumber=t,this.alignmentPatternCenters=r,this.ecBlocks=c;let h=0;const g=c[0].getECCodewordsPerBlock(),p=c[0].getECBlocks();for(const y of p)h+=y.getCount()*(y.getDataCodewords()+g);this.totalCodewords=h}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(t){return this.ecBlocks[t.getValue()]}static getProvisionalVersionForDimension(t){if(t%4!==1)throw new X;try{return this.getVersionForNumber((t-17)/4)}catch{throw new X}}static getVersionForNumber(t){if(t<1||t>40)throw new N;return Ze.VERSIONS[t-1]}static decodeVersionInformation(t){let r=Number.MAX_SAFE_INTEGER,c=0;for(let h=0;h<Ze.VERSION_DECODE_INFO.length;h++){const g=Ze.VERSION_DECODE_INFO[h];if(g===t)return Ze.getVersionForNumber(h+7);const p=Wn.numBitsDiffering(t,g);p<r&&(c=h+7,r=p)}return r<=3?Ze.getVersionForNumber(c):null}buildFunctionPattern(){const t=this.getDimensionForVersion(),r=new Ie(t);r.setRegion(0,0,9,9),r.setRegion(t-8,0,8,9),r.setRegion(0,t-8,9,8);const c=this.alignmentPatternCenters.length;for(let h=0;h<c;h++){const g=this.alignmentPatternCenters[h]-2;for(let p=0;p<c;p++)h===0&&(p===0||p===c-1)||h===c-1&&p===0||r.setRegion(this.alignmentPatternCenters[p]-2,g,5,5)}return r.setRegion(6,9,1,t-17),r.setRegion(9,6,t-17,1),this.versionNumber>6&&(r.setRegion(t-11,0,3,6),r.setRegion(0,t-11,6,3)),r}toString(){return""+this.versionNumber}}Ze.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Ze.VERSIONS=[new Ze(1,new Int32Array(0),new ce(7,new Y(1,19)),new ce(10,new Y(1,16)),new ce(13,new Y(1,13)),new ce(17,new Y(1,9))),new Ze(2,Int32Array.from([6,18]),new ce(10,new Y(1,34)),new ce(16,new Y(1,28)),new ce(22,new Y(1,22)),new ce(28,new Y(1,16))),new Ze(3,Int32Array.from([6,22]),new ce(15,new Y(1,55)),new ce(26,new Y(1,44)),new ce(18,new Y(2,17)),new ce(22,new Y(2,13))),new Ze(4,Int32Array.from([6,26]),new ce(20,new Y(1,80)),new ce(18,new Y(2,32)),new ce(26,new Y(2,24)),new ce(16,new Y(4,9))),new Ze(5,Int32Array.from([6,30]),new ce(26,new Y(1,108)),new ce(24,new Y(2,43)),new ce(18,new Y(2,15),new Y(2,16)),new ce(22,new Y(2,11),new Y(2,12))),new Ze(6,Int32Array.from([6,34]),new ce(18,new Y(2,68)),new ce(16,new Y(4,27)),new ce(24,new Y(4,19)),new ce(28,new Y(4,15))),new Ze(7,Int32Array.from([6,22,38]),new ce(20,new Y(2,78)),new ce(18,new Y(4,31)),new ce(18,new Y(2,14),new Y(4,15)),new ce(26,new Y(4,13),new Y(1,14))),new Ze(8,Int32Array.from([6,24,42]),new ce(24,new Y(2,97)),new ce(22,new Y(2,38),new Y(2,39)),new ce(22,new Y(4,18),new Y(2,19)),new ce(26,new Y(4,14),new Y(2,15))),new Ze(9,Int32Array.from([6,26,46]),new ce(30,new Y(2,116)),new ce(22,new Y(3,36),new Y(2,37)),new ce(20,new Y(4,16),new Y(4,17)),new ce(24,new Y(4,12),new Y(4,13))),new Ze(10,Int32Array.from([6,28,50]),new ce(18,new Y(2,68),new Y(2,69)),new ce(26,new Y(4,43),new Y(1,44)),new ce(24,new Y(6,19),new Y(2,20)),new ce(28,new Y(6,15),new Y(2,16))),new Ze(11,Int32Array.from([6,30,54]),new ce(20,new Y(4,81)),new ce(30,new Y(1,50),new Y(4,51)),new ce(28,new Y(4,22),new Y(4,23)),new ce(24,new Y(3,12),new Y(8,13))),new Ze(12,Int32Array.from([6,32,58]),new ce(24,new Y(2,92),new Y(2,93)),new ce(22,new Y(6,36),new Y(2,37)),new ce(26,new Y(4,20),new Y(6,21)),new ce(28,new Y(7,14),new Y(4,15))),new Ze(13,Int32Array.from([6,34,62]),new ce(26,new Y(4,107)),new ce(22,new Y(8,37),new Y(1,38)),new ce(24,new Y(8,20),new Y(4,21)),new ce(22,new Y(12,11),new Y(4,12))),new Ze(14,Int32Array.from([6,26,46,66]),new ce(30,new Y(3,115),new Y(1,116)),new ce(24,new Y(4,40),new Y(5,41)),new ce(20,new Y(11,16),new Y(5,17)),new ce(24,new Y(11,12),new Y(5,13))),new Ze(15,Int32Array.from([6,26,48,70]),new ce(22,new Y(5,87),new Y(1,88)),new ce(24,new Y(5,41),new Y(5,42)),new ce(30,new Y(5,24),new Y(7,25)),new ce(24,new Y(11,12),new Y(7,13))),new Ze(16,Int32Array.from([6,26,50,74]),new ce(24,new Y(5,98),new Y(1,99)),new ce(28,new Y(7,45),new Y(3,46)),new ce(24,new Y(15,19),new Y(2,20)),new ce(30,new Y(3,15),new Y(13,16))),new Ze(17,Int32Array.from([6,30,54,78]),new ce(28,new Y(1,107),new Y(5,108)),new ce(28,new Y(10,46),new Y(1,47)),new ce(28,new Y(1,22),new Y(15,23)),new ce(28,new Y(2,14),new Y(17,15))),new Ze(18,Int32Array.from([6,30,56,82]),new ce(30,new Y(5,120),new Y(1,121)),new ce(26,new Y(9,43),new Y(4,44)),new ce(28,new Y(17,22),new Y(1,23)),new ce(28,new Y(2,14),new Y(19,15))),new Ze(19,Int32Array.from([6,30,58,86]),new ce(28,new Y(3,113),new Y(4,114)),new ce(26,new Y(3,44),new Y(11,45)),new ce(26,new Y(17,21),new Y(4,22)),new ce(26,new Y(9,13),new Y(16,14))),new Ze(20,Int32Array.from([6,34,62,90]),new ce(28,new Y(3,107),new Y(5,108)),new ce(26,new Y(3,41),new Y(13,42)),new ce(30,new Y(15,24),new Y(5,25)),new ce(28,new Y(15,15),new Y(10,16))),new Ze(21,Int32Array.from([6,28,50,72,94]),new ce(28,new Y(4,116),new Y(4,117)),new ce(26,new Y(17,42)),new ce(28,new Y(17,22),new Y(6,23)),new ce(30,new Y(19,16),new Y(6,17))),new Ze(22,Int32Array.from([6,26,50,74,98]),new ce(28,new Y(2,111),new Y(7,112)),new ce(28,new Y(17,46)),new ce(30,new Y(7,24),new Y(16,25)),new ce(24,new Y(34,13))),new Ze(23,Int32Array.from([6,30,54,78,102]),new ce(30,new Y(4,121),new Y(5,122)),new ce(28,new Y(4,47),new Y(14,48)),new ce(30,new Y(11,24),new Y(14,25)),new ce(30,new Y(16,15),new Y(14,16))),new Ze(24,Int32Array.from([6,28,54,80,106]),new ce(30,new Y(6,117),new Y(4,118)),new ce(28,new Y(6,45),new Y(14,46)),new ce(30,new Y(11,24),new Y(16,25)),new ce(30,new Y(30,16),new Y(2,17))),new Ze(25,Int32Array.from([6,32,58,84,110]),new ce(26,new Y(8,106),new Y(4,107)),new ce(28,new Y(8,47),new Y(13,48)),new ce(30,new Y(7,24),new Y(22,25)),new ce(30,new Y(22,15),new Y(13,16))),new Ze(26,Int32Array.from([6,30,58,86,114]),new ce(28,new Y(10,114),new Y(2,115)),new ce(28,new Y(19,46),new Y(4,47)),new ce(28,new Y(28,22),new Y(6,23)),new ce(30,new Y(33,16),new Y(4,17))),new Ze(27,Int32Array.from([6,34,62,90,118]),new ce(30,new Y(8,122),new Y(4,123)),new ce(28,new Y(22,45),new Y(3,46)),new ce(30,new Y(8,23),new Y(26,24)),new ce(30,new Y(12,15),new Y(28,16))),new Ze(28,Int32Array.from([6,26,50,74,98,122]),new ce(30,new Y(3,117),new Y(10,118)),new ce(28,new Y(3,45),new Y(23,46)),new ce(30,new Y(4,24),new Y(31,25)),new ce(30,new Y(11,15),new Y(31,16))),new Ze(29,Int32Array.from([6,30,54,78,102,126]),new ce(30,new Y(7,116),new Y(7,117)),new ce(28,new Y(21,45),new Y(7,46)),new ce(30,new Y(1,23),new Y(37,24)),new ce(30,new Y(19,15),new Y(26,16))),new Ze(30,Int32Array.from([6,26,52,78,104,130]),new ce(30,new Y(5,115),new Y(10,116)),new ce(28,new Y(19,47),new Y(10,48)),new ce(30,new Y(15,24),new Y(25,25)),new ce(30,new Y(23,15),new Y(25,16))),new Ze(31,Int32Array.from([6,30,56,82,108,134]),new ce(30,new Y(13,115),new Y(3,116)),new ce(28,new Y(2,46),new Y(29,47)),new ce(30,new Y(42,24),new Y(1,25)),new ce(30,new Y(23,15),new Y(28,16))),new Ze(32,Int32Array.from([6,34,60,86,112,138]),new ce(30,new Y(17,115)),new ce(28,new Y(10,46),new Y(23,47)),new ce(30,new Y(10,24),new Y(35,25)),new ce(30,new Y(19,15),new Y(35,16))),new Ze(33,Int32Array.from([6,30,58,86,114,142]),new ce(30,new Y(17,115),new Y(1,116)),new ce(28,new Y(14,46),new Y(21,47)),new ce(30,new Y(29,24),new Y(19,25)),new ce(30,new Y(11,15),new Y(46,16))),new Ze(34,Int32Array.from([6,34,62,90,118,146]),new ce(30,new Y(13,115),new Y(6,116)),new ce(28,new Y(14,46),new Y(23,47)),new ce(30,new Y(44,24),new Y(7,25)),new ce(30,new Y(59,16),new Y(1,17))),new Ze(35,Int32Array.from([6,30,54,78,102,126,150]),new ce(30,new Y(12,121),new Y(7,122)),new ce(28,new Y(12,47),new Y(26,48)),new ce(30,new Y(39,24),new Y(14,25)),new ce(30,new Y(22,15),new Y(41,16))),new Ze(36,Int32Array.from([6,24,50,76,102,128,154]),new ce(30,new Y(6,121),new Y(14,122)),new ce(28,new Y(6,47),new Y(34,48)),new ce(30,new Y(46,24),new Y(10,25)),new ce(30,new Y(2,15),new Y(64,16))),new Ze(37,Int32Array.from([6,28,54,80,106,132,158]),new ce(30,new Y(17,122),new Y(4,123)),new ce(28,new Y(29,46),new Y(14,47)),new ce(30,new Y(49,24),new Y(10,25)),new ce(30,new Y(24,15),new Y(46,16))),new Ze(38,Int32Array.from([6,32,58,84,110,136,162]),new ce(30,new Y(4,122),new Y(18,123)),new ce(28,new Y(13,46),new Y(32,47)),new ce(30,new Y(48,24),new Y(14,25)),new ce(30,new Y(42,15),new Y(32,16))),new Ze(39,Int32Array.from([6,26,54,82,110,138,166]),new ce(30,new Y(20,117),new Y(4,118)),new ce(28,new Y(40,47),new Y(7,48)),new ce(30,new Y(43,24),new Y(22,25)),new ce(30,new Y(10,15),new Y(67,16))),new Ze(40,Int32Array.from([6,30,58,86,114,142,170]),new ce(30,new Y(19,118),new Y(6,119)),new ce(28,new Y(18,47),new Y(31,48)),new ce(30,new Y(34,24),new Y(34,25)),new ce(30,new Y(20,15),new Y(61,16)))];var Vn;(function(k){k[k.DATA_MASK_000=0]="DATA_MASK_000",k[k.DATA_MASK_001=1]="DATA_MASK_001",k[k.DATA_MASK_010=2]="DATA_MASK_010",k[k.DATA_MASK_011=3]="DATA_MASK_011",k[k.DATA_MASK_100=4]="DATA_MASK_100",k[k.DATA_MASK_101=5]="DATA_MASK_101",k[k.DATA_MASK_110=6]="DATA_MASK_110",k[k.DATA_MASK_111=7]="DATA_MASK_111"})(Vn||(Vn={}));class Es{constructor(t,r){this.value=t,this.isMasked=r}unmaskBitMatrix(t,r){for(let c=0;c<r;c++)for(let h=0;h<r;h++)this.isMasked(c,h)&&t.flip(h,c)}}Es.values=new Map([[Vn.DATA_MASK_000,new Es(Vn.DATA_MASK_000,(k,t)=>(k+t&1)===0)],[Vn.DATA_MASK_001,new Es(Vn.DATA_MASK_001,(k,t)=>(k&1)===0)],[Vn.DATA_MASK_010,new Es(Vn.DATA_MASK_010,(k,t)=>t%3===0)],[Vn.DATA_MASK_011,new Es(Vn.DATA_MASK_011,(k,t)=>(k+t)%3===0)],[Vn.DATA_MASK_100,new Es(Vn.DATA_MASK_100,(k,t)=>(Math.floor(k/2)+Math.floor(t/3)&1)===0)],[Vn.DATA_MASK_101,new Es(Vn.DATA_MASK_101,(k,t)=>k*t%6===0)],[Vn.DATA_MASK_110,new Es(Vn.DATA_MASK_110,(k,t)=>k*t%6<3)],[Vn.DATA_MASK_111,new Es(Vn.DATA_MASK_111,(k,t)=>(k+t+k*t%3&1)===0)]]);class Nr{constructor(t){const r=t.getHeight();if(r<21||(r&3)!==1)throw new X;this.bitMatrix=t}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let t=0;for(let g=0;g<6;g++)t=this.copyBit(g,8,t);t=this.copyBit(7,8,t),t=this.copyBit(8,8,t),t=this.copyBit(8,7,t);for(let g=5;g>=0;g--)t=this.copyBit(8,g,t);const r=this.bitMatrix.getHeight();let c=0;const h=r-7;for(let g=r-1;g>=h;g--)c=this.copyBit(8,g,c);for(let g=r-8;g<r;g++)c=this.copyBit(g,8,c);if(this.parsedFormatInfo=Wn.decodeFormatInformation(t,c),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new X}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const t=this.bitMatrix.getHeight(),r=Math.floor((t-17)/4);if(r<=6)return Ze.getVersionForNumber(r);let c=0;const h=t-11;for(let p=5;p>=0;p--)for(let y=t-9;y>=h;y--)c=this.copyBit(y,p,c);let g=Ze.decodeVersionInformation(c);if(g!==null&&g.getDimensionForVersion()===t)return this.parsedVersion=g,g;c=0;for(let p=5;p>=0;p--)for(let y=t-9;y>=h;y--)c=this.copyBit(p,y,c);if(g=Ze.decodeVersionInformation(c),g!==null&&g.getDimensionForVersion()===t)return this.parsedVersion=g,g;throw new X}copyBit(t,r,c){return(this.isMirror?this.bitMatrix.get(r,t):this.bitMatrix.get(t,r))?c<<1|1:c<<1}readCodewords(){const t=this.readFormatInformation(),r=this.readVersion(),c=Es.values.get(t.getDataMask()),h=this.bitMatrix.getHeight();c.unmaskBitMatrix(this.bitMatrix,h);const g=r.buildFunctionPattern();let p=!0;const y=new Uint8Array(r.getTotalCodewords());let _=0,E=0,j=0;for(let D=h-1;D>0;D-=2){D===6&&D--;for(let z=0;z<h;z++){const Q=p?h-1-z:z;for(let te=0;te<2;te++)g.get(D-te,Q)||(j++,E<<=1,this.bitMatrix.get(D-te,Q)&&(E|=1),j===8&&(y[_++]=E,j=0,E=0))}p=!p}if(_!==r.getTotalCodewords())throw new X;return y}remask(){if(this.parsedFormatInfo===null)return;const t=Es.values[this.parsedFormatInfo.getDataMask()],r=this.bitMatrix.getHeight();t.unmaskBitMatrix(this.bitMatrix,r)}setMirror(t){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=t}mirror(){const t=this.bitMatrix;for(let r=0,c=t.getWidth();r<c;r++)for(let h=r+1,g=t.getHeight();h<g;h++)t.get(r,h)!==t.get(h,r)&&(t.flip(h,r),t.flip(r,h))}}class el{constructor(t,r){this.numDataCodewords=t,this.codewords=r}static getDataBlocks(t,r,c){if(t.length!==r.getTotalCodewords())throw new N;const h=r.getECBlocksForLevel(c);let g=0;const p=h.getECBlocks();for(const te of p)g+=te.getCount();const y=new Array(g);let _=0;for(const te of p)for(let se=0;se<te.getCount();se++){const le=te.getDataCodewords(),pe=h.getECCodewordsPerBlock()+le;y[_++]=new el(le,new Uint8Array(pe))}const E=y[0].codewords.length;let j=y.length-1;for(;j>=0&&y[j].codewords.length!==E;)j--;j++;const D=E-h.getECCodewordsPerBlock();let z=0;for(let te=0;te<D;te++)for(let se=0;se<_;se++)y[se].codewords[te]=t[z++];for(let te=j;te<_;te++)y[te].codewords[D]=t[z++];const Q=y[0].codewords.length;for(let te=D;te<Q;te++)for(let se=0;se<_;se++){const le=se<j?te:te+1;y[se].codewords[le]=t[z++]}return y}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var As;(function(k){k[k.TERMINATOR=0]="TERMINATOR",k[k.NUMERIC=1]="NUMERIC",k[k.ALPHANUMERIC=2]="ALPHANUMERIC",k[k.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",k[k.BYTE=4]="BYTE",k[k.ECI=5]="ECI",k[k.KANJI=6]="KANJI",k[k.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",k[k.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",k[k.HANZI=9]="HANZI"})(As||(As={}));class at{constructor(t,r,c,h){this.value=t,this.stringValue=r,this.characterCountBitsForVersions=c,this.bits=h,at.FOR_BITS.set(h,this),at.FOR_VALUE.set(t,this)}static forBits(t){const r=at.FOR_BITS.get(t);if(r===void 0)throw new N;return r}getCharacterCountBits(t){const r=t.getVersionNumber();let c;return r<=9?c=0:r<=26?c=1:c=2,this.characterCountBitsForVersions[c]}getValue(){return this.value}getBits(){return this.bits}equals(t){if(!(t instanceof at))return!1;const r=t;return this.value===r.value}toString(){return this.stringValue}}at.FOR_BITS=new Map,at.FOR_VALUE=new Map,at.TERMINATOR=new at(As.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),at.NUMERIC=new at(As.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),at.ALPHANUMERIC=new at(As.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),at.STRUCTURED_APPEND=new at(As.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),at.BYTE=new at(As.BYTE,"BYTE",Int32Array.from([8,16,16]),4),at.ECI=new at(As.ECI,"ECI",Int32Array.from([0,0,0]),7),at.KANJI=new at(As.KANJI,"KANJI",Int32Array.from([8,10,12]),8),at.FNC1_FIRST_POSITION=new at(As.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),at.FNC1_SECOND_POSITION=new at(As.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),at.HANZI=new at(As.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class fn{static decode(t,r,c,h){const g=new Ys(t);let p=new be;const y=new Array;let _=-1,E=-1;try{let j=null,D=!1,z;do{if(g.available()<4)z=at.TERMINATOR;else{const Q=g.readBits(4);z=at.forBits(Q)}switch(z){case at.TERMINATOR:break;case at.FNC1_FIRST_POSITION:case at.FNC1_SECOND_POSITION:D=!0;break;case at.STRUCTURED_APPEND:if(g.available()<16)throw new X;_=g.readBits(8),E=g.readBits(8);break;case at.ECI:const Q=fn.parseECIValue(g);if(j=q.getCharacterSetECIByValue(Q),j===null)throw new X;break;case at.HANZI:const te=g.readBits(4),se=g.readBits(z.getCharacterCountBits(r));te===fn.GB2312_SUBSET&&fn.decodeHanziSegment(g,p,se);break;default:const le=g.readBits(z.getCharacterCountBits(r));switch(z){case at.NUMERIC:fn.decodeNumericSegment(g,p,le);break;case at.ALPHANUMERIC:fn.decodeAlphanumericSegment(g,p,le,D);break;case at.BYTE:fn.decodeByteSegment(g,p,le,j,y,h);break;case at.KANJI:fn.decodeKanjiSegment(g,p,le);break;default:throw new X}break}}while(z!==at.TERMINATOR)}catch{throw new X}return new Ce(t,p.toString(),y.length===0?null:y,c===null?null:c.toString(),_,E)}static decodeHanziSegment(t,r,c){if(c*13>t.available())throw new X;const h=new Uint8Array(2*c);let g=0;for(;c>0;){const p=t.readBits(13);let y=p/96<<8&4294967295|p%96;y<959?y+=41377:y+=42657,h[g]=y>>8&255,h[g+1]=y&255,g+=2,c--}try{r.append(ge.decode(h,ie.GB2312))}catch(p){throw new X(p)}}static decodeKanjiSegment(t,r,c){if(c*13>t.available())throw new X;const h=new Uint8Array(2*c);let g=0;for(;c>0;){const p=t.readBits(13);let y=p/192<<8&4294967295|p%192;y<7936?y+=33088:y+=49472,h[g]=y>>8,h[g+1]=y,g+=2,c--}try{r.append(ge.decode(h,ie.SHIFT_JIS))}catch(p){throw new X(p)}}static decodeByteSegment(t,r,c,h,g,p){if(8*c>t.available())throw new X;const y=new Uint8Array(c);for(let E=0;E<c;E++)y[E]=t.readBits(8);let _;h===null?_=ie.guessEncoding(y,p):_=h.getName();try{r.append(ge.decode(y,_))}catch(E){throw new X(E)}g.push(y)}static toAlphaNumericChar(t){if(t>=fn.ALPHANUMERIC_CHARS.length)throw new X;return fn.ALPHANUMERIC_CHARS[t]}static decodeAlphanumericSegment(t,r,c,h){const g=r.length();for(;c>1;){if(t.available()<11)throw new X;const p=t.readBits(11);r.append(fn.toAlphaNumericChar(Math.floor(p/45))),r.append(fn.toAlphaNumericChar(p%45)),c-=2}if(c===1){if(t.available()<6)throw new X;r.append(fn.toAlphaNumericChar(t.readBits(6)))}if(h)for(let p=g;p<r.length();p++)r.charAt(p)==="%"&&(p<r.length()-1&&r.charAt(p+1)==="%"?r.deleteCharAt(p+1):r.setCharAt(p,""))}static decodeNumericSegment(t,r,c){for(;c>=3;){if(t.available()<10)throw new X;const h=t.readBits(10);if(h>=1e3)throw new X;r.append(fn.toAlphaNumericChar(Math.floor(h/100))),r.append(fn.toAlphaNumericChar(Math.floor(h/10)%10)),r.append(fn.toAlphaNumericChar(h%10)),c-=3}if(c===2){if(t.available()<7)throw new X;const h=t.readBits(7);if(h>=100)throw new X;r.append(fn.toAlphaNumericChar(Math.floor(h/10))),r.append(fn.toAlphaNumericChar(h%10))}else if(c===1){if(t.available()<4)throw new X;const h=t.readBits(4);if(h>=10)throw new X;r.append(fn.toAlphaNumericChar(h))}}static parseECIValue(t){const r=t.readBits(8);if((r&128)===0)return r&127;if((r&192)===128){const c=t.readBits(8);return(r&63)<<8&4294967295|c}if((r&224)===192){const c=t.readBits(16);return(r&31)<<16&4294967295|c}throw new X}}fn.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",fn.GB2312_SUBSET=1;class lc{constructor(t){this.mirrored=t}isMirrored(){return this.mirrored}applyMirroredCorrection(t){if(!this.mirrored||t===null||t.length<3)return;const r=t[0];t[0]=t[2],t[2]=r}}class cd{constructor(){this.rsDecoder=new cn(ft.QR_CODE_FIELD_256)}decodeBooleanArray(t,r){return this.decodeBitMatrix(Ie.parseFromBooleanArray(t),r)}decodeBitMatrix(t,r){const c=new Nr(t);let h=null;try{return this.decodeBitMatrixParser(c,r)}catch(g){h=g}try{c.remask(),c.setMirror(!0),c.readVersion(),c.readFormatInformation(),c.mirror();const g=this.decodeBitMatrixParser(c,r);return g.setOther(new lc(!0)),g}catch(g){throw h!==null?h:g}}decodeBitMatrixParser(t,r){const c=t.readVersion(),h=t.readFormatInformation().getErrorCorrectionLevel(),g=t.readCodewords(),p=el.getDataBlocks(g,c,h);let y=0;for(const j of p)y+=j.getNumDataCodewords();const _=new Uint8Array(y);let E=0;for(const j of p){const D=j.getCodewords(),z=j.getNumDataCodewords();this.correctErrors(D,z);for(let Q=0;Q<z;Q++)_[E++]=D[Q]}return fn.decode(_,c,h,r)}correctErrors(t,r){const c=new Int32Array(t);try{this.rsDecoder.decode(c,t.length-r)}catch{throw new T}for(let h=0;h<r;h++)t[h]=c[h]}}class Tr extends ze{constructor(t,r,c){super(t,r),this.estimatedModuleSize=c}aboutEquals(t,r,c){if(Math.abs(r-this.getY())<=t&&Math.abs(c-this.getX())<=t){const h=Math.abs(t-this.estimatedModuleSize);return h<=1||h<=this.estimatedModuleSize}return!1}combineEstimate(t,r,c){const h=(this.getX()+r)/2,g=(this.getY()+t)/2,p=(this.estimatedModuleSize+c)/2;return new Tr(h,g,p)}}class ks{constructor(t,r,c,h,g,p,y){this.image=t,this.startX=r,this.startY=c,this.width=h,this.height=g,this.moduleSize=p,this.resultPointCallback=y,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const t=this.startX,r=this.height,c=this.width,h=t+c,g=this.startY+r/2,p=new Int32Array(3),y=this.image;for(let _=0;_<r;_++){const E=g+((_&1)===0?Math.floor((_+1)/2):-Math.floor((_+1)/2));p[0]=0,p[1]=0,p[2]=0;let j=t;for(;j<h&&!y.get(j,E);)j++;let D=0;for(;j<h;){if(y.get(j,E))if(D===1)p[1]++;else if(D===2){if(this.foundPatternCross(p)){const z=this.handlePossibleCenter(p,E,j);if(z!==null)return z}p[0]=p[2],p[1]=1,p[2]=0,D=1}else p[++D]++;else D===1&&D++,p[D]++;j++}if(this.foundPatternCross(p)){const z=this.handlePossibleCenter(p,E,h);if(z!==null)return z}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new V}static centerFromEnd(t,r){return r-t[2]-t[1]/2}foundPatternCross(t){const r=this.moduleSize,c=r/2;for(let h=0;h<3;h++)if(Math.abs(r-t[h])>=c)return!1;return!0}crossCheckVertical(t,r,c,h){const g=this.image,p=g.getHeight(),y=this.crossCheckStateCount;y[0]=0,y[1]=0,y[2]=0;let _=t;for(;_>=0&&g.get(r,_)&&y[1]<=c;)y[1]++,_--;if(_<0||y[1]>c)return NaN;for(;_>=0&&!g.get(r,_)&&y[0]<=c;)y[0]++,_--;if(y[0]>c)return NaN;for(_=t+1;_<p&&g.get(r,_)&&y[1]<=c;)y[1]++,_++;if(_===p||y[1]>c)return NaN;for(;_<p&&!g.get(r,_)&&y[2]<=c;)y[2]++,_++;if(y[2]>c)return NaN;const E=y[0]+y[1]+y[2];return 5*Math.abs(E-h)>=2*h?NaN:this.foundPatternCross(y)?ks.centerFromEnd(y,_):NaN}handlePossibleCenter(t,r,c){const h=t[0]+t[1]+t[2],g=ks.centerFromEnd(t,c),p=this.crossCheckVertical(r,g,2*t[1],h);if(!isNaN(p)){const y=(t[0]+t[1]+t[2])/3;for(const E of this.possibleCenters)if(E.aboutEquals(y,p,g))return E.combineEstimate(p,g,y);const _=new Tr(g,p,y);this.possibleCenters.push(_),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(_)}return null}}class mi extends ze{constructor(t,r,c,h){super(t,r),this.estimatedModuleSize=c,this.count=h,h===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(t,r,c){if(Math.abs(r-this.getY())<=t&&Math.abs(c-this.getX())<=t){const h=Math.abs(t-this.estimatedModuleSize);return h<=1||h<=this.estimatedModuleSize}return!1}combineEstimate(t,r,c){const h=this.count+1,g=(this.count*this.getX()+r)/h,p=(this.count*this.getY()+t)/h,y=(this.count*this.estimatedModuleSize+c)/h;return new mi(g,p,y,h)}}class tl{constructor(t){this.bottomLeft=t[0],this.topLeft=t[1],this.topRight=t[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class vn{constructor(t,r){this.image=t,this.resultPointCallback=r,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=r}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(t){const r=t!=null&&t.get(W.TRY_HARDER)!==void 0,c=t!=null&&t.get(W.PURE_BARCODE)!==void 0,h=this.image,g=h.getHeight(),p=h.getWidth();let y=Math.floor(3*g/(4*vn.MAX_MODULES));(y<vn.MIN_SKIP||r)&&(y=vn.MIN_SKIP);let _=!1;const E=new Int32Array(5);for(let D=y-1;D<g&&!_;D+=y){E[0]=0,E[1]=0,E[2]=0,E[3]=0,E[4]=0;let z=0;for(let Q=0;Q<p;Q++)if(h.get(Q,D))(z&1)===1&&z++,E[z]++;else if((z&1)===0)if(z===4)if(vn.foundPatternCross(E)){if(this.handlePossibleCenter(E,D,Q,c)===!0)if(y=2,this.hasSkipped===!0)_=this.haveMultiplyConfirmedCenters();else{const se=this.findRowSkip();se>E[2]&&(D+=se-E[2]-y,Q=p-1)}else{E[0]=E[2],E[1]=E[3],E[2]=E[4],E[3]=1,E[4]=0,z=3;continue}z=0,E[0]=0,E[1]=0,E[2]=0,E[3]=0,E[4]=0}else E[0]=E[2],E[1]=E[3],E[2]=E[4],E[3]=1,E[4]=0,z=3;else E[++z]++;else E[z]++;vn.foundPatternCross(E)&&this.handlePossibleCenter(E,D,p,c)===!0&&(y=E[0],this.hasSkipped&&(_=this.haveMultiplyConfirmedCenters()))}const j=this.selectBestPatterns();return ze.orderBestPatterns(j),new tl(j)}static centerFromEnd(t,r){return r-t[4]-t[3]-t[2]/2}static foundPatternCross(t){let r=0;for(let g=0;g<5;g++){const p=t[g];if(p===0)return!1;r+=p}if(r<7)return!1;const c=r/7,h=c/2;return Math.abs(c-t[0])<h&&Math.abs(c-t[1])<h&&Math.abs(3*c-t[2])<3*h&&Math.abs(c-t[3])<h&&Math.abs(c-t[4])<h}getCrossCheckStateCount(){const t=this.crossCheckStateCount;return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t}crossCheckDiagonal(t,r,c,h){const g=this.getCrossCheckStateCount();let p=0;const y=this.image;for(;t>=p&&r>=p&&y.get(r-p,t-p);)g[2]++,p++;if(t<p||r<p)return!1;for(;t>=p&&r>=p&&!y.get(r-p,t-p)&&g[1]<=c;)g[1]++,p++;if(t<p||r<p||g[1]>c)return!1;for(;t>=p&&r>=p&&y.get(r-p,t-p)&&g[0]<=c;)g[0]++,p++;if(g[0]>c)return!1;const _=y.getHeight(),E=y.getWidth();for(p=1;t+p<_&&r+p<E&&y.get(r+p,t+p);)g[2]++,p++;if(t+p>=_||r+p>=E)return!1;for(;t+p<_&&r+p<E&&!y.get(r+p,t+p)&&g[3]<c;)g[3]++,p++;if(t+p>=_||r+p>=E||g[3]>=c)return!1;for(;t+p<_&&r+p<E&&y.get(r+p,t+p)&&g[4]<c;)g[4]++,p++;if(g[4]>=c)return!1;const j=g[0]+g[1]+g[2]+g[3]+g[4];return Math.abs(j-h)<2*h&&vn.foundPatternCross(g)}crossCheckVertical(t,r,c,h){const g=this.image,p=g.getHeight(),y=this.getCrossCheckStateCount();let _=t;for(;_>=0&&g.get(r,_);)y[2]++,_--;if(_<0)return NaN;for(;_>=0&&!g.get(r,_)&&y[1]<=c;)y[1]++,_--;if(_<0||y[1]>c)return NaN;for(;_>=0&&g.get(r,_)&&y[0]<=c;)y[0]++,_--;if(y[0]>c)return NaN;for(_=t+1;_<p&&g.get(r,_);)y[2]++,_++;if(_===p)return NaN;for(;_<p&&!g.get(r,_)&&y[3]<c;)y[3]++,_++;if(_===p||y[3]>=c)return NaN;for(;_<p&&g.get(r,_)&&y[4]<c;)y[4]++,_++;if(y[4]>=c)return NaN;const E=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(E-h)>=2*h?NaN:vn.foundPatternCross(y)?vn.centerFromEnd(y,_):NaN}crossCheckHorizontal(t,r,c,h){const g=this.image,p=g.getWidth(),y=this.getCrossCheckStateCount();let _=t;for(;_>=0&&g.get(_,r);)y[2]++,_--;if(_<0)return NaN;for(;_>=0&&!g.get(_,r)&&y[1]<=c;)y[1]++,_--;if(_<0||y[1]>c)return NaN;for(;_>=0&&g.get(_,r)&&y[0]<=c;)y[0]++,_--;if(y[0]>c)return NaN;for(_=t+1;_<p&&g.get(_,r);)y[2]++,_++;if(_===p)return NaN;for(;_<p&&!g.get(_,r)&&y[3]<c;)y[3]++,_++;if(_===p||y[3]>=c)return NaN;for(;_<p&&g.get(_,r)&&y[4]<c;)y[4]++,_++;if(y[4]>=c)return NaN;const E=y[0]+y[1]+y[2]+y[3]+y[4];return 5*Math.abs(E-h)>=h?NaN:vn.foundPatternCross(y)?vn.centerFromEnd(y,_):NaN}handlePossibleCenter(t,r,c,h){const g=t[0]+t[1]+t[2]+t[3]+t[4];let p=vn.centerFromEnd(t,c),y=this.crossCheckVertical(r,Math.floor(p),t[2],g);if(!isNaN(y)&&(p=this.crossCheckHorizontal(Math.floor(p),Math.floor(y),t[2],g),!isNaN(p)&&(!h||this.crossCheckDiagonal(Math.floor(y),Math.floor(p),t[2],g)))){const _=g/7;let E=!1;const j=this.possibleCenters;for(let D=0,z=j.length;D<z;D++){const Q=j[D];if(Q.aboutEquals(_,y,p)){j[D]=Q.combineEstimate(y,p,_),E=!0;break}}if(!E){const D=new mi(p,y,_);j.push(D),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(D)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let r=null;for(const c of this.possibleCenters)if(c.getCount()>=vn.CENTER_QUORUM)if(r==null)r=c;else return this.hasSkipped=!0,Math.floor((Math.abs(r.getX()-c.getX())-Math.abs(r.getY()-c.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let t=0,r=0;const c=this.possibleCenters.length;for(const p of this.possibleCenters)p.getCount()>=vn.CENTER_QUORUM&&(t++,r+=p.getEstimatedModuleSize());if(t<3)return!1;const h=r/c;let g=0;for(const p of this.possibleCenters)g+=Math.abs(p.getEstimatedModuleSize()-h);return g<=.05*r}selectBestPatterns(){const t=this.possibleCenters.length;if(t<3)throw new V;const r=this.possibleCenters;let c;if(t>3){let h=0,g=0;for(const _ of this.possibleCenters){const E=_.getEstimatedModuleSize();h+=E,g+=E*E}c=h/t;let p=Math.sqrt(g/t-c*c);r.sort((_,E)=>{const j=Math.abs(E.getEstimatedModuleSize()-c),D=Math.abs(_.getEstimatedModuleSize()-c);return j<D?-1:j>D?1:0});const y=Math.max(.2*c,p);for(let _=0;_<r.length&&r.length>3;_++){const E=r[_];Math.abs(E.getEstimatedModuleSize()-c)>y&&(r.splice(_,1),_--)}}if(r.length>3){let h=0;for(const g of r)h+=g.getEstimatedModuleSize();c=h/r.length,r.sort((g,p)=>{if(p.getCount()===g.getCount()){const y=Math.abs(p.getEstimatedModuleSize()-c),_=Math.abs(g.getEstimatedModuleSize()-c);return y<_?1:y>_?-1:0}else return p.getCount()-g.getCount()}),r.splice(3)}return[r[0],r[1],r[2]]}}vn.CENTER_QUORUM=2,vn.MIN_SKIP=3,vn.MAX_MODULES=57;class ca{constructor(t){this.image=t}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(t){this.resultPointCallback=t==null?null:t.get(W.NEED_RESULT_POINT_CALLBACK);const c=new vn(this.image,this.resultPointCallback).find(t);return this.processFinderPatternInfo(c)}processFinderPatternInfo(t){const r=t.getTopLeft(),c=t.getTopRight(),h=t.getBottomLeft(),g=this.calculateModuleSize(r,c,h);if(g<1)throw new V("No pattern found in proccess finder.");const p=ca.computeDimension(r,c,h,g),y=Ze.getProvisionalVersionForDimension(p),_=y.getDimensionForVersion()-7;let E=null;if(y.getAlignmentPatternCenters().length>0){const Q=c.getX()-r.getX()+h.getX(),te=c.getY()-r.getY()+h.getY(),se=1-3/_,le=Math.floor(r.getX()+se*(Q-r.getX())),pe=Math.floor(r.getY()+se*(te-r.getY()));for(let Pe=4;Pe<=16;Pe<<=1)try{E=this.findAlignmentInRegion(g,le,pe,Pe);break}catch(Be){if(!(Be instanceof V))throw Be}}const j=ca.createTransform(r,c,h,E,p),D=ca.sampleGrid(this.image,j,p);let z;return E===null?z=[h,r,c]:z=[h,r,c,E],new Is(D,z)}static createTransform(t,r,c,h,g){const p=g-3.5;let y,_,E,j;return h!==null?(y=h.getX(),_=h.getY(),E=p-3,j=E):(y=r.getX()-t.getX()+c.getX(),_=r.getY()-t.getY()+c.getY(),E=p,j=p),_t.quadrilateralToQuadrilateral(3.5,3.5,p,3.5,E,j,3.5,p,t.getX(),t.getY(),r.getX(),r.getY(),y,_,c.getX(),c.getY())}static sampleGrid(t,r,c){return sn.getInstance().sampleGridWithTransform(t,c,c,r)}static computeDimension(t,r,c,h){const g=ht.round(ze.distance(t,r)/h),p=ht.round(ze.distance(t,c)/h);let y=Math.floor((g+p)/2)+7;switch(y&3){case 0:y++;break;case 2:y--;break;case 3:throw new V("Dimensions could be not found.")}return y}calculateModuleSize(t,r,c){return(this.calculateModuleSizeOneWay(t,r)+this.calculateModuleSizeOneWay(t,c))/2}calculateModuleSizeOneWay(t,r){const c=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(r.getX()),Math.floor(r.getY())),h=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(t.getX()),Math.floor(t.getY()));return isNaN(c)?h/7:isNaN(h)?c/7:(c+h)/14}sizeOfBlackWhiteBlackRunBothWays(t,r,c,h){let g=this.sizeOfBlackWhiteBlackRun(t,r,c,h),p=1,y=t-(c-t);y<0?(p=t/(t-y),y=0):y>=this.image.getWidth()&&(p=(this.image.getWidth()-1-t)/(y-t),y=this.image.getWidth()-1);let _=Math.floor(r-(h-r)*p);return p=1,_<0?(p=r/(r-_),_=0):_>=this.image.getHeight()&&(p=(this.image.getHeight()-1-r)/(_-r),_=this.image.getHeight()-1),y=Math.floor(t+(y-t)*p),g+=this.sizeOfBlackWhiteBlackRun(t,r,y,_),g-1}sizeOfBlackWhiteBlackRun(t,r,c,h){const g=Math.abs(h-r)>Math.abs(c-t);if(g){let Q=t;t=r,r=Q,Q=c,c=h,h=Q}const p=Math.abs(c-t),y=Math.abs(h-r);let _=-p/2;const E=t<c?1:-1,j=r<h?1:-1;let D=0;const z=c+E;for(let Q=t,te=r;Q!==z;Q+=E){const se=g?te:Q,le=g?Q:te;if(D===1===this.image.get(se,le)){if(D===2)return ht.distance(Q,te,t,r);D++}if(_+=y,_>0){if(te===h)break;te+=j,_-=p}}return D===2?ht.distance(c+E,h,t,r):NaN}findAlignmentInRegion(t,r,c,h){const g=Math.floor(h*t),p=Math.max(0,r-g),y=Math.min(this.image.getWidth()-1,r+g);if(y-p<t*3)throw new V("Alignment top exceeds estimated module size.");const _=Math.max(0,c-g),E=Math.min(this.image.getHeight()-1,c+g);if(E-_<t*3)throw new V("Alignment bottom exceeds estimated module size.");return new ks(this.image,p,_,y-p,E-_,t,this.resultPointCallback).find()}}class Sa{constructor(){this.decoder=new cd}getDecoder(){return this.decoder}decode(t,r){let c,h;if(r!=null&&r.get(W.PURE_BARCODE)!==void 0){const _=Sa.extractPureBits(t.getBlackMatrix());c=this.decoder.decodeBitMatrix(_,r),h=Sa.NO_POINTS}else{const _=new ca(t.getBlackMatrix()).detect(r);c=this.decoder.decodeBitMatrix(_.getBits(),r),h=_.getPoints()}c.getOther()instanceof lc&&c.getOther().applyMirroredCorrection(h);const g=new Ue(c.getText(),c.getRawBytes(),void 0,h,Ne.QR_CODE,void 0),p=c.getByteSegments();p!==null&&g.putMetadata(De.BYTE_SEGMENTS,p);const y=c.getECLevel();return y!==null&&g.putMetadata(De.ERROR_CORRECTION_LEVEL,y),c.hasStructuredAppend()&&(g.putMetadata(De.STRUCTURED_APPEND_SEQUENCE,c.getStructuredAppendSequenceNumber()),g.putMetadata(De.STRUCTURED_APPEND_PARITY,c.getStructuredAppendParity())),g}reset(){}static extractPureBits(t){const r=t.getTopLeftOnBit(),c=t.getBottomRightOnBit();if(r===null||c===null)throw new V;const h=this.moduleSize(r,t);let g=r[1],p=c[1],y=r[0],_=c[0];if(y>=_||g>=p)throw new V;if(p-g!==_-y&&(_=y+(p-g),_>=t.getWidth()))throw new V;const E=Math.round((_-y+1)/h),j=Math.round((p-g+1)/h);if(E<=0||j<=0)throw new V;if(j!==E)throw new V;const D=Math.floor(h/2);g+=D,y+=D;const z=y+Math.floor((E-1)*h)-_;if(z>0){if(z>D)throw new V;y-=z}const Q=g+Math.floor((j-1)*h)-p;if(Q>0){if(Q>D)throw new V;g-=Q}const te=new Ie(E,j);for(let se=0;se<j;se++){const le=g+Math.floor(se*h);for(let pe=0;pe<E;pe++)t.get(y+Math.floor(pe*h),le)&&te.set(pe,se)}return te}static moduleSize(t,r){const c=r.getHeight(),h=r.getWidth();let g=t[0],p=t[1],y=!0,_=0;for(;g<h&&p<c;){if(y!==r.get(g,p)){if(++_===5)break;y=!y}g++,p++}if(g===h||p===c)throw new V;return(g-t[0])/7}}Sa.NO_POINTS=new Array;class it{PDF417Common(){}static getBitCountSum(t){return ht.sum(t)}static toIntArray(t){if(t==null||!t.length)return it.EMPTY_INT_ARRAY;const r=new Int32Array(t.length);let c=0;for(const h of t)r[c++]=h;return r}static getCodeword(t){const r=U.binarySearch(it.SYMBOL_TABLE,t&262143);return r<0?-1:(it.CODEWORD_TABLE[r]-1)%it.NUMBER_OF_CODEWORDS}}it.NUMBER_OF_CODEWORDS=929,it.MAX_CODEWORDS_IN_BARCODE=it.NUMBER_OF_CODEWORDS-1,it.MIN_ROWS_IN_BARCODE=3,it.MAX_ROWS_IN_BARCODE=90,it.MODULES_IN_CODEWORD=17,it.MODULES_IN_STOP_PATTERN=18,it.BARS_IN_MODULE=8,it.EMPTY_INT_ARRAY=new Int32Array([]),it.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),it.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class cc{constructor(t,r){this.bits=t,this.points=r}getBits(){return this.bits}getPoints(){return this.points}}class pt{static detectMultiple(t,r,c){let h=t.getBlackMatrix(),g=pt.detect(c,h);return g.length||(h=h.clone(),h.rotate180(),g=pt.detect(c,h)),new cc(h,g)}static detect(t,r){const c=new Array;let h=0,g=0,p=!1;for(;h<r.getHeight();){const y=pt.findVertices(r,h,g);if(y[0]==null&&y[3]==null){if(!p)break;p=!1,g=0;for(const _ of c)_[1]!=null&&(h=Math.trunc(Math.max(h,_[1].getY()))),_[3]!=null&&(h=Math.max(h,Math.trunc(_[3].getY())));h+=pt.ROW_STEP;continue}if(p=!0,c.push(y),!t)break;y[2]!=null?(g=Math.trunc(y[2].getX()),h=Math.trunc(y[2].getY())):(g=Math.trunc(y[4].getX()),h=Math.trunc(y[4].getY()))}return c}static findVertices(t,r,c){const h=t.getHeight(),g=t.getWidth(),p=new Array(8);return pt.copyToResult(p,pt.findRowsWithPattern(t,h,g,r,c,pt.START_PATTERN),pt.INDEXES_START_PATTERN),p[4]!=null&&(c=Math.trunc(p[4].getX()),r=Math.trunc(p[4].getY())),pt.copyToResult(p,pt.findRowsWithPattern(t,h,g,r,c,pt.STOP_PATTERN),pt.INDEXES_STOP_PATTERN),p}static copyToResult(t,r,c){for(let h=0;h<c.length;h++)t[c[h]]=r[h]}static findRowsWithPattern(t,r,c,h,g,p){const y=new Array(4);let _=!1;const E=new Int32Array(p.length);for(;h<r;h+=pt.ROW_STEP){let D=pt.findGuardPattern(t,g,h,c,!1,p,E);if(D!=null){for(;h>0;){const z=pt.findGuardPattern(t,g,--h,c,!1,p,E);if(z!=null)D=z;else{h++;break}}y[0]=new ze(D[0],h),y[1]=new ze(D[1],h),_=!0;break}}let j=h+1;if(_){let D=0,z=Int32Array.from([Math.trunc(y[0].getX()),Math.trunc(y[1].getX())]);for(;j<r;j++){const Q=pt.findGuardPattern(t,z[0],j,c,!1,p,E);if(Q!=null&&Math.abs(z[0]-Q[0])<pt.MAX_PATTERN_DRIFT&&Math.abs(z[1]-Q[1])<pt.MAX_PATTERN_DRIFT)z=Q,D=0;else{if(D>pt.SKIPPED_ROW_COUNT_MAX)break;D++}}j-=D+1,y[2]=new ze(z[0],j),y[3]=new ze(z[1],j)}return j-h<pt.BARCODE_MIN_HEIGHT&&U.fill(y,null),y}static findGuardPattern(t,r,c,h,g,p,y){U.fillWithin(y,0,y.length,0);let _=r,E=0;for(;t.get(_,c)&&_>0&&E++<pt.MAX_PIXEL_DRIFT;)_--;let j=_,D=0,z=p.length;for(let Q=g;j<h;j++)if(t.get(j,c)!==Q)y[D]++;else{if(D===z-1){if(pt.patternMatchVariance(y,p,pt.MAX_INDIVIDUAL_VARIANCE)<pt.MAX_AVG_VARIANCE)return new Int32Array([_,j]);_+=y[0]+y[1],L.arraycopy(y,2,y,0,D-1),y[D-1]=0,y[D]=0,D--}else D++;y[D]=1,Q=!Q}return D===z-1&&pt.patternMatchVariance(y,p,pt.MAX_INDIVIDUAL_VARIANCE)<pt.MAX_AVG_VARIANCE?new Int32Array([_,j-1]):null}static patternMatchVariance(t,r,c){let h=t.length,g=0,p=0;for(let E=0;E<h;E++)g+=t[E],p+=r[E];if(g<p)return 1/0;let y=g/p;c*=y;let _=0;for(let E=0;E<h;E++){let j=t[E],D=r[E]*y,z=j>D?j-D:D-j;if(z>c)return 1/0;_+=z}return _/g}}pt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),pt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),pt.MAX_AVG_VARIANCE=.42,pt.MAX_INDIVIDUAL_VARIANCE=.8,pt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),pt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),pt.MAX_PIXEL_DRIFT=3,pt.MAX_PATTERN_DRIFT=5,pt.SKIPPED_ROW_COUNT_MAX=25,pt.ROW_STEP=5,pt.BARCODE_MIN_HEIGHT=10;class gn{constructor(t,r){if(r.length===0)throw new N;this.field=t;let c=r.length;if(c>1&&r[0]===0){let h=1;for(;h<c&&r[h]===0;)h++;h===c?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(c-h),L.arraycopy(r,h,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(t){return this.coefficients[this.coefficients.length-1-t]}evaluateAt(t){if(t===0)return this.getCoefficient(0);if(t===1){let h=0;for(let g of this.coefficients)h=this.field.add(h,g);return h}let r=this.coefficients[0],c=this.coefficients.length;for(let h=1;h<c;h++)r=this.field.add(this.field.multiply(t,r),this.coefficients[h]);return r}add(t){if(!this.field.equals(t.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero())return t;if(t.isZero())return this;let r=this.coefficients,c=t.coefficients;if(r.length>c.length){let p=r;r=c,c=p}let h=new Int32Array(c.length),g=c.length-r.length;L.arraycopy(c,0,h,0,g);for(let p=g;p<c.length;p++)h[p]=this.field.add(r[p-g],c[p]);return new gn(this.field,h)}subtract(t){if(!this.field.equals(t.field))throw new N("ModulusPolys do not have same ModulusGF field");return t.isZero()?this:this.add(t.negative())}multiply(t){return t instanceof gn?this.multiplyOther(t):this.multiplyScalar(t)}multiplyOther(t){if(!this.field.equals(t.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero()||t.isZero())return new gn(this.field,new Int32Array([0]));let r=this.coefficients,c=r.length,h=t.coefficients,g=h.length,p=new Int32Array(c+g-1);for(let y=0;y<c;y++){let _=r[y];for(let E=0;E<g;E++)p[y+E]=this.field.add(p[y+E],this.field.multiply(_,h[E]))}return new gn(this.field,p)}negative(){let t=this.coefficients.length,r=new Int32Array(t);for(let c=0;c<t;c++)r[c]=this.field.subtract(0,this.coefficients[c]);return new gn(this.field,r)}multiplyScalar(t){if(t===0)return new gn(this.field,new Int32Array([0]));if(t===1)return this;let r=this.coefficients.length,c=new Int32Array(r);for(let h=0;h<r;h++)c[h]=this.field.multiply(this.coefficients[h],t);return new gn(this.field,c)}multiplyByMonomial(t,r){if(t<0)throw new N;if(r===0)return new gn(this.field,new Int32Array([0]));let c=this.coefficients.length,h=new Int32Array(c+t);for(let g=0;g<c;g++)h[g]=this.field.multiply(this.coefficients[g],r);return new gn(this.field,h)}toString(){let t=new be;for(let r=this.getDegree();r>=0;r--){let c=this.getCoefficient(r);c!==0&&(c<0?(t.append(" - "),c=-c):t.length()>0&&t.append(" + "),(r===0||c!==1)&&t.append(c),r!==0&&(r===1?t.append("x"):(t.append("x^"),t.append(r))))}return t.toString()}}class nl{add(t,r){return(t+r)%this.modulus}subtract(t,r){return(this.modulus+t-r)%this.modulus}exp(t){return this.expTable[t]}log(t){if(t===0)throw new N;return this.logTable[t]}inverse(t){if(t===0)throw new Wt;return this.expTable[this.modulus-this.logTable[t]-1]}multiply(t,r){return t===0||r===0?0:this.expTable[(this.logTable[t]+this.logTable[r])%(this.modulus-1)]}getSize(){return this.modulus}equals(t){return t===this}}class Wa extends nl{constructor(t,r){super(),this.modulus=t,this.expTable=new Int32Array(t),this.logTable=new Int32Array(t);let c=1;for(let h=0;h<t;h++)this.expTable[h]=c,c=c*r%t;for(let h=0;h<t-1;h++)this.logTable[this.expTable[h]]=h;this.zero=new gn(this,new Int32Array([0])),this.one=new gn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(t,r){if(t<0)throw new N;if(r===0)return this.zero;let c=new Int32Array(t+1);return c[0]=r,new gn(this,c)}}Wa.PDF417_GF=new Wa(it.NUMBER_OF_CODEWORDS,3);class Ea{constructor(){this.field=Wa.PDF417_GF}decode(t,r,c){let h=new gn(this.field,t),g=new Int32Array(r),p=!1;for(let te=r;te>0;te--){let se=h.evaluateAt(this.field.exp(te));g[r-te]=se,se!==0&&(p=!0)}if(!p)return 0;let y=this.field.getOne();if(c!=null)for(const te of c){let se=this.field.exp(t.length-1-te),le=new gn(this.field,new Int32Array([this.field.subtract(0,se),1]));y=y.multiply(le)}let _=new gn(this.field,g),E=this.runEuclideanAlgorithm(this.field.buildMonomial(r,1),_,r),j=E[0],D=E[1],z=this.findErrorLocations(j),Q=this.findErrorMagnitudes(D,j,z);for(let te=0;te<z.length;te++){let se=t.length-1-this.field.log(z[te]);if(se<0)throw T.getChecksumInstance();t[se]=this.field.subtract(t[se],Q[te])}return z.length}runEuclideanAlgorithm(t,r,c){if(t.getDegree()<r.getDegree()){let z=t;t=r,r=z}let h=t,g=r,p=this.field.getZero(),y=this.field.getOne();for(;g.getDegree()>=Math.round(c/2);){let z=h,Q=p;if(h=g,p=y,h.isZero())throw T.getChecksumInstance();g=z;let te=this.field.getZero(),se=h.getCoefficient(h.getDegree()),le=this.field.inverse(se);for(;g.getDegree()>=h.getDegree()&&!g.isZero();){let pe=g.getDegree()-h.getDegree(),Pe=this.field.multiply(g.getCoefficient(g.getDegree()),le);te=te.add(this.field.buildMonomial(pe,Pe)),g=g.subtract(h.multiplyByMonomial(pe,Pe))}y=te.multiply(p).subtract(Q).negative()}let _=y.getCoefficient(0);if(_===0)throw T.getChecksumInstance();let E=this.field.inverse(_),j=y.multiply(E),D=g.multiply(E);return[j,D]}findErrorLocations(t){let r=t.getDegree(),c=new Int32Array(r),h=0;for(let g=1;g<this.field.getSize()&&h<r;g++)t.evaluateAt(g)===0&&(c[h]=this.field.inverse(g),h++);if(h!==r)throw T.getChecksumInstance();return c}findErrorMagnitudes(t,r,c){let h=r.getDegree(),g=new Int32Array(h);for(let E=1;E<=h;E++)g[h-E]=this.field.multiply(E,r.getCoefficient(E));let p=new gn(this.field,g),y=c.length,_=new Int32Array(y);for(let E=0;E<y;E++){let j=this.field.inverse(c[E]),D=this.field.subtract(0,t.evaluateAt(j)),z=this.field.inverse(p.evaluateAt(j));_[E]=this.field.multiply(D,z)}return _}}class Aa{constructor(t,r,c,h,g){t instanceof Aa?this.constructor_2(t):this.constructor_1(t,r,c,h,g)}constructor_1(t,r,c,h,g){const p=r==null||c==null,y=h==null||g==null;if(p&&y)throw new V;p?(r=new ze(0,h.getY()),c=new ze(0,g.getY())):y&&(h=new ze(t.getWidth()-1,r.getY()),g=new ze(t.getWidth()-1,c.getY())),this.image=t,this.topLeft=r,this.bottomLeft=c,this.topRight=h,this.bottomRight=g,this.minX=Math.trunc(Math.min(r.getX(),c.getX())),this.maxX=Math.trunc(Math.max(h.getX(),g.getX())),this.minY=Math.trunc(Math.min(r.getY(),h.getY())),this.maxY=Math.trunc(Math.max(c.getY(),g.getY()))}constructor_2(t){this.image=t.image,this.topLeft=t.getTopLeft(),this.bottomLeft=t.getBottomLeft(),this.topRight=t.getTopRight(),this.bottomRight=t.getBottomRight(),this.minX=t.getMinX(),this.maxX=t.getMaxX(),this.minY=t.getMinY(),this.maxY=t.getMaxY()}static merge(t,r){return t==null?r:r==null?t:new Aa(t.image,t.topLeft,t.bottomLeft,r.topRight,r.bottomRight)}addMissingRows(t,r,c){let h=this.topLeft,g=this.bottomLeft,p=this.topRight,y=this.bottomRight;if(t>0){let _=c?this.topLeft:this.topRight,E=Math.trunc(_.getY()-t);E<0&&(E=0);let j=new ze(_.getX(),E);c?h=j:p=j}if(r>0){let _=c?this.bottomLeft:this.bottomRight,E=Math.trunc(_.getY()+r);E>=this.image.getHeight()&&(E=this.image.getHeight()-1);let j=new ze(_.getX(),E);c?g=j:y=j}return new Aa(this.image,h,g,p,y)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class $i{constructor(t,r,c,h){this.columnCount=t,this.errorCorrectionLevel=h,this.rowCountUpperPart=r,this.rowCountLowerPart=c,this.rowCount=r+c}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class jr{constructor(){this.buffer=""}static form(t,r){let c=-1;function h(p,y,_,E,j,D){if(p==="%%")return"%";if(r[++c]===void 0)return;p=E?parseInt(E.substr(1)):void 0;let z=j?parseInt(j.substr(1)):void 0,Q;switch(D){case"s":Q=r[c];break;case"c":Q=r[c][0];break;case"f":Q=parseFloat(r[c]).toFixed(p);break;case"p":Q=parseFloat(r[c]).toPrecision(p);break;case"e":Q=parseFloat(r[c]).toExponential(p);break;case"x":Q=parseInt(r[c]).toString(z||16);break;case"d":Q=parseFloat(parseInt(r[c],z||10).toPrecision(p)).toFixed(0);break}Q=typeof Q=="object"?JSON.stringify(Q):(+Q).toString(z);let te=parseInt(_),se=_&&_[0]+""=="0"?"0":" ";for(;Q.length<te;)Q=y!==void 0?Q+se:se+Q;return Q}let g=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(g,h)}format(t,...r){this.buffer+=jr.form(t,r)}toString(){return this.buffer}}class La{constructor(t){this.boundingBox=new Aa(t),this.codewords=new Array(t.getMaxY()-t.getMinY()+1)}getCodewordNearby(t){let r=this.getCodeword(t);if(r!=null)return r;for(let c=1;c<La.MAX_NEARBY_DISTANCE;c++){let h=this.imageRowToCodewordIndex(t)-c;if(h>=0&&(r=this.codewords[h],r!=null)||(h=this.imageRowToCodewordIndex(t)+c,h<this.codewords.length&&(r=this.codewords[h],r!=null)))return r}return null}imageRowToCodewordIndex(t){return t-this.boundingBox.getMinY()}setCodeword(t,r){this.codewords[this.imageRowToCodewordIndex(t)]=r}getCodeword(t){return this.codewords[this.imageRowToCodewordIndex(t)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const t=new jr;let r=0;for(const c of this.codewords){if(c==null){t.format("%3d:    |   %n",r++);continue}t.format("%3d: %3d|%3d%n",r++,c.getRowNumber(),c.getValue())}return t.toString()}}La.MAX_NEARBY_DISTANCE=5;class Ba{constructor(){this.values=new Map}setValue(t){t=Math.trunc(t);let r=this.values.get(t);r==null&&(r=0),r++,this.values.set(t,r)}getValue(){let t=-1,r=new Array;for(const[c,h]of this.values.entries()){const g={getKey:()=>c,getValue:()=>h};g.getValue()>t?(t=g.getValue(),r=[],r.push(g.getKey())):g.getValue()===t&&r.push(g.getKey())}return it.toIntArray(r)}getConfidence(t){return this.values.get(t)}}class sl extends La{constructor(t,r){super(t),this._isLeft=r}setRowNumbers(){for(let t of this.getCodewords())t?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(t){let r=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(r,t);let c=this.getBoundingBox(),h=this._isLeft?c.getTopLeft():c.getTopRight(),g=this._isLeft?c.getBottomLeft():c.getBottomRight(),p=this.imageRowToCodewordIndex(Math.trunc(h.getY())),y=this.imageRowToCodewordIndex(Math.trunc(g.getY())),_=-1,E=1,j=0;for(let D=p;D<y;D++){if(r[D]==null)continue;let z=r[D],Q=z.getRowNumber()-_;if(Q===0)j++;else if(Q===1)E=Math.max(E,j),j=1,_=z.getRowNumber();else if(Q<0||z.getRowNumber()>=t.getRowCount()||Q>D)r[D]=null;else{let te;E>2?te=(E-2)*Q:te=Q;let se=te>=D;for(let le=1;le<=te&&!se;le++)se=r[D-le]!=null;se?r[D]=null:(_=z.getRowNumber(),j=1)}}}getRowHeights(){let t=this.getBarcodeMetadata();if(t==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(t);let r=new Int32Array(t.getRowCount());for(let c of this.getCodewords())if(c!=null){let h=c.getRowNumber();if(h>=r.length)continue;r[h]++}return r}adjustIncompleteIndicatorColumnRowNumbers(t){let r=this.getBoundingBox(),c=this._isLeft?r.getTopLeft():r.getTopRight(),h=this._isLeft?r.getBottomLeft():r.getBottomRight(),g=this.imageRowToCodewordIndex(Math.trunc(c.getY())),p=this.imageRowToCodewordIndex(Math.trunc(h.getY())),y=this.getCodewords(),_=-1;for(let E=g;E<p;E++){if(y[E]==null)continue;let j=y[E];j.setRowNumberAsRowIndicatorColumn();let D=j.getRowNumber()-_;D===0||(D===1?_=j.getRowNumber():j.getRowNumber()>=t.getRowCount()?y[E]=null:_=j.getRowNumber())}}getBarcodeMetadata(){let t=this.getCodewords(),r=new Ba,c=new Ba,h=new Ba,g=new Ba;for(let y of t){if(y==null)continue;y.setRowNumberAsRowIndicatorColumn();let _=y.getValue()%30,E=y.getRowNumber();switch(this._isLeft||(E+=2),E%3){case 0:c.setValue(_*3+1);break;case 1:g.setValue(_/3),h.setValue(_%3);break;case 2:r.setValue(_+1);break}}if(r.getValue().length===0||c.getValue().length===0||h.getValue().length===0||g.getValue().length===0||r.getValue()[0]<1||c.getValue()[0]+h.getValue()[0]<it.MIN_ROWS_IN_BARCODE||c.getValue()[0]+h.getValue()[0]>it.MAX_ROWS_IN_BARCODE)return null;let p=new $i(r.getValue()[0],c.getValue()[0],h.getValue()[0],g.getValue()[0]);return this.removeIncorrectCodewords(t,p),p}removeIncorrectCodewords(t,r){for(let c=0;c<t.length;c++){let h=t[c];if(t[c]==null)continue;let g=h.getValue()%30,p=h.getRowNumber();if(p>r.getRowCount()){t[c]=null;continue}switch(this._isLeft||(p+=2),p%3){case 0:g*3+1!==r.getRowCountUpperPart()&&(t[c]=null);break;case 1:(Math.trunc(g/3)!==r.getErrorCorrectionLevel()||g%3!==r.getRowCountLowerPart())&&(t[c]=null);break;case 2:g+1!==r.getColumnCount()&&(t[c]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Qn{constructor(t,r){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=t,this.barcodeColumnCount=t.getColumnCount(),this.boundingBox=r,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let t=it.MAX_CODEWORDS_IN_BARCODE,r;do r=t,t=this.adjustRowNumbersAndGetCount();while(t>0&&t<r);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(t){t?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let t=this.adjustRowNumbersByRow();if(t===0)return 0;for(let r=1;r<this.barcodeColumnCount+1;r++){let c=this.detectionResultColumns[r].getCodewords();for(let h=0;h<c.length;h++)c[h]!=null&&(c[h].hasValidRowNumber()||this.adjustRowNumbers(r,h,c))}return t}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let t=this.detectionResultColumns[0].getCodewords(),r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let c=0;c<t.length;c++)if(t[c]!=null&&r[c]!=null&&t[c].getRowNumber()===r[c].getRowNumber())for(let h=1;h<=this.barcodeColumnCount;h++){let g=this.detectionResultColumns[h].getCodewords()[c];g!=null&&(g.setRowNumber(t[c].getRowNumber()),g.hasValidRowNumber()||(this.detectionResultColumns[h].getCodewords()[c]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let t=0,r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let c=0;c<r.length;c++){if(r[c]==null)continue;let h=r[c].getRowNumber(),g=0;for(let p=this.barcodeColumnCount+1;p>0&&g<this.ADJUST_ROW_NUMBER_SKIP;p--){let y=this.detectionResultColumns[p].getCodewords()[c];y!=null&&(g=Qn.adjustRowNumberIfValid(h,g,y),y.hasValidRowNumber()||t++)}}return t}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let t=0,r=this.detectionResultColumns[0].getCodewords();for(let c=0;c<r.length;c++){if(r[c]==null)continue;let h=r[c].getRowNumber(),g=0;for(let p=1;p<this.barcodeColumnCount+1&&g<this.ADJUST_ROW_NUMBER_SKIP;p++){let y=this.detectionResultColumns[p].getCodewords()[c];y!=null&&(g=Qn.adjustRowNumberIfValid(h,g,y),y.hasValidRowNumber()||t++)}}return t}static adjustRowNumberIfValid(t,r,c){return c==null||c.hasValidRowNumber()||(c.isValidRowNumber(t)?(c.setRowNumber(t),r=0):++r),r}adjustRowNumbers(t,r,c){if(!this.detectionResultColumns[t-1])return;let h=c[r],g=this.detectionResultColumns[t-1].getCodewords(),p=g;this.detectionResultColumns[t+1]!=null&&(p=this.detectionResultColumns[t+1].getCodewords());let y=new Array(14);y[2]=g[r],y[3]=p[r],r>0&&(y[0]=c[r-1],y[4]=g[r-1],y[5]=p[r-1]),r>1&&(y[8]=c[r-2],y[10]=g[r-2],y[11]=p[r-2]),r<c.length-1&&(y[1]=c[r+1],y[6]=g[r+1],y[7]=p[r+1]),r<c.length-2&&(y[9]=c[r+2],y[12]=g[r+2],y[13]=p[r+2]);for(let _ of y)if(Qn.adjustRowNumber(h,_))return}static adjustRowNumber(t,r){return r==null?!1:r.hasValidRowNumber()&&r.getBucket()===t.getBucket()?(t.setRowNumber(r.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(t){this.boundingBox=t}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(t,r){this.detectionResultColumns[t]=r}getDetectionResultColumn(t){return this.detectionResultColumns[t]}toString(){let t=this.detectionResultColumns[0];t==null&&(t=this.detectionResultColumns[this.barcodeColumnCount+1]);let r=new jr;for(let c=0;c<t.getCodewords().length;c++){r.format("CW %3d:",c);for(let h=0;h<this.barcodeColumnCount+2;h++){if(this.detectionResultColumns[h]==null){r.format("    |   ");continue}let g=this.detectionResultColumns[h].getCodewords()[c];if(g==null){r.format("    |   ");continue}r.format(" %3d|%3d",g.getRowNumber(),g.getValue())}r.format("%n")}return r.toString()}}class Xs{constructor(t,r,c,h){this.rowNumber=Xs.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(t),this.endX=Math.trunc(r),this.bucket=Math.trunc(c),this.value=Math.trunc(h)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(t){return t!==Xs.BARCODE_ROW_UNKNOWN&&this.bucket===t%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(t){this.rowNumber=t}toString(){return this.rowNumber+"|"+this.value}}Xs.BARCODE_ROW_UNKNOWN=-1;class ss{static initialize(){for(let t=0;t<it.SYMBOL_TABLE.length;t++){let r=it.SYMBOL_TABLE[t],c=r&1;for(let h=0;h<it.BARS_IN_MODULE;h++){let g=0;for(;(r&1)===c;)g+=1,r>>=1;c=r&1,ss.RATIOS_TABLE[t]||(ss.RATIOS_TABLE[t]=new Array(it.BARS_IN_MODULE)),ss.RATIOS_TABLE[t][it.BARS_IN_MODULE-h-1]=Math.fround(g/it.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(t){let r=ss.getDecodedCodewordValue(ss.sampleBitCounts(t));return r!==-1?r:ss.getClosestDecodedValue(t)}static sampleBitCounts(t){let r=ht.sum(t),c=new Int32Array(it.BARS_IN_MODULE),h=0,g=0;for(let p=0;p<it.MODULES_IN_CODEWORD;p++){let y=r/(2*it.MODULES_IN_CODEWORD)+p*r/it.MODULES_IN_CODEWORD;g+t[h]<=y&&(g+=t[h],h++),c[h]++}return c}static getDecodedCodewordValue(t){let r=ss.getBitValue(t);return it.getCodeword(r)===-1?-1:r}static getBitValue(t){let r=0;for(let c=0;c<t.length;c++)for(let h=0;h<t[c];h++)r=r<<1|(c%2===0?1:0);return Math.trunc(r)}static getClosestDecodedValue(t){let r=ht.sum(t),c=new Array(it.BARS_IN_MODULE);if(r>1)for(let p=0;p<c.length;p++)c[p]=Math.fround(t[p]/r);let h=Hn.MAX_VALUE,g=-1;this.bSymbolTableReady||ss.initialize();for(let p=0;p<ss.RATIOS_TABLE.length;p++){let y=0,_=ss.RATIOS_TABLE[p];for(let E=0;E<it.BARS_IN_MODULE;E++){let j=Math.fround(_[E]-c[E]);if(y+=Math.fround(j*j),y>=h)break}y<h&&(h=y,g=it.SYMBOL_TABLE[p])}return g}}ss.bSymbolTableReady=!1,ss.RATIOS_TABLE=new Array(it.SYMBOL_TABLE.length).map(k=>new Array(it.BARS_IN_MODULE));class Rr{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(t){this.segmentIndex=t}getFileId(){return this.fileId}setFileId(t){this.fileId=t}getOptionalData(){return this.optionalData}setOptionalData(t){this.optionalData=t}isLastSegment(){return this.lastSegment}setLastSegment(t){this.lastSegment=t}getSegmentCount(){return this.segmentCount}setSegmentCount(t){this.segmentCount=t}getSender(){return this.sender||null}setSender(t){this.sender=t}getAddressee(){return this.addressee||null}setAddressee(t){this.addressee=t}getFileName(){return this.fileName}setFileName(t){this.fileName=t}getFileSize(){return this.fileSize}setFileSize(t){this.fileSize=t}getChecksum(){return this.checksum}setChecksum(t){this.checksum=t}getTimestamp(){return this.timestamp}setTimestamp(t){this.timestamp=t}}class uc{static parseLong(t,r=void 0){return parseInt(t,r)}}class Ji extends w{}Ji.kind="NullPointerException";class al{writeBytes(t){this.writeBytesOffset(t,0,t.length)}writeBytesOffset(t,r,c){if(t==null)throw new Ji;if(r<0||r>t.length||c<0||r+c>t.length||r+c<0)throw new B;if(c===0)return;for(let h=0;h<c;h++)this.write(t[r+h])}flush(){}close(){}}class pi extends w{}class eo extends al{constructor(t=32){if(super(),this.count=0,t<0)throw new N("Negative initial size: "+t);this.buf=new Uint8Array(t)}ensureCapacity(t){t-this.buf.length>0&&this.grow(t)}grow(t){let c=this.buf.length<<1;if(c-t<0&&(c=t),c<0){if(t<0)throw new pi;c=P.MAX_VALUE}this.buf=U.copyOfUint8Array(this.buf,c)}write(t){this.ensureCapacity(this.count+1),this.buf[this.count]=t,this.count+=1}writeBytesOffset(t,r,c){if(r<0||r>t.length||c<0||r+c-t.length>0)throw new B;this.ensureCapacity(this.count+c),L.arraycopy(t,r,this.buf,this.count,c),this.count+=c}writeTo(t){t.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return U.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(t){return t?typeof t=="string"?this.toString_string(t):this.toString_number(t):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(t){return new String(this.buf).toString()}toString_number(t){return new String(this.buf).toString()}close(){}}var $t;(function(k){k[k.ALPHA=0]="ALPHA",k[k.LOWER=1]="LOWER",k[k.MIXED=2]="MIXED",k[k.PUNCT=3]="PUNCT",k[k.ALPHA_SHIFT=4]="ALPHA_SHIFT",k[k.PUNCT_SHIFT=5]="PUNCT_SHIFT"})($t||($t={}));function dc(){if(typeof window<"u")return window.BigInt||null;if(typeof Cu<"u")return Cu.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let to;function Ua(k){if(typeof to>"u"&&(to=dc()),to===null)throw new Error("BigInt is not supported!");return to(k)}function rl(){let k=[];k[0]=Ua(1);let t=Ua(900);k[1]=t;for(let r=2;r<16;r++)k[r]=k[r-1]*t;return k}class xe{static decode(t,r){let c=new be(""),h=q.ISO8859_1;c.enableDecoding(h);let g=1,p=t[g++],y=new Rr;for(;g<t[0];){switch(p){case xe.TEXT_COMPACTION_MODE_LATCH:g=xe.textCompaction(t,g,c);break;case xe.BYTE_COMPACTION_MODE_LATCH:case xe.BYTE_COMPACTION_MODE_LATCH_6:g=xe.byteCompaction(p,t,h,g,c);break;case xe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(t[g++]);break;case xe.NUMERIC_COMPACTION_MODE_LATCH:g=xe.numericCompaction(t,g,c);break;case xe.ECI_CHARSET:q.getCharacterSetECIByValue(t[g++]);break;case xe.ECI_GENERAL_PURPOSE:g+=2;break;case xe.ECI_USER_DEFINED:g++;break;case xe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:g=xe.decodeMacroBlock(t,g,y);break;case xe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case xe.MACRO_PDF417_TERMINATOR:throw new X;default:g--,g=xe.textCompaction(t,g,c);break}if(g<t.length)p=t[g++];else throw X.getFormatInstance()}if(c.length()===0)throw X.getFormatInstance();let _=new Ce(null,c.toString(),null,r);return _.setOther(y),_}static decodeMacroBlock(t,r,c){if(r+xe.NUMBER_OF_SEQUENCE_CODEWORDS>t[0])throw X.getFormatInstance();let h=new Int32Array(xe.NUMBER_OF_SEQUENCE_CODEWORDS);for(let y=0;y<xe.NUMBER_OF_SEQUENCE_CODEWORDS;y++,r++)h[y]=t[r];c.setSegmentIndex(P.parseInt(xe.decodeBase900toBase10(h,xe.NUMBER_OF_SEQUENCE_CODEWORDS)));let g=new be;r=xe.textCompaction(t,r,g),c.setFileId(g.toString());let p=-1;for(t[r]===xe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(p=r+1);r<t[0];)switch(t[r]){case xe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(r++,t[r]){case xe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let y=new be;r=xe.textCompaction(t,r+1,y),c.setFileName(y.toString());break;case xe.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let _=new be;r=xe.textCompaction(t,r+1,_),c.setSender(_.toString());break;case xe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let E=new be;r=xe.textCompaction(t,r+1,E),c.setAddressee(E.toString());break;case xe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let j=new be;r=xe.numericCompaction(t,r+1,j),c.setSegmentCount(P.parseInt(j.toString()));break;case xe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let D=new be;r=xe.numericCompaction(t,r+1,D),c.setTimestamp(uc.parseLong(D.toString()));break;case xe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let z=new be;r=xe.numericCompaction(t,r+1,z),c.setChecksum(P.parseInt(z.toString()));break;case xe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let Q=new be;r=xe.numericCompaction(t,r+1,Q),c.setFileSize(uc.parseLong(Q.toString()));break;default:throw X.getFormatInstance()}break;case xe.MACRO_PDF417_TERMINATOR:r++,c.setLastSegment(!0);break;default:throw X.getFormatInstance()}if(p!==-1){let y=r-p;c.isLastSegment()&&y--,c.setOptionalData(U.copyOfRange(t,p,p+y))}return r}static textCompaction(t,r,c){let h=new Int32Array((t[0]-r)*2),g=new Int32Array((t[0]-r)*2),p=0,y=!1;for(;r<t[0]&&!y;){let _=t[r++];if(_<xe.TEXT_COMPACTION_MODE_LATCH)h[p]=_/30,h[p+1]=_%30,p+=2;else switch(_){case xe.TEXT_COMPACTION_MODE_LATCH:h[p++]=xe.TEXT_COMPACTION_MODE_LATCH;break;case xe.BYTE_COMPACTION_MODE_LATCH:case xe.BYTE_COMPACTION_MODE_LATCH_6:case xe.NUMERIC_COMPACTION_MODE_LATCH:case xe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case xe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case xe.MACRO_PDF417_TERMINATOR:r--,y=!0;break;case xe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h[p]=xe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,_=t[r++],g[p]=_,p++;break}}return xe.decodeTextCompaction(h,g,p,c),r}static decodeTextCompaction(t,r,c,h){let g=$t.ALPHA,p=$t.ALPHA,y=0;for(;y<c;){let _=t[y],E="";switch(g){case $t.ALPHA:if(_<26)E=String.fromCharCode(65+_);else switch(_){case 26:E=" ";break;case xe.LL:g=$t.LOWER;break;case xe.ML:g=$t.MIXED;break;case xe.PS:p=g,g=$t.PUNCT_SHIFT;break;case xe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h.append(r[y]);break;case xe.TEXT_COMPACTION_MODE_LATCH:g=$t.ALPHA;break}break;case $t.LOWER:if(_<26)E=String.fromCharCode(97+_);else switch(_){case 26:E=" ";break;case xe.AS:p=g,g=$t.ALPHA_SHIFT;break;case xe.ML:g=$t.MIXED;break;case xe.PS:p=g,g=$t.PUNCT_SHIFT;break;case xe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h.append(r[y]);break;case xe.TEXT_COMPACTION_MODE_LATCH:g=$t.ALPHA;break}break;case $t.MIXED:if(_<xe.PL)E=xe.MIXED_CHARS[_];else switch(_){case xe.PL:g=$t.PUNCT;break;case 26:E=" ";break;case xe.LL:g=$t.LOWER;break;case xe.AL:g=$t.ALPHA;break;case xe.PS:p=g,g=$t.PUNCT_SHIFT;break;case xe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h.append(r[y]);break;case xe.TEXT_COMPACTION_MODE_LATCH:g=$t.ALPHA;break}break;case $t.PUNCT:if(_<xe.PAL)E=xe.PUNCT_CHARS[_];else switch(_){case xe.PAL:g=$t.ALPHA;break;case xe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h.append(r[y]);break;case xe.TEXT_COMPACTION_MODE_LATCH:g=$t.ALPHA;break}break;case $t.ALPHA_SHIFT:if(g=p,_<26)E=String.fromCharCode(65+_);else switch(_){case 26:E=" ";break;case xe.TEXT_COMPACTION_MODE_LATCH:g=$t.ALPHA;break}break;case $t.PUNCT_SHIFT:if(g=p,_<xe.PAL)E=xe.PUNCT_CHARS[_];else switch(_){case xe.PAL:g=$t.ALPHA;break;case xe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h.append(r[y]);break;case xe.TEXT_COMPACTION_MODE_LATCH:g=$t.ALPHA;break}break}E!==""&&h.append(E),y++}}static byteCompaction(t,r,c,h,g){let p=new eo,y=0,_=0,E=!1;switch(t){case xe.BYTE_COMPACTION_MODE_LATCH:let j=new Int32Array(6),D=r[h++];for(;h<r[0]&&!E;)switch(j[y++]=D,_=900*_+D,D=r[h++],D){case xe.TEXT_COMPACTION_MODE_LATCH:case xe.BYTE_COMPACTION_MODE_LATCH:case xe.NUMERIC_COMPACTION_MODE_LATCH:case xe.BYTE_COMPACTION_MODE_LATCH_6:case xe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case xe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case xe.MACRO_PDF417_TERMINATOR:h--,E=!0;break;default:if(y%5===0&&y>0){for(let z=0;z<6;++z)p.write(Number(Ua(_)>>Ua(8*(5-z))));_=0,y=0}break}h===r[0]&&D<xe.TEXT_COMPACTION_MODE_LATCH&&(j[y++]=D);for(let z=0;z<y;z++)p.write(j[z]);break;case xe.BYTE_COMPACTION_MODE_LATCH_6:for(;h<r[0]&&!E;){let z=r[h++];if(z<xe.TEXT_COMPACTION_MODE_LATCH)y++,_=900*_+z;else switch(z){case xe.TEXT_COMPACTION_MODE_LATCH:case xe.BYTE_COMPACTION_MODE_LATCH:case xe.NUMERIC_COMPACTION_MODE_LATCH:case xe.BYTE_COMPACTION_MODE_LATCH_6:case xe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case xe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case xe.MACRO_PDF417_TERMINATOR:h--,E=!0;break}if(y%5===0&&y>0){for(let Q=0;Q<6;++Q)p.write(Number(Ua(_)>>Ua(8*(5-Q))));_=0,y=0}}break}return g.append(ge.decode(p.toByteArray(),c)),h}static numericCompaction(t,r,c){let h=0,g=!1,p=new Int32Array(xe.MAX_NUMERIC_CODEWORDS);for(;r<t[0]&&!g;){let y=t[r++];if(r===t[0]&&(g=!0),y<xe.TEXT_COMPACTION_MODE_LATCH)p[h]=y,h++;else switch(y){case xe.TEXT_COMPACTION_MODE_LATCH:case xe.BYTE_COMPACTION_MODE_LATCH:case xe.BYTE_COMPACTION_MODE_LATCH_6:case xe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case xe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case xe.MACRO_PDF417_TERMINATOR:r--,g=!0;break}(h%xe.MAX_NUMERIC_CODEWORDS===0||y===xe.NUMERIC_COMPACTION_MODE_LATCH||g)&&h>0&&(c.append(xe.decodeBase900toBase10(p,h)),h=0)}return r}static decodeBase900toBase10(t,r){let c=Ua(0);for(let g=0;g<r;g++)c+=xe.EXP900[r-g-1]*Ua(t[g]);let h=c.toString();if(h.charAt(0)!=="1")throw new X;return h.substring(1)}}xe.TEXT_COMPACTION_MODE_LATCH=900,xe.BYTE_COMPACTION_MODE_LATCH=901,xe.NUMERIC_COMPACTION_MODE_LATCH=902,xe.BYTE_COMPACTION_MODE_LATCH_6=924,xe.ECI_USER_DEFINED=925,xe.ECI_GENERAL_PURPOSE=926,xe.ECI_CHARSET=927,xe.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,xe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,xe.MACRO_PDF417_TERMINATOR=922,xe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,xe.MAX_NUMERIC_CODEWORDS=15,xe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,xe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,xe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,xe.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,xe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,xe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,xe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,xe.PL=25,xe.LL=27,xe.AS=27,xe.ML=28,xe.AL=28,xe.PS=29,xe.PAL=29,xe.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,xe.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",xe.EXP900=dc()?rl():[],xe.NUMBER_OF_SEQUENCE_CODEWORDS=2;class St{constructor(){}static decode(t,r,c,h,g,p,y){let _=new Aa(t,r,c,h,g),E=null,j=null,D;for(let te=!0;;te=!1){if(r!=null&&(E=St.getRowIndicatorColumn(t,_,r,!0,p,y)),h!=null&&(j=St.getRowIndicatorColumn(t,_,h,!1,p,y)),D=St.merge(E,j),D==null)throw V.getNotFoundInstance();let se=D.getBoundingBox();if(te&&se!=null&&(se.getMinY()<_.getMinY()||se.getMaxY()>_.getMaxY()))_=se;else break}D.setBoundingBox(_);let z=D.getBarcodeColumnCount()+1;D.setDetectionResultColumn(0,E),D.setDetectionResultColumn(z,j);let Q=E!=null;for(let te=1;te<=z;te++){let se=Q?te:z-te;if(D.getDetectionResultColumn(se)!==void 0)continue;let le;se===0||se===z?le=new sl(_,se===0):le=new La(_),D.setDetectionResultColumn(se,le);let pe=-1,Pe=pe;for(let Be=_.getMinY();Be<=_.getMaxY();Be++){if(pe=St.getStartColumn(D,se,Be,Q),pe<0||pe>_.getMaxX()){if(Pe===-1)continue;pe=Pe}let Oe=St.detectCodeword(t,_.getMinX(),_.getMaxX(),Q,pe,Be,p,y);Oe!=null&&(le.setCodeword(Be,Oe),Pe=pe,p=Math.min(p,Oe.getWidth()),y=Math.max(y,Oe.getWidth()))}}return St.createDecoderResult(D)}static merge(t,r){if(t==null&&r==null)return null;let c=St.getBarcodeMetadata(t,r);if(c==null)return null;let h=Aa.merge(St.adjustBoundingBox(t),St.adjustBoundingBox(r));return new Qn(c,h)}static adjustBoundingBox(t){if(t==null)return null;let r=t.getRowHeights();if(r==null)return null;let c=St.getMax(r),h=0;for(let y of r)if(h+=c-y,y>0)break;let g=t.getCodewords();for(let y=0;h>0&&g[y]==null;y++)h--;let p=0;for(let y=r.length-1;y>=0&&(p+=c-r[y],!(r[y]>0));y--);for(let y=g.length-1;p>0&&g[y]==null;y--)p--;return t.getBoundingBox().addMissingRows(h,p,t.isLeft())}static getMax(t){let r=-1;for(let c of t)r=Math.max(r,c);return r}static getBarcodeMetadata(t,r){let c;if(t==null||(c=t.getBarcodeMetadata())==null)return r==null?null:r.getBarcodeMetadata();let h;return r==null||(h=r.getBarcodeMetadata())==null?c:c.getColumnCount()!==h.getColumnCount()&&c.getErrorCorrectionLevel()!==h.getErrorCorrectionLevel()&&c.getRowCount()!==h.getRowCount()?null:c}static getRowIndicatorColumn(t,r,c,h,g,p){let y=new sl(r,h);for(let _=0;_<2;_++){let E=_===0?1:-1,j=Math.trunc(Math.trunc(c.getX()));for(let D=Math.trunc(Math.trunc(c.getY()));D<=r.getMaxY()&&D>=r.getMinY();D+=E){let z=St.detectCodeword(t,0,t.getWidth(),h,j,D,g,p);z!=null&&(y.setCodeword(D,z),h?j=z.getStartX():j=z.getEndX())}}return y}static adjustCodewordCount(t,r){let c=r[0][1],h=c.getValue(),g=t.getBarcodeColumnCount()*t.getBarcodeRowCount()-St.getNumberOfECCodeWords(t.getBarcodeECLevel());if(h.length===0){if(g<1||g>it.MAX_CODEWORDS_IN_BARCODE)throw V.getNotFoundInstance();c.setValue(g)}else h[0]!==g&&c.setValue(g)}static createDecoderResult(t){let r=St.createBarcodeMatrix(t);St.adjustCodewordCount(t,r);let c=new Array,h=new Int32Array(t.getBarcodeRowCount()*t.getBarcodeColumnCount()),g=[],p=new Array;for(let _=0;_<t.getBarcodeRowCount();_++)for(let E=0;E<t.getBarcodeColumnCount();E++){let j=r[_][E+1].getValue(),D=_*t.getBarcodeColumnCount()+E;j.length===0?c.push(D):j.length===1?h[D]=j[0]:(p.push(D),g.push(j))}let y=new Array(g.length);for(let _=0;_<y.length;_++)y[_]=g[_];return St.createDecoderResultFromAmbiguousValues(t.getBarcodeECLevel(),h,it.toIntArray(c),it.toIntArray(p),y)}static createDecoderResultFromAmbiguousValues(t,r,c,h,g){let p=new Int32Array(h.length),y=100;for(;y-- >0;){for(let _=0;_<p.length;_++)r[h[_]]=g[_][p[_]];try{return St.decodeCodewords(r,t,c)}catch(_){if(!(_ instanceof T))throw _}if(p.length===0)throw T.getChecksumInstance();for(let _=0;_<p.length;_++)if(p[_]<g[_].length-1){p[_]++;break}else if(p[_]=0,_===p.length-1)throw T.getChecksumInstance()}throw T.getChecksumInstance()}static createBarcodeMatrix(t){let r=Array.from({length:t.getBarcodeRowCount()},()=>new Array(t.getBarcodeColumnCount()+2));for(let h=0;h<r.length;h++)for(let g=0;g<r[h].length;g++)r[h][g]=new Ba;let c=0;for(let h of t.getDetectionResultColumns()){if(h!=null){for(let g of h.getCodewords())if(g!=null){let p=g.getRowNumber();if(p>=0){if(p>=r.length)continue;r[p][c].setValue(g.getValue())}}}c++}return r}static isValidBarcodeColumn(t,r){return r>=0&&r<=t.getBarcodeColumnCount()+1}static getStartColumn(t,r,c,h){let g=h?1:-1,p=null;if(St.isValidBarcodeColumn(t,r-g)&&(p=t.getDetectionResultColumn(r-g).getCodeword(c)),p!=null)return h?p.getEndX():p.getStartX();if(p=t.getDetectionResultColumn(r).getCodewordNearby(c),p!=null)return h?p.getStartX():p.getEndX();if(St.isValidBarcodeColumn(t,r-g)&&(p=t.getDetectionResultColumn(r-g).getCodewordNearby(c)),p!=null)return h?p.getEndX():p.getStartX();let y=0;for(;St.isValidBarcodeColumn(t,r-g);){r-=g;for(let _ of t.getDetectionResultColumn(r).getCodewords())if(_!=null)return(h?_.getEndX():_.getStartX())+g*y*(_.getEndX()-_.getStartX());y++}return h?t.getBoundingBox().getMinX():t.getBoundingBox().getMaxX()}static detectCodeword(t,r,c,h,g,p,y,_){g=St.adjustCodewordStartColumn(t,r,c,h,g,p);let E=St.getModuleBitCount(t,r,c,h,g,p);if(E==null)return null;let j,D=ht.sum(E);if(h)j=g+D;else{for(let te=0;te<E.length/2;te++){let se=E[te];E[te]=E[E.length-1-te],E[E.length-1-te]=se}j=g,g=j-D}if(!St.checkCodewordSkew(D,y,_))return null;let z=ss.getDecodedValue(E),Q=it.getCodeword(z);return Q===-1?null:new Xs(g,j,St.getCodewordBucketNumber(z),Q)}static getModuleBitCount(t,r,c,h,g,p){let y=g,_=new Int32Array(8),E=0,j=h?1:-1,D=h;for(;(h?y<c:y>=r)&&E<_.length;)t.get(y,p)===D?(_[E]++,y+=j):(E++,D=!D);return E===_.length||y===(h?c:r)&&E===_.length-1?_:null}static getNumberOfECCodeWords(t){return 2<<t}static adjustCodewordStartColumn(t,r,c,h,g,p){let y=g,_=h?-1:1;for(let E=0;E<2;E++){for(;(h?y>=r:y<c)&&h===t.get(y,p);){if(Math.abs(g-y)>St.CODEWORD_SKEW_SIZE)return g;y+=_}_=-_,h=!h}return y}static checkCodewordSkew(t,r,c){return r-St.CODEWORD_SKEW_SIZE<=t&&t<=c+St.CODEWORD_SKEW_SIZE}static decodeCodewords(t,r,c){if(t.length===0)throw X.getFormatInstance();let h=1<<r+1,g=St.correctErrors(t,c,h);St.verifyCodewordCount(t,h);let p=xe.decode(t,""+r);return p.setErrorsCorrected(g),p.setErasures(c.length),p}static correctErrors(t,r,c){if(r!=null&&r.length>c/2+St.MAX_ERRORS||c<0||c>St.MAX_EC_CODEWORDS)throw T.getChecksumInstance();return St.errorCorrection.decode(t,c,r)}static verifyCodewordCount(t,r){if(t.length<4)throw X.getFormatInstance();let c=t[0];if(c>t.length)throw X.getFormatInstance();if(c===0)if(r<t.length)t[0]=t.length-r;else throw X.getFormatInstance()}static getBitCountForCodeword(t){let r=new Int32Array(8),c=0,h=r.length-1;for(;!((t&1)!==c&&(c=t&1,h--,h<0));)r[h]++,t>>=1;return r}static getCodewordBucketNumber(t){return t instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(t):this.getCodewordBucketNumber_number(t)}static getCodewordBucketNumber_number(t){return St.getCodewordBucketNumber(St.getBitCountForCodeword(t))}static getCodewordBucketNumber_Int32Array(t){return(t[0]-t[2]+t[4]-t[6]+9)%9}static toString(t){let r=new jr;for(let c=0;c<t.length;c++){r.format("Row %2d: ",c);for(let h=0;h<t[c].length;h++){let g=t[c][h];g.getValue().length===0?r.format("        ",null):r.format("%4d(%2d)",g.getValue()[0],g.getConfidence(g.getValue()[0]))}r.format("%n")}return r.toString()}}St.CODEWORD_SKEW_SIZE=2,St.MAX_ERRORS=3,St.MAX_EC_CODEWORDS=512,St.errorCorrection=new Ea;class as{decode(t,r=null){let c=as.decode(t,r,!1);if(c==null||c.length===0||c[0]==null)throw V.getNotFoundInstance();return c[0]}decodeMultiple(t,r=null){try{return as.decode(t,r,!0)}catch(c){throw c instanceof X||c instanceof T?V.getNotFoundInstance():c}}static decode(t,r,c){const h=new Array,g=pt.detectMultiple(t,r,c);for(const p of g.getPoints()){const y=St.decode(g.getBits(),p[4],p[5],p[6],p[7],as.getMinCodewordWidth(p),as.getMaxCodewordWidth(p)),_=new Ue(y.getText(),y.getRawBytes(),void 0,p,Ne.PDF_417);_.putMetadata(De.ERROR_CORRECTION_LEVEL,y.getECLevel());const E=y.getOther();E!=null&&_.putMetadata(De.PDF417_EXTRA_METADATA,E),h.push(_)}return h.map(p=>p)}static getMaxWidth(t,r){return t==null||r==null?0:Math.trunc(Math.abs(t.getX()-r.getX()))}static getMinWidth(t,r){return t==null||r==null?P.MAX_VALUE:Math.trunc(Math.abs(t.getX()-r.getX()))}static getMaxCodewordWidth(t){return Math.floor(Math.max(Math.max(as.getMaxWidth(t[0],t[4]),as.getMaxWidth(t[6],t[2])*it.MODULES_IN_CODEWORD/it.MODULES_IN_STOP_PATTERN),Math.max(as.getMaxWidth(t[1],t[5]),as.getMaxWidth(t[7],t[3])*it.MODULES_IN_CODEWORD/it.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(t){return Math.floor(Math.min(Math.min(as.getMinWidth(t[0],t[4]),as.getMinWidth(t[6],t[2])*it.MODULES_IN_CODEWORD/it.MODULES_IN_STOP_PATTERN),Math.min(as.getMinWidth(t[1],t[5]),as.getMinWidth(t[7],t[3])*it.MODULES_IN_CODEWORD/it.MODULES_IN_STOP_PATTERN)))}reset(){}}class no extends w{}no.kind="ReaderException";class hc{constructor(t,r){this.verbose=t===!0,r&&this.setHints(r)}decode(t,r){return r&&this.setHints(r),this.decodeInternal(t)}decodeWithState(t){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(t)}setHints(t){this.hints=t;const r=!l(t)&&t.get(W.TRY_HARDER)===!0,c=l(t)?null:t.get(W.POSSIBLE_FORMATS),h=new Array;if(!l(c)){const g=c.some(p=>p===Ne.UPC_A||p===Ne.UPC_E||p===Ne.EAN_13||p===Ne.EAN_8||p===Ne.CODABAR||p===Ne.CODE_39||p===Ne.CODE_93||p===Ne.CODE_128||p===Ne.ITF||p===Ne.RSS_14||p===Ne.RSS_EXPANDED);g&&!r&&h.push(new Gs(t,this.verbose)),c.includes(Ne.QR_CODE)&&h.push(new Sa),c.includes(Ne.DATA_MATRIX)&&h.push(new _a),c.includes(Ne.AZTEC)&&h.push(new jn),c.includes(Ne.PDF_417)&&h.push(new as),g&&r&&h.push(new Gs(t,this.verbose))}h.length===0&&(r||h.push(new Gs(t,this.verbose)),h.push(new Sa),h.push(new _a),h.push(new jn),h.push(new as),r&&h.push(new Gs(t,this.verbose))),this.readers=h}reset(){if(this.readers!==null)for(const t of this.readers)t.reset()}decodeInternal(t){if(this.readers===null)throw new no("No readers where selected, nothing can be read.");for(const r of this.readers)try{return r.decode(t,this.hints)}catch(c){if(c instanceof no)continue}throw new V("No MultiFormat Readers were able to detect the code.")}}class fc extends Le{constructor(t=null,r=500){const c=new hc;c.setHints(t),super(c,r)}decodeBitmap(t){return this.reader.decodeWithState(t)}}class ud extends Le{constructor(t=500){super(new as,t)}}class dd extends Le{constructor(t=500){super(new Sa,t)}}var il;(function(k){k[k.ERROR_CORRECTION=0]="ERROR_CORRECTION",k[k.CHARACTER_SET=1]="CHARACTER_SET",k[k.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",k[k.MIN_SIZE=3]="MIN_SIZE",k[k.MAX_SIZE=4]="MAX_SIZE",k[k.MARGIN=5]="MARGIN",k[k.PDF417_COMPACT=6]="PDF417_COMPACT",k[k.PDF417_COMPACTION=7]="PDF417_COMPACTION",k[k.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",k[k.AZTEC_LAYERS=9]="AZTEC_LAYERS",k[k.QR_VERSION=10]="QR_VERSION"})(il||(il={}));var Gn=il;class xi{constructor(t){this.field=t,this.cachedGenerators=[],this.cachedGenerators.push(new mt(t,Int32Array.from([1])))}buildGenerator(t){const r=this.cachedGenerators;if(t>=r.length){let c=r[r.length-1];const h=this.field;for(let g=r.length;g<=t;g++){const p=c.multiply(new mt(h,Int32Array.from([1,h.exp(g-1+h.getGeneratorBase())])));r.push(p),c=p}}return r[t]}encode(t,r){if(r===0)throw new N("No error correction bytes");const c=t.length-r;if(c<=0)throw new N("No data bytes provided");const h=this.buildGenerator(r),g=new Int32Array(c);L.arraycopy(t,0,g,0,c);let p=new mt(this.field,g);p=p.multiplyByMonomial(r,1);const _=p.divide(h)[1].getCoefficients(),E=r-_.length;for(let j=0;j<E;j++)t[c+j]=0;L.arraycopy(_,0,t,c+E,_.length)}}class En{constructor(){}static applyMaskPenaltyRule1(t){return En.applyMaskPenaltyRule1Internal(t,!0)+En.applyMaskPenaltyRule1Internal(t,!1)}static applyMaskPenaltyRule2(t){let r=0;const c=t.getArray(),h=t.getWidth(),g=t.getHeight();for(let p=0;p<g-1;p++){const y=c[p];for(let _=0;_<h-1;_++){const E=y[_];E===y[_+1]&&E===c[p+1][_]&&E===c[p+1][_+1]&&r++}}return En.N2*r}static applyMaskPenaltyRule3(t){let r=0;const c=t.getArray(),h=t.getWidth(),g=t.getHeight();for(let p=0;p<g;p++)for(let y=0;y<h;y++){const _=c[p];y+6<h&&_[y]===1&&_[y+1]===0&&_[y+2]===1&&_[y+3]===1&&_[y+4]===1&&_[y+5]===0&&_[y+6]===1&&(En.isWhiteHorizontal(_,y-4,y)||En.isWhiteHorizontal(_,y+7,y+11))&&r++,p+6<g&&c[p][y]===1&&c[p+1][y]===0&&c[p+2][y]===1&&c[p+3][y]===1&&c[p+4][y]===1&&c[p+5][y]===0&&c[p+6][y]===1&&(En.isWhiteVertical(c,y,p-4,p)||En.isWhiteVertical(c,y,p+7,p+11))&&r++}return r*En.N3}static isWhiteHorizontal(t,r,c){r=Math.max(r,0),c=Math.min(c,t.length);for(let h=r;h<c;h++)if(t[h]===1)return!1;return!0}static isWhiteVertical(t,r,c,h){c=Math.max(c,0),h=Math.min(h,t.length);for(let g=c;g<h;g++)if(t[g][r]===1)return!1;return!0}static applyMaskPenaltyRule4(t){let r=0;const c=t.getArray(),h=t.getWidth(),g=t.getHeight();for(let _=0;_<g;_++){const E=c[_];for(let j=0;j<h;j++)E[j]===1&&r++}const p=t.getHeight()*t.getWidth();return Math.floor(Math.abs(r*2-p)*10/p)*En.N4}static getDataMaskBit(t,r,c){let h,g;switch(t){case 0:h=c+r&1;break;case 1:h=c&1;break;case 2:h=r%3;break;case 3:h=(c+r)%3;break;case 4:h=Math.floor(c/2)+Math.floor(r/3)&1;break;case 5:g=c*r,h=(g&1)+g%3;break;case 6:g=c*r,h=(g&1)+g%3&1;break;case 7:g=c*r,h=g%3+(c+r&1)&1;break;default:throw new N("Invalid mask pattern: "+t)}return h===0}static applyMaskPenaltyRule1Internal(t,r){let c=0;const h=r?t.getHeight():t.getWidth(),g=r?t.getWidth():t.getHeight(),p=t.getArray();for(let y=0;y<h;y++){let _=0,E=-1;for(let j=0;j<g;j++){const D=r?p[y][j]:p[j][y];D===E?_++:(_>=5&&(c+=En.N1+(_-5)),_=1,E=D)}_>=5&&(c+=En.N1+(_-5))}return c}}En.N1=3,En.N2=3,En.N3=40,En.N4=10;class so{constructor(t,r){this.width=t,this.height=r;const c=new Array(r);for(let h=0;h!==r;h++)c[h]=new Uint8Array(t);this.bytes=c}getHeight(){return this.height}getWidth(){return this.width}get(t,r){return this.bytes[r][t]}getArray(){return this.bytes}setNumber(t,r,c){this.bytes[r][t]=c}setBoolean(t,r,c){this.bytes[r][t]=c?1:0}clear(t){for(const r of this.bytes)U.fill(r,t)}equals(t){if(!(t instanceof so))return!1;const r=t;if(this.width!==r.width||this.height!==r.height)return!1;for(let c=0,h=this.height;c<h;++c){const g=this.bytes[c],p=r.bytes[c];for(let y=0,_=this.width;y<_;++y)if(g[y]!==p[y])return!1}return!0}toString(){const t=new be;for(let r=0,c=this.height;r<c;++r){const h=this.bytes[r];for(let g=0,p=this.width;g<p;++g)switch(h[g]){case 0:t.append(" 0");break;case 1:t.append(" 1");break;default:t.append("  ");break}t.append(`
`)}return t.toString()}}class Qa{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const t=new be;return t.append(`<<
`),t.append(" mode: "),t.append(this.mode?this.mode.toString():"null"),t.append(`
 ecLevel: `),t.append(this.ecLevel?this.ecLevel.toString():"null"),t.append(`
 version: `),t.append(this.version?this.version.toString():"null"),t.append(`
 maskPattern: `),t.append(this.maskPattern.toString()),this.matrix?(t.append(`
 matrix:
`),t.append(this.matrix.toString())):t.append(`
 matrix: null
`),t.append(`>>
`),t.toString()}setMode(t){this.mode=t}setECLevel(t){this.ecLevel=t}setVersion(t){this.version=t}setMaskPattern(t){this.maskPattern=t}setMatrix(t){this.matrix=t}static isValidMaskPattern(t){return t>=0&&t<Qa.NUM_MASK_PATTERNS}}Qa.NUM_MASK_PATTERNS=8;class tn extends w{}tn.kind="WriterException";class ot{constructor(){}static clearMatrix(t){t.clear(255)}static buildMatrix(t,r,c,h,g){ot.clearMatrix(g),ot.embedBasicPatterns(c,g),ot.embedTypeInfo(r,h,g),ot.maybeEmbedVersionInfo(c,g),ot.embedDataBits(t,h,g)}static embedBasicPatterns(t,r){ot.embedPositionDetectionPatternsAndSeparators(r),ot.embedDarkDotAtLeftBottomCorner(r),ot.maybeEmbedPositionAdjustmentPatterns(t,r),ot.embedTimingPatterns(r)}static embedTypeInfo(t,r,c){const h=new K;ot.makeTypeInfoBits(t,r,h);for(let g=0,p=h.getSize();g<p;++g){const y=h.get(h.getSize()-1-g),_=ot.TYPE_INFO_COORDINATES[g],E=_[0],j=_[1];if(c.setBoolean(E,j,y),g<8){const D=c.getWidth()-g-1;c.setBoolean(D,8,y)}else{const z=c.getHeight()-7+(g-8);c.setBoolean(8,z,y)}}}static maybeEmbedVersionInfo(t,r){if(t.getVersionNumber()<7)return;const c=new K;ot.makeVersionInfoBits(t,c);let h=17;for(let g=0;g<6;++g)for(let p=0;p<3;++p){const y=c.get(h);h--,r.setBoolean(g,r.getHeight()-11+p,y),r.setBoolean(r.getHeight()-11+p,g,y)}}static embedDataBits(t,r,c){let h=0,g=-1,p=c.getWidth()-1,y=c.getHeight()-1;for(;p>0;){for(p===6&&(p-=1);y>=0&&y<c.getHeight();){for(let _=0;_<2;++_){const E=p-_;if(!ot.isEmpty(c.get(E,y)))continue;let j;h<t.getSize()?(j=t.get(h),++h):j=!1,r!==255&&En.getDataMaskBit(r,E,y)&&(j=!j),c.setBoolean(E,y,j)}y+=g}g=-g,y+=g,p-=2}if(h!==t.getSize())throw new tn("Not all bits consumed: "+h+"/"+t.getSize())}static findMSBSet(t){return 32-P.numberOfLeadingZeros(t)}static calculateBCHCode(t,r){if(r===0)throw new N("0 polynomial");const c=ot.findMSBSet(r);for(t<<=c-1;ot.findMSBSet(t)>=c;)t^=r<<ot.findMSBSet(t)-c;return t}static makeTypeInfoBits(t,r,c){if(!Qa.isValidMaskPattern(r))throw new tn("Invalid mask pattern");const h=t.getBits()<<3|r;c.appendBits(h,5);const g=ot.calculateBCHCode(h,ot.TYPE_INFO_POLY);c.appendBits(g,10);const p=new K;if(p.appendBits(ot.TYPE_INFO_MASK_PATTERN,15),c.xor(p),c.getSize()!==15)throw new tn("should not happen but we got: "+c.getSize())}static makeVersionInfoBits(t,r){r.appendBits(t.getVersionNumber(),6);const c=ot.calculateBCHCode(t.getVersionNumber(),ot.VERSION_INFO_POLY);if(r.appendBits(c,12),r.getSize()!==18)throw new tn("should not happen but we got: "+r.getSize())}static isEmpty(t){return t===255}static embedTimingPatterns(t){for(let r=8;r<t.getWidth()-8;++r){const c=(r+1)%2;ot.isEmpty(t.get(r,6))&&t.setNumber(r,6,c),ot.isEmpty(t.get(6,r))&&t.setNumber(6,r,c)}}static embedDarkDotAtLeftBottomCorner(t){if(t.get(8,t.getHeight()-8)===0)throw new tn;t.setNumber(8,t.getHeight()-8,1)}static embedHorizontalSeparationPattern(t,r,c){for(let h=0;h<8;++h){if(!ot.isEmpty(c.get(t+h,r)))throw new tn;c.setNumber(t+h,r,0)}}static embedVerticalSeparationPattern(t,r,c){for(let h=0;h<7;++h){if(!ot.isEmpty(c.get(t,r+h)))throw new tn;c.setNumber(t,r+h,0)}}static embedPositionAdjustmentPattern(t,r,c){for(let h=0;h<5;++h){const g=ot.POSITION_ADJUSTMENT_PATTERN[h];for(let p=0;p<5;++p)c.setNumber(t+p,r+h,g[p])}}static embedPositionDetectionPattern(t,r,c){for(let h=0;h<7;++h){const g=ot.POSITION_DETECTION_PATTERN[h];for(let p=0;p<7;++p)c.setNumber(t+p,r+h,g[p])}}static embedPositionDetectionPatternsAndSeparators(t){const r=ot.POSITION_DETECTION_PATTERN[0].length;ot.embedPositionDetectionPattern(0,0,t),ot.embedPositionDetectionPattern(t.getWidth()-r,0,t),ot.embedPositionDetectionPattern(0,t.getWidth()-r,t);const c=8;ot.embedHorizontalSeparationPattern(0,c-1,t),ot.embedHorizontalSeparationPattern(t.getWidth()-c,c-1,t),ot.embedHorizontalSeparationPattern(0,t.getWidth()-c,t);const h=7;ot.embedVerticalSeparationPattern(h,0,t),ot.embedVerticalSeparationPattern(t.getHeight()-h-1,0,t),ot.embedVerticalSeparationPattern(h,t.getHeight()-h,t)}static maybeEmbedPositionAdjustmentPatterns(t,r){if(t.getVersionNumber()<2)return;const c=t.getVersionNumber()-1,h=ot.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[c];for(let g=0,p=h.length;g!==p;g++){const y=h[g];if(y>=0)for(let _=0;_!==p;_++){const E=h[_];E>=0&&ot.isEmpty(r.get(E,y))&&ot.embedPositionAdjustmentPattern(E-2,y-2,r)}}}}ot.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),ot.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),ot.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),ot.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),ot.VERSION_INFO_POLY=7973,ot.TYPE_INFO_POLY=1335,ot.TYPE_INFO_MASK_PATTERN=21522;class hd{constructor(t,r){this.dataBytes=t,this.errorCorrectionBytes=r}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class mn{constructor(){}static calculateMaskPenalty(t){return En.applyMaskPenaltyRule1(t)+En.applyMaskPenaltyRule2(t)+En.applyMaskPenaltyRule3(t)+En.applyMaskPenaltyRule4(t)}static encode(t,r,c=null){let h=mn.DEFAULT_BYTE_MODE_ENCODING;const g=c!==null&&c.get(Gn.CHARACTER_SET)!==void 0;g&&(h=c.get(Gn.CHARACTER_SET).toString());const p=this.chooseMode(t,h),y=new K;if(p===at.BYTE&&(g||mn.DEFAULT_BYTE_MODE_ENCODING!==h)){const Be=q.getCharacterSetECIByName(h);Be!==void 0&&this.appendECI(Be,y)}this.appendModeInfo(p,y);const _=new K;this.appendBytes(t,p,_,h);let E;if(c!==null&&c.get(Gn.QR_VERSION)!==void 0){const Be=Number.parseInt(c.get(Gn.QR_VERSION).toString(),10);E=Ze.getVersionForNumber(Be);const Oe=this.calculateBitsNeeded(p,y,_,E);if(!this.willFit(Oe,E,r))throw new tn("Data too big for requested version")}else E=this.recommendVersion(r,p,y,_);const j=new K;j.appendBitArray(y);const D=p===at.BYTE?_.getSizeInBytes():t.length;this.appendLengthInfo(D,E,p,j),j.appendBitArray(_);const z=E.getECBlocksForLevel(r),Q=E.getTotalCodewords()-z.getTotalECCodewords();this.terminateBits(Q,j);const te=this.interleaveWithECBytes(j,E.getTotalCodewords(),Q,z.getNumBlocks()),se=new Qa;se.setECLevel(r),se.setMode(p),se.setVersion(E);const le=E.getDimensionForVersion(),pe=new so(le,le),Pe=this.chooseMaskPattern(te,r,E,pe);return se.setMaskPattern(Pe),ot.buildMatrix(te,r,E,Pe,pe),se.setMatrix(pe),se}static recommendVersion(t,r,c,h){const g=this.calculateBitsNeeded(r,c,h,Ze.getVersionForNumber(1)),p=this.chooseVersion(g,t),y=this.calculateBitsNeeded(r,c,h,p);return this.chooseVersion(y,t)}static calculateBitsNeeded(t,r,c,h){return r.getSize()+t.getCharacterCountBits(h)+c.getSize()}static getAlphanumericCode(t){return t<mn.ALPHANUMERIC_TABLE.length?mn.ALPHANUMERIC_TABLE[t]:-1}static chooseMode(t,r=null){if(q.SJIS.getName()===r&&this.isOnlyDoubleByteKanji(t))return at.KANJI;let c=!1,h=!1;for(let g=0,p=t.length;g<p;++g){const y=t.charAt(g);if(mn.isDigit(y))c=!0;else if(this.getAlphanumericCode(y.charCodeAt(0))!==-1)h=!0;else return at.BYTE}return h?at.ALPHANUMERIC:c?at.NUMERIC:at.BYTE}static isOnlyDoubleByteKanji(t){let r;try{r=ge.encode(t,q.SJIS)}catch{return!1}const c=r.length;if(c%2!==0)return!1;for(let h=0;h<c;h+=2){const g=r[h]&255;if((g<129||g>159)&&(g<224||g>235))return!1}return!0}static chooseMaskPattern(t,r,c,h){let g=Number.MAX_SAFE_INTEGER,p=-1;for(let y=0;y<Qa.NUM_MASK_PATTERNS;y++){ot.buildMatrix(t,r,c,y,h);let _=this.calculateMaskPenalty(h);_<g&&(g=_,p=y)}return p}static chooseVersion(t,r){for(let c=1;c<=40;c++){const h=Ze.getVersionForNumber(c);if(mn.willFit(t,h,r))return h}throw new tn("Data too big")}static willFit(t,r,c){const h=r.getTotalCodewords(),p=r.getECBlocksForLevel(c).getTotalECCodewords(),y=h-p,_=(t+7)/8;return y>=_}static terminateBits(t,r){const c=t*8;if(r.getSize()>c)throw new tn("data bits cannot fit in the QR Code"+r.getSize()+" > "+c);for(let p=0;p<4&&r.getSize()<c;++p)r.appendBit(!1);const h=r.getSize()&7;if(h>0)for(let p=h;p<8;p++)r.appendBit(!1);const g=t-r.getSizeInBytes();for(let p=0;p<g;++p)r.appendBits((p&1)===0?236:17,8);if(r.getSize()!==c)throw new tn("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(t,r,c,h,g,p){if(h>=c)throw new tn("Block ID too large");const y=t%c,_=c-y,E=Math.floor(t/c),j=E+1,D=Math.floor(r/c),z=D+1,Q=E-D,te=j-z;if(Q!==te)throw new tn("EC bytes mismatch");if(c!==_+y)throw new tn("RS blocks mismatch");if(t!==(D+Q)*_+(z+te)*y)throw new tn("Total bytes mismatch");h<_?(g[0]=D,p[0]=Q):(g[0]=z,p[0]=te)}static interleaveWithECBytes(t,r,c,h){if(t.getSizeInBytes()!==c)throw new tn("Number of bits and data bytes does not match");let g=0,p=0,y=0;const _=new Array;for(let j=0;j<h;++j){const D=new Int32Array(1),z=new Int32Array(1);mn.getNumDataBytesAndNumECBytesForBlockID(r,c,h,j,D,z);const Q=D[0],te=new Uint8Array(Q);t.toBytes(8*g,te,0,Q);const se=mn.generateECBytes(te,z[0]);_.push(new hd(te,se)),p=Math.max(p,Q),y=Math.max(y,se.length),g+=D[0]}if(c!==g)throw new tn("Data bytes does not match offset");const E=new K;for(let j=0;j<p;++j)for(const D of _){const z=D.getDataBytes();j<z.length&&E.appendBits(z[j],8)}for(let j=0;j<y;++j)for(const D of _){const z=D.getErrorCorrectionBytes();j<z.length&&E.appendBits(z[j],8)}if(r!==E.getSizeInBytes())throw new tn("Interleaving error: "+r+" and "+E.getSizeInBytes()+" differ.");return E}static generateECBytes(t,r){const c=t.length,h=new Int32Array(c+r);for(let p=0;p<c;p++)h[p]=t[p]&255;new xi(ft.QR_CODE_FIELD_256).encode(h,r);const g=new Uint8Array(r);for(let p=0;p<r;p++)g[p]=h[c+p];return g}static appendModeInfo(t,r){r.appendBits(t.getBits(),4)}static appendLengthInfo(t,r,c,h){const g=c.getCharacterCountBits(r);if(t>=1<<g)throw new tn(t+" is bigger than "+((1<<g)-1));h.appendBits(t,g)}static appendBytes(t,r,c,h){switch(r){case at.NUMERIC:mn.appendNumericBytes(t,c);break;case at.ALPHANUMERIC:mn.appendAlphanumericBytes(t,c);break;case at.BYTE:mn.append8BitBytes(t,c,h);break;case at.KANJI:mn.appendKanjiBytes(t,c);break;default:throw new tn("Invalid mode: "+r)}}static getDigit(t){return t.charCodeAt(0)-48}static isDigit(t){const r=mn.getDigit(t);return r>=0&&r<=9}static appendNumericBytes(t,r){const c=t.length;let h=0;for(;h<c;){const g=mn.getDigit(t.charAt(h));if(h+2<c){const p=mn.getDigit(t.charAt(h+1)),y=mn.getDigit(t.charAt(h+2));r.appendBits(g*100+p*10+y,10),h+=3}else if(h+1<c){const p=mn.getDigit(t.charAt(h+1));r.appendBits(g*10+p,7),h+=2}else r.appendBits(g,4),h++}}static appendAlphanumericBytes(t,r){const c=t.length;let h=0;for(;h<c;){const g=mn.getAlphanumericCode(t.charCodeAt(h));if(g===-1)throw new tn;if(h+1<c){const p=mn.getAlphanumericCode(t.charCodeAt(h+1));if(p===-1)throw new tn;r.appendBits(g*45+p,11),h+=2}else r.appendBits(g,6),h++}}static append8BitBytes(t,r,c){let h;try{h=ge.encode(t,c)}catch(g){throw new tn(g)}for(let g=0,p=h.length;g!==p;g++){const y=h[g];r.appendBits(y,8)}}static appendKanjiBytes(t,r){let c;try{c=ge.encode(t,q.SJIS)}catch(g){throw new tn(g)}const h=c.length;for(let g=0;g<h;g+=2){const p=c[g]&255,y=c[g+1]&255,_=p<<8&4294967295|y;let E=-1;if(_>=33088&&_<=40956?E=_-33088:_>=57408&&_<=60351&&(E=_-49472),E===-1)throw new tn("Invalid byte sequence");const j=(E>>8)*192+(E&255);r.appendBits(j,13)}}static appendECI(t,r){r.appendBits(at.ECI.getBits(),4),r.appendBits(t.getValue(),8)}}mn.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),mn.DEFAULT_BYTE_MODE_ENCODING=q.UTF8.getName();class Ka{write(t,r,c,h=null){if(t.length===0)throw new N("Found empty contents");if(r<0||c<0)throw new N("Requested dimensions are too small: "+r+"x"+c);let g=Tt.L,p=Ka.QUIET_ZONE_SIZE;h!==null&&(h.get(Gn.ERROR_CORRECTION)!==void 0&&(g=Tt.fromString(h.get(Gn.ERROR_CORRECTION).toString())),h.get(Gn.MARGIN)!==void 0&&(p=Number.parseInt(h.get(Gn.MARGIN).toString(),10)));const y=mn.encode(t,g,h);return this.renderResult(y,r,c,p)}writeToDom(t,r,c,h,g=null){typeof t=="string"&&(t=document.querySelector(t));const p=this.write(r,c,h,g);t&&t.appendChild(p)}renderResult(t,r,c,h){const g=t.getMatrix();if(g===null)throw new xn;const p=g.getWidth(),y=g.getHeight(),_=p+h*2,E=y+h*2,j=Math.max(r,_),D=Math.max(c,E),z=Math.min(Math.floor(j/_),Math.floor(D/E)),Q=Math.floor((j-p*z)/2),te=Math.floor((D-y*z)/2),se=this.createSVGElement(j,D);for(let le=0,pe=te;le<y;le++,pe+=z)for(let Pe=0,Be=Q;Pe<p;Pe++,Be+=z)if(g.get(Pe,le)===1){const Oe=this.createSvgRectElement(Be,pe,z,z);se.appendChild(Oe)}return se}createSVGElement(t,r){const c=document.createElementNS(Ka.SVG_NS,"svg");return c.setAttributeNS(null,"height",t.toString()),c.setAttributeNS(null,"width",r.toString()),c}createSvgRectElement(t,r,c,h){const g=document.createElementNS(Ka.SVG_NS,"rect");return g.setAttributeNS(null,"x",t.toString()),g.setAttributeNS(null,"y",r.toString()),g.setAttributeNS(null,"height",c.toString()),g.setAttributeNS(null,"width",h.toString()),g.setAttributeNS(null,"fill","#000000"),g}}Ka.QUIET_ZONE_SIZE=4,Ka.SVG_NS="http://www.w3.org/2000/svg";class Ir{encode(t,r,c,h,g){if(t.length===0)throw new N("Found empty contents");if(r!==Ne.QR_CODE)throw new N("Can only encode QR_CODE, but got "+r);if(c<0||h<0)throw new N(`Requested dimensions are too small: ${c}x${h}`);let p=Tt.L,y=Ir.QUIET_ZONE_SIZE;g!==null&&(g.get(Gn.ERROR_CORRECTION)!==void 0&&(p=Tt.fromString(g.get(Gn.ERROR_CORRECTION).toString())),g.get(Gn.MARGIN)!==void 0&&(y=Number.parseInt(g.get(Gn.MARGIN).toString(),10)));const _=mn.encode(t,p,g);return Ir.renderResult(_,c,h,y)}static renderResult(t,r,c,h){const g=t.getMatrix();if(g===null)throw new xn;const p=g.getWidth(),y=g.getHeight(),_=p+h*2,E=y+h*2,j=Math.max(r,_),D=Math.max(c,E),z=Math.min(Math.floor(j/_),Math.floor(D/E)),Q=Math.floor((j-p*z)/2),te=Math.floor((D-y*z)/2),se=new Ie(j,D);for(let le=0,pe=te;le<y;le++,pe+=z)for(let Pe=0,Be=Q;Pe<p;Pe++,Be+=z)g.get(Pe,le)===1&&se.setRegion(Be,pe,z,z);return se}}Ir.QUIET_ZONE_SIZE=4;class fd{encode(t,r,c,h,g){let p;switch(r){case Ne.QR_CODE:p=new Ir;break;default:throw new N("No encoder available for format "+r)}return p.encode(t,r,c,h,g)}}class ua extends ke{constructor(t,r,c,h,g,p,y,_){if(super(p,y),this.yuvData=t,this.dataWidth=r,this.dataHeight=c,this.left=h,this.top=g,h+p>r||g+y>c)throw new N("Crop rectangle does not fit within image data.");_&&this.reverseHorizontal(p,y)}getRow(t,r){if(t<0||t>=this.getHeight())throw new N("Requested row is outside the image: "+t);const c=this.getWidth();(r==null||r.length<c)&&(r=new Uint8ClampedArray(c));const h=(t+this.top)*this.dataWidth+this.left;return L.arraycopy(this.yuvData,h,r,0,c),r}getMatrix(){const t=this.getWidth(),r=this.getHeight();if(t===this.dataWidth&&r===this.dataHeight)return this.yuvData;const c=t*r,h=new Uint8ClampedArray(c);let g=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return L.arraycopy(this.yuvData,g,h,0,c),h;for(let p=0;p<r;p++){const y=p*t;L.arraycopy(this.yuvData,g,h,y,t),g+=this.dataWidth}return h}isCropSupported(){return!0}crop(t,r,c,h){return new ua(this.yuvData,this.dataWidth,this.dataHeight,this.left+t,this.top+r,c,h,!1)}renderThumbnail(){const t=this.getWidth()/ua.THUMBNAIL_SCALE_FACTOR,r=this.getHeight()/ua.THUMBNAIL_SCALE_FACTOR,c=new Int32Array(t*r),h=this.yuvData;let g=this.top*this.dataWidth+this.left;for(let p=0;p<r;p++){const y=p*t;for(let _=0;_<t;_++){const E=h[g+_*ua.THUMBNAIL_SCALE_FACTOR]&255;c[y+_]=4278190080|E*65793}g+=this.dataWidth*ua.THUMBNAIL_SCALE_FACTOR}return c}getThumbnailWidth(){return this.getWidth()/ua.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/ua.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(t,r){const c=this.yuvData;for(let h=0,g=this.top*this.dataWidth+this.left;h<r;h++,g+=this.dataWidth){const p=g+t/2;for(let y=g,_=g+t-1;y<p;y++,_--){const E=c[y];c[y]=c[_],c[_]=E}}}invert(){return new Ge(this)}}ua.THUMBNAIL_SCALE_FACTOR=2;class ol extends ke{constructor(t,r,c,h,g,p,y){if(super(r,c),this.dataWidth=h,this.dataHeight=g,this.left=p,this.top=y,t.BYTES_PER_ELEMENT===4){const _=r*c,E=new Uint8ClampedArray(_);for(let j=0;j<_;j++){const D=t[j],z=D>>16&255,Q=D>>7&510,te=D&255;E[j]=(z+Q+te)/4&255}this.luminances=E}else this.luminances=t;if(h===void 0&&(this.dataWidth=r),g===void 0&&(this.dataHeight=c),p===void 0&&(this.left=0),y===void 0&&(this.top=0),this.left+r>this.dataWidth||this.top+c>this.dataHeight)throw new N("Crop rectangle does not fit within image data.")}getRow(t,r){if(t<0||t>=this.getHeight())throw new N("Requested row is outside the image: "+t);const c=this.getWidth();(r==null||r.length<c)&&(r=new Uint8ClampedArray(c));const h=(t+this.top)*this.dataWidth+this.left;return L.arraycopy(this.luminances,h,r,0,c),r}getMatrix(){const t=this.getWidth(),r=this.getHeight();if(t===this.dataWidth&&r===this.dataHeight)return this.luminances;const c=t*r,h=new Uint8ClampedArray(c);let g=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return L.arraycopy(this.luminances,g,h,0,c),h;for(let p=0;p<r;p++){const y=p*t;L.arraycopy(this.luminances,g,h,y,t),g+=this.dataWidth}return h}isCropSupported(){return!0}crop(t,r,c,h){return new ol(this.luminances,c,h,this.dataWidth,this.dataHeight,this.left+t,this.top+r)}invert(){return new Ge(this)}}class gc extends q{static forName(t){return this.getCharacterSetECIByName(t)}}class yi{}yi.ISO_8859_1=q.ISO8859_1;class Or{isCompact(){return this.compact}setCompact(t){this.compact=t}getSize(){return this.size}setSize(t){this.size=t}getLayers(){return this.layers}setLayers(t){this.layers=t}getCodeWords(){return this.codeWords}setCodeWords(t){this.codeWords=t}getMatrix(){return this.matrix}setMatrix(t){this.matrix=t}}class mc{static singletonList(t){return[t]}static min(t,r){return t.sort(r)[0]}}class pc{constructor(t){this.previous=t}getPrevious(){return this.previous}}class Za extends pc{constructor(t,r,c){super(t),this.value=r,this.bitCount=c}appendTo(t,r){t.appendBits(this.value,this.bitCount)}add(t,r){return new Za(this,t,r)}addBinaryShift(t,r){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Za(this,t,r)}toString(){let t=this.value&(1<<this.bitCount)-1;return t|=1<<this.bitCount,"<"+P.toBinaryString(t|1<<this.bitCount).substring(1)+">"}}class ao extends Za{constructor(t,r,c){super(t,0,0),this.binaryShiftStart=r,this.binaryShiftByteCount=c}appendTo(t,r){for(let c=0;c<this.binaryShiftByteCount;c++)(c===0||c===31&&this.binaryShiftByteCount<=62)&&(t.appendBits(31,5),this.binaryShiftByteCount>62?t.appendBits(this.binaryShiftByteCount-31,16):c===0?t.appendBits(Math.min(this.binaryShiftByteCount,31),5):t.appendBits(this.binaryShiftByteCount-31,5)),t.appendBits(r[this.binaryShiftStart+c],8)}addBinaryShift(t,r){return new ao(this,t,r)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function xc(k,t,r){return new ao(k,t,r)}function Mr(k,t,r){return new Za(k,t,r)}const kr=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Pa=0,ro=1,Ds=2,ll=3,Ws=4,wi=new Za(null,0,0),$a=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function gd(k){for(let t of k)U.fill(t,-1);return k[Pa][Ws]=0,k[ro][Ws]=0,k[ro][Pa]=28,k[ll][Ws]=0,k[Ds][Ws]=0,k[Ds][Pa]=15,k}const bi=gd(U.createInt32Array(6,6));class Qs{constructor(t,r,c,h){this.token=t,this.mode=r,this.binaryShiftByteCount=c,this.bitCount=h}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(t,r){let c=this.bitCount,h=this.token;if(t!==this.mode){let p=$a[this.mode][t];h=Mr(h,p&65535,p>>16),c+=p>>16}let g=t===Ds?4:5;return h=Mr(h,r,g),new Qs(h,t,0,c+g)}shiftAndAppend(t,r){let c=this.token,h=this.mode===Ds?4:5;return c=Mr(c,bi[this.mode][t],h),c=Mr(c,r,5),new Qs(c,this.mode,0,this.bitCount+h+5)}addBinaryShiftChar(t){let r=this.token,c=this.mode,h=this.bitCount;if(this.mode===Ws||this.mode===Ds){let y=$a[c][Pa];r=Mr(r,y&65535,y>>16),h+=y>>16,c=Pa}let g=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,p=new Qs(r,c,this.binaryShiftByteCount+1,h+g);return p.binaryShiftByteCount===2078&&(p=p.endBinaryShift(t+1)),p}endBinaryShift(t){if(this.binaryShiftByteCount===0)return this;let r=this.token;return r=xc(r,t-this.binaryShiftByteCount,this.binaryShiftByteCount),new Qs(r,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(t){let r=this.bitCount+($a[this.mode][t.mode]>>16);return this.binaryShiftByteCount<t.binaryShiftByteCount?r+=Qs.calculateBinaryShiftCost(t)-Qs.calculateBinaryShiftCost(this):this.binaryShiftByteCount>t.binaryShiftByteCount&&t.binaryShiftByteCount>0&&(r+=10),r<=t.bitCount}toBitArray(t){let r=[];for(let h=this.endBinaryShift(t.length).token;h!==null;h=h.getPrevious())r.unshift(h);let c=new K;for(const h of r)h.appendTo(c,t);return c}toString(){return ie.format("%s bits=%d bytes=%d",kr[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(t){return t.binaryShiftByteCount>62?21:t.binaryShiftByteCount>31?20:t.binaryShiftByteCount>0?10:0}}Qs.INITIAL_STATE=new Qs(wi,Pa,0,0);function yc(k){const t=ie.getCharCode(" "),r=ie.getCharCode("."),c=ie.getCharCode(",");k[Pa][t]=1;const h=ie.getCharCode("Z"),g=ie.getCharCode("A");for(let z=g;z<=h;z++)k[Pa][z]=z-g+2;k[ro][t]=1;const p=ie.getCharCode("z"),y=ie.getCharCode("a");for(let z=y;z<=p;z++)k[ro][z]=z-y+2;k[Ds][t]=1;const _=ie.getCharCode("9"),E=ie.getCharCode("0");for(let z=E;z<=_;z++)k[Ds][z]=z-E+2;k[Ds][c]=12,k[Ds][r]=13;const j=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let z=0;z<j.length;z++)k[ll][ie.getCharCode(j[z])]=z;const D=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let z=0;z<D.length;z++)ie.getCharCode(D[z])>0&&(k[Ws][ie.getCharCode(D[z])]=z);return k}const vi=yc(U.createInt32Array(5,256));class Ja{constructor(t){this.text=t}encode(){const t=ie.getCharCode(" "),r=ie.getCharCode(`
`);let c=mc.singletonList(Qs.INITIAL_STATE);for(let g=0;g<this.text.length;g++){let p,y=g+1<this.text.length?this.text[g+1]:0;switch(this.text[g]){case ie.getCharCode("\r"):p=y===r?2:0;break;case ie.getCharCode("."):p=y===t?3:0;break;case ie.getCharCode(","):p=y===t?4:0;break;case ie.getCharCode(":"):p=y===t?5:0;break;default:p=0}p>0?(c=Ja.updateStateListForPair(c,g,p),g++):c=this.updateStateListForChar(c,g)}return mc.min(c,(g,p)=>g.getBitCount()-p.getBitCount()).toBitArray(this.text)}updateStateListForChar(t,r){const c=[];for(let h of t)this.updateStateForChar(h,r,c);return Ja.simplifyStates(c)}updateStateForChar(t,r,c){let h=this.text[r]&255,g=vi[t.getMode()][h]>0,p=null;for(let y=0;y<=Ws;y++){let _=vi[y][h];if(_>0){if(p==null&&(p=t.endBinaryShift(r)),!g||y===t.getMode()||y===Ds){const E=p.latchAndAppend(y,_);c.push(E)}if(!g&&bi[t.getMode()][y]>=0){const E=p.shiftAndAppend(y,_);c.push(E)}}}if(t.getBinaryShiftByteCount()>0||vi[t.getMode()][h]===0){let y=t.addBinaryShiftChar(r);c.push(y)}}static updateStateListForPair(t,r,c){const h=[];for(let g of t)this.updateStateForPair(g,r,c,h);return this.simplifyStates(h)}static updateStateForPair(t,r,c,h){let g=t.endBinaryShift(r);if(h.push(g.latchAndAppend(Ws,c)),t.getMode()!==Ws&&h.push(g.shiftAndAppend(Ws,c)),c===3||c===4){let p=g.latchAndAppend(Ds,16-c).latchAndAppend(Ds,1);h.push(p)}if(t.getBinaryShiftByteCount()>0){let p=t.addBinaryShiftChar(r).addBinaryShiftChar(r+1);h.push(p)}}static simplifyStates(t){let r=[];for(const c of t){let h=!0;for(const g of r){if(g.isBetterThanOrEqualTo(c)){h=!1;break}c.isBetterThanOrEqualTo(g)&&(r=r.filter(p=>p!==g))}h&&r.push(c)}return r}}class kt{constructor(){}static encodeBytes(t){return kt.encode(t,kt.DEFAULT_EC_PERCENT,kt.DEFAULT_AZTEC_LAYERS)}static encode(t,r,c){let h=new Ja(t).encode(),g=P.truncDivision(h.getSize()*r,100)+11,p=h.getSize()+g,y,_,E,j,D;if(c!==kt.DEFAULT_AZTEC_LAYERS){if(y=c<0,_=Math.abs(c),_>(y?kt.MAX_NB_BITS_COMPACT:kt.MAX_NB_BITS))throw new N(ie.format("Illegal value %s for layers",c));E=kt.totalBitsInLayer(_,y),j=kt.WORD_SIZE[_];let Oe=E-E%j;if(D=kt.stuffBits(h,j),D.getSize()+g>Oe)throw new N("Data to large for user specified layer");if(y&&D.getSize()>j*64)throw new N("Data to large for user specified layer")}else{j=0,D=null;for(let Oe=0;;Oe++){if(Oe>kt.MAX_NB_BITS)throw new N("Data too large for an Aztec code");if(y=Oe<=3,_=y?Oe+1:Oe,E=kt.totalBitsInLayer(_,y),p>E)continue;(D==null||j!==kt.WORD_SIZE[_])&&(j=kt.WORD_SIZE[_],D=kt.stuffBits(h,j));let At=E-E%j;if(!(y&&D.getSize()>j*64)&&D.getSize()+g<=At)break}}let z=kt.generateCheckWords(D,E,j),Q=D.getSize()/j,te=kt.generateModeMessage(y,_,Q),se=(y?11:14)+_*4,le=new Int32Array(se),pe;if(y){pe=se;for(let Oe=0;Oe<le.length;Oe++)le[Oe]=Oe}else{pe=se+1+2*P.truncDivision(P.truncDivision(se,2)-1,15);let Oe=P.truncDivision(se,2),At=P.truncDivision(pe,2);for(let yt=0;yt<Oe;yt++){let Un=yt+P.truncDivision(yt,15);le[Oe-yt-1]=At-Un-1,le[Oe+yt]=At+Un+1}}let Pe=new Ie(pe);for(let Oe=0,At=0;Oe<_;Oe++){let yt=(_-Oe)*4+(y?9:12);for(let Un=0;Un<yt;Un++){let Ls=Un*2;for(let ms=0;ms<2;ms++)z.get(At+Ls+ms)&&Pe.set(le[Oe*2+ms],le[Oe*2+Un]),z.get(At+yt*2+Ls+ms)&&Pe.set(le[Oe*2+Un],le[se-1-Oe*2-ms]),z.get(At+yt*4+Ls+ms)&&Pe.set(le[se-1-Oe*2-ms],le[se-1-Oe*2-Un]),z.get(At+yt*6+Ls+ms)&&Pe.set(le[se-1-Oe*2-Un],le[Oe*2+ms])}At+=yt*8}if(kt.drawModeMessage(Pe,y,pe,te),y)kt.drawBullsEye(Pe,P.truncDivision(pe,2),5);else{kt.drawBullsEye(Pe,P.truncDivision(pe,2),7);for(let Oe=0,At=0;Oe<P.truncDivision(se,2)-1;Oe+=15,At+=16)for(let yt=P.truncDivision(pe,2)&1;yt<pe;yt+=2)Pe.set(P.truncDivision(pe,2)-At,yt),Pe.set(P.truncDivision(pe,2)+At,yt),Pe.set(yt,P.truncDivision(pe,2)-At),Pe.set(yt,P.truncDivision(pe,2)+At)}let Be=new Or;return Be.setCompact(y),Be.setSize(pe),Be.setLayers(_),Be.setCodeWords(Q),Be.setMatrix(Pe),Be}static drawBullsEye(t,r,c){for(let h=0;h<c;h+=2)for(let g=r-h;g<=r+h;g++)t.set(g,r-h),t.set(g,r+h),t.set(r-h,g),t.set(r+h,g);t.set(r-c,r-c),t.set(r-c+1,r-c),t.set(r-c,r-c+1),t.set(r+c,r-c),t.set(r+c,r-c+1),t.set(r+c,r+c-1)}static generateModeMessage(t,r,c){let h=new K;return t?(h.appendBits(r-1,2),h.appendBits(c-1,6),h=kt.generateCheckWords(h,28,4)):(h.appendBits(r-1,5),h.appendBits(c-1,11),h=kt.generateCheckWords(h,40,4)),h}static drawModeMessage(t,r,c,h){let g=P.truncDivision(c,2);if(r)for(let p=0;p<7;p++){let y=g-3+p;h.get(p)&&t.set(y,g-5),h.get(p+7)&&t.set(g+5,y),h.get(20-p)&&t.set(y,g+5),h.get(27-p)&&t.set(g-5,y)}else for(let p=0;p<10;p++){let y=g-5+p+P.truncDivision(p,5);h.get(p)&&t.set(y,g-7),h.get(p+10)&&t.set(g+7,y),h.get(29-p)&&t.set(y,g+7),h.get(39-p)&&t.set(g-7,y)}}static generateCheckWords(t,r,c){let h=t.getSize()/c,g=new xi(kt.getGF(c)),p=P.truncDivision(r,c),y=kt.bitsToWords(t,c,p);g.encode(y,p-h);let _=r%c,E=new K;E.appendBits(0,_);for(const j of Array.from(y))E.appendBits(j,c);return E}static bitsToWords(t,r,c){let h=new Int32Array(c),g,p;for(g=0,p=t.getSize()/r;g<p;g++){let y=0;for(let _=0;_<r;_++)y|=t.get(g*r+_)?1<<r-_-1:0;h[g]=y}return h}static getGF(t){switch(t){case 4:return ft.AZTEC_PARAM;case 6:return ft.AZTEC_DATA_6;case 8:return ft.AZTEC_DATA_8;case 10:return ft.AZTEC_DATA_10;case 12:return ft.AZTEC_DATA_12;default:throw new N("Unsupported word size "+t)}}static stuffBits(t,r){let c=new K,h=t.getSize(),g=(1<<r)-2;for(let p=0;p<h;p+=r){let y=0;for(let _=0;_<r;_++)(p+_>=h||t.get(p+_))&&(y|=1<<r-1-_);(y&g)===g?(c.appendBits(y&g,r),p--):(y&g)===0?(c.appendBits(y|1,r),p--):c.appendBits(y,r)}return c}static totalBitsInLayer(t,r){return((r?88:112)+16*t)*t}}kt.DEFAULT_EC_PERCENT=33,kt.DEFAULT_AZTEC_LAYERS=0,kt.MAX_NB_BITS=32,kt.MAX_NB_BITS_COMPACT=4,kt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Ci{encode(t,r,c,h){return this.encodeWithHints(t,r,c,h,null)}encodeWithHints(t,r,c,h,g){let p=yi.ISO_8859_1,y=kt.DEFAULT_EC_PERCENT,_=kt.DEFAULT_AZTEC_LAYERS;return g!=null&&(g.has(Gn.CHARACTER_SET)&&(p=gc.forName(g.get(Gn.CHARACTER_SET).toString())),g.has(Gn.ERROR_CORRECTION)&&(y=P.parseInt(g.get(Gn.ERROR_CORRECTION).toString())),g.has(Gn.AZTEC_LAYERS)&&(_=P.parseInt(g.get(Gn.AZTEC_LAYERS).toString()))),Ci.encodeLayers(t,r,c,h,p,y,_)}static encodeLayers(t,r,c,h,g,p,y){if(r!==Ne.AZTEC)throw new N("Can only encode AZTEC, but got "+r);let _=kt.encode(ie.getBytes(t,g),p,y);return Ci.renderResult(_,c,h)}static renderResult(t,r,c){let h=t.getMatrix();if(h==null)throw new xn;let g=h.getWidth(),p=h.getHeight(),y=Math.max(r,g),_=Math.max(c,p),E=Math.min(y/g,_/p),j=(y-g*E)/2,D=(_-p*E)/2,z=new Ie(y,_);for(let Q=0,te=D;Q<p;Q++,te+=E)for(let se=0,le=j;se<g;se++,le+=E)h.get(se,Q)&&z.setRegion(le,te,E,E);return z}}a.AbstractExpandedDecoder=Ee,a.ArgumentException=A,a.ArithmeticException=Wt,a.AztecCode=Or,a.AztecCodeReader=jn,a.AztecCodeWriter=Ci,a.AztecDecoder=Nt,a.AztecDetector=qn,a.AztecDetectorResult=Me,a.AztecEncoder=kt,a.AztecHighLevelEncoder=Ja,a.AztecPoint=Vt,a.BarcodeFormat=Ne,a.Binarizer=O,a.BinaryBitmap=R,a.BitArray=K,a.BitMatrix=Ie,a.BitSource=Ys,a.BrowserAztecCodeReader=ts,a.BrowserBarcodeReader=od,a.BrowserCodeReader=Le,a.BrowserDatamatrixCodeReader=Zi,a.BrowserMultiFormatReader=fc,a.BrowserPDF417Reader=ud,a.BrowserQRCodeReader=dd,a.BrowserQRCodeSvgWriter=Ka,a.CharacterSetECI=q,a.ChecksumException=T,a.Code128Reader=je,a.Code39Reader=lt,a.DataMatrixDecodedBitStreamParser=Ca,a.DataMatrixReader=_a,a.DecodeHintType=W,a.DecoderResult=Ce,a.DefaultGridSampler=Tn,a.DetectorResult=Is,a.EAN13Reader=Rn,a.EncodeHintType=Gn,a.Exception=w,a.FormatException=X,a.GenericGF=ft,a.GenericGFPoly=mt,a.GlobalHistogramBinarizer=$,a.GridSampler=nt,a.GridSamplerInstance=sn,a.HTMLCanvasElementLuminanceSource=Ke,a.HybridBinarizer=oe,a.ITFReader=gt,a.IllegalArgumentException=N,a.IllegalStateException=xn,a.InvertedLuminanceSource=Ge,a.LuminanceSource=ke,a.MathUtils=ht,a.MultiFormatOneDReader=Gs,a.MultiFormatReader=hc,a.MultiFormatWriter=fd,a.NotFoundException=V,a.OneDReader=Ut,a.PDF417DecodedBitStreamParser=xe,a.PDF417DecoderErrorCorrection=Ea,a.PDF417Reader=as,a.PDF417ResultMetadata=Rr,a.PerspectiveTransform=_t,a.PlanarYUVLuminanceSource=ua,a.QRCodeByteMatrix=so,a.QRCodeDataMask=Es,a.QRCodeDecodedBitStreamParser=fn,a.QRCodeDecoderErrorCorrectionLevel=Tt,a.QRCodeDecoderFormatInformation=Wn,a.QRCodeEncoder=mn,a.QRCodeEncoderQRCode=Qa,a.QRCodeMaskUtil=En,a.QRCodeMatrixUtil=ot,a.QRCodeMode=at,a.QRCodeReader=Sa,a.QRCodeVersion=Ze,a.QRCodeWriter=Ir,a.RGBLuminanceSource=ol,a.RSS14Reader=en,a.RSSExpandedReader=Re,a.ReaderException=no,a.ReedSolomonDecoder=cn,a.ReedSolomonEncoder=xi,a.ReedSolomonException=Mt,a.Result=Ue,a.ResultMetadataType=De,a.ResultPoint=ze,a.StringUtils=ie,a.UnsupportedOperationException=he,a.VideoInputDevice=ne,a.WhiteRectangleDetector=Fe,a.WriterException=tn,a.ZXingArrays=U,a.ZXingCharset=gc,a.ZXingInteger=P,a.ZXingStandardCharsets=yi,a.ZXingStringBuilder=be,a.ZXingStringEncoding=ge,a.ZXingSystem=L,a.createAbstractExpandedDecoder=_r,Object.defineProperty(a,"__esModule",{value:!0})}))})(Xl,Xl.exports)),Xl.exports}var Sn=GE();const YE=Qu(Sn),XE=Ux({__proto__:null,default:YE},[Sn]);var Ex=(function(){function i(n,a,l){if(this.formatMap=new Map([[Ye.QR_CODE,Sn.BarcodeFormat.QR_CODE],[Ye.AZTEC,Sn.BarcodeFormat.AZTEC],[Ye.CODABAR,Sn.BarcodeFormat.CODABAR],[Ye.CODE_39,Sn.BarcodeFormat.CODE_39],[Ye.CODE_93,Sn.BarcodeFormat.CODE_93],[Ye.CODE_128,Sn.BarcodeFormat.CODE_128],[Ye.DATA_MATRIX,Sn.BarcodeFormat.DATA_MATRIX],[Ye.MAXICODE,Sn.BarcodeFormat.MAXICODE],[Ye.ITF,Sn.BarcodeFormat.ITF],[Ye.EAN_13,Sn.BarcodeFormat.EAN_13],[Ye.EAN_8,Sn.BarcodeFormat.EAN_8],[Ye.PDF_417,Sn.BarcodeFormat.PDF_417],[Ye.RSS_14,Sn.BarcodeFormat.RSS_14],[Ye.RSS_EXPANDED,Sn.BarcodeFormat.RSS_EXPANDED],[Ye.UPC_A,Sn.BarcodeFormat.UPC_A],[Ye.UPC_E,Sn.BarcodeFormat.UPC_E],[Ye.UPC_EAN_EXTENSION,Sn.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!XE)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=a,this.logger=l;var d=this.createZXingFormats(n),f=new Map;f.set(Sn.DecodeHintType.POSSIBLE_FORMATS,d),f.set(Sn.DecodeHintType.TRY_HARDER,!1),this.hints=f}return i.prototype.decodeAsync=function(n){var a=this;return new Promise(function(l,d){try{l(a.decode(n))}catch(f){d(f)}})},i.prototype.decode=function(n){var a=new Sn.MultiFormatReader(this.verbose,this.hints),l=new Sn.HTMLCanvasElementLuminanceSource(n),d=new Sn.BinaryBitmap(new Sn.HybridBinarizer(l)),f=a.decode(d);return{text:f.text,format:fy.create(this.toHtml5QrcodeSupportedFormats(f.format)),debugData:this.createDebugData()}},i.prototype.createReverseFormatMap=function(){var n=new Map;return this.formatMap.forEach(function(a,l,d){n.set(a,l)}),n},i.prototype.toHtml5QrcodeSupportedFormats=function(n){if(!this.reverseFormatMap.has(n))throw"reverseFormatMap doesn't have ".concat(n);return this.reverseFormatMap.get(n)},i.prototype.createZXingFormats=function(n){for(var a=[],l=0,d=n;l<d.length;l++){var f=d[l];this.formatMap.has(f)?a.push(this.formatMap.get(f)):this.logger.logError("".concat(f," is not supported by")+"ZXingHtml5QrcodeShim")}return a},i.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},i})(),WE=function(i,n,a,l){function d(f){return f instanceof a?f:new a(function(x){x(f)})}return new(a||(a=Promise))(function(f,x){function v(A){try{w(l.next(A))}catch(N){x(N)}}function C(A){try{w(l.throw(A))}catch(N){x(N)}}function w(A){A.done?f(A.value):d(A.value).then(v,C)}w((l=l.apply(i,n||[])).next())})},QE=function(i,n){var a={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},l,d,f,x;return x={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function v(w){return function(A){return C([w,A])}}function C(w){if(l)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(a=0)),a;)try{if(l=1,d&&(f=w[0]&2?d.return:w[0]?d.throw||((f=d.return)&&f.call(d),0):d.next)&&!(f=f.call(d,w[1])).done)return f;switch(d=0,f&&(w=[w[0]&2,f.value]),w[0]){case 0:case 1:f=w;break;case 4:return a.label++,{value:w[1],done:!1};case 5:a.label++,d=w[1],w=[0];continue;case 7:w=a.ops.pop(),a.trys.pop();continue;default:if(f=a.trys,!(f=f.length>0&&f[f.length-1])&&(w[0]===6||w[0]===2)){a=0;continue}if(w[0]===3&&(!f||w[1]>f[0]&&w[1]<f[3])){a.label=w[1];break}if(w[0]===6&&a.label<f[1]){a.label=f[1],f=w;break}if(f&&a.label<f[2]){a.label=f[2],a.ops.push(w);break}f[2]&&a.ops.pop(),a.trys.pop();continue}w=n.call(i,a)}catch(A){w=[6,A],d=0}finally{l=f=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},Ax=(function(){function i(n,a,l){if(this.formatMap=new Map([[Ye.QR_CODE,"qr_code"],[Ye.AZTEC,"aztec"],[Ye.CODABAR,"codabar"],[Ye.CODE_39,"code_39"],[Ye.CODE_93,"code_93"],[Ye.CODE_128,"code_128"],[Ye.DATA_MATRIX,"data_matrix"],[Ye.ITF,"itf"],[Ye.EAN_13,"ean_13"],[Ye.EAN_8,"ean_8"],[Ye.PDF_417,"pdf417"],[Ye.UPC_A,"upc_a"],[Ye.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!i.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=a,this.logger=l;var d=this.createBarcodeDetectorFormats(n);if(this.detector=new BarcodeDetector(d),!this.detector)throw"BarcodeDetector detector not supported"}return i.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var n=new BarcodeDetector({formats:["qr_code"]});return typeof n<"u"},i.prototype.decodeAsync=function(n){return WE(this,void 0,void 0,function(){var a,l;return QE(this,function(d){switch(d.label){case 0:return[4,this.detector.detect(n)];case 1:if(a=d.sent(),!a||a.length===0)throw"No barcode or QR code detected.";return l=this.selectLargestBarcode(a),[2,{text:l.rawValue,format:fy.create(this.toHtml5QrcodeSupportedFormats(l.format)),debugData:this.createDebugData()}]}})})},i.prototype.selectLargestBarcode=function(n){for(var a=null,l=0,d=0,f=n;d<f.length;d++){var x=f[d],v=x.boundingBox.width*x.boundingBox.height;v>l&&(l=v,a=x)}if(!a)throw"No largest barcode found";return a},i.prototype.createBarcodeDetectorFormats=function(n){for(var a=[],l=0,d=n;l<d.length;l++){var f=d[l];this.formatMap.has(f)?a.push(this.formatMap.get(f)):this.logger.warn("".concat(f," is not supported by")+"BarcodeDetectorDelegate")}return{formats:a}},i.prototype.toHtml5QrcodeSupportedFormats=function(n){if(!this.reverseFormatMap.has(n))throw"reverseFormatMap doesn't have ".concat(n);return this.reverseFormatMap.get(n)},i.prototype.createReverseFormatMap=function(){var n=new Map;return this.formatMap.forEach(function(a,l,d){n.set(a,l)}),n},i.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},i})(),Nx=function(i,n,a,l){function d(f){return f instanceof a?f:new a(function(x){x(f)})}return new(a||(a=Promise))(function(f,x){function v(A){try{w(l.next(A))}catch(N){x(N)}}function C(A){try{w(l.throw(A))}catch(N){x(N)}}function w(A){A.done?f(A.value):d(A.value).then(v,C)}w((l=l.apply(i,n||[])).next())})},Tx=function(i,n){var a={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},l,d,f,x;return x={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function v(w){return function(A){return C([w,A])}}function C(w){if(l)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(a=0)),a;)try{if(l=1,d&&(f=w[0]&2?d.return:w[0]?d.throw||((f=d.return)&&f.call(d),0):d.next)&&!(f=f.call(d,w[1])).done)return f;switch(d=0,f&&(w=[w[0]&2,f.value]),w[0]){case 0:case 1:f=w;break;case 4:return a.label++,{value:w[1],done:!1};case 5:a.label++,d=w[1],w=[0];continue;case 7:w=a.ops.pop(),a.trys.pop();continue;default:if(f=a.trys,!(f=f.length>0&&f[f.length-1])&&(w[0]===6||w[0]===2)){a=0;continue}if(w[0]===3&&(!f||w[1]>f[0]&&w[1]<f[3])){a.label=w[1];break}if(w[0]===6&&a.label<f[1]){a.label=f[1],f=w;break}if(f&&a.label<f[2]){a.label=f[2],a.ops.push(w);break}f[2]&&a.ops.pop(),a.trys.pop();continue}w=n.call(i,a)}catch(A){w=[6,A],d=0}finally{l=f=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},KE=(function(){function i(n,a,l,d){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=l,a&&Ax.isSupported()?(this.primaryDecoder=new Ax(n,l,d),this.secondaryDecoder=new Ex(n,l,d)):this.primaryDecoder=new Ex(n,l,d)}return i.prototype.decodeAsync=function(n){return Nx(this,void 0,void 0,function(){var a;return Tx(this,function(l){switch(l.label){case 0:a=performance.now(),l.label=1;case 1:return l.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(n)];case 2:return[2,l.sent()];case 3:return this.possiblyLogPerformance(a),[7];case 4:return[2]}})})},i.prototype.decodeRobustlyAsync=function(n){return Nx(this,void 0,void 0,function(){var a,l;return Tx(this,function(d){switch(d.label){case 0:a=performance.now(),d.label=1;case 1:return d.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(n)];case 2:return[2,d.sent()];case 3:if(l=d.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(n)];throw l;case 4:return this.possiblyLogPerformance(a),[7];case 5:return[2]}})})},i.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},i.prototype.possiblyLogPerformance=function(n){if(this.verbose){var a=performance.now()-n;this.executionResults.push(a),this.executions++,this.possiblyFlushPerformanceReport()}},i.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var n=0,a=0,l=this.executionResults;a<l.length;a++){var d=l[a];n+=d}var f=n/this.executionResults.length;console.log("".concat(f," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},i})(),P0=(function(){var i=function(n,a){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,d){l.__proto__=d}||function(l,d){for(var f in d)Object.prototype.hasOwnProperty.call(d,f)&&(l[f]=d[f])},i(n,a)};return function(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");i(n,a);function l(){this.constructor=n}n.prototype=a===null?Object.create(a):(l.prototype=a.prototype,new l)}})(),Xu=function(i,n,a,l){function d(f){return f instanceof a?f:new a(function(x){x(f)})}return new(a||(a=Promise))(function(f,x){function v(A){try{w(l.next(A))}catch(N){x(N)}}function C(A){try{w(l.throw(A))}catch(N){x(N)}}function w(A){A.done?f(A.value):d(A.value).then(v,C)}w((l=l.apply(i,n||[])).next())})},Wu=function(i,n){var a={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},l,d,f,x;return x={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function v(w){return function(A){return C([w,A])}}function C(w){if(l)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(a=0)),a;)try{if(l=1,d&&(f=w[0]&2?d.return:w[0]?d.throw||((f=d.return)&&f.call(d),0):d.next)&&!(f=f.call(d,w[1])).done)return f;switch(d=0,f&&(w=[w[0]&2,f.value]),w[0]){case 0:case 1:f=w;break;case 4:return a.label++,{value:w[1],done:!1};case 5:a.label++,d=w[1],w=[0];continue;case 7:w=a.ops.pop(),a.trys.pop();continue;default:if(f=a.trys,!(f=f.length>0&&f[f.length-1])&&(w[0]===6||w[0]===2)){a=0;continue}if(w[0]===3&&(!f||w[1]>f[0]&&w[1]<f[3])){a.label=w[1];break}if(w[0]===6&&a.label<f[1]){a.label=f[1],f=w;break}if(f&&a.label<f[2]){a.label=f[2],a.ops.push(w);break}f[2]&&a.ops.pop(),a.trys.pop();continue}w=n.call(i,a)}catch(A){w=[6,A],d=0}finally{l=f=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},xy=(function(){function i(n,a){this.name=n,this.track=a}return i.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},i.prototype.apply=function(n){var a={};a[this.name]=n;var l={advanced:[a]};return this.track.applyConstraints(l)},i.prototype.value=function(){var n=this.track.getSettings();if(this.name in n){var a=n[this.name];return a}return null},i})(),ZE=(function(i){P0(n,i);function n(a,l){return i.call(this,a,l)||this}return n.prototype.min=function(){return this.getCapabilities().min},n.prototype.max=function(){return this.getCapabilities().max},n.prototype.step=function(){return this.getCapabilities().step},n.prototype.apply=function(a){var l={};l[this.name]=a;var d={advanced:[l]};return this.track.applyConstraints(d)},n.prototype.getCapabilities=function(){this.failIfNotSupported();var a=this.track.getCapabilities(),l=a[this.name];return{min:l.min,max:l.max,step:l.step}},n.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},n})(xy),$E=(function(i){P0(n,i);function n(a){return i.call(this,"zoom",a)||this}return n})(ZE),JE=(function(i){P0(n,i);function n(a){return i.call(this,"torch",a)||this}return n})(xy),eA=(function(){function i(n){this.track=n}return i.prototype.zoomFeature=function(){return new $E(this.track)},i.prototype.torchFeature=function(){return new JE(this.track)},i})(),tA=(function(){function i(n,a,l){this.isClosed=!1,this.parentElement=n,this.mediaStream=a,this.callbacks=l,this.surface=this.createVideoElement(this.parentElement.clientWidth),n.append(this.surface)}return i.prototype.createVideoElement=function(n){var a=document.createElement("video");return a.style.width="".concat(n,"px"),a.style.display="block",a.muted=!0,a.setAttribute("muted","true"),a.playsInline=!0,a},i.prototype.setupSurface=function(){var n=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var a=function(){var l=n.surface.clientWidth,d=n.surface.clientHeight;n.callbacks.onRenderSurfaceReady(l,d),n.surface.removeEventListener("playing",a)};this.surface.addEventListener("playing",a),this.surface.srcObject=this.mediaStream,this.surface.play()},i.create=function(n,a,l,d){return Xu(this,void 0,void 0,function(){var f,x;return Wu(this,function(v){switch(v.label){case 0:return f=new i(n,a,d),l.aspectRatio?(x={aspectRatio:l.aspectRatio},[4,f.getFirstTrackOrFail().applyConstraints(x)]):[3,2];case 1:v.sent(),v.label=2;case 2:return f.setupSurface(),[2,f]}})})},i.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},i.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},i.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},i.prototype.resume=function(n){this.failIfClosed();var a=this,l=function(){setTimeout(n,200),a.surface.removeEventListener("playing",l)};this.surface.addEventListener("playing",l),this.surface.play()},i.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},i.prototype.getSurface=function(){return this.failIfClosed(),this.surface},i.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},i.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},i.prototype.applyVideoConstraints=function(n){return Xu(this,void 0,void 0,function(){return Wu(this,function(a){if("aspectRatio"in n)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(n)]})})},i.prototype.close=function(){if(this.isClosed)return Promise.resolve();var n=this;return new Promise(function(a,l){var d=n.mediaStream.getVideoTracks(),f=d.length,x=0;n.mediaStream.getVideoTracks().forEach(function(v){n.mediaStream.removeTrack(v),v.stop(),++x,x>=f&&(n.isClosed=!0,n.parentElement.removeChild(n.surface),a())})})},i.prototype.getCapabilities=function(){return new eA(this.getFirstTrackOrFail())},i})(),nA=(function(){function i(n){this.mediaStream=n}return i.prototype.render=function(n,a,l){return Xu(this,void 0,void 0,function(){return Wu(this,function(d){return[2,tA.create(n,this.mediaStream,a,l)]})})},i.create=function(n){return Xu(this,void 0,void 0,function(){var a,l;return Wu(this,function(d){switch(d.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return a={audio:!1,video:n},[4,navigator.mediaDevices.getUserMedia(a)];case 1:return l=d.sent(),[2,new i(l)]}})})},i})(),jx=function(i,n,a,l){function d(f){return f instanceof a?f:new a(function(x){x(f)})}return new(a||(a=Promise))(function(f,x){function v(A){try{w(l.next(A))}catch(N){x(N)}}function C(A){try{w(l.throw(A))}catch(N){x(N)}}function w(A){A.done?f(A.value):d(A.value).then(v,C)}w((l=l.apply(i,n||[])).next())})},Rx=function(i,n){var a={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},l,d,f,x;return x={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function v(w){return function(A){return C([w,A])}}function C(w){if(l)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(a=0)),a;)try{if(l=1,d&&(f=w[0]&2?d.return:w[0]?d.throw||((f=d.return)&&f.call(d),0):d.next)&&!(f=f.call(d,w[1])).done)return f;switch(d=0,f&&(w=[w[0]&2,f.value]),w[0]){case 0:case 1:f=w;break;case 4:return a.label++,{value:w[1],done:!1};case 5:a.label++,d=w[1],w=[0];continue;case 7:w=a.ops.pop(),a.trys.pop();continue;default:if(f=a.trys,!(f=f.length>0&&f[f.length-1])&&(w[0]===6||w[0]===2)){a=0;continue}if(w[0]===3&&(!f||w[1]>f[0]&&w[1]<f[3])){a.label=w[1];break}if(w[0]===6&&a.label<f[1]){a.label=f[1],f=w;break}if(f&&a.label<f[2]){a.label=f[2],a.ops.push(w);break}f[2]&&a.ops.pop(),a.trys.pop();continue}w=n.call(i,a)}catch(A){w=[6,A],d=0}finally{l=f=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},sA=(function(){function i(){}return i.failIfNotSupported=function(){return jx(this,void 0,void 0,function(){return Rx(this,function(n){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new i]})})},i.prototype.create=function(n){return jx(this,void 0,void 0,function(){return Rx(this,function(a){return[2,nA.create(n)]})})},i})(),aA=function(i,n,a,l){function d(f){return f instanceof a?f:new a(function(x){x(f)})}return new(a||(a=Promise))(function(f,x){function v(A){try{w(l.next(A))}catch(N){x(N)}}function C(A){try{w(l.throw(A))}catch(N){x(N)}}function w(A){A.done?f(A.value):d(A.value).then(v,C)}w((l=l.apply(i,n||[])).next())})},rA=function(i,n){var a={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},l,d,f,x;return x={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function v(w){return function(A){return C([w,A])}}function C(w){if(l)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(a=0)),a;)try{if(l=1,d&&(f=w[0]&2?d.return:w[0]?d.throw||((f=d.return)&&f.call(d),0):d.next)&&!(f=f.call(d,w[1])).done)return f;switch(d=0,f&&(w=[w[0]&2,f.value]),w[0]){case 0:case 1:f=w;break;case 4:return a.label++,{value:w[1],done:!1};case 5:a.label++,d=w[1],w=[0];continue;case 7:w=a.ops.pop(),a.trys.pop();continue;default:if(f=a.trys,!(f=f.length>0&&f[f.length-1])&&(w[0]===6||w[0]===2)){a=0;continue}if(w[0]===3&&(!f||w[1]>f[0]&&w[1]<f[3])){a.label=w[1];break}if(w[0]===6&&a.label<f[1]){a.label=f[1],f=w;break}if(f&&a.label<f[2]){a.label=f[2],a.ops.push(w);break}f[2]&&a.ops.pop(),a.trys.pop();continue}w=n.call(i,a)}catch(A){w=[6,A],d=0}finally{l=f=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},iA=(function(){function i(){}return i.retrieve=function(){if(navigator.mediaDevices)return i.getCamerasFromMediaDevices();var n=MediaStreamTrack;return MediaStreamTrack&&n.getSources?i.getCamerasFromMediaStreamTrack():i.rejectWithError()},i.rejectWithError=function(){var n=Ho.unableToQuerySupportedDevices();return i.isHttpsOrLocalhost()||(n=Ho.insecureContextCameraQueryError()),Promise.reject(n)},i.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var n=location.host.split(":")[0];return n==="127.0.0.1"||n==="localhost"},i.getCamerasFromMediaDevices=function(){return aA(this,void 0,void 0,function(){var n,a,l,d,f,x,v;return rA(this,function(C){switch(C.label){case 0:return n=function(w){for(var A=w.getVideoTracks(),N=0,R=A;N<R.length;N++){var T=R[N];T.enabled=!1,T.stop(),w.removeTrack(T)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return a=C.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(l=C.sent(),d=[],f=0,x=l;f<x.length;f++)v=x[f],v.kind==="videoinput"&&d.push({id:v.deviceId,label:v.label});return n(a),[2,d]}})})},i.getCamerasFromMediaStreamTrack=function(){return new Promise(function(n,a){var l=function(f){for(var x=[],v=0,C=f;v<C.length;v++){var w=C[v];w.kind==="video"&&x.push({id:w.id,label:w.label})}n(x)},d=MediaStreamTrack;d.getSources(l)})},i})(),kn;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.NOT_STARTED=1]="NOT_STARTED",i[i.SCANNING=2]="SCANNING",i[i.PAUSED=3]="PAUSED"})(kn||(kn={}));var oA=(function(){function i(){this.state=kn.NOT_STARTED,this.onGoingTransactionNewState=kn.UNKNOWN}return i.prototype.directTransition=function(n){this.failIfTransitionOngoing(),this.validateTransition(n),this.state=n},i.prototype.startTransition=function(n){return this.failIfTransitionOngoing(),this.validateTransition(n),this.onGoingTransactionNewState=n,this},i.prototype.execute=function(){if(this.onGoingTransactionNewState===kn.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var n=this.onGoingTransactionNewState;this.onGoingTransactionNewState=kn.UNKNOWN,this.directTransition(n)},i.prototype.cancel=function(){if(this.onGoingTransactionNewState===kn.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=kn.UNKNOWN},i.prototype.getState=function(){return this.state},i.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==kn.UNKNOWN)throw"Cannot transition to a new state, already under transition"},i.prototype.validateTransition=function(n){switch(this.state){case kn.UNKNOWN:throw"Transition from unknown is not allowed";case kn.NOT_STARTED:this.failIfNewStateIs(n,[kn.PAUSED]);break;case kn.SCANNING:break;case kn.PAUSED:break}},i.prototype.failIfNewStateIs=function(n,a){for(var l=0,d=a;l<d.length;l++){var f=d[l];if(n===f)throw"Cannot transition from ".concat(this.state," to ").concat(n)}},i})(),lA=(function(){function i(n){this.stateManager=n}return i.prototype.startTransition=function(n){return this.stateManager.startTransition(n)},i.prototype.directTransition=function(n){this.stateManager.directTransition(n)},i.prototype.getState=function(){return this.stateManager.getState()},i.prototype.canScanFile=function(){return this.stateManager.getState()===kn.NOT_STARTED},i.prototype.isScanning=function(){return this.stateManager.getState()!==kn.NOT_STARTED},i.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===kn.SCANNING},i.prototype.isPaused=function(){return this.stateManager.getState()===kn.PAUSED},i})(),cA=(function(){function i(){}return i.create=function(){return new lA(new oA)},i})(),uA=(function(){var i=function(n,a){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,d){l.__proto__=d}||function(l,d){for(var f in d)Object.prototype.hasOwnProperty.call(d,f)&&(l[f]=d[f])},i(n,a)};return function(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");i(n,a);function l(){this.constructor=n}n.prototype=a===null?Object.create(a):(l.prototype=a.prototype,new l)}})(),sa=(function(i){uA(n,i);function n(){return i!==null&&i.apply(this,arguments)||this}return n.DEFAULT_WIDTH=300,n.DEFAULT_WIDTH_OFFSET=2,n.FILE_SCAN_MIN_HEIGHT=300,n.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,n.MIN_QR_BOX_SIZE=50,n.SHADED_LEFT=1,n.SHADED_RIGHT=2,n.SHADED_TOP=3,n.SHADED_BOTTOM=4,n.SHADED_REGION_ELEMENT_ID="qr-shaded-region",n.VERBOSE=!1,n.BORDER_SHADER_DEFAULT_COLOR="#ffffff",n.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",n})(Oa),dA=(function(){function i(n,a){this.logger=a,this.fps=sa.SCAN_DEFAULT_FPS,n?(n.fps&&(this.fps=n.fps),this.disableFlip=n.disableFlip===!0,this.qrbox=n.qrbox,this.aspectRatio=n.aspectRatio,this.videoConstraints=n.videoConstraints):this.disableFlip=sa.DEFAULT_DISABLE_FLIP}return i.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?py.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},i.prototype.isShadedBoxEnabled=function(){return!Ga(this.qrbox)},i.create=function(n,a){return new i(n,a)},i})(),m0=(function(){function i(n,a){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(n))throw"HTML Element with id=".concat(n," not found");this.elementId=n,this.verbose=!1;var l;typeof a=="boolean"?this.verbose=a===!0:a&&(l=a,this.verbose=l.verbose===!0,l.experimentalFeatures),this.logger=new my(this.verbose),this.qrcode=new KE(this.getSupportedFormats(a),this.getUseBarCodeDetectorIfSupported(l),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=cA.create()}return i.prototype.start=function(n,a,l,d){var f=this;if(!n)throw"cameraIdOrConfig is required";if(!l||typeof l!="function")throw"qrCodeSuccessCallback is required and should be a function.";var x;d?x=d:x=this.verbose?this.logger.log:function(){};var v=dA.create(a,this.logger);this.clearElement();var C=!1;v.videoConstraints&&(v.isMediaStreamConstraintsValid()?C=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var w=C,A=document.getElementById(this.elementId);A.clientWidth?A.clientWidth:sa.DEFAULT_WIDTH,A.style.position="relative",this.shouldScan=!0,this.element=A;var N=this,R=this.stateManagerProxy.startTransition(kn.SCANNING);return new Promise(function(T,O){var L=w?v.videoConstraints:N.createVideoConstraints(n);if(!L){R.cancel(),O("videoConstraints should be defined");return}var B={};(!w||v.aspectRatio)&&(B.aspectRatio=v.aspectRatio);var H={onRenderSurfaceReady:function(U,P){N.setupUi(U,P,v),N.isScanning=!0,N.foreverScan(v,l,x)}};sA.failIfNotSupported().then(function(U){U.create(L).then(function(P){return P.render(f.element,B,H).then(function(K){N.renderedCamera=K,R.execute(),T(null)}).catch(function(K){R.cancel(),O(K)})}).catch(function(P){R.cancel(),O(Ho.errorGettingUserMedia(P))})}).catch(function(U){R.cancel(),O(Ho.cameraStreamingNotSupported())})})},i.prototype.pause=function(n){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(kn.PAUSED),this.showPausedState(),(Ga(n)||n!==!0)&&(n=!1),n&&this.renderedCamera&&this.renderedCamera.pause()},i.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var n=this,a=function(){n.stateManagerProxy.directTransition(kn.SCANNING),n.hidePausedState()};if(!this.renderedCamera.isPaused()){a();return}this.renderedCamera.resume(function(){a()})},i.prototype.getState=function(){return this.stateManagerProxy.getState()},i.prototype.stop=function(){var n=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var a=this.stateManagerProxy.startTransition(kn.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var l=function(){if(n.element){var f=document.getElementById(sa.SHADED_REGION_ELEMENT_ID);f&&n.element.removeChild(f)}},d=this;return this.renderedCamera.close().then(function(){return d.renderedCamera=null,d.element&&(d.element.removeChild(d.canvasElement),d.canvasElement=null),l(),d.qrRegion&&(d.qrRegion=null),d.context&&(d.context=null),a.execute(),d.hidePausedState(),d.isScanning=!1,Promise.resolve()})},i.prototype.scanFile=function(n,a){return this.scanFileV2(n,a).then(function(l){return l.decodedText})},i.prototype.scanFileV2=function(n,a){var l=this;if(!n||!(n instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Ga(a)&&(a=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(d,f){l.possiblyCloseLastScanImageFile(),l.clearElement(),l.lastScanImageFile=URL.createObjectURL(n);var x=new Image;x.onload=function(){var v=x.width,C=x.height,w=document.getElementById(l.elementId),A=w.clientWidth?w.clientWidth:sa.DEFAULT_WIDTH,N=Math.max(w.clientHeight?w.clientHeight:C,sa.FILE_SCAN_MIN_HEIGHT),R=l.computeCanvasDrawConfig(v,C,A,N);if(a){var T=l.createCanvasElement(A,N,"qr-canvas-visible");T.style.display="inline-block",w.appendChild(T);var O=T.getContext("2d");if(!O)throw"Unable to get 2d context from canvas";O.canvas.width=A,O.canvas.height=N,O.drawImage(x,0,0,v,C,R.x,R.y,R.width,R.height)}var L=sa.FILE_SCAN_HIDDEN_CANVAS_PADDING,B=Math.max(x.width,R.width),H=Math.max(x.height,R.height),U=B+2*L,P=H+2*L,K=l.createCanvasElement(U,P);w.appendChild(K);var Z=K.getContext("2d");if(!Z)throw"Unable to get 2d context from canvas";Z.canvas.width=U,Z.canvas.height=P,Z.drawImage(x,0,0,v,C,L,L,B,H);try{l.qrcode.decodeRobustlyAsync(K).then(function(W){d(Cx.createFromQrcodeResult(W))}).catch(f)}catch(W){f("QR code parse error, error = ".concat(W))}},x.onerror=f,x.onabort=f,x.onstalled=f,x.onsuspend=f,x.src=URL.createObjectURL(n)})},i.prototype.clear=function(){this.clearElement()},i.getCameras=function(){return iA.retrieve()},i.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},i.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},i.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},i.prototype.applyVideoConstraints=function(n){if(n){if(!py.isMediaStreamConstraintsValid(n,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(n)},i.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},i.prototype.getSupportedFormats=function(n){var a=[Ye.QR_CODE,Ye.AZTEC,Ye.CODABAR,Ye.CODE_39,Ye.CODE_93,Ye.CODE_128,Ye.DATA_MATRIX,Ye.MAXICODE,Ye.ITF,Ye.EAN_13,Ye.EAN_8,Ye.PDF_417,Ye.RSS_14,Ye.RSS_EXPANDED,Ye.UPC_A,Ye.UPC_E,Ye.UPC_EAN_EXTENSION];if(!n||typeof n=="boolean"||!n.formatsToSupport)return a;if(!Array.isArray(n.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(n.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var l=[],d=0,f=n.formatsToSupport;d<f.length;d++){var x=f[d];HE(x)?l.push(x):this.logger.warn("Invalid format: ".concat(x," passed in config, ignoring."))}if(l.length===0)throw"None of formatsToSupport match supported values.";return l},i.prototype.getUseBarCodeDetectorIfSupported=function(n){if(Ga(n))return!0;if(!Ga(n.useBarCodeDetectorIfSupported))return n.useBarCodeDetectorIfSupported!==!1;if(Ga(n.experimentalFeatures))return!0;var a=n.experimentalFeatures;return Ga(a.useBarCodeDetectorIfSupported)?!0:a.useBarCodeDetectorIfSupported!==!1},i.prototype.validateQrboxSize=function(n,a,l){var d=this,f=l.qrbox;this.validateQrboxConfig(f);var x=this.toQrdimensions(n,a,f),v=function(w){if(w<sa.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(sa.MIN_QR_BOX_SIZE,"px.")},C=function(w){return w>n&&(d.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),w=n),w};v(x.width),v(x.height),x.width=C(x.width)},i.prototype.validateQrboxConfig=function(n){if(typeof n!="number"&&typeof n!="function"&&(n.width===void 0||n.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},i.prototype.toQrdimensions=function(n,a,l){if(typeof l=="number")return{width:l,height:l};if(typeof l=="function")try{return l(n,a)}catch(d){throw new Error("qrbox config was passed as a function but it failed with unknown error"+d)}return l},i.prototype.setupUi=function(n,a,l){l.isShadedBoxEnabled()&&this.validateQrboxSize(n,a,l);var d=Ga(l.qrbox)?{width:n,height:a}:l.qrbox;this.validateQrboxConfig(d);var f=this.toQrdimensions(n,a,d);f.height>a&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var x=l.isShadedBoxEnabled()&&f.height<=a,v={x:0,y:0,width:n,height:a},C=x?this.getShadedRegionBounds(n,a,f):v,w=this.createCanvasElement(C.width,C.height),A={willReadFrequently:!0},N=w.getContext("2d",A);N.canvas.width=C.width,N.canvas.height=C.height,this.element.append(w),x&&this.possiblyInsertShadingElement(this.element,n,a,f),this.createScannerPausedUiElement(this.element),this.qrRegion=C,this.context=N,this.canvasElement=w},i.prototype.createScannerPausedUiElement=function(n){var a=document.createElement("div");a.innerText=Ho.scannerPaused(),a.style.display="none",a.style.position="absolute",a.style.top="0px",a.style.zIndex="1",a.style.background="rgba(9, 9, 9, 0.46)",a.style.color="#FFECEC",a.style.textAlign="center",a.style.width="100%",n.appendChild(a),this.scannerPausedUiElement=a},i.prototype.scanContext=function(n,a){var l=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(d){return n(d.text,Cx.createFromQrcodeResult(d)),l.possiblyUpdateShaders(!0),!0}).catch(function(d){l.possiblyUpdateShaders(!1);var f=Ho.codeParseError(d);return a(f,gy.createFrom(f)),!1})},i.prototype.foreverScan=function(n,a,l){var d=this;if(this.shouldScan&&this.renderedCamera){var f=this.renderedCamera.getSurface(),x=f.videoWidth/f.clientWidth,v=f.videoHeight/f.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var C=this.qrRegion.width*x,w=this.qrRegion.height*v,A=this.qrRegion.x*x,N=this.qrRegion.y*v;this.context.drawImage(f,A,N,C,w,0,0,this.qrRegion.width,this.qrRegion.height);var R=function(){d.foreverScanTimeout=setTimeout(function(){d.foreverScan(n,a,l)},d.getTimeoutFps(n.fps))};this.scanContext(a,l).then(function(T){!T&&n.disableFlip!==!0?(d.context.translate(d.context.canvas.width,0),d.context.scale(-1,1),d.scanContext(a,l).finally(function(){R()})):R()}).catch(function(T){d.logger.logError("Error happend while scanning context",T),R()})}},i.prototype.createVideoConstraints=function(n){if(typeof n=="string")return{deviceId:{exact:n}};if(typeof n=="object"){var a="facingMode",l="deviceId",d={user:!0,environment:!0},f="exact",x=function(O){if(O in d)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(O,"'")},v=Object.keys(n);if(v.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(v.length," keys");var C=Object.keys(n)[0];if(C!==a&&C!==l)throw"Only '".concat(a,"' and '").concat(l,"' ")+" are supported for 'cameraIdOrConfig'";if(C===a){var w=n.facingMode;if(typeof w=="string"){if(x(w))return{facingMode:w}}else if(typeof w=="object")if(f in w){if(x(w["".concat(f)]))return{facingMode:{exact:w["".concat(f)]}}}else throw"'facingMode' should be string or object with"+" ".concat(f," as key.");else{var A=typeof w;throw"Invalid type of 'facingMode' = ".concat(A)}}else{var N=n.deviceId;if(typeof N=="string")return{deviceId:N};if(typeof N=="object"){if(f in N)return{deviceId:{exact:N["".concat(f)]}};throw"'deviceId' should be string or object with"+" ".concat(f," as key.")}else{var R=typeof N;throw"Invalid type of 'deviceId' = ".concat(R)}}}var T=typeof n;throw"Invalid type of 'cameraIdOrConfig' = ".concat(T)},i.prototype.computeCanvasDrawConfig=function(n,a,l,d){if(n<=l&&a<=d){var f=(l-n)/2,x=(d-a)/2;return{x:f,y:x,width:n,height:a}}else{var v=n,C=a;return n>l&&(a=l/n*a,n=l),a>d&&(n=d/a*n,a=d),this.logger.log("Image downsampled from "+"".concat(v,"X").concat(C)+" to ".concat(n,"X").concat(a,".")),this.computeCanvasDrawConfig(n,a,l,d)}},i.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var n=document.getElementById(this.elementId);n&&(n.innerHTML="")},i.prototype.possiblyUpdateShaders=function(n){this.qrMatch!==n&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(a){a.style.backgroundColor=n?sa.BORDER_SHADER_MATCH_COLOR:sa.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=n)},i.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},i.prototype.createCanvasElement=function(n,a,l){var d=n,f=a,x=document.createElement("canvas");return x.style.width="".concat(d,"px"),x.style.height="".concat(f,"px"),x.style.display="none",x.id=Ga(l)?"qr-canvas":l,x},i.prototype.getShadedRegionBounds=function(n,a,l){if(l.width>n||l.height>a)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(n-l.width)/2,y:(a-l.height)/2,width:l.width,height:l.height}},i.prototype.possiblyInsertShadingElement=function(n,a,l,d){if(!(a-d.width<1||l-d.height<1)){var f=document.createElement("div");f.style.position="absolute";var x=(a-d.width)/2,v=(l-d.height)/2;if(f.style.borderLeft="".concat(x,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderRight="".concat(x,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderTop="".concat(v,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderBottom="".concat(v,"px solid rgba(0, 0, 0, 0.48)"),f.style.boxSizing="border-box",f.style.top="0px",f.style.bottom="0px",f.style.left="0px",f.style.right="0px",f.id="".concat(sa.SHADED_REGION_ELEMENT_ID),a-d.width<11||l-d.height<11)this.hasBorderShaders=!1;else{var C=5,w=40;this.insertShaderBorders(f,w,C,-C,null,0,!0),this.insertShaderBorders(f,w,C,-C,null,0,!1),this.insertShaderBorders(f,w,C,null,-C,0,!0),this.insertShaderBorders(f,w,C,null,-C,0,!1),this.insertShaderBorders(f,C,w+C,-C,null,-C,!0),this.insertShaderBorders(f,C,w+C,null,-C,-C,!0),this.insertShaderBorders(f,C,w+C,-C,null,-C,!1),this.insertShaderBorders(f,C,w+C,null,-C,-C,!1),this.hasBorderShaders=!0}n.append(f)}},i.prototype.insertShaderBorders=function(n,a,l,d,f,x,v){var C=document.createElement("div");C.style.position="absolute",C.style.backgroundColor=sa.BORDER_SHADER_DEFAULT_COLOR,C.style.width="".concat(a,"px"),C.style.height="".concat(l,"px"),d!==null&&(C.style.top="".concat(d,"px")),f!==null&&(C.style.bottom="".concat(f,"px")),v?C.style.left="".concat(x,"px"):C.style.right="".concat(x,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(C),n.appendChild(C)},i.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},i.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},i.prototype.getTimeoutFps=function(n){return 1e3/n},i})(),z0="data:image/svg+xml;base64,",hA=z0+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",fA=z0+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",Ix=z0+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",gA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",Ox=(function(){function i(){}return i.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},i})(),mA=(function(){function i(){this.data=Ox.createDefault();var n=localStorage.getItem(i.LOCAL_STORAGE_KEY);n?this.data=JSON.parse(n):this.reset()}return i.prototype.hasCameraPermissions=function(){return this.data.hasPermission},i.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},i.prototype.setHasPermission=function(n){this.data.hasPermission=n,this.flush()},i.prototype.setLastUsedCameraId=function(n){this.data.lastUsedCameraId=n,this.flush()},i.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},i.prototype.reset=function(){this.data=Ox.createDefault(),this.flush()},i.prototype.flush=function(){localStorage.setItem(i.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},i.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",i})(),pA=(function(){function i(){this.infoDiv=document.createElement("div")}return i.prototype.renderInto=function(n){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=_x.poweredBy();var a=document.createElement("a");a.innerText="ScanApp",a.href="https://scanapp.org",a.target="new",a.style.color="white",this.infoDiv.appendChild(a);var l=document.createElement("br"),d=document.createElement("br");this.infoDiv.appendChild(l),this.infoDiv.appendChild(d);var f=document.createElement("a");f.innerText=_x.reportIssues(),f.href="https://github.com/mebjas/html5-qrcode/issues",f.target="new",f.style.color="white",this.infoDiv.appendChild(f),n.appendChild(this.infoDiv)},i.prototype.show=function(){this.infoDiv.style.display="block"},i.prototype.hide=function(){this.infoDiv.style.display="none"},i})(),xA=(function(){function i(n,a){this.isShowingInfoIcon=!0,this.onTapIn=n,this.onTapOut=a,this.infoIcon=document.createElement("img")}return i.prototype.renderInto=function(n){var a=this;this.infoIcon.alt="Info icon",this.infoIcon.src=Ix,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(l){return a.onHoverIn()},this.infoIcon.onmouseout=function(l){return a.onHoverOut()},this.infoIcon.onclick=function(l){return a.onClick()},n.appendChild(this.infoIcon)},i.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},i.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},i.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=gA,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=Ix,this.infoIcon.style.opacity="0.6")},i})(),yA=(function(){function i(){var n=this;this.infoDiv=new pA,this.infoIcon=new xA(function(){n.infoDiv.show()},function(){n.infoDiv.hide()})}return i.prototype.renderInto=function(n){this.infoDiv.renderInto(n),this.infoIcon.renderInto(n)},i})(),wA=function(i,n,a,l){function d(f){return f instanceof a?f:new a(function(x){x(f)})}return new(a||(a=Promise))(function(f,x){function v(A){try{w(l.next(A))}catch(N){x(N)}}function C(A){try{w(l.throw(A))}catch(N){x(N)}}function w(A){A.done?f(A.value):d(A.value).then(v,C)}w((l=l.apply(i,n||[])).next())})},bA=function(i,n){var a={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},l,d,f,x;return x={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function v(w){return function(A){return C([w,A])}}function C(w){if(l)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(a=0)),a;)try{if(l=1,d&&(f=w[0]&2?d.return:w[0]?d.throw||((f=d.return)&&f.call(d),0):d.next)&&!(f=f.call(d,w[1])).done)return f;switch(d=0,f&&(w=[w[0]&2,f.value]),w[0]){case 0:case 1:f=w;break;case 4:return a.label++,{value:w[1],done:!1};case 5:a.label++,d=w[1],w=[0];continue;case 7:w=a.ops.pop(),a.trys.pop();continue;default:if(f=a.trys,!(f=f.length>0&&f[f.length-1])&&(w[0]===6||w[0]===2)){a=0;continue}if(w[0]===3&&(!f||w[1]>f[0]&&w[1]<f[3])){a.label=w[1];break}if(w[0]===6&&a.label<f[1]){a.label=f[1],f=w;break}if(f&&a.label<f[2]){a.label=f[2],a.ops.push(w);break}f[2]&&a.ops.pop(),a.trys.pop();continue}w=n.call(i,a)}catch(A){w=[6,A],d=0}finally{l=f=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},Mx=(function(){function i(){}return i.hasPermissions=function(){return wA(this,void 0,void 0,function(){var n,a,l,d;return bA(this,function(f){switch(f.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(n=f.sent(),a=0,l=n;a<l.length;a++)if(d=l[a],d.kind==="videoinput"&&d.label)return[2,!0];return[2,!1]}})})},i})(),ii=(function(){function i(n){this.supportedScanTypes=this.validateAndReturnScanTypes(n)}return i.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},i.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},i.prototype.isCameraScanRequired=function(){for(var n=0,a=this.supportedScanTypes;n<a.length;n++){var l=a[n];if(i.isCameraScanType(l))return!0}return!1},i.isCameraScanType=function(n){return n===vr.SCAN_TYPE_CAMERA},i.isFileScanType=function(n){return n===vr.SCAN_TYPE_FILE},i.prototype.validateAndReturnScanTypes=function(n){if(!n||n.length===0)return Oa.DEFAULT_SUPPORTED_SCAN_TYPE;var a=Oa.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(n.length>a)throw"Max ".concat(a," values expected for ")+"supportedScanTypes";for(var l=0,d=n;l<d.length;l++){var f=d[l];if(!Oa.DEFAULT_SUPPORTED_SCAN_TYPE.includes(f))throw"Unsupported scan type ".concat(f)}return n},i})(),oa=(function(){function i(){}return i.ALL_ELEMENT_CLASS="html5-qrcode-element",i.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",i.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",i.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",i.TORCH_BUTTON_ID="html5-qrcode-button-torch",i.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",i.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",i.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",i.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",i.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",i.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",i})(),xr=(function(){function i(){}return i.createElement=function(n,a){var l=document.createElement(n);return l.id=a,l.classList.add(oa.ALL_ELEMENT_CLASS),n==="button"&&l.setAttribute("type","button"),l},i})(),yy=function(i,n,a,l){function d(f){return f instanceof a?f:new a(function(x){x(f)})}return new(a||(a=Promise))(function(f,x){function v(A){try{w(l.next(A))}catch(N){x(N)}}function C(A){try{w(l.throw(A))}catch(N){x(N)}}function w(A){A.done?f(A.value):d(A.value).then(v,C)}w((l=l.apply(i,n||[])).next())})},wy=function(i,n){var a={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},l,d,f,x;return x={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function v(w){return function(A){return C([w,A])}}function C(w){if(l)throw new TypeError("Generator is already executing.");for(;x&&(x=0,w[0]&&(a=0)),a;)try{if(l=1,d&&(f=w[0]&2?d.return:w[0]?d.throw||((f=d.return)&&f.call(d),0):d.next)&&!(f=f.call(d,w[1])).done)return f;switch(d=0,f&&(w=[w[0]&2,f.value]),w[0]){case 0:case 1:f=w;break;case 4:return a.label++,{value:w[1],done:!1};case 5:a.label++,d=w[1],w=[0];continue;case 7:w=a.ops.pop(),a.trys.pop();continue;default:if(f=a.trys,!(f=f.length>0&&f[f.length-1])&&(w[0]===6||w[0]===2)){a=0;continue}if(w[0]===3&&(!f||w[1]>f[0]&&w[1]<f[3])){a.label=w[1];break}if(w[0]===6&&a.label<f[1]){a.label=f[1],f=w;break}if(f&&a.label<f[2]){a.label=f[2],a.ops.push(w);break}f[2]&&a.ops.pop(),a.trys.pop();continue}w=n.call(i,a)}catch(A){w=[6,A],d=0}finally{l=f=0}if(w[0]&5)throw w[1];return{value:w[0]?w[1]:void 0,done:!0}}},kx=(function(){function i(n,a,l){this.isTorchOn=!1,this.torchCapability=n,this.buttonController=a,this.onTorchActionFailureCallback=l}return i.prototype.isTorchEnabled=function(){return this.isTorchOn},i.prototype.flipState=function(){return yy(this,void 0,void 0,function(){var n,a;return wy(this,function(l){switch(l.label){case 0:this.buttonController.disable(),n=!this.isTorchOn,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,this.torchCapability.apply(n)];case 2:return l.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),n),[3,4];case 3:return a=l.sent(),this.propagateFailure(n,a),this.buttonController.enable(),[3,4];case 4:return[2]}})})},i.prototype.updateUiBasedOnLatestSettings=function(n,a){n===a?(this.buttonController.setText(a?ln.torchOffButton():ln.torchOnButton()),this.isTorchOn=a):this.propagateFailure(a),this.buttonController.enable()},i.prototype.propagateFailure=function(n,a){var l=n?ln.torchOnFailedMessage():ln.torchOffFailedMessage();a&&(l+="; Error = "+a),this.onTorchActionFailureCallback(l)},i.prototype.reset=function(){this.isTorchOn=!1},i})(),vA=(function(){function i(n,a){this.onTorchActionFailureCallback=a,this.torchButton=xr.createElement("button",oa.TORCH_BUTTON_ID),this.torchController=new kx(n,this,a)}return i.prototype.render=function(n,a){var l=this;this.torchButton.innerText=ln.torchOnButton(),this.torchButton.style.display=a.display,this.torchButton.style.marginLeft=a.marginLeft;var d=this;this.torchButton.addEventListener("click",function(f){return yy(l,void 0,void 0,function(){return wy(this,function(x){switch(x.label){case 0:return[4,d.torchController.flipState()];case 1:return x.sent(),d.torchController.isTorchEnabled()?(d.torchButton.classList.remove(oa.TORCH_BUTTON_CLASS_TORCH_OFF),d.torchButton.classList.add(oa.TORCH_BUTTON_CLASS_TORCH_ON)):(d.torchButton.classList.remove(oa.TORCH_BUTTON_CLASS_TORCH_ON),d.torchButton.classList.add(oa.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),n.appendChild(this.torchButton)},i.prototype.updateTorchCapability=function(n){this.torchController=new kx(n,this,this.onTorchActionFailureCallback)},i.prototype.getTorchButton=function(){return this.torchButton},i.prototype.hide=function(){this.torchButton.style.display="none"},i.prototype.show=function(){this.torchButton.style.display="inline-block"},i.prototype.disable=function(){this.torchButton.disabled=!0},i.prototype.enable=function(){this.torchButton.disabled=!1},i.prototype.setText=function(n){this.torchButton.innerText=n},i.prototype.reset=function(){this.torchButton.innerText=ln.torchOnButton(),this.torchController.reset()},i.create=function(n,a,l,d){var f=new i(a,d);return f.render(n,l),f},i})(),CA=(function(){function i(n,a,l){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=a?"block":"none",n.appendChild(this.fileBasedScanRegion);var d=document.createElement("label");d.setAttribute("for",this.getFileScanInputId()),d.style.display="inline-block",this.fileBasedScanRegion.appendChild(d),this.fileSelectionButton=xr.createElement("button",oa.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(v){d.click()}),d.append(this.fileSelectionButton),this.fileScanInput=xr.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",d.appendChild(this.fileScanInput);var f=this;this.fileScanInput.addEventListener("change",function(v){if(!(v==null||v.target==null)){var C=v.target;if(!(C.files&&C.files.length===0)){var w=C.files,A=w[0],N=A.name;f.setImageNameToButton(N),l(A)}}});var x=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(x),this.fileBasedScanRegion.addEventListener("dragenter",function(v){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionActiveBorder(),v.stopPropagation(),v.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(v){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionDefaultBorder(),v.stopPropagation(),v.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(v){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionActiveBorder(),v.stopPropagation(),v.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(v){v.stopPropagation(),v.preventDefault(),f.fileBasedScanRegion.style.border=f.fileBasedScanRegionDefaultBorder();var C=v.dataTransfer;if(C){var w=C.files;if(!w||w.length===0)return;for(var A=!1,N=0;N<w.length;++N){var R=w.item(N);if(R){var T=/image.*/;if(R.type.match(T)){A=!0;var O=R.name;f.setImageNameToButton(O),l(R),x.innerText=ln.dragAndDropMessage();break}}}A||(x.innerText=ln.dragAndDropMessageOnlyImages())}})}return i.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},i.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},i.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},i.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},i.prototype.createFileBasedScanRegion=function(){var n=document.createElement("div");return n.style.textAlign="center",n.style.margin="auto",n.style.width="80%",n.style.maxWidth="600px",n.style.border=this.fileBasedScanRegionDefaultBorder(),n.style.padding="10px",n.style.marginBottom="10px",n},i.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},i.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},i.prototype.createDragAndDropMessage=function(){var n=document.createElement("div");return n.innerText=ln.dragAndDropMessage(),n.style.fontWeight="400",n},i.prototype.setImageNameToButton=function(n){var a=20;if(n.length>a){var l=n.substring(0,8),d=n.length,f=n.substring(d-8,d);n="".concat(l,"....").concat(f)}var x=ln.fileSelectionChooseAnother()+" - "+n;this.fileSelectionButton.innerText=x},i.prototype.setInitialValueToButton=function(){var n=ln.fileSelectionChooseImage()+" - "+ln.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=n},i.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},i.create=function(n,a,l){var d=new i(n,a,l);return d},i})(),_A=(function(){function i(n){this.selectElement=xr.createElement("select",oa.CAMERA_SELECTION_SELECT_ID),this.cameras=n,this.options=[]}return i.prototype.render=function(n){var a=document.createElement("span");a.style.marginRight="10px";var l=this.cameras.length;if(l===0)throw new Error("No cameras found");if(l===1)a.style.display="none";else{var d=ln.selectCamera();a.innerText="".concat(d," (").concat(this.cameras.length,")  ")}for(var f=1,x=0,v=this.cameras;x<v.length;x++){var C=v[x],w=C.id,A=C.label==null?w:C.label;(!A||A==="")&&(A=[ln.anonymousCameraPrefix(),f++].join(" "));var N=document.createElement("option");N.value=w,N.innerText=A,this.options.push(N),this.selectElement.appendChild(N)}a.appendChild(this.selectElement),n.appendChild(a)},i.prototype.disable=function(){this.selectElement.disabled=!0},i.prototype.isDisabled=function(){return this.selectElement.disabled===!0},i.prototype.enable=function(){this.selectElement.disabled=!1},i.prototype.getValue=function(){return this.selectElement.value},i.prototype.hasValue=function(n){for(var a=0,l=this.options;a<l.length;a++){var d=l[a];if(d.value===n)return!0}return!1},i.prototype.setValue=function(n){if(!this.hasValue(n))throw new Error("".concat(n," is not present in the camera list."));this.selectElement.value=n},i.prototype.hasSingleItem=function(){return this.cameras.length===1},i.prototype.numCameras=function(){return this.cameras.length},i.create=function(n,a){var l=new i(a);return l.render(n),l},i})(),SA=(function(){function i(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=xr.createElement("input",oa.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return i.prototype.render=function(n,a){this.zoomElementContainer.style.display=a?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",n.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var l=ln.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(l),this.rangeText.style.marginRight="10px";var d=this;this.rangeInput.addEventListener("input",function(){return d.onValueChange()}),this.rangeInput.addEventListener("change",function(){return d.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},i.prototype.onValueChange=function(){var n=ln.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(n),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},i.prototype.setValues=function(n,a,l,d){this.rangeInput.min=n.toString(),this.rangeInput.max=a.toString(),this.rangeInput.step=d.toString(),this.rangeInput.value=l.toString(),this.onValueChange()},i.prototype.show=function(){this.zoomElementContainer.style.display="block"},i.prototype.hide=function(){this.zoomElementContainer.style.display="none"},i.prototype.setOnCameraZoomValueChangeCallback=function(n){this.onChangeCallback=n},i.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},i.create=function(n,a){var l=new i;return l.render(n,a),l},i})(),aa;(function(i){i[i.STATUS_DEFAULT=0]="STATUS_DEFAULT",i[i.STATUS_SUCCESS=1]="STATUS_SUCCESS",i[i.STATUS_WARNING=2]="STATUS_WARNING",i[i.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(aa||(aa={}));function EA(i){return{fps:i.fps,qrbox:i.qrbox,aspectRatio:i.aspectRatio,disableFlip:i.disableFlip,videoConstraints:i.videoConstraints}}function AA(i,n){return{formatsToSupport:i.formatsToSupport,useBarCodeDetectorIfSupported:i.useBarCodeDetectorIfSupported,experimentalFeatures:i.experimentalFeatures,verbose:n}}var by=(function(){function i(n,a,l){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=n,this.config=this.createConfig(a),this.verbose=l===!0,!document.getElementById(n))throw"HTML Element with id=".concat(n," not found");this.scanTypeSelector=new ii(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new my(this.verbose),this.persistedDataManager=new mA,a.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return i.prototype.render=function(n,a){var l=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(f,x){if(n)n(f,x);else{if(l.lastMatchFound===f)return;l.lastMatchFound=f,l.setHeaderMessage(ln.lastMatch(f),aa.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(f,x){a&&a(f,x)};var d=document.getElementById(this.elementId);if(!d)throw"HTML Element with id=".concat(this.elementId," not found");d.innerHTML="",this.createBasicLayout(d),this.html5Qrcode=new m0(this.getScanRegionId(),AA(this.config,this.verbose))},i.prototype.pause=function(n){(Ga(n)||n!==!0)&&(n=!1),this.getHtml5QrcodeOrFail().pause(n)},i.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},i.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},i.prototype.clear=function(){var n=this,a=function(){var l=document.getElementById(n.elementId);l&&(l.innerHTML="",n.resetBasicLayout(l))};return this.html5Qrcode?new Promise(function(l,d){if(!n.html5Qrcode){l();return}n.html5Qrcode.isScanning?n.html5Qrcode.stop().then(function(f){if(!n.html5Qrcode){l();return}n.html5Qrcode.clear(),a(),l()}).catch(function(f){n.verbose&&n.logger.logError("Unable to stop qrcode scanner",f),d(f)}):(n.html5Qrcode.clear(),a(),l())}):Promise.resolve()},i.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},i.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},i.prototype.applyVideoConstraints=function(n){return this.getHtml5QrcodeOrFail().applyVideoConstraints(n)},i.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},i.prototype.createConfig=function(n){return n?(n.fps||(n.fps=Oa.SCAN_DEFAULT_FPS),n.rememberLastUsedCamera!==!Oa.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(n.rememberLastUsedCamera=Oa.DEFAULT_REMEMBER_LAST_CAMERA_USED),n.supportedScanTypes||(n.supportedScanTypes=Oa.DEFAULT_SUPPORTED_SCAN_TYPE),n):{fps:Oa.SCAN_DEFAULT_FPS,rememberLastUsedCamera:Oa.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:Oa.DEFAULT_SUPPORTED_SCAN_TYPE}},i.prototype.createBasicLayout=function(n){n.style.position="relative",n.style.padding="0px",n.style.border="1px solid silver",this.createHeader(n);var a=document.createElement("div"),l=this.getScanRegionId();a.id=l,a.style.width="100%",a.style.minHeight="100px",a.style.textAlign="center",n.appendChild(a),ii.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var d=document.createElement("div"),f=this.getDashboardId();d.id=f,d.style.width="100%",n.appendChild(d),this.setupInitialDashboard(d)},i.prototype.resetBasicLayout=function(n){n.style.border="none"},i.prototype.setupInitialDashboard=function(n){this.createSection(n),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},i.prototype.createHeader=function(n){var a=document.createElement("div");a.style.textAlign="left",a.style.margin="0px",n.appendChild(a);var l=new yA;l.renderInto(a);var d=document.createElement("div");d.id=this.getHeaderMessageContainerId(),d.style.display="none",d.style.textAlign="center",d.style.fontSize="14px",d.style.padding="2px 10px",d.style.margin="4px",d.style.borderTop="1px solid #f6f6f6",a.appendChild(d)},i.prototype.createSection=function(n){var a=document.createElement("div");a.id=this.getDashboardSectionId(),a.style.width="100%",a.style.padding="10px 0px 10px 0px",a.style.textAlign="left",n.appendChild(a)},i.prototype.createCameraListUi=function(n,a,l){var d=this;d.showHideScanTypeSwapLink(!1),d.setHeaderMessage(ln.cameraPermissionRequesting());var f=function(){l||d.createPermissionButton(n,a)};m0.getCameras().then(function(x){d.persistedDataManager.setHasPermission(!0),d.showHideScanTypeSwapLink(!0),d.resetHeaderMessage(),x&&x.length>0?(n.removeChild(a),d.renderCameraSelection(x)):(d.setHeaderMessage(ln.noCameraFound(),aa.STATUS_WARNING),f())}).catch(function(x){d.persistedDataManager.setHasPermission(!1),l?l.disabled=!1:f(),d.setHeaderMessage(x,aa.STATUS_WARNING),d.showHideScanTypeSwapLink(!0)})},i.prototype.createPermissionButton=function(n,a){var l=this,d=xr.createElement("button",this.getCameraPermissionButtonId());d.innerText=ln.cameraPermissionTitle(),d.addEventListener("click",function(){d.disabled=!0,l.createCameraListUi(n,a,d)}),a.appendChild(d)},i.prototype.createPermissionsUi=function(n,a){var l=this;if(ii.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){Mx.hasPermissions().then(function(d){d?l.createCameraListUi(n,a):(l.persistedDataManager.setHasPermission(!1),l.createPermissionButton(n,a))}).catch(function(d){l.persistedDataManager.setHasPermission(!1),l.createPermissionButton(n,a)});return}this.createPermissionButton(n,a)},i.prototype.createSectionControlPanel=function(){var n=document.getElementById(this.getDashboardSectionId()),a=document.createElement("div");n.appendChild(a);var l=document.createElement("div");l.id=this.getDashboardSectionCameraScanRegionId(),l.style.display=ii.isCameraScanType(this.currentScanType)?"block":"none",a.appendChild(l);var d=document.createElement("div");d.style.textAlign="center",l.appendChild(d),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(l,d),this.renderFileScanUi(a)},i.prototype.renderFileScanUi=function(n){var a=ii.isFileScanType(this.currentScanType),l=this,d=function(f){if(!l.html5Qrcode)throw"html5Qrcode not defined";ii.isFileScanType(l.currentScanType)&&(l.setHeaderMessage(ln.loadingImage()),l.html5Qrcode.scanFileV2(f,!0).then(function(x){l.resetHeaderMessage(),l.qrCodeSuccessCallback(x.decodedText,x)}).catch(function(x){l.setHeaderMessage(x,aa.STATUS_WARNING),l.qrCodeErrorCallback(x,gy.createFrom(x))}))};this.fileSelectionUi=CA.create(n,a,d)},i.prototype.renderCameraSelection=function(n){var a=this,l=this,d=document.getElementById(this.getDashboardSectionCameraScanRegionId());d.style.textAlign="center";var f=SA.create(d,!1),x=function(L){var B=L.zoomFeature();if(B.isSupported()){f.setOnCameraZoomValueChangeCallback(function(U){B.apply(U)});var H=1;a.config.defaultZoomValueIfSupported&&(H=a.config.defaultZoomValueIfSupported),H=qE(H,B.min(),B.max()),f.setValues(B.min(),B.max(),H,B.step()),f.show()}},v=_A.create(d,n),C=document.createElement("span"),w=xr.createElement("button",oa.CAMERA_START_BUTTON_ID);w.innerText=ln.scanButtonStartScanningText(),C.appendChild(w);var A=xr.createElement("button",oa.CAMERA_STOP_BUTTON_ID);A.innerText=ln.scanButtonStopScanningText(),A.style.display="none",A.disabled=!0,C.appendChild(A);var N,R=function(L){if(!L.torchFeature().isSupported()){N&&N.hide();return}N?N.updateTorchCapability(L.torchFeature()):N=vA.create(C,L.torchFeature(),{display:"none",marginLeft:"5px"},function(B){l.setHeaderMessage(B,aa.STATUS_WARNING)}),N.show()};d.appendChild(C);var T=function(L){L||(w.style.display="none"),w.innerText=ln.scanButtonStartScanningText(),w.style.opacity="1",w.disabled=!1,L&&(w.style.display="inline-block")};if(w.addEventListener("click",function(L){w.innerText=ln.scanButtonScanningStarting(),v.disable(),w.disabled=!0,w.style.opacity="0.5",a.scanTypeSelector.hasMoreThanOneScanType()&&l.showHideScanTypeSwapLink(!1),l.resetHeaderMessage();var B=v.getValue();l.persistedDataManager.setLastUsedCameraId(B),l.html5Qrcode.start(B,EA(l.config),l.qrCodeSuccessCallback,l.qrCodeErrorCallback).then(function(H){A.disabled=!1,A.style.display="inline-block",T(!1);var U=l.html5Qrcode.getRunningTrackCameraCapabilities();a.config.showTorchButtonIfSupported===!0&&R(U),a.config.showZoomSliderIfSupported===!0&&x(U)}).catch(function(H){l.showHideScanTypeSwapLink(!0),v.enable(),T(!0),l.setHeaderMessage(H,aa.STATUS_WARNING)})}),v.hasSingleItem()&&w.click(),A.addEventListener("click",function(L){if(!l.html5Qrcode)throw"html5Qrcode not defined";A.disabled=!0,l.html5Qrcode.stop().then(function(B){a.scanTypeSelector.hasMoreThanOneScanType()&&l.showHideScanTypeSwapLink(!0),v.enable(),w.disabled=!1,A.style.display="none",w.style.display="inline-block",N&&(N.reset(),N.hide()),f.removeOnCameraZoomValueChangeCallback(),f.hide(),l.insertCameraScanImageToScanRegion()}).catch(function(B){A.disabled=!1,l.setHeaderMessage(B,aa.STATUS_WARNING)})}),l.persistedDataManager.getLastUsedCameraId()){var O=l.persistedDataManager.getLastUsedCameraId();v.hasValue(O)?(v.setValue(O),w.click()):l.persistedDataManager.resetLastUsedCameraId()}},i.prototype.createSectionSwap=function(){var n=this,a=ln.textIfCameraScanSelected(),l=ln.textIfFileScanSelected(),d=document.getElementById(this.getDashboardSectionId()),f=document.createElement("div");f.style.textAlign="center";var x=xr.createElement("span",this.getDashboardSectionSwapLinkId());x.style.textDecoration="underline",x.style.cursor="pointer",x.innerText=ii.isCameraScanType(this.currentScanType)?a:l,x.addEventListener("click",function(){if(!n.sectionSwapAllowed){n.verbose&&n.logger.logError("Section swap called when not allowed");return}n.resetHeaderMessage(),n.fileSelectionUi.resetValue(),n.sectionSwapAllowed=!1,ii.isCameraScanType(n.currentScanType)?(n.clearScanRegion(),n.getCameraScanRegion().style.display="none",n.fileSelectionUi.show(),x.innerText=l,n.currentScanType=vr.SCAN_TYPE_FILE,n.insertFileScanImageToScanRegion()):(n.clearScanRegion(),n.getCameraScanRegion().style.display="block",n.fileSelectionUi.hide(),x.innerText=a,n.currentScanType=vr.SCAN_TYPE_CAMERA,n.insertCameraScanImageToScanRegion(),n.startCameraScanIfPermissionExistsOnSwap()),n.sectionSwapAllowed=!0}),f.appendChild(x),d.appendChild(f)},i.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var n=this,a=this;if(this.persistedDataManager.hasCameraPermissions()){Mx.hasPermissions().then(function(l){if(l){var d=document.getElementById(a.getCameraPermissionButtonId());if(!d)throw n.logger.logError("Permission button not found, fail;"),"Permission button not found";d.click()}else a.persistedDataManager.setHasPermission(!1)}).catch(function(l){a.persistedDataManager.setHasPermission(!1)});return}},i.prototype.resetHeaderMessage=function(){var n=document.getElementById(this.getHeaderMessageContainerId());n.style.display="none"},i.prototype.setHeaderMessage=function(n,a){a||(a=aa.STATUS_DEFAULT);var l=this.getHeaderMessageDiv();switch(l.innerText=n,l.style.display="block",a){case aa.STATUS_SUCCESS:l.style.background="rgba(106, 175, 80, 0.26)",l.style.color="#477735";break;case aa.STATUS_WARNING:l.style.background="rgba(203, 36, 49, 0.14)",l.style.color="#cb2431";break;case aa.STATUS_DEFAULT:default:l.style.background="rgba(0, 0, 0, 0)",l.style.color="rgb(17, 17, 17)";break}},i.prototype.showHideScanTypeSwapLink=function(n){this.scanTypeSelector.hasMoreThanOneScanType()&&(n!==!0&&(n=!1),this.sectionSwapAllowed=n,this.getDashboardSectionSwapLink().style.display=n?"inline-block":"none")},i.prototype.insertCameraScanImageToScanRegion=function(){var n=this,a=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){a.innerHTML="<br>",a.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(l){a.innerHTML="<br>",a.appendChild(n.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=hA,this.cameraScanImage.alt=ln.cameraScanAltText()},i.prototype.insertFileScanImageToScanRegion=function(){var n=this,a=document.getElementById(this.getScanRegionId());if(this.fileScanImage){a.innerHTML="<br>",a.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(l){a.innerHTML="<br>",a.appendChild(n.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=fA,this.fileScanImage.alt=ln.fileScanAltText()},i.prototype.clearScanRegion=function(){var n=document.getElementById(this.getScanRegionId());n.innerHTML=""},i.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},i.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},i.prototype.getDashboardSectionSwapLinkId=function(){return oa.SCAN_TYPE_CHANGE_ANCHOR_ID},i.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},i.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},i.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},i.prototype.getCameraPermissionButtonId=function(){return oa.CAMERA_PERMISSION_BUTTON_ID},i.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},i.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},i.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},i})();const NA=Object.freeze(Object.defineProperty({__proto__:null,Html5Qrcode:m0,get Html5QrcodeScanType(){return vr},Html5QrcodeScanner:by,get Html5QrcodeScannerState(){return kn},get Html5QrcodeSupportedFormats(){return Ye}},Symbol.toStringTag,{value:"Module"})),vy=({onScan:i,onClose:n,onError:a})=>{const l=M.useRef(null),d=M.useRef(null),[f,x]=M.useState(!1),[v,C]=M.useState("");M.useEffect(()=>()=>{N()},[]);const w=()=>{try{C(""),x(!0);const T={fps:10,qrbox:{width:250,height:250},aspectRatio:1,disableFlip:!1,videoConstraints:{facingMode:"environment"}};d.current=new by("qr-reader",T,!1),d.current.render((O,L)=>{A(O,L)},O=>{O.includes("No QR code found")||console.warn("QR scan error:",O)})}catch(T){console.error("Error initializing QR scanner:",T),C("Failed to initialize camera. Please check camera permissions."),x(!1),a&&a(T)}},A=(T,O)=>{try{N(),x(!1);let L;try{L=JSON.parse(T)}catch{L={type:"url",url:T}}i&&i(L)}catch(L){console.error("Error processing QR scan result:",L),C("Invalid QR code format")}},N=()=>{if(d.current){try{d.current.clear()}catch(T){console.warn("Error cleaning up QR scanner:",T)}d.current=null}},R=async T=>{const O=T.target.files[0];if(O)try{C(""),x(!0);const{Html5Qrcode:L}=await td(async()=>{const{Html5Qrcode:U}=await Promise.resolve().then(()=>NA);return{Html5Qrcode:U}},void 0,import.meta.url),B=new L("hidden-qr-reader"),H=await B.scanFile(O,!1);B.clear(),A(H,{})}catch(L){console.error("Error scanning uploaded file:",L),C("Failed to scan QR code from image. Please ensure the image contains a valid QR code."),x(!1)}};return o.jsxs("div",{className:"qr-scanner-modal",children:[o.jsx("div",{id:"hidden-qr-reader",style:{display:"none"}}),o.jsxs("div",{className:"qr-scanner-content",children:[o.jsxs("div",{className:"qr-scanner-header",children:[o.jsx("h3",{children:"Scan QR Code"}),o.jsx("button",{className:"qr-close-btn",onClick:n,children:o.jsx("i",{className:"fas fa-times"})})]}),o.jsx("div",{className:"qr-scanner-body",children:v?o.jsxs("div",{className:"qr-error",children:[o.jsx("div",{className:"error-icon",children:""}),o.jsx("p",{children:v}),o.jsxs("button",{className:"qr-retry-btn",onClick:w,children:[o.jsx("i",{className:"fas fa-redo"}),"Try Again"]})]}):f?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"qr-reader-container",children:o.jsx("div",{id:"qr-reader",ref:l,className:"qr-reader"})}),o.jsxs("div",{className:"qr-scanner-info",children:[o.jsx("p",{children:"Position the QR code within the frame"}),o.jsxs("div",{className:"qr-scanner-tips",children:[o.jsxs("div",{className:"tip",children:[o.jsx("i",{className:"fas fa-lightbulb"}),o.jsx("span",{children:"Ensure good lighting"})]}),o.jsxs("div",{className:"tip",children:[o.jsx("i",{className:"fas fa-hand-paper"}),o.jsx("span",{children:"Hold steady"})]})]})]}),o.jsx("div",{className:"qr-scanner-actions",children:o.jsxs("button",{className:"qr-stop-btn",onClick:()=>{N(),x(!1)},children:[o.jsx("i",{className:"fas fa-stop"}),"Stop Scanning"]})})]}):o.jsxs("div",{className:"qr-start-section",children:[o.jsx("div",{className:"qr-start-icon",children:o.jsx("i",{className:"fas fa-camera"})}),o.jsx("p",{children:"Scan QR codes to connect with CaBa users"}),o.jsxs("button",{className:"qr-start-btn",onClick:w,children:[o.jsx("i",{className:"fas fa-qrcode"}),"Start Scanning"]}),o.jsxs("div",{className:"qr-alternative",children:[o.jsx("span",{children:"or"}),o.jsxs("label",{className:"qr-upload-btn",children:[o.jsx("i",{className:"fas fa-upload"}),"Upload from Gallery",o.jsx("input",{type:"file",accept:"image/*",onChange:R,style:{display:"none"}})]})]})]})})]})]})},id=()=>{const i=us(),n=Cr(),a=[{path:"/",icon:Ma,label:"Chats"},{path:"/calls",icon:Hs,label:"Calls"},{path:"/qr",icon:ry,label:"QR Code"},{path:"/news",icon:ci,label:"News"},{path:"/settings",icon:Kl,label:"Settings"}],l=d=>d==="/"?n.pathname==="/"||n.pathname.startsWith("/chat"):n.pathname.startsWith(d);return o.jsx("nav",{className:"bottom-nav",children:a.map(({path:d,icon:f,label:x})=>o.jsxs("button",{className:`nav-item ${l(d)?"active":""}`,onClick:()=>i(d),children:[o.jsx(f,{size:20}),o.jsx("span",{className:"label",children:x})]},d))})},TA=()=>{const i=us(),{user:n}=Xa(),[a,l]=M.useState(!1),[d,f]=M.useState(!1),[x,v]=M.useState(null),[C,w]=M.useState(!1),A=O=>{f(!1);try{const L=JSON.parse(O);L.id&&L.name?(v(L),w(!0)):L.url&&window.open(L.url,"_blank")}catch{O.startsWith("http")?window.open(O,"_blank"):alert("Invalid QR code format")}},N=()=>{if(!x)return;let O=JSON.parse(localStorage.getItem("CaBa_contacts")||"[]");O.some(L=>L.id===x.id)?alert("User already in contacts"):(O.push({id:x.id,name:x.name,phone:x.phone,about:x.about,addedAt:new Date().toISOString()}),localStorage.setItem("CaBa_contacts",JSON.stringify(O)),alert(`${x.name} added to contacts!`)),w(!1),v(null)},R=()=>{x&&(i(`/chat/new/${x.id}`),w(!1),v(null))};if(!n)return o.jsxs("div",{className:"qr-page",children:[o.jsxs("div",{className:"qr-page-header",children:[o.jsx("button",{className:"back-btn",onClick:()=>i("/"),children:o.jsx("i",{className:"fas fa-arrow-left"})}),o.jsx("h1",{children:"QR Code"})]}),o.jsx("div",{className:"qr-page-content",children:o.jsx("p",{children:"Please log in to use QR code features"})})]});console.log("QR Page - User object:",n);const T={id:n.id||"",name:n.name||n.user_metadata?.full_name||n.user_metadata?.name||"User",phone:n.phone||n.user_metadata?.phone||"",email:n.email||""};return o.jsxs("div",{className:"qr-page",children:[o.jsxs("div",{className:"qr-page-header",children:[o.jsx("button",{className:"back-btn",onClick:()=>i("/"),children:o.jsx("i",{className:"fas fa-arrow-left"})}),o.jsx("h1",{children:"QR Code"})]}),o.jsxs("div",{className:"qr-page-content",children:[o.jsxs("div",{className:"qr-options",children:[o.jsxs("div",{className:"qr-option-card",onClick:()=>l(!0),children:[o.jsx("div",{className:"qr-option-icon",children:o.jsx("i",{className:"fas fa-qrcode"})}),o.jsx("h3",{children:"My QR Code"}),o.jsx("p",{children:"Generate and share your profile QR code"})]}),o.jsxs("div",{className:"qr-option-card",onClick:()=>f(!0),children:[o.jsx("div",{className:"qr-option-icon",children:o.jsx("i",{className:"fas fa-camera"})}),o.jsx("h3",{children:"Scan QR Code"}),o.jsx("p",{children:"Scan QR codes to add contacts or visit links"})]})]}),o.jsxs("div",{className:"qr-info-section",children:[o.jsx("h3",{children:"How QR Codes Work"}),o.jsxs("div",{className:"qr-info-grid",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("i",{className:"fas fa-user-plus"}),o.jsx("h4",{children:"Add Contacts"}),o.jsx("p",{children:"Scan someone's QR code to instantly add them to your contacts"})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("i",{className:"fas fa-share"}),o.jsx("h4",{children:"Share Profile"}),o.jsx("p",{children:"Share your QR code so others can view your profile and start chatting"})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("i",{className:"fas fa-mobile-alt"}),o.jsx("h4",{children:"Cross-Platform"}),o.jsx("p",{children:"Works across all devices and platforms"})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("i",{className:"fas fa-shield-alt"}),o.jsx("h4",{children:"Secure"}),o.jsx("p",{children:"End-to-end encrypted and secure"})]})]})]})]}),a&&n&&o.jsx(hy,{userId:T.id,userName:T.name,userPhone:T.phone,onClose:()=>l(!1)}),d&&o.jsx(vy,{onScan:A,onClose:()=>f(!1)}),C&&x&&o.jsx("div",{className:"modal",style:{display:"flex"},children:o.jsxs("div",{className:"modal-content",children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"User Found"}),o.jsx("button",{className:"close-modal",onClick:()=>{w(!1),v(null)},children:o.jsx("i",{className:"fas fa-times"})})]}),o.jsxs("div",{className:"modal-body",style:{textAlign:"center"},children:[o.jsx("div",{style:{marginBottom:"20px"},children:o.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"15px"},children:[o.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",background:"var(--primary-color)",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"15px",color:"white",fontSize:"24px"},children:x.name.split(" ").map(O=>O[0]).join("").toUpperCase().slice(0,2)}),o.jsxs("div",{style:{textAlign:"left"},children:[o.jsx("h3",{style:{margin:"0",color:"var(--text-primary)"},children:x.name}),o.jsx("p",{style:{margin:"5px 0",color:"var(--text-secondary)"},children:x.phone}),x.about&&o.jsx("p",{style:{margin:"0",color:"var(--text-secondary)",fontSize:"14px"},children:x.about})]})]})}),o.jsxs("div",{className:"action-buttons",style:{display:"flex",gap:"10px",justifyContent:"center"},children:[o.jsxs("button",{className:"btn-primary",onClick:N,children:[o.jsx("i",{className:"fas fa-user-plus"}),"Add to Contacts"]}),o.jsxs("button",{className:"btn-secondary",onClick:R,children:[o.jsx("i",{className:"fas fa-comments"}),"Start Chat"]})]})]})]})}),o.jsx(id,{})]})},jA=()=>{const{supabase:i}=ds(),{user:n,loading:a}=Xa(),[l,d]=M.useState(null),[f,x]=M.useState(!0),[v,C]=M.useState({chats:0,calls:0,contacts:0}),[w,A]=M.useState(!1),[N,R]=M.useState(!1),[T,O]=M.useState(!1),[L,B]=M.useState(!1),[H,U]=M.useState(!1),[P,K]=M.useState(null),[Z,W]=M.useState({name:"",about:"",email:""});M.useEffect(()=>{a||X()},[n,a]);const X=async()=>{try{if(!n)return;const V=localStorage.getItem(`digidad_profile_${n.id}`);if(V){const Ge=JSON.parse(V);d(Ge),J()}const{data:$,error:oe}=await i.from("users").select("*").eq("id",n.id).single();let ke;if(oe&&oe.code==="PGRST116"){const{data:Ge,error:Ke}=await i.from("users").insert([{id:n.id,name:n.name||"User",phone:n.phone||"",email:n.email,avatar:n.avatar||null,about:"Hey there! I am using CaBa",is_online:!1,last_seen:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select().single();if(Ke)throw Ke;ke=Ge}else{if(oe)throw oe;ke=$}localStorage.setItem(`digidad_profile_${n.id}`,JSON.stringify(ke)),d(ke),J()}catch(V){console.error("Error loading profile:",V)}finally{x(!1)}},J=()=>{const V=JSON.parse(localStorage.getItem("CaBa_contacts")||"[]");C({chats:V.length||0,calls:0,contacts:V.length||0})},q=V=>V.split(" ").map($=>$[0]).join("").toUpperCase().slice(0,2),he=()=>{W({name:l.name,about:l.about||"",email:l.email||""}),A(!0)},ge=async()=>{try{const{name:V,about:$,email:oe}=Z;if(V.length<3){alert("Name must be at least 3 characters");return}const{error:ke}=await i.from("users").update({name:V,about:$,email:oe||null}).eq("id",n.id);if(ke)throw ke;const Ge={...l,name:V,about:$,email:oe};d(Ge),localStorage.setItem(`digidad_profile_${n.id}`,JSON.stringify(Ge)),localStorage.setItem("currentUser",JSON.stringify(Ge)),A(!1),alert("Profile updated successfully")}catch(V){console.error("Error updating profile:",V),alert("Failed to update profile")}},ie=async V=>{try{const{error:$}=await i.from("users").update({avatar:V.toString()}).eq("id",n.id);if($)throw $;const oe={...l,avatar:V.toString()};d(oe),localStorage.setItem(`digidad_profile_${n.id}`,JSON.stringify(oe)),localStorage.setItem("currentUser",JSON.stringify(oe)),R(!1),alert("Profile picture updated")}catch($){console.error("Error selecting DP:",$),alert("Failed to update profile picture")}},be=V=>{B(!1);try{const $=JSON.parse(V);$.id&&$.name&&(K($),U(!0))}catch{alert("Invalid QR code format")}},Ie=()=>{let V=JSON.parse(localStorage.getItem("CaBa_contacts")||"[]");V.some($=>$.id===P.id)?alert("User already in contacts"):(V.push({id:P.id,name:P.name,phone:P.phone,about:P.about,addedAt:new Date().toISOString()}),localStorage.setItem("CaBa_contacts",JSON.stringify(V)),alert(`${P.name} added to contacts`),J()),U(!1)};return f?o.jsx("div",{className:"profile-screen",children:o.jsx("div",{style:{textAlign:"center",padding:"50px"},children:"Loading..."})}):l?o.jsxs("div",{className:"profile-screen",children:[o.jsxs("header",{className:"profile-header",children:[o.jsx("button",{className:"back-btn",onClick:()=>window.history.back(),children:o.jsx("span",{className:"icon",children:""})}),o.jsx("h1",{children:"Profile"}),o.jsx("button",{className:"icon-btn",onClick:he,children:o.jsx("i",{className:"fas fa-edit"})})]}),o.jsxs("div",{className:"profile-content",children:[o.jsx("div",{className:"profile-picture-section",children:o.jsx("div",{className:"profile-avatar",onClick:()=>R(!0),children:l.avatar?o.jsx("img",{src:parseInt(l.avatar)?Rs.find(V=>V.id===parseInt(l.avatar))?.path:l.avatar,alt:"Profile Picture",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}):o.jsx("div",{className:"profile-initials",children:q(l.name)})})}),o.jsxs("div",{className:"profile-info-section",children:[o.jsxs("div",{className:"info-item",children:[o.jsxs("div",{className:"info-label",children:[o.jsx("i",{className:"fas fa-user"}),o.jsx("span",{className:"label",children:"Name"})]}),o.jsx("div",{className:"info-value",children:o.jsx("span",{children:l.name})})]}),o.jsxs("div",{className:"info-item",children:[o.jsxs("div",{className:"info-label",children:[o.jsx("i",{className:"fas fa-info-circle"}),o.jsx("span",{className:"label",children:"About"})]}),o.jsx("div",{className:"info-value",children:o.jsx("span",{children:l.about||"Hey there! I am using CaBa"})})]}),o.jsxs("div",{className:"info-item",children:[o.jsxs("div",{className:"info-label",children:[o.jsx("i",{className:"fas fa-phone"}),o.jsx("span",{className:"label",children:"Phone"})]}),o.jsx("div",{className:"info-value",children:o.jsx("span",{children:l.phone})})]}),o.jsxs("div",{className:"info-item",children:[o.jsxs("div",{className:"info-label",children:[o.jsx("i",{className:"fas fa-envelope"}),o.jsx("span",{className:"label",children:"Email"})]}),o.jsx("div",{className:"info-value",children:o.jsx("span",{children:l.email||"Not set"})})]})]}),o.jsxs("div",{className:"profile-stats",children:[o.jsxs("div",{className:"stat-item",children:[o.jsx("h3",{children:v.chats}),o.jsx("p",{children:"Chats"})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("h3",{children:v.calls}),o.jsx("p",{children:"Calls"})]}),o.jsxs("div",{className:"stat-item",children:[o.jsx("h3",{children:v.contacts}),o.jsx("p",{children:"Contacts"})]})]}),o.jsxs("div",{className:"profile-actions",children:[o.jsxs("button",{className:"action-btn",onClick:()=>O(!0),children:[o.jsx("i",{className:"fas fa-qrcode"}),o.jsx("span",{className:"label",children:"My QR Code"})]}),o.jsxs("button",{className:"action-btn",onClick:()=>B(!0),children:[o.jsx("i",{className:"fas fa-camera"}),o.jsx("span",{className:"label",children:"Scan QR Code"})]})]})]}),w&&o.jsx("div",{className:"modal",style:{display:"flex"},children:o.jsxs("div",{className:"modal-content",children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Edit Profile"}),o.jsx("button",{className:"close-modal",onClick:()=>A(!1),children:o.jsx("i",{className:"fas fa-times"})})]}),o.jsx("div",{className:"modal-body",children:o.jsxs("form",{onSubmit:V=>{V.preventDefault(),ge()},children:[o.jsxs("div",{className:"input-group",children:[o.jsx("label",{htmlFor:"editName",children:"Full Name"}),o.jsx("input",{type:"text",id:"editName",value:Z.name,onChange:V=>W({...Z,name:V.target.value}),required:!0,minLength:"3"})]}),o.jsxs("div",{className:"input-group",children:[o.jsx("label",{htmlFor:"editAbout",children:"About"}),o.jsx("textarea",{id:"editAbout",rows:"3",maxLength:"150",value:Z.about,onChange:V=>W({...Z,about:V.target.value})})]}),o.jsxs("div",{className:"input-group",children:[o.jsx("label",{htmlFor:"editEmail",children:"Email"}),o.jsx("input",{type:"email",id:"editEmail",value:Z.email,onChange:V=>W({...Z,email:V.target.value})})]}),o.jsx("button",{type:"submit",className:"btn-primary",children:"Save Changes"})]})})]})}),N&&o.jsx("div",{className:"modal",style:{display:"flex"},children:o.jsxs("div",{className:"modal-content",children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Choose Profile Picture"}),o.jsx("button",{className:"close-modal",onClick:()=>R(!1),children:o.jsx("i",{className:"fas fa-times"})})]}),o.jsx("div",{className:"modal-body",children:o.jsx("div",{className:"dp-options-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(80px, 1fr))",gap:"10px"},children:Rs.map(V=>o.jsx("img",{src:V.path,alt:`DP ${V.id}`,style:{width:"80px",height:"80px",borderRadius:"8px",cursor:"pointer",objectFit:"cover"},onClick:()=>ie(V.id)},V.id))})})]})}),T&&l&&o.jsx(hy,{userId:l.id,userName:l.name,userPhone:l.phone,onClose:()=>O(!1)}),L&&o.jsx(vy,{onScan:be,onClose:()=>B(!1)}),H&&P&&o.jsx("div",{className:"modal",style:{display:"flex"},children:o.jsxs("div",{className:"modal-content",children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"User Found"}),o.jsx("button",{className:"close-modal",onClick:()=>U(!1),children:o.jsx("i",{className:"fas fa-times"})})]}),o.jsxs("div",{className:"modal-body",style:{textAlign:"center"},children:[o.jsx("div",{style:{marginBottom:"20px"},children:o.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"15px"},children:[o.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",background:"var(--primary-color)",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"15px",color:"white",fontSize:"24px"},children:q(P.name)}),o.jsxs("div",{style:{textAlign:"left"},children:[o.jsx("h3",{style:{margin:"0",color:"var(--text-primary)"},children:P.name}),o.jsx("p",{style:{margin:"5px 0",color:"var(--text-secondary)"},children:P.phone}),P.about&&o.jsx("p",{style:{margin:"0",color:"var(--text-secondary)",fontSize:"14px"},children:P.about})]})]})}),o.jsx("div",{className:"action-buttons",style:{display:"flex",gap:"10px",justifyContent:"center"},children:o.jsxs("button",{className:"btn-primary",onClick:Ie,children:[o.jsx("i",{className:"fas fa-user-plus"}),"Add to Contacts"]})})]})]})})]}):o.jsx("div",{className:"profile-screen",children:o.jsx("div",{style:{textAlign:"center",padding:"50px"},children:"Please log in to view profile"})})},RA=()=>{const i=us(),{supabase:n}=ds(),{theme:a,toggleTheme:l}=Jo(),{chatTheme:d,chatThemes:f,selectTheme:x,currentThemeData:v}=M0(),C="./",[w,A]=M.useState({messageNotifications:!0,callNotifications:!0,notificationSound:!0,vibrate:!0,enterToSend:!1,readReceipts:!0,lastSeen:!0,showOnlineStatus:!0,allowEveryoneMessage:!0,profileVisible:!0,storageUsage:{app:0,media:0,total:0},callRingtone:"fm-freemusic-give-me-a-smile(chosic.com).mp3"}),[N,R]=M.useState(!1),[T,O]=M.useState(!1),[L,B]=M.useState(!1),[H,U]=M.useState(!1),[P,K]=M.useState(null),[Z,W]=M.useState("fm-freemusic-give-me-a-smile(chosic.com).mp3"),X=[{file:"fm-freemusic-give-me-a-smile(chosic.com).mp3",name:"Give Me a Smile"},{file:"gio_office_0610.mp3",name:"Office"},{file:"Journey(chosic.com).mp3",name:"Journey"},{file:"Lights(chosic.com).mp3",name:"Lights"},{file:"nice_ring_tones.mp3",name:"Nice Ring"},{file:"PeriTune_Alleyway-chosic.com_.mp3",name:"Alleyway"},{file:"PeriTune_Village_Fete-chosic.com_.mp3",name:"Village Fete"},{file:"professional.mp3",name:"Professional"},{file:"roa-music-summer-madness(chosic.com).mp3",name:"Summer Madness"},{file:"Run-Amok(chosic.com).mp3",name:"Run Amok"},{file:"Sakura-Girl-Daisy-chosic.com_.mp3",name:"Daisy"},{file:"Sakura-Girl-Wake-Up-chosic.com_.mp3",name:"Wake Up"},{file:"smta_own_tone.mp3",name:"Own Tone"},{file:"-Spring-field-(chosic.com).mp3",name:"Spring Field"}];M.useEffect(()=>(J(),()=>{P&&P.pause()}),[]);const J=()=>{const Ce={...w};Ce.messageNotifications=localStorage.getItem("messageNotifications")!=="false",Ce.callNotifications=localStorage.getItem("callNotifications")!=="false",Ce.notificationSound=localStorage.getItem("notificationSound")!=="false",Ce.vibrate=localStorage.getItem("vibrate")!=="false",Ce.enterToSend=localStorage.getItem("enterToSend")==="true",Ce.readReceipts=localStorage.getItem("readReceipts")!=="false",Ce.lastSeen=localStorage.getItem("lastSeen")!=="false",Ce.showOnlineStatus=localStorage.getItem("showOnlineStatus")!=="false",Ce.allowEveryoneMessage=localStorage.getItem("allowEveryoneMessage")!=="false",Ce.profileVisible=localStorage.getItem("profileVisible")!=="false",Ce.callRingtone=localStorage.getItem("callRingtone")||"fm-freemusic-give-me-a-smile(chosic.com).mp3",A(Ce),W(Ce.callRingtone),q()},q=async()=>{try{let Ce=0,Je=0;for(let Wt in localStorage)localStorage.hasOwnProperty(Wt)&&(Ce+=localStorage[Wt].length+Wt.length);const mt=Ce+Je;A(Wt=>({...Wt,storageUsage:{app:Ce,media:Je,total:mt}}))}catch(Ce){console.error("Error calculating storage:",Ce)}},he=Ce=>{const Je=Ce/1024,mt=Je/1024;return mt>=1?`${mt.toFixed(2)} MB`:`${Je.toFixed(2)} KB`},ge=()=>{l(),alert(`${a==="dark"?"Light":"Dark"} mode enabled`)},ie=()=>{U(!0)},be=async Ce=>{await x(Ce),U(!1),alert(`Chat theme "${f[Ce].name}" applied`)},Ie=Ce=>{const Je=!w[Ce];localStorage.setItem(Ce,Je.toString()),A(mt=>({...mt,[Ce]:Je}))},V=()=>{B(!0)},$=Ce=>{P&&(P.pause(),P.currentTime=0);const Je=new Audio(`${C}assets/audio/${Ce}`);Je.volume=.7,Je.play().catch(mt=>{console.log("Could not play ringtone:",mt),alert("Could not play ringtone")}),K(Je),setTimeout(()=>{P===Je&&(Je.pause(),Je.currentTime=0,K(null))},1e4)},oe=Ce=>{localStorage.setItem("callRingtone",Ce),A(Je=>({...Je,callRingtone:Ce})),W(Ce),P&&(P.pause(),K(null)),B(!1),alert("Call ringtone updated")},ke=async()=>{if(confirm("This will clear all cached media files. Continue?"))try{alert("Clearing media storage..."),await q(),alert("Media storage cleared successfully")}catch(Ce){console.error("Error clearing media storage:",Ce),alert("Failed to clear media storage")}},Ge=async()=>{if(confirm("This will clear app cache and temporary data. Continue?"))try{alert("Clearing app storage..."),Object.keys(localStorage).forEach(Je=>{["currentUser","rememberMe","theme","messageNotifications","callNotifications","notificationSound","vibrate","enterToSend","readReceipts","lastSeen","mutedUsers","showOnlineStatus","allowEveryoneMessage","profileVisible"].includes(Je)||localStorage.removeItem(Je)}),await q(),alert("App storage cleared successfully")}catch(Ce){console.error("Error clearing app storage:",Ce),alert("Failed to clear app storage")}},Ke=async()=>{if(confirm("This will clear all cached data. Continue?"))try{alert("Clearing all cache..."),await ke(),await Ge(),alert("All cache cleared successfully")}catch(Ce){console.error("Error clearing cache:",Ce),alert("Failed to clear cache")}},ne=async()=>{if(confirm("Are you sure you want to delete your account? This action cannot be undone.")&&confirm("This will permanently delete all your messages, calls, and data. Continue?"))try{const Ce=localStorage.getItem("currentUser");if(!Ce){alert("No user session found"),i("/login");return}const Je=JSON.parse(Ce),{error:mt}=await n.from("users").delete().eq("id",Je.id);if(mt){console.error("Error deleting user data:",mt),alert("Failed to delete account");return}localStorage.clear(),alert("Account deleted successfully"),i("/login")}catch(Ce){console.error("Error deleting account:",Ce),alert("Failed to delete account")}},ye=()=>alert("Security settings coming soon"),Le=()=>i("/blocked"),Ue=()=>alert("Auto download settings coming soon"),We=()=>alert("Help center coming soon"),Ne=()=>alert("Contact support coming soon"),$e=()=>alert("Terms & Privacy coming soon"),De=()=>alert("You are using the latest version (1.0.0)");return o.jsxs("div",{className:"settings-screen",children:[o.jsxs("header",{className:"settings-header",children:[o.jsx("button",{className:"back-btn",onClick:()=>i(-1),children:o.jsx("i",{className:"fas fa-arrow-left"})}),o.jsx("h1",{children:"Settings"})]}),o.jsxs("div",{className:"settings-content",children:[o.jsxs("div",{className:"settings-section",children:[o.jsx("h2",{className:"section-title",children:"Account"}),o.jsxs("div",{className:"settings-item",onClick:()=>i("/profile"),children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-user"}),o.jsx("span",{className:"label",children:"Profile"})]}),o.jsx("i",{className:"fas fa-chevron-right"})]}),o.jsxs("div",{className:"settings-item",onClick:()=>R(!N),children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-lock"}),o.jsx("span",{className:"label",children:"Privacy"})]}),o.jsx("span",{className:"icon arrow",style:{transform:N?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.3s ease"},children:""})]}),N&&o.jsxs("div",{className:"privacy-options",children:[o.jsxs("div",{className:"settings-item toggle-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-eye"}),o.jsx("span",{className:"label",children:"Show Online Status"})]}),o.jsxs("label",{className:"toggle-switch",children:[o.jsx("input",{type:"checkbox",checked:w.showOnlineStatus,onChange:()=>Ie("showOnlineStatus")}),o.jsx("span",{className:"toggle-slider"})]})]}),o.jsxs("div",{className:"settings-item toggle-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-envelope"}),o.jsx("span",{className:"label",children:"Allow Everyone to Message"})]}),o.jsxs("label",{className:"toggle-switch",children:[o.jsx("input",{type:"checkbox",checked:w.allowEveryoneMessage,onChange:()=>Ie("allowEveryoneMessage")}),o.jsx("span",{className:"toggle-slider"})]})]}),o.jsxs("div",{className:"settings-item toggle-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-user"}),o.jsx("span",{className:"label",children:"Profile Visible to Everyone"})]}),o.jsxs("label",{className:"toggle-switch",children:[o.jsx("input",{type:"checkbox",checked:w.profileVisible,onChange:()=>Ie("profileVisible")}),o.jsx("span",{className:"toggle-slider"})]})]})]}),o.jsxs("div",{className:"settings-item",onClick:ye,children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-shield-alt"}),o.jsx("span",{className:"label",children:"Security"})]}),o.jsx("span",{className:"icon arrow",children:""})]}),o.jsxs("div",{className:"settings-item",onClick:Le,children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-ban"}),o.jsx("span",{className:"label",children:"Blocked Users"})]}),o.jsx("span",{className:"icon arrow",children:""})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h2",{className:"section-title",children:"Appearance"}),o.jsxs("div",{className:"settings-item toggle-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-moon"}),o.jsx("span",{className:"label",children:"Dark Mode"})]}),o.jsxs("label",{className:"toggle-switch",children:[o.jsx("input",{type:"checkbox",checked:a==="dark",onChange:ge}),o.jsx("span",{className:"toggle-slider"})]})]}),o.jsxs("div",{className:"settings-item",onClick:ge,children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-palette"}),o.jsx("span",{className:"label",children:"Theme"})]}),o.jsxs("div",{className:"item-right",children:[o.jsx("span",{className:"value",children:a==="dark"?"Dark":"Light"}),o.jsx("span",{className:"icon arrow",children:""})]})]}),o.jsxs("div",{className:"settings-item",onClick:ie,children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-comments"}),o.jsx("span",{className:"label",children:"Chat Theme"})]}),o.jsxs("div",{className:"item-right",children:[o.jsx("span",{className:"value",children:v.name}),o.jsx("span",{className:"icon arrow",children:""})]})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h2",{className:"section-title",children:"Notifications"}),o.jsxs("div",{className:"settings-item toggle-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-bell"}),o.jsx("span",{className:"label",children:"Message Notifications"})]}),o.jsxs("label",{className:"toggle-switch",children:[o.jsx("input",{type:"checkbox",checked:w.messageNotifications,onChange:()=>Ie("messageNotifications")}),o.jsx("span",{className:"toggle-slider"})]})]}),o.jsxs("div",{className:"settings-item toggle-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-phone"}),o.jsx("span",{className:"label",children:"Call Notifications"})]}),o.jsxs("label",{className:"toggle-switch",children:[o.jsx("input",{type:"checkbox",checked:w.callNotifications,onChange:()=>Ie("callNotifications")}),o.jsx("span",{className:"toggle-slider"})]})]}),o.jsxs("div",{className:"settings-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-music"}),o.jsx("span",{className:"label",children:"Call Ringtone"})]}),o.jsxs("button",{className:"btn-primary",onClick:V,children:[o.jsx("i",{className:"fas fa-music"}),"Choose Ringtone"]})]}),o.jsxs("div",{className:"settings-item toggle-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-volume-up"}),o.jsx("span",{className:"label",children:"Notification Sound"})]}),o.jsxs("label",{className:"toggle-switch",children:[o.jsx("input",{type:"checkbox",checked:w.notificationSound,onChange:()=>Ie("notificationSound")}),o.jsx("span",{className:"toggle-slider"})]})]}),o.jsxs("div",{className:"settings-item toggle-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-mobile-alt"}),o.jsx("span",{className:"label",children:"Vibrate"})]}),o.jsxs("label",{className:"toggle-switch",children:[o.jsx("input",{type:"checkbox",checked:w.vibrate,onChange:()=>Ie("vibrate")}),o.jsx("span",{className:"toggle-slider"})]})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h2",{className:"section-title",children:"Chat Settings"}),o.jsxs("div",{className:"settings-item toggle-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-keyboard"}),o.jsx("span",{className:"label",children:"Enter to Send"})]}),o.jsxs("label",{className:"toggle-switch",children:[o.jsx("input",{type:"checkbox",checked:w.enterToSend,onChange:()=>Ie("enterToSend")}),o.jsx("span",{className:"toggle-slider"})]})]}),o.jsxs("div",{className:"settings-item toggle-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-check"}),o.jsx("span",{className:"label",children:"Read Receipts"})]}),o.jsxs("label",{className:"toggle-switch",children:[o.jsx("input",{type:"checkbox",checked:w.readReceipts,onChange:()=>Ie("readReceipts")}),o.jsx("span",{className:"toggle-slider"})]})]}),o.jsxs("div",{className:"settings-item toggle-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-clock"}),o.jsx("span",{className:"label",children:"Last Seen"})]}),o.jsxs("label",{className:"toggle-switch",children:[o.jsx("input",{type:"checkbox",checked:w.lastSeen,onChange:()=>Ie("lastSeen")}),o.jsx("span",{className:"toggle-slider"})]})]}),o.jsxs("div",{className:"settings-item",onClick:Ue,children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-arrow-down"}),o.jsx("span",{className:"label",children:"Auto Download Media"})]}),o.jsx("span",{className:"icon arrow",children:""})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h2",{className:"section-title",children:"Storage and Data"}),o.jsxs("div",{className:"settings-item",onClick:()=>O(!T),children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-save"}),o.jsx("span",{className:"label",children:"Storage Usage"})]}),o.jsxs("div",{className:"item-right",children:[o.jsx("span",{className:"value",children:he(w.storageUsage.total)}),o.jsx("span",{className:"icon arrow",style:{transform:T?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.3s ease"},children:""})]})]}),T&&o.jsxs("div",{className:"storage-details",children:[o.jsxs("div",{className:"settings-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-images"}),o.jsx("span",{className:"label",children:"Media Storage"})]}),o.jsxs("div",{className:"item-right",children:[o.jsx("span",{className:"value",children:he(w.storageUsage.media)}),o.jsx("button",{className:"clear-btn",onClick:ke,children:o.jsx("i",{className:"fas fa-trash-alt"})})]})]}),o.jsxs("div",{className:"settings-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-mobile-alt"}),o.jsx("span",{className:"label",children:"App Storage"})]}),o.jsxs("div",{className:"item-right",children:[o.jsx("span",{className:"value",children:he(w.storageUsage.app)}),o.jsx("button",{className:"clear-btn",onClick:Ge,children:o.jsx("i",{className:"fas fa-trash-alt"})})]})]})]}),o.jsxs("div",{className:"settings-item",onClick:Ke,children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-trash"}),o.jsx("span",{className:"label",children:"Clear All Cache"})]}),o.jsx("span",{className:"icon arrow",children:""})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h2",{className:"section-title",children:"Help & Support"}),o.jsxs("div",{className:"settings-item",onClick:We,children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-question"}),o.jsx("span",{className:"label",children:"Help Center"})]}),o.jsx("span",{className:"icon arrow",children:""})]}),o.jsxs("div",{className:"settings-item",onClick:Ne,children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-envelope"}),o.jsx("span",{className:"label",children:"Contact Us"})]}),o.jsx("span",{className:"icon arrow",children:""})]}),o.jsxs("div",{className:"settings-item",onClick:$e,children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-file"}),o.jsx("span",{className:"label",children:"Terms & Privacy Policy"})]}),o.jsx("span",{className:"icon arrow",children:""})]})]}),o.jsxs("div",{className:"settings-section",children:[o.jsx("h2",{className:"section-title",children:"About"}),o.jsxs("div",{className:"settings-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-info"}),o.jsx("span",{className:"label",children:"App Version"})]}),o.jsx("span",{className:"value",children:"1.0.0"})]}),o.jsxs("div",{className:"settings-item",onClick:De,children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-sync"}),o.jsx("span",{className:"label",children:"Check for Updates"})]}),o.jsx("span",{className:"icon arrow",children:""})]})]}),o.jsx("div",{className:"settings-section danger-section",children:o.jsxs("div",{className:"settings-item danger",onClick:ne,children:[o.jsxs("div",{className:"item-left",children:[o.jsx("i",{className:"fas fa-exclamation-triangle"}),o.jsx("span",{className:"label",children:"Delete Account"})]}),o.jsx("span",{className:"icon arrow",children:""})]})})]}),L&&o.jsx("div",{className:"modal",style:{display:"flex"},children:o.jsxs("div",{className:"modal-content",children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Choose Call Ringtone"}),o.jsx("button",{className:"close-modal",onClick:()=>B(!1),children:o.jsx("i",{className:"fas fa-times"})})]}),o.jsx("div",{className:"modal-body",children:o.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:X.map(Ce=>o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px",border:"1px solid #ddd",borderRadius:"8px"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[o.jsx("i",{className:"fas fa-music"}),o.jsx("span",{children:Ce.name})]}),o.jsxs("div",{style:{display:"flex",gap:"10px"},children:[o.jsx("button",{onClick:()=>$(Ce.file),style:{padding:"5px 10px",border:"none",borderRadius:"4px",background:"#007bff",color:"white",cursor:"pointer"},children:o.jsx("i",{className:"fas fa-play"})}),o.jsx("button",{onClick:()=>oe(Ce.file),style:{padding:"5px 10px",border:"none",borderRadius:"4px",background:"#28a745",color:"white",cursor:"pointer"},children:"Confirm"})]})]},Ce.file))})})]})}),H&&o.jsx("div",{className:"modal",style:{display:"flex"},children:o.jsxs("div",{className:"modal-content",children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Choose Chat Theme"}),o.jsx("button",{className:"close-modal",onClick:()=>U(!1),children:o.jsx("i",{className:"fas fa-times"})})]}),o.jsx("div",{className:"modal-body",children:o.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"15px"},children:Object.entries(f).map(([Ce,Je])=>o.jsxs("div",{className:`theme-item ${d===Ce?"active":""}`,onClick:()=>be(Ce),style:{cursor:"pointer",borderRadius:"8px",overflow:"hidden",transition:"transform 0.2s, box-shadow 0.2s",border:d===Ce?"3px solid var(--primary-color)":"1px solid #ddd",height:"80px"},children:[o.jsx("div",{style:{width:"100%",height:"60%",background:Je.background,backgroundSize:"cover",backgroundPosition:"center"}}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 8px",height:"40%"},children:[o.jsx("div",{style:{width:"35px",height:"8px",borderRadius:"4px",background:Je.sentMessage.background}}),o.jsx("div",{style:{width:"35px",height:"8px",borderRadius:"4px",background:Je.receivedMessage.background}})]}),o.jsx("div",{style:{position:"absolute",bottom:"5px",left:"8px",right:"8px",fontSize:"0.7rem",fontWeight:"500",color:"#ffffff",textShadow:"0 1px 2px rgba(0,0,0,0.5)",textAlign:"center"},children:Je.name})]},Ce))})})]})}),o.jsx(id,{})]})},IA=()=>{const{supabase:i}=ds(),[n,a]=M.useState(null),[l,d]=M.useState([]),[f,x]=M.useState([]),[v,C]=M.useState(!0),[w,A]=M.useState(null);M.useEffect(()=>{N()},[]);const N=async()=>{try{const U=localStorage.getItem("currentUser");if(!U){A("No user logged in"),C(!1);return}let P;try{if(P=JSON.parse(U),!P||!P.id){A("Invalid user data"),C(!1);return}}catch{A("Invalid user data"),C(!1);return}a(P),await R(P),await T(P),C(!1)}catch(U){console.error("Error initializing news:",U),A("Failed to load news"),C(!1)}},R=async U=>{try{const{data:P,error:K}=await i.from("statuses").select("*").eq("user_id",U.id).gte("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(K)throw K;d(P||[])}catch(P){console.error("Error loading my status:",P)}},T=async U=>{try{const P=`digidad_statuses_${U.id}`;let K=null;try{const q=localStorage.getItem(P);q&&(K=JSON.parse(q),x(K))}catch(q){console.warn("Error loading cached statuses:",q)}const{data:Z,error:W}=await i.from("statuses").select(`
          *,
          user:users(*)
        `).neq("user_id",U.id).gte("expires_at",new Date().toISOString()).order("created_at",{ascending:!1});if(W)throw W;const X={};Z&&Z.length>0&&Z.forEach(q=>{X[q.user_id]||(X[q.user_id]={user:q.user,statuses:[]}),X[q.user_id].statuses.push(q)});const J=Object.values(X);try{localStorage.setItem(P,JSON.stringify(J))}catch(q){console.warn("Error caching statuses:",q)}x(J)}catch(P){console.error("Error loading recent statuses:",P),f.length||A("Failed to load recent updates")}},O=U=>U?U.split(" ").map(P=>P[0]).join("").toUpperCase().slice(0,2):"U",L=U=>{try{const P=new Date(U);if(isNaN(P.getTime()))return"now";const Z=new Date-P,W=Math.floor(Z/6e4),X=Math.floor(Z/36e5),J=Math.floor(Z/864e5);return W<1?"now":W<60?`${W}m`:X<24?`${X}h`:`${J}d`}catch{return"now"}},B=()=>{alert("Status feature coming soon")},H=(U,P)=>{alert(`Viewing ${U.name}'s status`)};return v?o.jsxs("div",{className:"news-loading",children:[o.jsx("div",{className:"loading-spinner"}),o.jsx("p",{children:"Loading news..."})]}):w?o.jsxs("div",{className:"news-error",children:[o.jsxs("p",{children:[o.jsx(rd,{size:16})," ",w]}),o.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]}):o.jsxs("div",{className:"news-container",children:[o.jsx("header",{className:"news-header",children:o.jsxs("h1",{children:[o.jsx("i",{className:"fas fa-newspaper"})," Latest News Feed"]})}),o.jsx("div",{className:"my-status-section",children:o.jsxs("div",{className:"my-status",onClick:l.length>0?()=>H(n):void 0,children:[o.jsx("div",{className:"status-avatar",children:o.jsx("div",{className:"avatar-circle",children:n?.avatar?o.jsx("img",{src:n.avatar,alt:n?.name||"User"}):O(n?.name||"User")})}),o.jsxs("div",{className:"status-info",children:[o.jsx("h3",{children:"My Status"}),o.jsx("p",{children:l.length>0?`${l.length} update${l.length>1?"s":""}`:"Tap to add status"})]}),o.jsx("button",{className:"add-status-btn",onClick:B,children:o.jsx("i",{className:"fas fa-plus"})})]})}),o.jsxs("div",{className:"recent-statuses-section",children:[o.jsx("h2",{children:"Recent Updates"}),o.jsx("div",{className:"recent-status-list",children:f.length>0?f.filter(({user:U,statuses:P})=>U&&P&&P.length>0).map(({user:U,statuses:P})=>o.jsxs("div",{className:"status-item",onClick:()=>H(U),children:[o.jsx("div",{className:"status-avatar",children:o.jsx("div",{className:"avatar-circle",children:U.avatar?o.jsx("img",{src:U.avatar,alt:U.name||"User"}):O(U.name||"User")})}),o.jsxs("div",{className:"status-info",children:[o.jsx("h3",{children:U.name||"User"}),o.jsx("p",{children:P[0]?.created_at?L(P[0].created_at):"now"})]})]},U.id)):o.jsxs("div",{className:"empty-state",children:[o.jsx("p",{children:"No recent updates"}),o.jsx("small",{children:"Check back later"})]})})]}),o.jsx(id,{})]})},OA=()=>{const{supabase:i}=ds(),{theme:n}=Jo(),[a,l]=M.useState(null),[d,f]=M.useState([]),[x,v]=M.useState(!0),[C,w]=M.useState(null),[A,N]=M.useState("all"),[R,T]=M.useState("upcoming");M.useEffect(()=>{O()},[]);const O=async()=>{try{const V=localStorage.getItem("currentUser");if(!V){w("No user logged in"),v(!1);return}const $=JSON.parse(V);l($),await L($),v(!1)}catch(V){console.error("Error initializing reminders:",V),w("Failed to load reminders"),v(!1)}},L=async V=>{try{let $=i.from("reminders").select(`
          *,
          sender:users!reminders_sender_id_fkey(id, name, avatar, phone),
          receiver:users!reminders_receiver_id_fkey(id, name, avatar, phone)
        `);A==="sent"?$=$.eq("sender_id",V.id):A==="received"?$=$.eq("receiver_id",V.id):A==="pending"?$=$.eq("receiver_id",V.id).eq("status","pending"):A==="accepted"?$=$.eq("status","accepted"):$=$.or(`sender_id.eq.${V.id},receiver_id.eq.${V.id}`);const{data:oe,error:ke}=await $.order("reminder_time",{ascending:!0});if(ke)throw ke;f(oe||[])}catch($){console.error("Error loading reminders:",$),w("Failed to load reminders")}},B=V=>{N(V),a&&L(a)},H=V=>{T(V)},U=async V=>{try{const{error:$}=await i.from("reminders").update({status:"accepted",accepted_at:new Date().toISOString()}).eq("id",V);if($)throw $;alert("Reminder accepted"),L(a)}catch($){console.error("Error accepting reminder:",$),alert("Failed to accept reminder")}},P=async V=>{try{const{error:$}=await i.from("reminders").update({status:"rejected"}).eq("id",V);if($)throw $;alert("Reminder rejected"),L(a)}catch($){console.error("Error rejecting reminder:",$),alert("Failed to reject reminder")}},K=async V=>{try{const{error:$}=await i.from("reminders").update({status:"completed",completed_at:new Date().toISOString()}).eq("id",V);if($)throw $;alert("Reminder completed"),L(a)}catch($){console.error("Error completing reminder:",$),alert("Failed to complete reminder")}},Z=async V=>{const $=parseInt(prompt("Snooze for how many minutes?","10"));if(!(!$||$<1))try{const oe=new Date;oe.setMinutes(oe.getMinutes()+$);const{error:ke}=await i.from("reminders").update({status:"snoozed",snooze_until:oe.toISOString(),snooze_count:i.sql`snooze_count + 1`}).eq("id",V);if(ke)throw ke;alert(`Snoozed for ${$} minutes`),L(a)}catch(oe){console.error("Error snoozing reminder:",oe),alert("Failed to snooze reminder")}},W=V=>{const $=new Date,oe=V-$,ke=Math.floor(oe/(1e3*60*60*24)),Ge=V.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:V.getFullYear()!==$.getFullYear()?"numeric":void 0}),Ke=V.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"});return ke===0?`Today, ${Ke}`:ke===1?`Tomorrow, ${Ke}`:ke===-1?`Yesterday, ${Ke}`:ke>0&&ke<7?`${V.toLocaleDateString("en-IN",{weekday:"long"})}, ${Ke}`:`${Ge}, ${Ke}`},X=V=>({pending:"fa-clock",accepted:"fa-check",rejected:"fa-times",completed:"fa-check-circle",snoozed:"fa-hourglass-half",cancelled:"fa-ban"})[V]||"fa-circle",J=V=>({general:"fa-bell",medicine:"fa-pills",meeting:"fa-users",appointment:"fa-calendar-check",birthday:"fa-birthday-cake",task:"fa-tasks",other:"fa-ellipsis-h"})[V]||"fa-bell",q=V=>V.split(" ").map($=>$[0]).join("").toUpperCase().slice(0,2),he=new Date,ge=d.filter(V=>new Date(V.reminder_time)>he&&!["completed","cancelled"].includes(V.status)),ie=d.filter(V=>new Date(V.reminder_time)<=he||["completed","cancelled"].includes(V.status)),be=d.filter(V=>V.is_recurring),Ie=()=>{switch(R){case"upcoming":return ge;case"past":return ie;case"recurring":return be;default:return ge}};return x?o.jsxs("div",{className:"reminders-loading",children:[o.jsx("div",{className:"loading-spinner"}),o.jsx("p",{children:"Loading reminders..."})]}):C?o.jsxs("div",{className:"reminders-error",children:[o.jsxs("p",{children:[o.jsx(rd,{size:16})," ",C]}),o.jsx("button",{onClick:()=>window.location.reload(),children:"Retry"})]}):o.jsxs("div",{className:"reminders-container",children:[o.jsxs("header",{className:"app-header",children:[o.jsx("div",{className:"header-left",children:o.jsx("button",{className:"back-btn",onClick:()=>window.history.back(),children:o.jsx("i",{className:"fas fa-arrow-left"})})}),o.jsx("div",{className:"header-center",children:o.jsx("h1",{children:"Reminders"})}),o.jsxs("div",{className:"header-right",children:[o.jsx("button",{className:"icon-btn",onClick:()=>alert("Create reminder"),children:o.jsx("i",{className:"fas fa-plus"})}),o.jsx("button",{className:"icon-btn",onClick:()=>alert("Settings"),children:o.jsx("i",{className:"fas fa-cog"})})]})]}),o.jsx("div",{className:"filter-chips",children:["all","pending","accepted","sent","received"].map(V=>o.jsxs("button",{className:`chip ${A===V?"active":""}`,onClick:()=>B(V),children:[o.jsx("i",{className:`fas fa-${V==="all"?"list":V==="pending"?"clock":V==="accepted"?"check":V==="sent"?"paper-plane":"inbox"}`}),V.charAt(0).toUpperCase()+V.slice(1)]},V))}),o.jsx("div",{className:"tabs",children:["upcoming","past","recurring"].map(V=>o.jsx("button",{className:`tab ${R===V?"active":""}`,onClick:()=>H(V),children:V.charAt(0).toUpperCase()+V.slice(1)},V))}),o.jsx("main",{className:"reminders-list",children:Ie().length>0?Ie().map(V=>{const $=V.sender_id===a.id,oe=$?V.receiver:V.sender,ke=new Date(V.reminder_time),Ge=!$&&V.status==="pending",Ke=V.status==="accepted",ne=V.status==="accepted";return o.jsxs("div",{className:`reminder-card priority-${V.priority}`,children:[o.jsxs("div",{className:"reminder-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"reminder-title",children:V.title}),o.jsxs("div",{className:"reminder-user",children:[o.jsx("div",{className:"avatar-placeholder",children:oe.avatar?o.jsx("img",{src:oe.avatar,alt:oe.name}):q(oe.name)}),o.jsx("i",{className:`fas fa-${$?"paper-plane":"inbox"}`}),$?"To":"From",": ",oe.name]})]}),o.jsxs("span",{className:`reminder-status status-${V.status}`,children:[o.jsx("i",{className:`fas ${X(V.status)}`}),V.status]})]}),o.jsxs("div",{className:"reminder-details",children:[o.jsxs("div",{className:"reminder-time",children:[o.jsx("i",{className:"fas fa-clock"}),W(ke)]}),V.location&&o.jsxs("div",{className:"reminder-location",children:[o.jsx("i",{className:"fas fa-map-marker-alt"}),V.location]}),V.description&&o.jsx("div",{className:"reminder-description",children:V.description})]}),o.jsxs("div",{className:"reminder-meta",children:[o.jsxs("span",{className:`reminder-category category-${V.category}`,children:[o.jsx("i",{className:`fas ${J(V.category)}`}),V.category]}),V.is_recurring&&o.jsxs("span",{className:"reminder-category",children:[o.jsx("i",{className:"fas fa-redo"}),V.recurring_type]})]}),(Ge||Ke||ne)&&o.jsxs("div",{className:"reminder-actions",children:[Ge&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{className:"btn-action btn-accept",onClick:()=>U(V.id),children:[o.jsx("i",{className:"fas fa-check"}),"Accept"]}),o.jsxs("button",{className:"btn-action btn-reject",onClick:()=>P(V.id),children:[o.jsx("i",{className:"fas fa-times"}),"Reject"]})]}),Ke&&o.jsxs("button",{className:"btn-action btn-complete",onClick:()=>K(V.id),children:[o.jsx("i",{className:"fas fa-check-circle"}),"Complete"]}),ne&&o.jsxs("button",{className:"btn-action btn-snooze",onClick:()=>Z(V.id),children:[o.jsx("i",{className:"fas fa-clock"}),"Snooze"]})]})]},V.id)}):o.jsxs("div",{className:"empty-state",children:[o.jsx("i",{className:"fas fa-bell-slash"}),o.jsx("h3",{children:"No Reminders"}),o.jsx("p",{children:"You don't have any reminders in this category"}),o.jsxs("button",{className:"btn-primary",onClick:()=>alert("Create reminder"),children:[o.jsx("i",{className:"fas fa-plus"})," Create Reminder"]})]})}),o.jsx("button",{className:"fab",onClick:()=>alert("Create reminder"),children:o.jsx("i",{className:"fas fa-plus"})})]})},MA=({onBack:i})=>{const[n,a]=M.useState(null),[l,d]=M.useState(null),[f,x]=M.useState([]),[v,C]=M.useState({title:"",description:"",date:"",time:"",location:"",category:"general",priority:"medium",isRecurring:!1,recurringType:"daily",soundEnabled:!0,vibrationEnabled:!0}),[w,A]=M.useState(!1);M.useEffect(()=>{N()},[]);const N=async()=>{try{const B=localStorage.getItem("currentUser");if(!B){alert("No user logged in");return}const H=JSON.parse(B);a(H),await R(H)}catch(B){console.error("Error initializing create reminder:",B)}},R=async B=>{try{const{data:H,error:U}=await vt.from("contacts").select(`
          *,
          contact_user:users!contacts_contact_user_id_fkey(*)
        `).eq("user_id",B.id);if(U)throw U;const P=H.map(Z=>Z.contact_user),{data:K}=await vt.from("chats").select(`
          user1:users!chats_user1_id_fkey(*),
          user2:users!chats_user2_id_fkey(*)
        `).or(`user1_id.eq.${B.id},user2_id.eq.${B.id}`);K&&K.forEach(Z=>{const W=Z.user1.id===B.id?Z.user2:Z.user1;P.find(X=>X.id===W.id)||P.push(W)}),x(P)}catch(H){console.error("Error loading contacts:",H)}},T=(B,H)=>{C(U=>({...U,[B]:H}))},O=async B=>{if(B.preventDefault(),!l){alert("Please select a recipient");return}if(!v.title.trim()){alert("Please enter a title");return}if(!v.date||!v.time){alert("Please select date and time");return}const H=new Date(`${v.date}T${v.time}`);if(H<new Date){alert("Reminder time cannot be in the past");return}A(!0);try{const U={sender_id:n.id,receiver_id:l.id,title:v.title.trim(),description:v.description.trim()||null,reminder_time:H.toISOString(),location:v.location.trim()||null,category:v.category,priority:v.priority,sound_enabled:v.soundEnabled,vibration_enabled:v.vibrationEnabled,is_recurring:v.isRecurring,status:"pending",requires_acceptance:!0};v.isRecurring&&(U.recurring_type=v.recurringType);const{data:P,error:K}=await vt.from("reminders").insert(U).select().single();if(K)throw K;alert("Reminder created successfully"),i&&i()}catch(U){console.error("Error creating reminder:",U),alert("Failed to create reminder")}finally{A(!1)}},L=B=>B.split(" ").map(H=>H[0]).join("").toUpperCase().slice(0,2);return n?o.jsxs("div",{className:"create-reminder-container",children:[o.jsxs("header",{className:"app-header",children:[o.jsx("div",{className:"header-left",children:o.jsx("button",{className:"back-btn",onClick:i,children:o.jsx("i",{className:"fas fa-arrow-left"})})}),o.jsx("div",{className:"header-center",children:o.jsx("h1",{children:"Create Reminder"})}),o.jsx("div",{className:"header-right",children:o.jsx("button",{className:"icon-btn",onClick:O,disabled:w,children:o.jsx("i",{className:"fas fa-check"})})})]}),o.jsxs("form",{onSubmit:O,className:"reminder-form",children:[o.jsxs("div",{className:"form-section",children:[o.jsxs("label",{className:"form-label",children:[o.jsx("i",{className:"fas fa-user"}),"Remind To *"]}),o.jsxs("div",{className:"recipient-selector",onClick:()=>alert("Select contact - feature not implemented"),children:[o.jsx("div",{className:"selected-recipient",children:l?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"avatar-placeholder",children:l.avatar?o.jsx("img",{src:l.avatar,alt:l.name}):L(l.name)}),o.jsx("span",{children:l.name})]}):o.jsxs(o.Fragment,{children:[o.jsx("i",{className:"fas fa-user-plus"}),o.jsx("span",{children:"Select Contact"})]})}),o.jsx("i",{className:"fas fa-chevron-right"})]})]}),o.jsxs("div",{className:"form-section",children:[o.jsxs("label",{className:"form-label",children:[o.jsx("i",{className:"fas fa-heading"}),"Title *"]}),o.jsx("input",{type:"text",className:"form-input",placeholder:"e.g., Take Medicine, Meeting with Dr.",value:v.title,onChange:B=>T("title",B.target.value),required:!0})]}),o.jsxs("div",{className:"form-section",children:[o.jsxs("label",{className:"form-label",children:[o.jsx("i",{className:"fas fa-align-left"}),"Description (Optional)"]}),o.jsx("textarea",{className:"form-textarea",placeholder:"Add additional details...",rows:"3",value:v.description,onChange:B=>T("description",B.target.value)})]}),o.jsxs("div",{className:"form-section",children:[o.jsxs("label",{className:"form-label",children:[o.jsx("i",{className:"fas fa-calendar-alt"}),"Date & Time *"]}),o.jsxs("div",{className:"datetime-group",children:[o.jsx("input",{type:"date",className:"form-input",value:v.date,onChange:B=>T("date",B.target.value),required:!0}),o.jsx("input",{type:"time",className:"form-input",value:v.time,onChange:B=>T("time",B.target.value),required:!0})]})]}),o.jsxs("div",{className:"form-section",children:[o.jsxs("label",{className:"form-label",children:[o.jsx("i",{className:"fas fa-map-marker-alt"}),"Location (Optional)"]}),o.jsx("input",{type:"text",className:"form-input",placeholder:"e.g., Home, Office, Hospital",value:v.location,onChange:B=>T("location",B.target.value)})]}),o.jsxs("div",{className:"form-section",children:[o.jsxs("label",{className:"form-label",children:[o.jsx("i",{className:"fas fa-tag"}),"Category"]}),o.jsxs("select",{className:"form-select",value:v.category,onChange:B=>T("category",B.target.value),children:[o.jsx("option",{value:"general",children:"General"}),o.jsx("option",{value:"medicine",children:"Medicine"}),o.jsx("option",{value:"meeting",children:"Meeting"}),o.jsx("option",{value:"appointment",children:"Appointment"}),o.jsx("option",{value:"birthday",children:"Birthday"}),o.jsx("option",{value:"task",children:"Task"}),o.jsx("option",{value:"other",children:"Other"})]})]}),o.jsxs("div",{className:"form-section",children:[o.jsxs("label",{className:"form-label",children:[o.jsx("i",{className:"fas fa-flag"}),"Priority"]}),o.jsx("div",{className:"priority-selector",children:["low","medium","high","urgent"].map(B=>o.jsxs("button",{type:"button",className:`priority-btn ${v.priority===B?"active":""}`,onClick:()=>T("priority",B),children:[o.jsx("i",{className:"fas fa-flag"})," ",B.charAt(0).toUpperCase()+B.slice(1)]},B))})]}),o.jsxs("div",{className:"form-section",children:[o.jsxs("label",{className:"form-label toggle-label",children:[o.jsxs("span",{children:[o.jsx("i",{className:"fas fa-redo"}),"Recurring Reminder"]}),o.jsxs("label",{className:"toggle",children:[o.jsx("input",{type:"checkbox",checked:v.isRecurring,onChange:B=>T("isRecurring",B.target.checked)}),o.jsx("span",{className:"toggle-slider"})]})]}),v.isRecurring&&o.jsx("div",{className:"recurring-options",children:o.jsxs("select",{className:"form-select",value:v.recurringType,onChange:B=>T("recurringType",B.target.value),children:[o.jsx("option",{value:"daily",children:"Daily"}),o.jsx("option",{value:"weekly",children:"Weekly"}),o.jsx("option",{value:"monthly",children:"Monthly"}),o.jsx("option",{value:"yearly",children:"Yearly"})]})})]}),o.jsx("div",{className:"form-section",children:o.jsxs("label",{className:"form-label toggle-label",children:[o.jsxs("span",{children:[o.jsx("i",{className:"fas fa-volume-up"}),"Sound"]}),o.jsxs("label",{className:"toggle",children:[o.jsx("input",{type:"checkbox",checked:v.soundEnabled,onChange:B=>T("soundEnabled",B.target.checked)}),o.jsx("span",{className:"toggle-slider"})]})]})}),o.jsx("div",{className:"form-section",children:o.jsxs("label",{className:"form-label toggle-label",children:[o.jsxs("span",{children:[o.jsx("i",{className:"fas fa-mobile-alt"}),"Vibration"]}),o.jsxs("label",{className:"toggle",children:[o.jsx("input",{type:"checkbox",checked:v.vibrationEnabled,onChange:B=>T("vibrationEnabled",B.target.checked)}),o.jsx("span",{className:"toggle-slider"})]})]})}),o.jsxs("button",{type:"submit",className:"btn-submit",disabled:w,children:[o.jsx("i",{className:"fas fa-bell"}),w?"Creating...":"Create Reminder"]})]})]}):o.jsx("div",{children:"Loading..."})};function kA(i){const[n,a]=M.useState([]),[l,d]=M.useState(!0),[f,x]=M.useState(null),[v,C]=M.useState(0),w=M.useCallback(async()=>{if(i)try{d(!0);const N=await ls.getCallHistory(i);a(N||[])}catch(N){x(N.message)}finally{d(!1)}},[i]),A=M.useCallback(async()=>{if(i)try{const N=await ls.getMissedCallsCount(i);C(N||0)}catch(N){console.error("Error fetching missed count:",N)}},[i]);return M.useEffect(()=>{w(),A()},[w,A]),{history:n,loading:l,error:f,missedCount:v,refetch:w}}function DA({userId:i,userAvatar:n,userName:a}){const{history:l,loading:d,error:f,missedCount:x}=kA(i),{startCall:v,callState:C}=hi(),w=N=>{const R=new Date(N),O=Math.floor((new Date-R)/(1e3*60*60*24));return O===0?R.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):O===1?"Yesterday":O<7?R.toLocaleDateString([],{weekday:"short"}):R.toLocaleDateString([],{month:"short",day:"numeric"})},A=async(N,R)=>{if(C!=="idle"){console.log("Already in a call");return}try{await v(N,R)}catch(T){console.error("Failed to start call:",T)}};return d?o.jsx("div",{className:"flex items-center justify-center p-8",children:o.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full"})}):f?o.jsx("div",{className:"text-center p-8 text-red-500",children:"Error loading call history"}):o.jsx("div",{className:"call-history-wrapper",children:o.jsxs("div",{className:"call-history-card",children:[o.jsxs("div",{className:"call-history-header",children:[o.jsxs("div",{className:"header-content",children:[o.jsx("h2",{className:"call-history-title",children:"Call History"}),x>0&&o.jsxs("span",{className:"missed-calls-badge",children:[x," missed"]})]}),n&&o.jsx("div",{className:"user-avatar-header",children:o.jsx("div",{className:"avatar-circle",children:n?parseInt(n)?o.jsx("img",{src:Rs.find(N=>N.id===parseInt(n))?.path||n,alt:a||"User"}):o.jsx("img",{src:n,alt:a||"User"}):a?.charAt(0)||"?"})})]}),o.jsx("div",{children:l.length>0?l.map(N=>o.jsxs("div",{className:"call-item",children:[o.jsx("div",{className:"call-avatar",children:N.other_user_avatar?parseInt(N.other_user_avatar)?o.jsx("img",{src:Rs.find(R=>R.id===parseInt(N.other_user_avatar))?.path||N.other_user_avatar,alt:N.other_user_name}):o.jsx("img",{src:N.other_user_avatar,alt:N.other_user_name}):N.other_user_name?.charAt(0)||"?"}),o.jsxs("div",{className:"call-details",children:[o.jsx("h3",{className:"call-name",children:N.other_user_name||"Unknown"}),o.jsxs("div",{className:"call-status-row",children:[N.call_status==="missed"?o.jsx(CS,{size:14,className:"status-icon missed"}):N.caller_id===i?o.jsx(ES,{size:14,className:"status-icon outgoing"}):o.jsx(bS,{size:14,className:"status-icon incoming"}),o.jsx("span",{className:"call-time-text",children:w(N.started_at)})]})]}),o.jsx("button",{className:"call-action-btn",onClick:()=>A(N.other_user_id,N.call_type),disabled:C!=="idle",children:N.call_type==="video"?o.jsx(fi,{size:22}):o.jsx(Hs,{size:22})})]},N.id)):o.jsxs("div",{className:"empty-state",children:[o.jsx(Hs,{size:48}),o.jsx("h3",{children:"No call history"}),o.jsx("p",{children:"Your calls will appear here"})]})})]})})}function Dx({receiverId:i,callType:n="video",size:a="md"}){const{startCall:l,callState:d}=hi(),f=async()=>{if(d!=="idle"){console.log("Already in a call");return}try{await l(i,n)}catch(C){console.error("Failed to start call:",C)}},x={sm:"w-10 h-10",md:"w-12 h-12",lg:"w-14 h-14"},v={sm:18,md:22,lg:26};return o.jsx("button",{onClick:f,disabled:d!=="idle",className:`${x[a]} rounded-full flex items-center justify-center transition-all ${n==="video"?"bg-blue-500 hover:bg-blue-600":"bg-green-500 hover:bg-green-600"} disabled:opacity-50 disabled:cursor-not-allowed`,children:n==="video"?o.jsx(fi,{size:v[a],className:"text-white"}):o.jsx(Hs,{size:v[a],className:"text-white"})})}function Cy(){const i=us(),{callState:n,incomingCall:a,callerInfo:l,answerCall:d,rejectCall:f}=hi(),x=M.useRef(null),v=M.useRef(!1);if(n!=="ringing"||!a)return null;const C=a.signal_data?.callType==="video",w=()=>{if(!v.current&&x.current){v.current=!0;try{const N=new(window.AudioContext||window.webkitAudioContext),R=N.createOscillator(),T=N.createGain();R.connect(T),T.connect(N.destination),R.frequency.setValueAtTime(800,N.currentTime),R.frequency.setValueAtTime(600,N.currentTime+.1),T.gain.setValueAtTime(.3,N.currentTime),T.gain.exponentialRampToValueAtTime(.01,N.currentTime+.3),R.start(N.currentTime),R.stop(N.currentTime+.3);const O=setInterval(()=>{if(n==="ringing"){const L=N.createOscillator(),B=N.createGain();L.connect(B),B.connect(N.destination),L.frequency.setValueAtTime(800,N.currentTime),L.frequency.setValueAtTime(600,N.currentTime+.1),B.gain.setValueAtTime(.3,N.currentTime),B.gain.exponentialRampToValueAtTime(.01,N.currentTime+.3),L.start(N.currentTime),L.stop(N.currentTime+.3)}else clearInterval(O)},2e3);return()=>clearInterval(O)}catch(N){console.warn("Could not play ringtone:",N),"vibrate"in navigator&&navigator.vibrate([200,100,200,100,200])}}},A=async N=>{if(w(),N===d)try{await N(),i(`/call/${a.call_id}`)}catch(R){console.error("Error answering call:",R)}else N()};return o.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-gray-900 rounded-3xl p-8 text-center max-w-sm w-full mx-4 shadow-2xl",children:[o.jsxs("div",{className:"relative mb-6",children:[o.jsx("div",{className:"w-32 h-32 mx-auto rounded-full overflow-hidden ring-4 ring-green-500 animate-pulse",children:l?.avatar?o.jsx("img",{src:l.avatar,alt:l.name,className:"w-full h-full object-cover"}):o.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-4xl font-bold text-white",children:l?.name?.charAt(0)||"?"})}),o.jsx("div",{className:"absolute -bottom-2 left-1/2 transform -translate-x-1/2 bg-green-500 px-4 py-1 rounded-full",children:o.jsxs("span",{className:"text-white text-sm font-medium flex items-center gap-1",children:[C?o.jsx(fi,{size:14}):o.jsx(Hs,{size:14}),C?"Video Call":"Voice Call"]})})]}),o.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:l?.name||"Unknown Caller"}),o.jsx("p",{className:"text-gray-400 mb-8",children:l?.phone||"Incoming call..."}),o.jsxs("div",{className:"flex justify-center gap-8",children:[o.jsx("button",{onClick:()=>A(f),className:"w-16 h-16 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center transition-all hover:scale-110 shadow-lg shadow-red-500/30",children:o.jsx(D0,{className:"w-7 h-7 text-white"})}),o.jsx("button",{onClick:()=>A(d),className:"w-16 h-16 rounded-full bg-green-500 hover:bg-green-600 flex items-center justify-center transition-all hover:scale-110 shadow-lg shadow-green-500/30 animate-bounce",children:o.jsx(Hs,{className:"w-7 h-7 text-white"})})]}),o.jsx("p",{className:"text-gray-500 text-sm mt-6",children:"Tap to answer or reject"})]})})}const LA=()=>{us();const{theme:i}=Jo(),{startCall:n,answerCall:a}=hi(),[l,d]=M.useState(null),[f,x]=M.useState([]),[v,C]=M.useState([]),[w,A]=M.useState(""),[N,R]=M.useState(!0),[T,O]=M.useState(null);M.useEffect(()=>{L(),U()},[]);const L=async()=>{try{const Z=localStorage.getItem("currentUser");if(!Z){alert("No user logged in"),R(!1);return}const W=JSON.parse(Z);if(!W.avatar)W.avatar=Math.floor(Math.random()*46)+1;else if(typeof W.avatar=="string"&&!W.avatar.startsWith("http")){const X=parseInt(W.avatar);isNaN(X)&&(W.avatar=Math.floor(Math.random()*46)+1)}d(W),await Promise.all([B(W),H(W)]),R(!1)}catch(Z){console.error("Error initializing calls:",Z),R(!1)}},B=async Z=>{try{const{data:W,error:X}=await vt.from("contacts").select("contact_user_id").eq("user_id",Z.id);if(X)throw X;let J=[];if(W&&W.length>0){const he=W.map(ge=>ge.contact_user_id).filter(ge=>ge);if(he.length>0){const{data:ge,error:ie}=await vt.from("users").select("*").in("id",he);!ie&&ge&&(J=ge)}}const{data:q}=await vt.from("chats").select(`
          user1:users!chats_user1_id_fkey(*),
          user2:users!chats_user2_id_fkey(*)
        `).or(`user1_id.eq.${Z.id},user2_id.eq.${Z.id}`);q&&q.forEach(he=>{const ge=he.user1.id===Z.id?he.user2:he.user1;ge&&ge.id&&!J.find(ie=>ie.id===ge.id)&&J.push(ge)}),x(J)}catch(W){console.error("Error loading contacts:",W)}},H=async Z=>{try{const{data:W,error:X}=await vt.from("call_history").select(`
          *,
          caller:users!call_history_caller_id_fkey(name, avatar),
          receiver:users!call_history_receiver_id_fkey(name, avatar)
        `).or(`caller_id.eq.${Z.id},receiver_id.eq.${Z.id}`).order("created_at",{ascending:!1}).limit(50);if(X)throw X;const J=W.map(q=>({...q,otherUser:q.caller_id===Z.id?q.receiver:q.caller})).filter(q=>q.otherUser&&q.otherUser.id);C(J)}catch(W){console.error("Error loading call history:",W)}},U=async()=>{const Z=localStorage.getItem("pendingCall");if(Z)try{const X=JSON.parse(Z);localStorage.removeItem("pendingCall"),await n(X.contact.id,X.type)}catch(X){console.error("Error parsing pending call:",X)}const W=localStorage.getItem("pendingIncomingCall");if(W)try{const X=JSON.parse(W);localStorage.removeItem("pendingIncomingCall"),setActiveCall(X)}catch(X){console.error("Error parsing pending incoming call:",X)}},P=f.filter(Z=>{if(!Z||!Z.id)return!1;if(!w)return!0;const W=w.toLowerCase();return Z.name.toLowerCase().includes(W)||Z.phone&&Z.phone.includes(W)}),K=Z=>Z.split(" ").map(W=>W[0]).join("").toUpperCase().slice(0,2);return N?o.jsxs("div",{className:"calls-loading",children:[o.jsx("div",{className:"loading-spinner"}),o.jsx("p",{children:"Loading contacts..."})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"calls-container",children:[o.jsxs("header",{className:"app-header",children:[o.jsx("div",{className:"header-left",children:o.jsx("button",{className:"back-btn",onClick:()=>window.history.back(),children:o.jsx("i",{className:"fas fa-arrow-left"})})}),o.jsx("div",{className:"header-center",children:o.jsx("h1",{children:"Calls"})}),o.jsx("div",{className:"header-right"})]}),o.jsx("div",{className:"search-container",children:o.jsxs("div",{className:"search-box",children:[o.jsx("i",{className:"fas fa-search"}),o.jsx("input",{type:"text",placeholder:"Search contacts...",value:w,onChange:Z=>A(Z.target.value)})]})}),o.jsx("div",{className:"call-history-section",children:o.jsx(DA,{userId:l?.id,userAvatar:l?.avatar,userName:l?.name})}),o.jsxs("div",{className:"contacts-section",children:[o.jsx("h3",{children:"Contacts"}),o.jsx("div",{className:"contacts-list",children:P.length>0?P.map(Z=>o.jsxs("div",{className:"contact-item",children:[o.jsxs("div",{className:"contact-avatar",children:[o.jsx("div",{className:"avatar-circle",children:Z.avatar?parseInt(Z.avatar)?o.jsx("img",{src:Rs.find(W=>W.id===parseInt(Z.avatar))?.path||Z.avatar,alt:Z.name}):o.jsx("img",{src:Z.avatar,alt:Z.name}):K(Z.name)}),o.jsx("span",{className:`online-status ${Z.is_online?"online":""}`})]}),o.jsxs("div",{className:"contact-info",children:[o.jsx("h4",{children:Z.name}),o.jsx("p",{children:Z.phone||"No phone"})]}),o.jsxs("div",{className:"call-buttons",children:[o.jsx(Dx,{receiverId:Z.id,callType:"voice",size:"md"}),o.jsx(Dx,{receiverId:Z.id,callType:"video",size:"md"})]})]},Z.id)):o.jsxs("div",{className:"empty-state",children:[o.jsx("i",{className:"fas fa-user-slash"}),o.jsx("h3",{children:"No contacts found"}),o.jsx("p",{children:"Add contacts to start making calls"})]})})]})]}),o.jsx(Cy,{}),o.jsx(id,{})]})},BA=({onBack:i})=>{const[n,a]=M.useState(null),[l,d]=M.useState([]),[f,x]=M.useState(!0),[v,C]=M.useState(null);M.useEffect(()=>{w()},[]);const w=async()=>{try{const O=localStorage.getItem("currentUser");if(!O){alert("No user logged in"),x(!1);return}const L=JSON.parse(O);a(L),await A(L),x(!1)}catch(O){console.error("Error initializing blocked:",O),x(!1)}},A=async O=>{try{const{data:L,error:B}=await vt.from("blocked_users").select(`
          id,
          blocked_id,
          created_at,
          users!blocked_users_blocked_id_fkey (
            id,
            name,
            phone,
            avatar,
            about
          )
        `).eq("blocker_id",O.id).order("created_at",{ascending:!1});if(B)throw B;d(L||[])}catch(L){console.error("Error loading blocked users:",L),alert("Failed to load blocked users")}},N=(O,L)=>{C({blockId:O,userName:L})},R=async()=>{if(v)try{const{error:O}=await vt.from("blocked_users").delete().eq("id",v.blockId);if(O)throw O;C(null),await A(n),alert("User unblocked successfully")}catch(O){console.error("Error unblocking user:",O),alert("Failed to unblock user")}},T=O=>O.split(" ").map(L=>L[0]).join("").toUpperCase().slice(0,2);return f?o.jsxs("div",{className:"blocked-loading",children:[o.jsx("div",{className:"loading-spinner"}),o.jsx("p",{children:"Loading blocked users..."})]}):o.jsxs("div",{className:"blocked-container",children:[o.jsxs("header",{className:"app-header",children:[o.jsx("div",{className:"header-left",children:o.jsx("button",{className:"back-btn",onClick:i,children:o.jsx("i",{className:"fas fa-arrow-left"})})}),o.jsx("div",{className:"header-center",children:o.jsx("h1",{children:"Blocked Users"})}),o.jsx("div",{className:"header-right"})]}),o.jsx("div",{className:"blocked-content",children:l.length>0?o.jsx("div",{className:"blocked-users-list",children:l.map(O=>{const L=O.users;return L?o.jsxs("div",{className:"blocked-user-item",children:[o.jsx("div",{className:"blocked-user-avatar",children:L.avatar?o.jsx("img",{src:L.avatar,alt:L.name}):T(L.name)}),o.jsxs("div",{className:"blocked-user-info",children:[o.jsx("div",{className:"blocked-user-name",children:L.name}),o.jsx("div",{className:"blocked-user-phone",children:L.phone})]}),o.jsx("div",{className:"blocked-user-actions",children:o.jsx("button",{className:"unblock-btn",onClick:()=>N(O.id,L.name),children:"Unblock"})})]},O.id):null})}):o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-icon",children:""}),o.jsx("h3",{children:"No blocked users"}),o.jsx("p",{children:"You haven't blocked any users yet."})]})}),v&&o.jsx("div",{className:"modal",onClick:()=>C(null),children:o.jsxs("div",{className:"modal-content",onClick:O=>O.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h2",{children:"Unblock User"}),o.jsx("button",{className:"close-modal",onClick:()=>C(null),children:o.jsx("i",{className:"fas fa-times"})})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("p",{children:["Are you sure you want to unblock ",o.jsx("strong",{children:v.userName}),"?"]}),o.jsx("p",{className:"modal-note",children:"You will be able to receive messages and calls from this user again."}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{className:"btn-secondary",onClick:()=>C(null),children:"Cancel"}),o.jsx("button",{className:"btn-danger",onClick:R,children:"Unblock"})]})]})]})})]})},UA=()=>{const{id:i}=Zu(),n=us(),{supabase:a}=ds(),{startCall:l}=hi(),[d,f]=M.useState(null),[x,v]=M.useState(null),[C,w]=M.useState(!0),[A,N]=M.useState(!1),[R,T]=M.useState(!1),[O,L]=M.useState(!1),[B,H]=M.useState({images:0,links:0,docs:0}),[U,P]=M.useState([]),[K,Z]=M.useState(""),[W,X]=M.useState(""),[J,q]=M.useState(""),[he,ge]=M.useState(!1),[ie,be]=M.useState(!1),[Ie,V]=M.useState(!1),[$,oe]=M.useState(!1),[ke,Ge]=M.useState(""),[Ke,ne]=M.useState("");M.useEffect(()=>{if(!i||i==="undefined"||i==="null"){n("/");return}ye()},[i]);const ye=async()=>{try{const Me=localStorage.getItem("currentUser");if(!Me){n("/login");return}const Fe=JSON.parse(Me);v(Fe);const nt=`digidad_user_${i}`;let _t=localStorage.getItem(nt),Tn;_t&&(_t=JSON.parse(_t),f(_t),await Le(Fe,i));try{const{data:sn,error:Vt}=await a.from("users").select("*").eq("id",i).single();if(Vt)throw Vt;Tn=sn,localStorage.setItem(nt,JSON.stringify(Tn)),(!_t||JSON.stringify(_t)!==JSON.stringify(Tn))&&(f(Tn),await Le(Fe,i))}catch(sn){console.warn("Network error loading user details:",sn),_t||f({id:i,name:"Unknown User",phone:"N/A",avatar:null,about:"User information not available"})}w(!1)}catch(Me){console.error("Error loading user details:",Me),w(!1)}},Le=async(Me,Fe)=>{try{const nt=JSON.parse(localStorage.getItem("mutedChats")||"{}"),_t=[Me.id,Fe].sort().join("_");N(!!nt[_t]),await Ue(Me.id,Fe),await We(Me.id,Fe),await Ne(Me.id,Fe)}catch(nt){console.error("Error loading additional data:",nt)}},Ue=async(Me,Fe)=>{try{const{data:nt,error:_t}=await a.from("contacts").select("*").eq("user_id",Me).eq("contact_user_id",Fe);T(nt&&nt.length>0)}catch(nt){console.error("Error checking contact status:",nt)}},We=async(Me,Fe)=>{try{const{data:nt,error:_t}=await a.from("blocked_users").select("*").eq("blocker_id",Me).eq("blocked_id",Fe);L(nt&&nt.length>0)}catch(nt){console.error("Error checking block status:",nt)}},Ne=async(Me,Fe)=>{try{const{data:nt}=await a.from("chats").select("id").or(`and(user1_id.eq.${Me},user2_id.eq.${Fe}),and(user1_id.eq.${Fe},user2_id.eq.${Me})`).single();if(!nt){H({images:0,links:0,docs:0});return}const{data:_t,error:Tn}=await a.from("messages").select("message_type, content").eq("chat_id",nt.id);if(Tn)throw Tn;let sn=0,Vt=0,qn=0;_t.forEach(jn=>{jn.message_type==="image"?sn++:jn.message_type==="document"?qn++:jn.content&&(jn.content.includes("http://")||jn.content.includes("https://"))&&Vt++}),H({images:sn,links:Vt,docs:qn})}catch(nt){console.error("Error loading media count:",nt),H({images:0,links:0,docs:0})}},$e=Me=>Me?.split(" ").map(Fe=>Fe[0]).join("").toUpperCase().slice(0,2)||"U",De=async()=>{try{if(!x||!d)return;const{data:Me}=await a.from("chats").select("*").or(`and(user1_id.eq.${x.id},user2_id.eq.${d.id}),and(user1_id.eq.${d.id},user2_id.eq.${x.id})`).single();if(Me)n(`/chat/${Me.id}/${d.id}`);else{const Fe={user1_id:x.id,user2_id:d.id,last_message:null,last_message_time:new Date().toISOString(),unread_count:0},{data:nt,error:_t}=await a.from("chats").insert([Fe]).select();if(_t)throw _t;if(nt&&nt[0])n(`/chat/${nt[0].id}/${d.id}`);else throw new Error("Failed to create chat")}}catch(Me){console.error("Error navigating to chat:",Me),alert("Failed to open chat")}},Ce=async()=>{try{const{callId:Me}=await l(d.id,"voice");n(`/call/${Me}`)}catch(Me){console.error("Failed to start voice call:",Me),alert("Failed to start call: "+Me.message)}},Je=async()=>{try{const{callId:Me}=await l(d.id,"video");n(`/call/${Me}`)}catch(Me){console.error("Failed to start video call:",Me),alert("Failed to start call: "+Me.message)}},mt=()=>{const Me=[x.id,i].sort().join("_"),Fe=JSON.parse(localStorage.getItem("mutedChats")||"{}");A?delete Fe[Me]:Fe[Me]=!0,localStorage.setItem("mutedChats",JSON.stringify(Fe)),N(!A)},Wt=async()=>{try{if(!x||!d)return;const{data:Me}=await a.from("contacts").select("*").eq("user_id",x.id).eq("contact_user_id",d.id).single();if(Me){alert("Contact already exists");return}const{error:Fe}=await a.from("contacts").insert([{user_id:x.id,contact_user_id:d.id,contact_name:d.name}]);if(Fe)throw Fe;T(!0),alert("Contact added successfully")}catch(Me){console.error("Error adding contact:",Me),alert("Failed to add contact")}},ft=()=>{const Me=`${d.name}
${d.phone||""}`;navigator.share?navigator.share({title:"Share Contact",text:Me}):navigator.clipboard.writeText(Me).then(()=>{alert("Contact info copied")})},Mt=async()=>{try{if(!x||!d)return;const{data:Me,error:Fe}=await a.from("chats").select("id").or(`and(user1_id.eq.${x.id},user2_id.eq.${d.id}),and(user1_id.eq.${d.id},user2_id.eq.${x.id})`).single();if(Fe||!Me){alert("No chat history found with this user");return}const{data:nt,error:_t}=await a.from("messages").select("*").eq("chat_id",Me.id).order("created_at",{ascending:!0});if(_t)throw _t;if(!nt||nt.length===0){alert("No messages to export");return}const Tn=nt.map(ts=>({timestamp:new Date(ts.created_at).toLocaleString(),sender:ts.sender_id===x.id?"You":d.name,message:ts.content})),sn=[["Timestamp","Sender","Message"],...Tn.map(ts=>[ts.timestamp,ts.sender,ts.message])].map(ts=>ts.map(Ut=>`"${Ut}"`).join(",")).join(`
`),Vt=new Blob([sn],{type:"text/csv;charset=utf-8;"}),qn=document.createElement("a"),jn=URL.createObjectURL(Vt);qn.setAttribute("href",jn),qn.setAttribute("download",`chat_${d.name}_${new Date().toISOString().split("T")[0]}.csv`),qn.style.visibility="hidden",document.body.appendChild(qn),qn.click(),document.body.removeChild(qn),alert("Chat exported successfully!")}catch(Me){console.error("Error exporting chat:",Me),alert("Failed to export chat")}},xn=()=>{if(!R){alert("Please add this user to contacts first");return}a.from("contacts").select("*").eq("user_id",x.id).eq("contact_user_id",i).single().then(({data:Me,error:Fe})=>{if(Fe&&Fe.code!=="PGRST116"){console.error("Error fetching contact:",Fe),alert("Failed to load contact info");return}Z(Me?.contact_name||d.name),X(d.phone||""),x.id===i&&q(d.about||""),be(!0)})},cn=async()=>{try{if(!K.trim()){alert("Name is required");return}const Me={user_id:x.id,contact_user_id:i,contact_name:K.trim(),updated_at:new Date().toISOString()},{data:Fe}=await a.from("contacts").select("id").eq("user_id",x.id).eq("contact_user_id",i).single();if(Fe?await a.from("contacts").update(Me).eq("id",Fe.id):await a.from("contacts").insert([Me]),x.id===i){const nt={name:K.trim(),phone:W.trim(),updated_at:new Date().toISOString()};J.trim()&&(nt.about=J.trim()),await a.from("users").update(nt).eq("id",x.id)}f({...d,name:K.trim(),phone:W.trim(),about:J.trim()}),be(!1),alert("Contact updated successfully")}catch(Me){console.error("Error saving contact:",Me),alert("Failed to update contact")}},qt=()=>{O?ht():ge(!0)},Nt=async()=>{try{const{error:Me}=await a.from("blocked_users").insert([{blocker_id:x.id,blocked_id:i}]);if(Me)throw Me;L(!0),ge(!1),alert("Contact blocked")}catch(Me){console.error("Error blocking contact:",Me),alert("Failed to block contact")}},ht=async()=>{try{const{error:Me}=await a.from("blocked_users").delete().eq("blocker_id",x.id).eq("blocked_id",i);if(Me)throw Me;L(!1),alert("Contact unblocked")}catch(Me){console.error("Error unblocking contact:",Me),alert("Failed to unblock contact")}},Hn=()=>{V(!0)},ze=async()=>{try{if(!ke.trim()){alert("Please select a reason");return}const{error:Me}=await a.from("reports").insert([{reporter_id:x.id,reported_id:i,reason:ke,details:Ke}]);if(Me)throw Me;V(!1),Ge(""),ne(""),alert("Report submitted")}catch(Me){console.error("Error submitting report:",Me),alert("Failed to submit report")}},Is=async()=>{if(confirm(`Delete chat with ${d.name}? This will delete all messages.`))try{const{data:Fe}=await a.from("chats").select("id").or(`and(user1_id.eq.${x.id},user2_id.eq.${d.id}),and(user1_id.eq.${d.id},user2_id.eq.${x.id})`).single();Fe&&(await a.from("messages").delete().eq("chat_id",Fe.id),await a.from("chats").delete().eq("id",Fe.id)),alert("Contact deleted"),n("/")}catch(Fe){console.error("Error deleting contact:",Fe),alert("Failed to delete contact")}};return C?o.jsx(Gi,{}):d?o.jsxs("div",{className:"user-details-screen",children:[o.jsxs("header",{className:"user-details-header",children:[o.jsx("button",{className:"back-btn",onClick:()=>n(-1),children:o.jsx($o,{size:24})}),o.jsx("h1",{children:"Contact Info"}),o.jsx(B0,{trigger:o.jsx(sd,{size:24}),items:[{icon:o.jsx(ad,{size:16}),label:"Edit Contact",onClick:xn,disabled:!R}]})]}),o.jsxs("div",{className:"user-profile-section",children:[o.jsx("div",{className:"user-details-avatar",id:"userDetailAvatar",onClick:()=>d.avatar&&oe(!0),style:{cursor:d.avatar?"pointer":"default"},children:d.avatar?parseInt(d.avatar)?o.jsx("img",{id:"userDetailImg",src:Rs.find(Me=>Me.id===parseInt(d.avatar))?.path,alt:d.name}):o.jsx("img",{id:"userDetailImg",src:d.avatar,alt:d.name}):o.jsx("div",{className:"dp-preview-initials",id:"userDetailInitials",children:$e(d.name)})}),o.jsx("h2",{className:"user-detail-name",id:"userDetailName",children:d.name}),o.jsx("p",{className:"user-detail-phone",id:"userDetailPhone",children:d.phone||"+91 0000000000"})]}),o.jsxs("div",{className:"user-actions",children:[o.jsx("button",{className:"action-btn",id:"messageUserBtn",onClick:De,children:o.jsx(Ma,{size:24,style:{color:"white"}})}),o.jsx("button",{className:"action-btn",id:"voiceCallUserBtn",onClick:Ce,children:o.jsx(Hs,{size:24,style:{color:"white"}})}),o.jsx("button",{className:"action-btn",id:"videoCallUserBtn",onClick:Je,children:o.jsx(fi,{size:24,style:{color:"white"}})})]}),o.jsxs("div",{className:"user-info-sections",children:[o.jsxs("div",{className:"info-section",children:[o.jsx("h3",{className:"section-header",children:"Media, Links, and Docs"}),o.jsxs("div",{className:"media-preview",children:[o.jsxs("div",{className:"media-item",children:[o.jsx(ay,{className:"icon",size:20}),o.jsx("span",{className:"count",id:"mediaCount",children:B.images})]}),o.jsxs("div",{className:"media-item",children:[o.jsx(nS,{className:"icon",size:20}),o.jsx("span",{className:"count",id:"linksCount",children:B.links})]}),o.jsxs("div",{className:"media-item",children:[o.jsx(k0,{className:"icon",size:20}),o.jsx("span",{className:"count",id:"docsCount",children:B.docs})]})]})]}),o.jsx("div",{className:"info-section",children:o.jsxs("div",{className:"settings-item toggle-item",children:[o.jsxs("div",{className:"item-left",children:[o.jsx(ty,{className:"icon",size:20}),o.jsx("span",{className:"label",children:"Mute Notifications"})]}),o.jsxs("label",{className:"toggle-switch",children:[o.jsx("input",{type:"checkbox",id:"muteUserToggle",checked:A,onChange:mt}),o.jsx("span",{className:"toggle-slider"})]})]})}),o.jsxs("div",{className:"info-section",children:[!R&&o.jsx("div",{className:"settings-item",id:"addToContactsBtn",onClick:Wt,children:o.jsxs("div",{className:"item-left",children:[o.jsx(YS,{className:"icon",size:20}),o.jsx("span",{className:"label",children:"Add to Contacts"})]})}),o.jsx("div",{className:"settings-item",id:"shareContactBtn",onClick:ft,children:o.jsxs("div",{className:"item-left",children:[o.jsx(iy,{className:"icon",size:20}),o.jsx("span",{className:"label",children:"Share Contact"})]})}),o.jsx("div",{className:"settings-item",id:"exportChatBtn",onClick:Mt,children:o.jsxs("div",{className:"item-left",children:[o.jsx(V_,{className:"icon",size:20}),o.jsx("span",{className:"label",children:"Export Chat"})]})})]}),o.jsxs("div",{className:"info-section",id:"groupsSection",children:[o.jsx("h3",{className:"section-header",children:"Groups in Common"}),o.jsx("div",{id:"commonGroups",children:o.jsx("p",{className:"no-data",children:"No groups in common"})})]}),o.jsxs("div",{className:"info-section danger-section",children:[o.jsx("div",{className:"settings-item danger",id:"blockContactBtn",onClick:qt,children:o.jsxs("div",{className:"item-left",children:[o.jsx(Gu,{className:"icon",size:20}),o.jsx("span",{className:"label",children:O?"Unblock Contact":"Block Contact"})]})}),o.jsx("div",{className:"settings-item danger",id:"reportContactBtn",onClick:Hn,children:o.jsxs("div",{className:"item-left",children:[o.jsx(h0,{className:"icon",size:20}),o.jsx("span",{className:"label",children:"Report Contact"})]})}),o.jsx("div",{className:"settings-item danger",id:"deleteContactBtn",onClick:Is,children:o.jsxs("div",{className:"item-left",children:[o.jsx(js,{className:"icon",size:20}),o.jsx("span",{className:"label",children:"Delete Contact"})]})})]})]}),o.jsx(wr,{isOpen:he,onClose:()=>ge(!1),title:"Block Contact",size:"small",children:o.jsxs("div",{className:"modal-content-text",children:[o.jsxs("p",{children:["Block ",d.name,"?"]}),o.jsx("p",{className:"warning-text",children:"Blocked contacts will no longer be able to call you or send you messages."}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{className:"btn-secondary",onClick:()=>ge(!1),children:"Cancel"}),o.jsx("button",{className:"btn-danger",onClick:Nt,children:"Block"})]})]})}),o.jsx(wr,{isOpen:ie,onClose:()=>be(!1),title:"Edit Contact",size:"small",children:o.jsxs("div",{className:"edit-contact-form",children:[o.jsxs("div",{className:"input-group",children:[o.jsx("label",{children:"Contact Name"}),o.jsx("input",{type:"text",value:K,onChange:Me=>Z(Me.target.value),placeholder:"Enter name"})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{className:"btn-secondary",onClick:()=>be(!1),children:"Cancel"}),o.jsx("button",{className:"btn-primary",onClick:cn,children:"Save"})]})]})}),o.jsx(wr,{isOpen:Ie,onClose:()=>V(!1),title:"Report Contact",size:"small",children:o.jsxs("div",{className:"report-form",children:[o.jsx("p",{children:"Why are you reporting this contact?"}),o.jsxs("div",{className:"report-reasons",children:[o.jsxs("label",{className:"report-reason-item",children:[o.jsx("input",{type:"radio",name:"report",value:"spam",checked:ke==="spam",onChange:Me=>Ge(Me.target.value)}),o.jsx("span",{children:"Spam"})]}),o.jsxs("label",{className:"report-reason-item",children:[o.jsx("input",{type:"radio",name:"report",value:"harassment",checked:ke==="harassment",onChange:Me=>Ge(Me.target.value)}),o.jsx("span",{children:"Harassment"})]}),o.jsxs("label",{className:"report-reason-item",children:[o.jsx("input",{type:"radio",name:"report",value:"inappropriate",checked:ke==="inappropriate",onChange:Me=>Ge(Me.target.value)}),o.jsx("span",{children:"Inappropriate Content"})]}),o.jsxs("label",{className:"report-reason-item",children:[o.jsx("input",{type:"radio",name:"report",value:"other",checked:ke==="other",onChange:Me=>Ge(Me.target.value)}),o.jsx("span",{children:"Other"})]})]}),o.jsxs("div",{className:"modal-actions",children:[o.jsx("button",{className:"btn-secondary",onClick:()=>V(!1),children:"Cancel"}),o.jsx("button",{className:"btn-danger",onClick:ze,children:"Report"})]})]})}),$&&o.jsx("div",{className:"modal-backdrop",onClick:()=>oe(!1),children:o.jsxs("div",{className:"modal-content",onClick:Me=>Me.stopPropagation(),children:[o.jsx("button",{className:"close-modal-btn",onClick:()=>oe(!1),children:""}),o.jsx("div",{className:"image-modal-content",children:d.avatar&&o.jsx("img",{src:parseInt(d.avatar)?Rs.find(Me=>Me.id===parseInt(d.avatar))?.path:d.avatar,alt:d.name,className:"full-screen-image",onClick:()=>oe(!1)})})]})})]}):o.jsxs("div",{className:"user-details-error",children:[o.jsx("p",{children:"User not found"}),o.jsx("button",{onClick:()=>n("/"),children:"Go Back"})]})},PA=({userId:i,onBack:n})=>{const[a,l]=M.useState(null),[d,f]=M.useState(null),[x,v]=M.useState(!0);M.useEffect(()=>{C()},[i]);const C=async()=>{try{const T=localStorage.getItem("currentUser");T&&f(JSON.parse(T)),await w(i),v(!1)}catch(T){console.error("Error initializing shared profile:",T),v(!1)}},w=async T=>{try{const{data:O,error:L}=await vt.from("users").select("id, name, phone, avatar, about, created_at").eq("id",T).single();if(L)throw L;l(O)}catch(O){console.error("Error loading shared profile:",O),alert("Profile not found")}},A=()=>{alert("Add to contacts - feature not implemented")},N=()=>{alert("Start chat - feature not implemented")},R=T=>T.split(" ").map(O=>O[0]).join("").toUpperCase().slice(0,2);return x?o.jsxs("div",{className:"shared-profile-loading",children:[o.jsx("div",{className:"loading-spinner"}),o.jsx("p",{children:"Loading profile..."})]}):a?o.jsxs("div",{className:"shared-profile-container",children:[o.jsxs("header",{className:"app-header",children:[o.jsx("div",{className:"header-left",children:o.jsx("button",{className:"back-btn",onClick:n,children:o.jsx("i",{className:"fas fa-arrow-left"})})}),o.jsx("div",{className:"header-center",children:o.jsx("h1",{children:"Profile"})}),o.jsx("div",{className:"header-right",children:!d&&o.jsxs("div",{className:"auth-actions",children:[o.jsxs("button",{className:"btn-primary",onClick:()=>alert("Login - feature not implemented"),children:[o.jsx("i",{className:"fas fa-sign-in-alt"})," Login"]}),o.jsxs("button",{className:"btn-secondary",onClick:()=>alert("Sign up - feature not implemented"),children:[o.jsx("i",{className:"fas fa-user-plus"})," Sign Up"]})]})})]}),o.jsxs("div",{className:"profile-content",children:[o.jsx("div",{className:"profile-picture-section",children:o.jsx("div",{className:"profile-avatar",children:a.avatar?parseInt(a.avatar)?o.jsx("img",{src:Rs.find(T=>T.id===parseInt(a.avatar))?.path||a.avatar,alt:a.name}):o.jsx("img",{src:a.avatar,alt:a.name}):o.jsx("div",{className:"profile-initials",children:R(a.name)})})}),o.jsxs("div",{className:"profile-info-section",children:[o.jsxs("div",{className:"info-item",children:[o.jsxs("div",{className:"info-label",children:[o.jsx("i",{className:"fas fa-user"}),o.jsx("span",{className:"label",children:"Name"})]}),o.jsx("div",{className:"info-value",children:o.jsx("span",{children:a.name})})]}),o.jsxs("div",{className:"info-item",children:[o.jsxs("div",{className:"info-label",children:[o.jsx("i",{className:"fas fa-info-circle"}),o.jsx("span",{className:"label",children:"About"})]}),o.jsx("div",{className:"info-value",children:o.jsx("span",{children:a.about||"Hey there! I am using CaBa"})})]}),o.jsxs("div",{className:"info-item",children:[o.jsxs("div",{className:"info-label",children:[o.jsx("i",{className:"fas fa-phone"}),o.jsx("span",{className:"label",children:"Phone"})]}),o.jsx("div",{className:"info-value",children:o.jsx("span",{children:a.phone||"Not provided"})})]})]}),d&&o.jsxs("div",{className:"profile-actions",children:[o.jsxs("button",{className:"action-btn",onClick:A,children:[o.jsx("i",{className:"fas fa-user-plus"}),o.jsx("span",{className:"label",children:"Add to Contacts"})]}),o.jsxs("button",{className:"action-btn",onClick:N,children:[o.jsx("i",{className:"fas fa-comment"}),o.jsx("span",{className:"label",children:"Chat"})]})]})]})]}):o.jsxs("div",{className:"shared-profile-error",children:[o.jsxs("p",{children:[o.jsx(rd,{size:16})," Profile not found"]}),o.jsx("button",{onClick:n,children:"Go Back"})]})},zA=()=>{const i=us();return o.jsxs("div",{className:"about-container",children:[o.jsxs("header",{className:"about-header",children:[o.jsx("button",{className:"back-btn",onClick:()=>i("/"),children:o.jsx($o,{size:24})}),o.jsx("h1",{children:"About CaBa"})]}),o.jsxs("div",{className:"about-content",children:[o.jsxs("div",{className:"about-hero",children:[o.jsx("div",{className:"app-logo-large",children:o.jsx("span",{className:"logo-text",children:"CB"})}),o.jsx("h2",{children:"CaBa Messaging App"}),o.jsx("p",{className:"version",children:"Version 1.0.0"}),o.jsx("p",{className:"tagline",children:"Connect, Communicate, Care"})]}),o.jsxs("div",{className:"about-section",children:[o.jsx("div",{className:"section-icon",children:o.jsx(Z_,{size:32})}),o.jsx("h3",{children:"Our Purpose"}),o.jsx("p",{children:"CaBa is designed to bring people closer together through secure, private, and reliable communication. Whether you're chatting with friends, family, or colleagues, CaBa ensures your conversations remain private and your connections stay strong."}),o.jsxs("div",{className:"purpose-features",children:[o.jsxs("div",{className:"feature-item",children:[o.jsx(Ma,{size:20}),o.jsx("span",{children:"Instant Messaging"})]}),o.jsxs("div",{className:"feature-item",children:[o.jsx(Hs,{size:20}),o.jsx("span",{children:"Voice & Video Calls"})]}),o.jsxs("div",{className:"feature-item",children:[o.jsx(qi,{size:20}),o.jsx("span",{children:"Group Chats"})]}),o.jsxs("div",{className:"feature-item",children:[o.jsx(oi,{size:20}),o.jsx("span",{children:"End-to-End Encryption"})]})]})]}),o.jsxs("div",{className:"about-section",children:[o.jsx("div",{className:"section-icon",children:o.jsx(oi,{size:32})}),o.jsx("h3",{children:"How We Keep Your Chats & Calls Safe"}),o.jsxs("div",{className:"security-grid",children:[o.jsxs("div",{className:"security-item",children:[o.jsx(Fp,{size:24}),o.jsx("h4",{children:"End-to-End Encryption"}),o.jsx("p",{children:"All your messages, calls, and media are encrypted from the moment they leave your device until they reach the intended recipient. Only you and the person you're communicating with can read or listen to them."})]}),o.jsxs("div",{className:"security-item",children:[o.jsx(oi,{size:24}),o.jsx("h4",{children:"Secure Servers"}),o.jsx("p",{children:"Our servers use industry-standard security protocols and are regularly audited for vulnerabilities. Your data is stored securely and never shared with third parties without your consent."})]}),o.jsxs("div",{className:"security-item",children:[o.jsx(Ya,{size:24}),o.jsx("h4",{children:"Privacy First"}),o.jsx("p",{children:"We don't track your location, read your messages, or analyze your behavior for advertising. Your privacy is our top priority, and we only collect the minimum data necessary to provide our service."})]})]})]}),o.jsxs("div",{className:"about-section",children:[o.jsx("div",{className:"section-icon",children:o.jsx(Ya,{size:32})}),o.jsx("h3",{children:"Your Privacy Matters"}),o.jsxs("div",{className:"privacy-points",children:[o.jsxs("div",{className:"privacy-point",children:[o.jsx("div",{className:"privacy-icon",children:o.jsx(Fp,{size:20})}),o.jsxs("div",{children:[o.jsx("h4",{children:"Data Encryption"}),o.jsx("p",{children:"Your messages are encrypted in transit and at rest using AES-256 encryption."})]})]}),o.jsxs("div",{className:"privacy-point",children:[o.jsx("div",{className:"privacy-icon",children:o.jsx(oi,{size:20})}),o.jsxs("div",{children:[o.jsx("h4",{children:"No Tracking"}),o.jsx("p",{children:"We don't track your location or monitor your online activity."})]})]}),o.jsxs("div",{className:"privacy-point",children:[o.jsx("div",{className:"privacy-icon",children:o.jsx(Ya,{size:20})}),o.jsxs("div",{children:[o.jsx("h4",{children:"Device Control"}),o.jsx("p",{children:"You control who can contact you and what information is shared."})]})]}),o.jsxs("div",{className:"privacy-point",children:[o.jsx("div",{className:"privacy-icon",children:o.jsx(js,{size:20})}),o.jsxs("div",{children:[o.jsx("h4",{children:"Data Deletion"}),o.jsx("p",{children:"You can delete your account and all associated data at any time."})]})]}),o.jsxs("div",{className:"privacy-point",children:[o.jsx("div",{className:"privacy-icon",children:o.jsx(oi,{size:20})}),o.jsxs("div",{children:[o.jsx("h4",{children:"Secure Authentication"}),o.jsx("p",{children:"Multi-factor authentication and secure login methods protect your account."})]})]}),o.jsxs("div",{className:"privacy-point",children:[o.jsx("div",{className:"privacy-icon",children:o.jsx(k0,{size:20})}),o.jsxs("div",{children:[o.jsx("h4",{children:"Minimal Data Collection"}),o.jsx("p",{children:"We only collect what's necessary: your name, phone number, and profile information."})]})]})]})]}),o.jsxs("div",{className:"about-section",children:[o.jsx("h3",{children:"Key Features"}),o.jsxs("div",{className:"features-grid",children:[o.jsxs("div",{className:"feature-card",children:[o.jsx(Ma,{size:24}),o.jsx("h4",{children:"Real-time Messaging"}),o.jsx("p",{children:"Send and receive messages instantly with read receipts and typing indicators."})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx(Hs,{size:24}),o.jsx("h4",{children:"HD Voice & Video Calls"}),o.jsx("p",{children:"Crystal clear voice calls and high-definition video calls with screen sharing."})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx(qi,{size:24}),o.jsx("h4",{children:"Group Conversations"}),o.jsx("p",{children:"Create groups for family, friends, or work with up to 1000 members."})]}),o.jsxs("div",{className:"feature-card",children:[o.jsx(oi,{size:24}),o.jsx("h4",{children:"Advanced Security"}),o.jsx("p",{children:"Self-destructing messages, two-factor authentication, and biometric login."})]})]})]}),o.jsxs("div",{className:"about-footer",children:[o.jsx("p",{children:"Thank you for choosing CaBa for your communication needs."}),o.jsx("p",{className:"copyright",children:" 2024 CaBa Messaging App. All rights reserved."})]})]})]})},FA=()=>{const i=us(),[n,a]=M.useState([{id:1,text:" Welcome to CaBa Support!",sender:"support",timestamp:new Date(Date.now()-3e5),status:"read"},{id:2,text:"How can we help you today? Feel free to share your questions, suggestions, or any issues you're facing with the app.",sender:"support",timestamp:new Date(Date.now()-24e4),status:"read"},{id:3,text:"You can also check our About page for detailed information about privacy, security, and app features.",sender:"support",timestamp:new Date(Date.now()-18e4),status:"read"}]),[l,d]=M.useState(""),f=M.useRef(null),x=()=>{f.current?.scrollIntoView({behavior:"smooth"})};M.useEffect(()=>{x()},[n]);const v=()=>{if(!l.trim())return;const A=JSON.parse(localStorage.getItem("currentUser")||"{}"),N={id:Date.now(),text:l,sender:"user",timestamp:new Date,status:"sent",userName:A.name||"Unknown User",userPhone:A.phone||"Unknown",isRead:!1};a(T=>[...T,N]),d("");const R=JSON.parse(localStorage.getItem("supportMessages")||"[]");R.push(N),localStorage.setItem("supportMessages",JSON.stringify(R)),setTimeout(()=>{const T={id:Date.now()+1,text:"Thank you for your message! Our support team will review it and get back to you soon. In the meantime, you can check our About page for more information.",sender:"support",timestamp:new Date,status:"read"};a(O=>[...O,T])},2e3)},C=A=>{A.key==="Enter"&&!A.shiftKey&&(A.preventDefault(),v())},w=A=>A.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return o.jsxs("div",{className:"support-chat-container",children:[o.jsxs("header",{className:"support-chat-header",children:[o.jsx("div",{className:"header-left",children:o.jsx("button",{className:"back-btn",onClick:()=>i("/"),children:o.jsx($o,{size:24})})}),o.jsxs("div",{className:"header-center",children:[o.jsx("div",{className:"support-avatar",children:o.jsx("div",{className:"support-initials",children:"CS"})}),o.jsxs("div",{className:"support-info",children:[o.jsx("h3",{children:"CaBa Support"}),o.jsx("span",{className:"support-status",children:"Online"})]})]}),o.jsx("div",{className:"header-right",children:o.jsx("span",{className:"support-verified",children:o.jsx(u0,{size:16})})})]}),o.jsx("div",{className:"support-messages",children:o.jsxs("div",{className:"messages-list",children:[n.map(A=>o.jsx("div",{className:`message-item ${A.sender==="user"?"user-message":"support-message"}`,children:o.jsxs("div",{className:"message-content",children:[o.jsx("p",{children:A.text}),o.jsxs("div",{className:"message-footer",children:[o.jsx("span",{className:"message-time",children:w(A.timestamp)}),A.sender==="user"&&o.jsx("span",{className:"message-status",children:A.status==="sent"?o.jsx(ny,{size:14}):o.jsx(u0,{size:14})})]})]})},A.id)),o.jsx("div",{ref:f})]})}),o.jsx("div",{className:"support-input-area",children:o.jsxs("div",{className:"input-container",children:[o.jsx("input",{type:"text",placeholder:"Type your message...",value:l,onChange:A=>d(A.target.value),onKeyPress:C,className:"message-input"}),o.jsx("button",{className:"send-btn",onClick:v,disabled:!l.trim(),children:o.jsx(DS,{size:20})})]})})]})},Yf=i=>{if(!i)return`${baseUrl}assets/images/dp-options/00701602b0eac0390b3107b9e2a665e0.jpg`;if(parseInt(i)){const n=Rs.find(a=>a.id===parseInt(i));return n?n.path:`${baseUrl}assets/images/dp-options/00701602b0eac0390b3107b9e2a665e0.jpg`}return i},HA=()=>{const i=us(),{supabase:n}=ds(),{user:a}=Xa(),[l,d]=M.useState(null),[f,x]=M.useState("dashboard"),[v,C]=M.useState(!0),[w,A]=M.useState({totalUsers:0,totalMessages:0,onlineUsers:0,totalChats:0,totalNews:0,totalReports:0,totalMedia:0,totalCalls:0}),[N,R]=M.useState([]),[T,O]=M.useState([]),[L,B]=M.useState([]),[H,U]=M.useState([]),[P,K]=M.useState([]),[Z,W]=M.useState([]),[X,J]=M.useState([]),[q,he]=M.useState([]),[ge,ie]=M.useState([]),[be,Ie]=M.useState([]),[V,$]=M.useState([]),[oe,ke]=M.useState(""),[Ge,Ke]=M.useState(null),[ne,ye]=M.useState(!1),[Le,Ue]=M.useState(!1),[We,Ne]=M.useState(null),[$e,De]=M.useState(!1),[Ce,Je]=M.useState({open:!1,messageId:null,userName:"",message:""}),[mt,Wt]=M.useState(""),[ft,Mt]=M.useState({users:!1,messages:!1,news:!1,reports:!1,logs:!1,support:!1,blocked:!1,groups:!1,reminders:!1,statuses:!1,"media-transfers":!1});M.useEffect(()=>{xn()},[]),M.useEffect(()=>{l&&cn()},[l,f]);const xn=async()=>{try{if(!a){console.log(" No valid user found in Admin, redirecting to login"),i("/login");return}const{data:G,error:Te}=await n.from("users").select("*").eq("id",a.id).single();if(Te||!G||!G.is_admin){i("/");return}G.is_admin&&console.log("Admin access granted for user:",G.name),d(G)}catch{i("/")}},cn=async()=>{if(f){Mt(G=>({...G,[f]:!0}));try{switch(f){case"dashboard":await qt();break;case"users":await Nt();break;case"messages":await ht();break;case"news":await Hn();break;case"reports":await ze();break;case"logs":await Is();break;case"support":await Me();break;case"blocked":await Fe();break;case"groups":await nt();break;case"reminders":await _t();break;case"statuses":await Tn();break;case"media-transfers":await sn();break}}catch(G){l?.is_admin&&console.error("Error loading data:",G)}finally{Mt(G=>({...G,[f]:!1}))}}},qt=async()=>{try{const[G,Te,jt,On,hs,yn,Kt]=await Promise.all([n.from("users").select("id, is_online",{count:"exact"}),n.from("messages").select("*",{count:"exact",head:!0}),n.from("chats").select("*",{count:"exact",head:!0}),n.from("news_articles").select("*",{count:"exact",head:!0}),n.from("reports").select("*",{count:"exact",head:!0}),n.from("media").select("*",{count:"exact",head:!0}),n.from("call_history").select("*",{count:"exact",head:!0})]),ns=G.data?.filter(He=>He.is_online).length||0;A({totalUsers:G.count||0,totalMessages:Te.count||0,onlineUsers:ns,totalChats:jt.count||0,totalNews:On.count||0,totalReports:hs.count||0,totalMedia:yn.count||0,totalCalls:Kt.count||0})}catch(G){console.error("Error loading stats:",G)}},Nt=async()=>{try{const{data:G,error:Te}=await n.from("users").select("*").order("created_at",{ascending:!1});if(Te){console.error("Error loading users:",Te);try{const{data:jt,error:On}=await n.from("users").select("id, name, email, phone, avatar, is_admin, is_online, created_at").order("created_at",{ascending:!1});if(On){console.error("Error with simple user query:",On),R([]);return}R(jt||[])}catch(jt){console.error("Simple user query failed:",jt),R([])}}else if(G&&G.length>0)try{const jt=G.map(Kt=>Kt.id),{data:On}=await n.from("messages").select("sender_id").in("sender_id",jt),hs={};On?.forEach(Kt=>{hs[Kt.sender_id]=(hs[Kt.sender_id]||0)+1});const yn=G.map(Kt=>({...Kt,message_count:hs[Kt.id]||0}));R(yn)}catch(jt){console.warn("Could not load additional user data:",jt),R(G)}else R([])}catch(G){console.error("Error loading users:",G),R([])}},ht=async()=>{try{const{data:G,error:Te}=await n.from("messages").select("*").order("created_at",{ascending:!1}).limit(100);if(Te){console.error("Error loading messages:",Te),O([]);return}if(G&&G.length>0)try{const jt=[...new Set(G.map(Kt=>Kt.sender_id))],{data:On}=await n.from("users").select("id, name, avatar").in("id",jt),hs={};On?.forEach(Kt=>{hs[Kt.id]=Kt});const yn=G.map(Kt=>({...Kt,users:hs[Kt.sender_id]||{name:"Unknown User",avatar:null}}));O(yn)}catch(jt){console.warn("Could not load additional message data:",jt),O(G.map(On=>({...On,users:{name:"Unknown User",avatar:null}})))}else O([])}catch(G){console.error("Error loading messages:",G),O([])}},Hn=async()=>{try{const{data:G,error:Te}=await n.from("news_articles").select("*").order("created_at",{ascending:!1});!Te&&G&&B(G)}catch(G){l?.is_admin&&console.error("Error loading news:",G)}},ze=async()=>{try{const{data:G,error:Te}=await n.from("reports").select(`
          *,
          users!reporter_id(name),
          messages(content)
        `).order("created_at",{ascending:!1});!Te&&G&&U(G)}catch(G){l?.is_admin&&console.error("Error loading reports:",G)}},Is=async()=>{try{const{data:G,error:Te}=await n.from("admin_logs").select(`
          *,
          users!admin_id(name)
        `).order("created_at",{ascending:!1}).limit(100);!Te&&G&&K(G)}catch(G){l?.is_admin&&console.error("Error loading admin logs:",G)}},Me=async()=>{De(!0);try{const{data:G,error:Te}=await n.rpc("get_support_messages_for_admin");!Te&&G?W(G):(l?.is_admin&&console.error("Error loading support messages:",Te),W([]))}catch(G){l?.is_admin&&console.error("Error loading support messages:",G),W([])}finally{De(!1)}},Fe=async()=>{try{const{data:G,error:Te}=await n.from("blocked_users").select(`
          *,
          blocker:users!blocker_id(name, email),
          blocked:users!blocked_id(name, email)
        `).order("created_at",{ascending:!1});!Te&&G&&J(G)}catch(G){l?.is_admin&&console.error("Error loading blocked users:",G)}},nt=async()=>{try{const{data:G,error:Te}=await n.from("groups").select(`
          *,
          creator:users!created_by(name),
          members:group_members(count)
        `).order("created_at",{ascending:!1});!Te&&G&&he(G)}catch(G){l?.is_admin&&console.error("Error loading groups:",G)}},_t=async()=>{try{const{data:G,error:Te}=await n.from("reminders").select(`
          *,
          sender:users!sender_id(name),
          receiver:users!receiver_id(name)
        `).order("created_at",{ascending:!1}).limit(100);!Te&&G&&ie(G)}catch(G){l?.is_admin&&console.error("Error loading reminders:",G)}},Tn=async()=>{try{const{data:G,error:Te}=await n.from("statuses").select(`
          *,
          user:users(name, avatar)
        `).order("created_at",{ascending:!1}).limit(100);!Te&&G&&Ie(G)}catch(G){l?.is_admin&&console.error("Error loading statuses:",G)}},sn=async()=>{try{const{data:G,error:Te}=await n.from("media_transfers").select(`
          *,
          sender:users!sender_id(name),
          receiver:users!receiver_id(name)
        `).order("created_at",{ascending:!1}).limit(100);!Te&&G&&$(G)}catch(G){l?.is_admin&&console.error("Error loading media transfers:",G)}},Vt=async G=>{if(confirm("Are you sure you want to remove admin privileges from this user?"))try{const{error:Te}=await n.from("users").update({is_admin:!1}).eq("id",G);Te?alert("Error removing admin privileges: "+Te.message):(await je("demote_admin",`Removed admin privileges from user ${G}`),Nt(),alert("Admin privileges removed successfully"))}catch(Te){l?.is_admin&&console.error("Error demoting admin:",Te),alert("Error removing admin privileges")}},qn=async G=>{if(confirm("Are you sure you want to grant admin privileges to this user?"))try{const{error:Te}=await n.from("users").update({is_admin:!0}).eq("id",G);Te?alert("Error granting admin privileges: "+Te.message):(await je("promote_admin",`Granted admin privileges to user ${G}`),Nt(),alert("Admin privileges granted successfully"))}catch(Te){l?.is_admin&&console.error("Error promoting to admin:",Te),alert("Error granting admin privileges")}},jn=async G=>{if(confirm("Are you sure you want to delete this message?"))try{const{error:Te}=await n.from("messages").delete().eq("id",G);Te||(await je("delete_message",`Deleted message ${G}`),ht(),alert("Message deleted successfully"))}catch(Te){l?.is_admin&&console.error("Error deleting message:",Te),alert("Error deleting message")}},ts=async G=>{if(confirm("Are you sure you want to delete this article?"))try{const{error:Te}=await n.from("news_articles").delete().eq("id",G);Te||(await je("delete_news",`Deleted news article ${G}`),Hn(),alert("Article deleted successfully"))}catch(Te){l?.is_admin&&console.error("Error deleting article:",Te),alert("Error deleting article")}},Ut=async(G,Te)=>{try{const{error:jt}=await n.from("reports").update({status:Te,resolved_at:new Date().toISOString(),admin_notes:`Resolved by admin: ${Te}`}).eq("id",G);jt||(await je("resolve_report",`Resolved report ${G} as ${Te}`),ze())}catch(jt){l?.is_admin&&console.error("Error resolving report:",jt)}},je=async(G,Te)=>{try{await n.from("admin_logs").insert({admin_id:a.id,action:G,details:{description:Te},ip_address:"admin-panel",user_agent:navigator.userAgent})}catch(jt){l?.is_admin&&console.error("Error logging admin action:",jt)}},lt=async G=>{try{const{data:Te,error:jt}=await n.rpc(G);jt?alert(`Error running ${G}: ${jt.message}`):(await je("maintenance",`Ran ${G}`),alert(`${G} completed successfully`),cn())}catch(Te){l?.is_admin&&console.error(`Error running ${G}:`,Te),alert(`Error running ${G}`)}},gt=async G=>{const Te=Z.find(jt=>jt.id===G);Te&&Je({open:!0,messageId:G,userName:Te.user_name,message:Te.message})},Qt=async()=>{if(!mt.trim()){alert("Please enter a response");return}try{const{data:G,error:Te}=await n.rpc("respond_to_support_message",{p_message_id:Ce.messageId,p_response:mt.trim(),p_admin_id:a.id});!Te&&G?(await je("support_response",`Responded to support message from ${Ce.userName}`),alert("Response sent successfully"),Je({open:!1,messageId:null,userName:"",message:""}),Wt(""),Me()):alert("Error sending response")}catch(G){l?.is_admin&&console.error("Error responding to support message:",G),alert("Error sending response")}},Os=async G=>{try{const{data:Te,error:jt}=await n.rpc("mark_support_message_read",{p_message_id:G});!jt&&Te&&Me()}catch(Te){l?.is_admin&&console.error("Error marking message as read:",Te)}},va=async(G,Te)=>{try{const{error:jt}=await n.from("blocked_users").delete().eq("blocker_id",G).eq("blocked_id",Te);jt?alert("Error unblocking users: "+jt.message):(await je("unblock_users",`Unblocked user ${Te} from ${G}`),Fe(),alert("Users unblocked successfully"))}catch(jt){l?.is_admin&&console.error("Error unblocking users:",jt),alert("Error unblocking users")}},qs=async G=>{try{const{error:Te}=await n.from("groups").delete().eq("id",G);Te?alert("Error deleting group: "+Te.message):(await je("delete_group",`Deleted group ${G}`),nt(),alert("Group deleted successfully"))}catch(Te){l?.is_admin&&console.error("Error deleting group:",Te),alert("Error deleting group")}},wt=async G=>{try{const{error:Te}=await n.from("reminders").delete().eq("id",G);Te?alert("Error deleting reminder: "+Te.message):(await je("delete_reminder",`Deleted reminder ${G}`),_t(),alert("Reminder deleted successfully"))}catch(Te){l?.is_admin&&console.error("Error deleting reminder:",Te),alert("Error deleting reminder")}},Rn=async G=>{try{const{error:Te}=await n.from("statuses").delete().eq("id",G);Te?alert("Error deleting status: "+Te.message):(await je("delete_status",`Deleted status ${G}`),Tn(),alert("Status deleted successfully"))}catch(Te){l?.is_admin&&console.error("Error deleting status:",Te),alert("Error deleting status")}},me=async G=>{try{const{error:Te}=await n.from("media_transfers").delete().eq("id",G);Te?alert("Error deleting media transfer: "+Te.message):(await je("delete_media_transfer",`Deleted media transfer ${G}`),sn(),alert("Media transfer deleted successfully"))}catch(Te){l?.is_admin&&console.error("Error deleting media transfer:",Te),alert("Error deleting media transfer")}},qe=G=>new Date(G).toLocaleString(),ct=G=>{switch(G){case"image":return o.jsx(ay,{size:16});case"video":return o.jsx(fi,{size:16});case"audio":return o.jsx(mS,{size:16});case"document":return o.jsx(k0,{size:16});default:return o.jsx(ku,{size:16})}},an=G=>G?G.split(" ").map(Te=>Te[0]).join("").toUpperCase().slice(0,2):"U",Pt=N.filter(G=>G.name?.toLowerCase().includes(oe.toLowerCase())||G.email?.toLowerCase().includes(oe.toLowerCase())||G.phone?.includes(oe)),In=T.filter(G=>G.content?.toLowerCase().includes(oe.toLowerCase())||G.users?.name?.toLowerCase().includes(oe.toLowerCase()));return v&&!l?o.jsxs("div",{className:"admin-loading",children:[o.jsx("div",{className:"loading-spinner"}),o.jsx("p",{children:"Loading admin panel..."})]}):l?.is_admin?o.jsxs("div",{className:"admin-container",children:[o.jsxs("header",{className:"admin-header",children:[o.jsxs("div",{className:"header-left",children:[o.jsx("button",{className:"back-btn",onClick:()=>i("/"),children:o.jsx($o,{size:24})}),o.jsx("h1",{children:"Admin Panel"})]}),o.jsx("div",{className:"header-right",children:o.jsxs("span",{className:"admin-badge",children:[o.jsx(oi,{size:16}),"Admin"]})})]}),o.jsxs("div",{className:"admin-content",children:[o.jsxs("div",{className:"admin-sidebar",children:[o.jsx("div",{className:"sidebar-header",children:o.jsx("h3",{children:"Admin Panel"})}),o.jsx("nav",{className:"sidebar-nav",children:[{id:"dashboard",label:"Dashboard",icon:zp},{id:"users",label:"Users",icon:qi},{id:"messages",label:"Messages",icon:ku},{id:"blocked",label:"Blocked Users",icon:Gu},{id:"groups",label:"Groups",icon:qi},{id:"reminders",label:"Reminders",icon:c0},{id:"statuses",label:"Statuses",icon:bf},{id:"media-transfers",label:"Media Transfers",icon:vf},{id:"news",label:"News",icon:ci},{id:"reports",label:"Reports",icon:h0},{id:"logs",label:"Admin Logs",icon:bf},{id:"support",label:"Support",icon:Ma},{id:"maintenance",label:"Maintenance",icon:H_}].map(G=>o.jsxs("button",{className:`nav-item ${f===G.id?"active":""}`,onClick:()=>x(G.id),children:[o.jsx(G.icon,{size:20}),o.jsx("span",{children:G.label})]},G.id))})]}),o.jsxs("div",{className:"main-content",children:[f==="dashboard"&&o.jsxs("div",{className:"dashboard-content",children:[o.jsxs("div",{className:"stats-grid",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:o.jsx(qi,{size:24})}),o.jsxs("div",{className:"stat-info",children:[o.jsx("h3",{children:w.totalUsers}),o.jsx("p",{children:"Total Users"})]})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:o.jsx(ku,{size:24})}),o.jsxs("div",{className:"stat-info",children:[o.jsx("h3",{children:w.totalMessages}),o.jsx("p",{children:"Total Messages"})]})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:o.jsx(zp,{size:24})}),o.jsxs("div",{className:"stat-info",children:[o.jsx("h3",{children:w.onlineUsers}),o.jsx("p",{children:"Online Users"})]})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:o.jsx(Ma,{size:24})}),o.jsxs("div",{className:"stat-info",children:[o.jsx("h3",{children:w.totalChats}),o.jsx("p",{children:"Total Chats"})]})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:o.jsx(ci,{size:24})}),o.jsxs("div",{className:"stat-info",children:[o.jsx("h3",{children:w.totalNews}),o.jsx("p",{children:"News Articles"})]})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:o.jsx(h0,{size:24})}),o.jsxs("div",{className:"stat-info",children:[o.jsx("h3",{children:w.totalReports}),o.jsx("p",{children:"Pending Reports"})]})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:o.jsx(Hs,{size:24})}),o.jsxs("div",{className:"stat-info",children:[o.jsx("h3",{children:w.totalCalls}),o.jsx("p",{children:"Total Calls"})]})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("div",{className:"stat-icon",children:o.jsx(vf,{size:24})}),o.jsxs("div",{className:"stat-info",children:[o.jsx("h3",{children:w.totalMedia}),o.jsx("p",{children:"Media Files"})]})]})]}),o.jsxs("div",{className:"quick-actions",children:[o.jsx("h3",{children:"Quick Actions"}),o.jsxs("div",{className:"actions-grid",children:[o.jsxs("button",{className:"action-btn",onClick:()=>lt("cleanup_expired_sessions"),children:[o.jsx(Ui,{size:20}),"Clean Sessions"]}),o.jsxs("button",{className:"action-btn",onClick:()=>lt("cleanup_expired_signaling"),children:[o.jsx(Ui,{size:20}),"Clean Signaling"]}),o.jsxs("button",{className:"action-btn",onClick:()=>lt("vanish_expired_messages"),children:[o.jsx(js,{size:20}),"Clean Messages"]}),o.jsxs("button",{className:"action-btn",onClick:()=>lt("cleanup_old_news_articles"),children:[o.jsx(ci,{size:20}),"Clean News"]})]})]})]}),f==="users"&&o.jsxs("div",{className:"users-content",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("h2",{children:"User Management"}),o.jsxs("div",{className:"search-bar",children:[o.jsx(nc,{size:20}),o.jsx("input",{type:"text",placeholder:"Search users...",value:oe,onChange:G=>ke(G.target.value)})]})]}),ft.users?o.jsxs("div",{className:"loading-container",children:[o.jsx("div",{className:"loading-spinner"}),o.jsx("p",{children:"Loading users..."})]}):o.jsx("div",{className:"users-list",children:Pt.length>0?Pt.map(G=>o.jsxs("div",{className:"user-item",children:[o.jsxs("div",{className:"user-info",children:[o.jsx("img",{src:Yf(G.avatar),alt:G.name||"User",className:"user-avatar",onError:Te=>{Te.target.src=`${baseUrl}assets/images/dp-options/00701602b0eac0390b3107b9e2a665e0.jpg`}}),o.jsxs("div",{className:"user-details",children:[o.jsx("h4",{children:G.name||"Unknown User"}),o.jsxs("p",{children:[G.email||"No email","  ",G.phone||"No phone"]}),o.jsxs("small",{children:["Joined: ",G.created_at?qe(G.created_at):"Unknown"]}),G.message_count!==void 0&&o.jsxs("small",{children:["Messages: ",G.message_count]})]})]}),o.jsxs("div",{className:"user-status",children:[o.jsx("span",{className:`status ${G.is_online?"online":"offline"}`,children:G.is_online?"Online":"Offline"}),G.is_admin&&o.jsx("span",{className:"admin-tag",children:"Admin"})]}),o.jsxs("div",{className:"user-actions",children:[o.jsx("button",{className:"action-btn small",onClick:()=>{Ke(G),ye(!0)},title:"View Details",children:o.jsx(Ya,{size:16})}),G.is_admin?o.jsxs("button",{className:"action-btn small danger",onClick:()=>Vt(G.id),title:"Remove Admin",children:[o.jsx(WS,{size:16}),"Demote"]}):o.jsxs("button",{className:"action-btn small success",onClick:()=>qn(G.id),title:"Make Admin",children:[o.jsx(VS,{size:16}),"Promote"]})]})]},G.id)):o.jsxs("div",{className:"no-data",children:[o.jsx(qi,{size:48}),o.jsx("p",{children:oe?"No users found matching your search":"No users found"}),oe&&o.jsx("button",{className:"action-btn",onClick:()=>ke(""),children:"Clear Search"})]})})]}),f==="messages"&&o.jsxs("div",{className:"messages-content",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("h2",{children:"Message Moderation"}),o.jsxs("div",{className:"search-bar",children:[o.jsx(nc,{size:20}),o.jsx("input",{type:"text",placeholder:"Search messages...",value:oe,onChange:G=>ke(G.target.value)})]})]}),o.jsx("div",{className:"messages-list",children:In.map(G=>o.jsxs("div",{className:"message-item",children:[o.jsxs("div",{className:"message-header",children:[o.jsxs("div",{className:"sender-info",children:[o.jsx("img",{src:Yf(G.users?.avatar),alt:G.users?.name,className:"sender-avatar",onError:Te=>{Te.target.src=`${baseUrl}assets/images/dp-options/00701602b0eac0390b3107b9e2a665e0.jpg`}}),o.jsx("span",{className:"sender-name",children:G.users?.name})]}),o.jsxs("div",{className:"message-meta",children:[ct(G.message_type),o.jsx("span",{className:"message-time",children:qe(G.created_at)})]})]}),o.jsx("div",{className:"message-content",children:o.jsx("p",{children:G.content})}),o.jsxs("div",{className:"message-actions",children:[o.jsx("button",{className:"action-btn small",onClick:()=>{Ne(G),Ue(!0)},children:o.jsx(Ya,{size:16})}),o.jsx("button",{className:"action-btn small danger",onClick:()=>jn(G.id),children:o.jsx(js,{size:16})})]})]},G.id))})]}),f==="news"&&o.jsxs("div",{className:"news-content",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("h2",{children:"News Management"}),o.jsxs("button",{className:"action-btn",children:[o.jsx(HS,{size:20}),"Add Article"]})]}),o.jsx("div",{className:"news-list",children:L.map(G=>o.jsxs("div",{className:"news-item",children:[o.jsxs("div",{className:"news-info",children:[o.jsx("h4",{children:G.title}),o.jsx("p",{children:G.summary}),o.jsxs("div",{className:"news-meta",children:[o.jsxs("span",{children:["Views: ",G.view_count]}),o.jsxs("span",{children:["Shares: ",G.share_count]}),o.jsxs("span",{children:["Published: ",qe(G.published_at)]})]})]}),o.jsxs("div",{className:"news-actions",children:[o.jsx("button",{className:"action-btn small",children:o.jsx(ad,{size:16})}),o.jsx("button",{className:"action-btn small danger",onClick:()=>ts(G.id),children:o.jsx(js,{size:16})})]})]},G.id))})]}),f==="reports"&&o.jsxs("div",{className:"reports-content",children:[o.jsx("div",{className:"section-header",children:o.jsx("h2",{children:"Reports Management"})}),o.jsx("div",{className:"reports-list",children:H.map(G=>o.jsxs("div",{className:"report-item",children:[o.jsxs("div",{className:"report-info",children:[o.jsxs("h4",{children:[G.report_type," Report"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Reporter:"})," ",G.users?.name]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Reason:"})," ",G.reason]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Description:"})," ",G.description]}),o.jsxs("small",{children:["Reported: ",qe(G.created_at)]})]}),o.jsx("div",{className:"report-status",children:o.jsx("span",{className:`status ${G.status}`,children:G.status})}),o.jsx("div",{className:"report-actions",children:G.status==="pending"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"action-btn small success",onClick:()=>Ut(G.id,"resolved"),children:o.jsx(Cf,{size:16})}),o.jsx("button",{className:"action-btn small danger",onClick:()=>Ut(G.id,"dismissed"),children:o.jsx(L_,{size:16})})]})})]},G.id))})]}),f==="logs"&&o.jsxs("div",{className:"logs-content",children:[o.jsx("div",{className:"section-header",children:o.jsx("h2",{children:"Admin Activity Logs"})}),o.jsx("div",{className:"logs-list",children:P.map(G=>o.jsx("div",{className:"log-item",children:o.jsxs("div",{className:"log-info",children:[o.jsx("h4",{children:G.action}),o.jsxs("p",{children:[o.jsx("strong",{children:"Admin:"})," ",G.users?.name]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Details:"})," ",G.details?.description]}),o.jsx("small",{children:qe(G.created_at)})]})},G.id))})]}),f==="support"&&o.jsxs("div",{className:"support-content",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("h2",{children:"Support Messages"}),o.jsxs("button",{className:"action-btn",onClick:Me,children:[o.jsx(Ui,{size:20}),"Refresh"]})]}),o.jsx("div",{className:"support-messages-list",children:Z.length>0?Z.map(G=>o.jsxs("div",{className:`support-message-item ${G.is_read?"read":"unread"}`,children:[o.jsxs("div",{className:"message-header",children:[o.jsxs("div",{className:"user-info",children:[o.jsx("div",{className:"user-avatar",children:G.user_name?o.jsx("div",{children:an(G.user_name)}):o.jsx(L0,{size:20})}),o.jsxs("div",{children:[o.jsx("span",{className:"user-name",children:G.user_name||"Unknown User"}),o.jsxs("span",{className:"user-phone",children:["(",G.user_phone||"N/A",")"]}),o.jsx("div",{className:"user-email",children:G.user_email})]})]}),o.jsxs("div",{className:"message-meta",children:[o.jsx("span",{className:"message-time",children:qe(G.created_at)}),!G.is_read&&o.jsx("span",{className:"unread-indicator",children:"New"})]})]}),o.jsxs("div",{className:"message-content",children:[o.jsxs("div",{className:"user-message",children:[o.jsx("strong",{children:"User:"})," ",G.message]}),G.admin_response&&o.jsxs("div",{className:"admin-response",children:[o.jsxs("strong",{children:["Admin (",G.admin_name,"):"]})," ",G.admin_response,o.jsxs("small",{children:["Responded: ",qe(G.responded_at)]})]})]}),!G.admin_response&&o.jsxs("div",{className:"message-actions",children:[o.jsxs("button",{className:"action-btn small success",onClick:()=>gt(G.id),children:[o.jsx(Ma,{size:16}),"Respond"]}),o.jsxs("button",{className:"action-btn small",onClick:()=>Os(G.id),children:[o.jsx(Cf,{size:16}),"Mark Read"]})]})]},G.id)):o.jsxs("div",{className:"no-messages",children:[o.jsx(ku,{size:48}),o.jsx("p",{children:"No support messages yet"})]})})]}),f==="blocked"&&o.jsxs("div",{className:"blocked-content",children:[o.jsx("div",{className:"section-header",children:o.jsx("h2",{children:"Blocked Users Management"})}),o.jsxs("div",{className:"blocked-list",children:[X.map(G=>o.jsxs("div",{className:"blocked-item",children:[o.jsxs("div",{className:"blocked-info",children:[o.jsx("h4",{children:"Block Relationship"}),o.jsxs("p",{children:[o.jsx("strong",{children:"Blocker:"})," ",G.blocker?.name," (",G.blocker?.email,")"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Blocked:"})," ",G.blocked?.name," (",G.blocked?.email,")"]}),o.jsxs("small",{children:["Blocked: ",qe(G.created_at)]})]}),o.jsx("div",{className:"blocked-actions",children:o.jsxs("button",{className:"action-btn small danger",onClick:()=>{confirm("Are you sure you want to unblock this user?")&&va(G.blocker_id,G.blocked_id)},children:[o.jsx(Cf,{size:16}),"Unblock"]})})]},G.id)),X.length===0&&o.jsxs("div",{className:"no-data",children:[o.jsx(Gu,{size:48}),o.jsx("p",{children:"No blocked users found"})]})]})]}),f==="groups"&&o.jsxs("div",{className:"groups-content",children:[o.jsx("div",{className:"section-header",children:o.jsx("h2",{children:"Groups Management"})}),o.jsxs("div",{className:"groups-list",children:[q.map(G=>o.jsxs("div",{className:"group-item",children:[o.jsxs("div",{className:"group-info",children:[o.jsx("h4",{children:G.name}),o.jsx("p",{children:G.description}),o.jsxs("div",{className:"group-meta",children:[o.jsxs("span",{children:["Created by: ",G.creator?.name]}),o.jsxs("span",{children:["Members: ",G.members?.[0]?.count||0]}),o.jsxs("span",{children:["Created: ",qe(G.created_at)]})]})]}),o.jsxs("div",{className:"group-actions",children:[o.jsxs("button",{className:"action-btn small",children:[o.jsx(Ya,{size:16}),"View"]}),o.jsx("button",{className:"action-btn small danger",onClick:()=>{confirm("Are you sure you want to delete this group?")&&qs(G.id)},children:o.jsx(js,{size:16})})]})]},G.id)),q.length===0&&o.jsxs("div",{className:"no-data",children:[o.jsx(qi,{size:48}),o.jsx("p",{children:"No groups found"})]})]})]}),f==="reminders"&&o.jsxs("div",{className:"reminders-content",children:[o.jsx("div",{className:"section-header",children:o.jsx("h2",{children:"Reminders Management"})}),o.jsxs("div",{className:"reminders-list",children:[ge.map(G=>o.jsxs("div",{className:"reminder-item",children:[o.jsxs("div",{className:"reminder-info",children:[o.jsx("h4",{children:G.title}),o.jsx("p",{children:G.description}),o.jsxs("div",{className:"reminder-meta",children:[o.jsxs("span",{children:["From: ",G.sender?.name]}),o.jsxs("span",{children:["To: ",G.receiver?.name]}),o.jsxs("span",{children:["Due: ",qe(G.reminder_time)]}),o.jsxs("span",{children:["Status: ",G.status]}),o.jsxs("span",{children:["Priority: ",G.priority]})]})]}),o.jsx("div",{className:"reminder-actions",children:o.jsx("button",{className:"action-btn small danger",onClick:()=>{confirm("Are you sure you want to delete this reminder?")&&wt(G.id)},children:o.jsx(js,{size:16})})})]},G.id)),ge.length===0&&o.jsxs("div",{className:"no-data",children:[o.jsx(c0,{size:48}),o.jsx("p",{children:"No reminders found"})]})]})]}),f==="statuses"&&o.jsxs("div",{className:"statuses-content",children:[o.jsx("div",{className:"section-header",children:o.jsx("h2",{children:"Status Management"})}),o.jsxs("div",{className:"statuses-list",children:[be.map(G=>o.jsxs("div",{className:"status-item",children:[o.jsxs("div",{className:"status-info",children:[o.jsxs("div",{className:"status-user",children:[o.jsx("img",{src:Yf(G.user?.avatar),alt:G.user?.name,className:"status-avatar",onError:Te=>{Te.target.src=`${baseUrl}assets/images/dp-options/00701602b0eac0390b3107b9e2a665e0.jpg`}}),o.jsx("span",{children:G.user?.name})]}),o.jsx("p",{children:G.content}),o.jsxs("div",{className:"status-meta",children:[o.jsxs("span",{children:["Views: ",G.view_count]}),o.jsxs("span",{children:["Expires: ",qe(G.expires_at)]}),o.jsxs("span",{children:["Posted: ",qe(G.created_at)]})]})]}),o.jsx("div",{className:"status-actions",children:o.jsx("button",{className:"action-btn small danger",onClick:()=>{confirm("Are you sure you want to delete this status?")&&Rn(G.id)},children:o.jsx(js,{size:16})})})]},G.id)),be.length===0&&o.jsxs("div",{className:"no-data",children:[o.jsx(bf,{size:48}),o.jsx("p",{children:"No statuses found"})]})]})]}),f==="media-transfers"&&o.jsxs("div",{className:"media-transfers-content",children:[o.jsx("div",{className:"section-header",children:o.jsx("h2",{children:"Media Transfers Management"})}),o.jsxs("div",{className:"media-transfers-list",children:[V.map(G=>o.jsxs("div",{className:"transfer-item",children:[o.jsxs("div",{className:"transfer-info",children:[o.jsx("h4",{children:G.filename}),o.jsxs("p",{children:["Original: ",G.original_filename]}),o.jsxs("div",{className:"transfer-meta",children:[o.jsxs("span",{children:["From: ",G.sender?.name]}),o.jsxs("span",{children:["To: ",G.receiver?.name]}),o.jsxs("span",{children:["Size: ",(G.file_size/1024/1024).toFixed(2)," MB"]}),o.jsxs("span",{children:["Status: ",G.status]}),o.jsxs("span",{children:["Downloads: ",G.download_count,"/",G.max_downloads]})]})]}),o.jsx("div",{className:"transfer-actions",children:o.jsx("button",{className:"action-btn small danger",onClick:()=>{confirm("Are you sure you want to delete this transfer?")&&me(G.id)},children:o.jsx(js,{size:16})})})]},G.id)),V.length===0&&o.jsxs("div",{className:"no-data",children:[o.jsx(vf,{size:48}),o.jsx("p",{children:"No media transfers found"})]})]})]}),f==="maintenance"&&o.jsxs("div",{className:"maintenance-content",children:[o.jsx("div",{className:"section-header",children:o.jsx("h2",{children:"Database Maintenance"})}),o.jsxs("div",{className:"maintenance-grid",children:[o.jsxs("div",{className:"maintenance-card",children:[o.jsx("h3",{children:"Cleanup Functions"}),o.jsxs("div",{className:"maintenance-actions",children:[o.jsxs("button",{className:"action-btn",onClick:()=>lt("cleanup_expired_sessions"),children:[o.jsx(Ui,{size:20}),"Clean Expired Sessions"]}),o.jsxs("button",{className:"action-btn",onClick:()=>lt("cleanup_expired_signaling"),children:[o.jsx(Ui,{size:20}),"Clean Expired Signaling"]}),o.jsxs("button",{className:"action-btn",onClick:()=>lt("cleanup_expired_statuses"),children:[o.jsx(Ui,{size:20}),"Clean Expired Statuses"]}),o.jsxs("button",{className:"action-btn",onClick:()=>lt("cleanup_expired_reset_tokens"),children:[o.jsx(Ui,{size:20}),"Clean Reset Tokens"]})]})]}),o.jsxs("div",{className:"maintenance-card",children:[o.jsx("h3",{children:"Message Management"}),o.jsxs("div",{className:"maintenance-actions",children:[o.jsxs("button",{className:"action-btn",onClick:()=>lt("vanish_expired_messages"),children:[o.jsx(js,{size:20}),"Vanish Expired Messages"]}),o.jsxs("button",{className:"action-btn",onClick:()=>lt("delete_vanished_messages"),children:[o.jsx(js,{size:20}),"Delete Vanished Messages"]})]})]}),o.jsxs("div",{className:"maintenance-card",children:[o.jsx("h3",{children:"Content Management"}),o.jsx("div",{className:"maintenance-actions",children:o.jsxs("button",{className:"action-btn",onClick:()=>lt("cleanup_old_news_articles"),children:[o.jsx(ci,{size:20}),"Clean Old News Articles"]})})]})]})]})]})]}),Ce.open&&o.jsx("div",{className:"modal-overlay",children:o.jsxs("div",{className:"modal-content response-modal",children:[o.jsxs("div",{className:"modal-header",children:[o.jsx("h3",{children:"Respond to Support Message"}),o.jsx("button",{className:"close-btn",onClick:()=>Je({open:!1,messageId:null,userName:"",message:""}),children:""})]}),o.jsxs("div",{className:"modal-body",children:[o.jsxs("div",{className:"original-message",children:[o.jsxs("h4",{children:["From: ",Ce.userName]}),o.jsx("p",{children:Ce.message})]}),o.jsxs("div",{className:"response-form",children:[o.jsx("label",{htmlFor:"response",children:"Your Response:"}),o.jsx("textarea",{id:"response",value:mt,onChange:G=>Wt(G.target.value),placeholder:"Type your response to the user...",rows:6})]})]}),o.jsxs("div",{className:"modal-footer",children:[o.jsx("button",{className:"btn-secondary",onClick:()=>Je({open:!1,messageId:null,userName:"",message:""}),children:"Cancel"}),o.jsx("button",{className:"btn-primary",onClick:Qt,disabled:!mt.trim(),children:"Send Response"})]})]})})]}):o.jsx("div",{className:"admin-container",children:o.jsx("div",{className:"admin-blank",children:o.jsxs("div",{className:"blank-content",children:[o.jsx(oi,{size:64}),o.jsx("h2",{children:"Access Restricted"}),o.jsx("p",{children:"You don't have permission to access this panel."})]})})})},qA=({onComplete:i})=>{const n=us(),{isDark:a}=Jo(),l=a,d=l?"#25D366":"#00a884";return M.useEffect(()=>{const f=setTimeout(()=>{const v=new URLSearchParams(window.location.search).get("redirect");n(v==="login"?"/login":"/"),i()},3e3);return()=>clearTimeout(f)},[n,i]),o.jsxs("div",{className:`intro-overlay transition-colors duration-500 overflow-hidden
      ${l?"bg-[#111b21]":"bg-white"}`,children:[o.jsx("style",{children:`
        /* 1. BALL ANIMATION */
        @keyframes ballDrop {
          0% { transform: translateY(-80px) scale(1); opacity: 1; }
          30% { transform: translateY(0) scale(1); opacity: 1; }
          35% { transform: translateY(5px) scale(1.4, 0.6); opacity: 1; }
          36% { opacity: 0; }
          90% { opacity: 0; }
          91% { transform: translateY(0) scale(1); opacity: 1; }
          100% { transform: translateY(-80px) scale(1); opacity: 1; }
        }

        /* 2. LOGO REVEAL */
        @keyframes logoCycle {
          0%, 35% { transform: scale(0); opacity: 0; }
          36% { transform: scale(1.2, 0.8); opacity: 1; }
          45% { transform: scale(1); opacity: 1; }
          85% { transform: scale(1); opacity: 1; }
          90% { transform: scale(0); opacity: 0; }
          100% { transform: scale(0); opacity: 0; }
        }

        /* 3. STROKE DRAWING */
        @keyframes drawStroke {
          0%, 35% { stroke-dashoffset: 200; }
          50% { stroke-dashoffset: 0; }
          85% { stroke-dashoffset: 0; }
          90% { stroke-dashoffset: 200; }
        }

        /* 4. TEXT SLIDE */
        @keyframes textSlide {
          0%, 40% { opacity: 0; transform: translateX(-20px); }
          50% { opacity: 1; transform: translateX(0); }
          85% { opacity: 1; transform: translateX(0); }
          90% { opacity: 0; transform: translateX(-10px); }
        }

        /* 5. DOT WAVE (Improved) */
        @keyframes dotWave {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-4px); }
        }

        /* 6. SHOCKWAVE RIPPLE (New) */
        @keyframes rippleEffect {
          0%, 30% { width: 0px; height: 0px; opacity: 0; border-width: 0px; }
          31% { width: 10px; height: 5px; opacity: 0.8; border-width: 4px; }
          50% { width: 120px; height: 20px; opacity: 0; border-width: 0px; }
          100% { width: 120px; height: 20px; opacity: 0; border-width: 0px; }
        }

        /* 7. SPLASH PARTICLES (New) */
        @keyframes splashOut {
          0%, 30% { transform: translate(0,0) scale(0); opacity: 0; }
          31% { transform: translate(0,0) scale(1); opacity: 1; }
          45% { opacity: 0; } /* Fade out quickly as they move */
          100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
        }

        @keyframes shadowJump {
          0%, 100% { transform: scale(0.3); opacity: 0.1; }
          35% { transform: scale(1.2); opacity: 0.4; }
          90% { transform: scale(0.3); opacity: 0.1; }
        }
      `}),o.jsxs("div",{className:"relative flex flex-col items-center h-48 justify-center",children:[o.jsx("div",{className:"absolute top-[50%] left-[50%] w-0 h-0 z-0",children:[...Array(6)].map((f,x)=>{const v=x*60*(Math.PI/180),C=40,w=Math.cos(v)*C+"px",A=Math.sin(v)*C-20+"px";return o.jsx("div",{className:"absolute w-1.5 h-1.5 rounded-full",style:{backgroundColor:d,"--tx":w,"--ty":A,animation:"splashOut 3s ease-out infinite"}},x)})}),o.jsx("div",{className:"absolute w-5 h-5 rounded-full z-20",style:{backgroundColor:d,animation:"ballDrop 3s cubic-bezier(0.45, 0, 0.55, 1) infinite"}}),o.jsx("div",{className:"relative z-10 flex items-center justify-center",style:{animation:"logoCycle 3s cubic-bezier(0.175, 0.885, 0.32, 1.275) infinite",transformOrigin:"bottom center"},children:o.jsxs("svg",{width:"180",height:"80",viewBox:"0 0 180 80",className:"overflow-visible",children:[o.jsxs("g",{transform:"translate(40, 40)",children:[o.jsx("path",{d:"M 25 -15 A 28 28 0 1 0 25 20",fill:"none",stroke:d,strokeWidth:"7",strokeLinecap:"round",strokeDasharray:"200",style:{animation:"drawStroke 3s ease-in-out infinite"},transform:"rotate(-15)"}),o.jsx("path",{d:"M -15 22 L -25 35 L -5 27 Z",fill:d,style:{animation:"logoCycle 3s infinite"}}),o.jsx("circle",{cx:"-12",cy:"5",r:"4.5",fill:d,style:{animation:"dotWave 1s ease-in-out infinite",animationDelay:"0s"}}),o.jsx("circle",{cx:"0",cy:"5",r:"4.5",fill:d,style:{animation:"dotWave 1s ease-in-out infinite",animationDelay:"0.15s"}}),o.jsx("circle",{cx:"12",cy:"5",r:"4.5",fill:d,style:{animation:"dotWave 1s ease-in-out infinite",animationDelay:"0.3s"}})]}),o.jsx("text",{x:"80",y:"58",fontFamily:"Arial, sans-serif",fontWeight:"bold",fontSize:"48",fill:d,style:{animation:"textSlide 3s ease-out infinite"},children:"aBa"})]})}),o.jsx("div",{className:"absolute bottom-6 rounded-[100%] border-solid box-border z-0",style:{borderColor:d,animation:"rippleEffect 3s linear infinite"}}),o.jsx("div",{className:`absolute bottom-6 w-16 h-1.5 rounded-full blur-sm transition-colors duration-500
            ${l?"bg-black/40":"bg-gray-400/40"}`,style:{animation:"shadowJump 3s cubic-bezier(0.45, 0, 0.55, 1) infinite"}})]}),o.jsx("div",{className:"mt-8 text-center",children:o.jsx("p",{className:"text-xs font-bold tracking-[0.3em] uppercase transition-colors duration-500",style:{color:d,opacity:.8},children:"Loading"})})]})};function VA(){const{callId:i}=Zu(),n=us(),{callState:a,callType:l,localStream:d,remoteStream:f,callerInfo:x,receiverInfo:v,isMuted:C,isVideoOff:w,isSpeakerOn:A,callDuration:N,endCall:R,toggleMute:T,toggleVideo:O,switchCamera:L}=hi(),B=M.useRef(null),H=M.useRef(null),[U,P]=M.useState(!0);M.useEffect(()=>{B.current&&d&&(B.current.srcObject=d)},[d]),M.useEffect(()=>{H.current&&f&&(H.current.srcObject=f)},[f]),M.useEffect(()=>{if(a==="connected"){const J=setTimeout(()=>P(!1),5e3);return()=>clearTimeout(J)}},[a,U]),M.useEffect(()=>{["calling","connecting","connected"].includes(a)||n("/",{replace:!0})},[a,n]);const K=J=>{const q=Math.floor(J/60),he=J%60;return`${q.toString().padStart(2,"0")}:${he.toString().padStart(2,"0")}`},Z=x||v,W=l==="video",X=async()=>{await R(),n("/",{replace:!0})};return o.jsxs("div",{className:"min-h-screen bg-gray-900",children:[o.jsx("div",{className:`fixed top-0 left-0 right-0 z-10 bg-black/80 backdrop-blur-sm transition-opacity ${U?"opacity-100":"opacity-0"}`,children:o.jsxs("div",{className:"flex items-center justify-between p-4",children:[o.jsx("button",{onClick:()=>n(-1),className:"p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors",children:o.jsx($o,{className:"w-5 h-5 text-white"})}),o.jsxs("div",{className:"text-center flex-1",children:[o.jsxs("p",{className:"text-white/60 text-sm",children:[a==="calling"&&" Calling...",a==="connecting"&&" Connecting...",a==="connected"&&K(N)]}),o.jsx("h3",{className:"text-white font-semibold text-lg",children:Z?.name||"Unknown"})]}),o.jsx("div",{className:"w-10"})," "]})}),o.jsxs("div",{className:"h-screen flex items-center justify-center cursor-pointer",onClick:()=>P(!U),children:[W&&o.jsx("video",{ref:H,autoPlay:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"}),!W&&o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-800 to-gray-900 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"w-40 h-40 mx-auto rounded-full overflow-hidden ring-4 ring-white/20 mb-6",children:Z?.avatar?o.jsx("img",{src:Z.avatar,alt:Z.name,className:"w-full h-full object-cover"}):o.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-6xl font-bold text-white",children:Z?.name?.charAt(0)||"?"})}),o.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:Z?.name||"Unknown"}),o.jsxs("p",{className:"text-white/60",children:[a==="calling"&&"Calling...",a==="connecting"&&"Connecting...",a==="connected"&&`Connected  ${K(N)}`]})]})}),W&&d&&o.jsxs("div",{className:"absolute top-20 right-4 w-32 h-44 rounded-2xl overflow-hidden shadow-2xl border-2 border-white/20",children:[o.jsx("video",{ref:B,autoPlay:!0,playsInline:!0,muted:!0,className:`w-full h-full object-cover ${w?"hidden":""}`}),w&&o.jsx("div",{className:"w-full h-full bg-gray-800 flex items-center justify-center",children:o.jsx(Vp,{className:"w-8 h-8 text-gray-500"})})]})]}),o.jsx("div",{className:`fixed bottom-0 left-0 right-0 z-10 bg-black/80 backdrop-blur-sm p-8 transition-opacity ${U?"opacity-100":"opacity-0"}`,children:o.jsxs("div",{className:"flex justify-center items-center gap-6",children:[o.jsx("button",{onClick:J=>{J.stopPropagation(),T()},className:`w-14 h-14 rounded-full flex items-center justify-center transition-all ${C?"bg-red-500":"bg-white/20 hover:bg-white/30"}`,children:C?o.jsx(dS,{className:"w-6 h-6 text-white"}):o.jsx(fS,{className:"w-6 h-6 text-white"})}),W&&o.jsx("button",{onClick:J=>{J.stopPropagation(),O()},className:`w-14 h-14 rounded-full flex items-center justify-center transition-all ${w?"bg-red-500":"bg-white/20 hover:bg-white/30"}`,children:w?o.jsx(Vp,{className:"w-6 h-6 text-white"}):o.jsx(fi,{className:"w-6 h-6 text-white"})}),o.jsx("button",{onClick:J=>{J.stopPropagation(),X()},className:"w-16 h-16 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center transition-all shadow-lg shadow-red-500/30",children:o.jsx(D0,{className:"w-7 h-7 text-white"})}),W&&o.jsx("button",{onClick:J=>{J.stopPropagation(),L()},className:"w-14 h-14 rounded-full bg-white/20 hover:bg-white/30 flex items-center justify-center transition-all",children:o.jsx(OS,{className:"w-6 h-6 text-white"})}),!W&&o.jsx("button",{onClick:J=>J.stopPropagation(),className:`w-14 h-14 rounded-full flex items-center justify-center transition-all ${A?"bg-blue-500":"bg-white/20 hover:bg-white/30"}`,children:A?o.jsx(eE,{className:"w-6 h-6 text-white"}):o.jsx(nE,{className:"w-6 h-6 text-white"})})]})})]})}function GA(){const i=us(),{callState:n,callType:a,callId:l,callerInfo:d,receiverInfo:f,endCall:x}=hi();if(!["calling","connecting","connected"].includes(n))return null;const v=d||f,C=a==="video",w=()=>{l&&i(`/call/${l}`)},A=N=>{N.stopPropagation(),x()};return o.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-green-500 text-white px-4 py-2 rounded-full shadow-lg cursor-pointer hover:bg-green-600 transition-colors flex items-center gap-2 animate-pulse",onClick:w,title:"Click to view active call",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[C?o.jsx(fi,{size:16}):o.jsx(Hs,{size:16}),o.jsxs("span",{className:"text-sm font-medium",children:[n==="calling"&&"Calling...",n==="connecting"&&"Connecting...",n==="connected"&&"On Call"]})]}),o.jsx("span",{className:"text-sm max-w-24 truncate",children:v?.name||"Unknown"}),o.jsx("button",{onClick:A,className:"ml-2 bg-red-500 hover:bg-red-600 rounded-full p-1 transition-colors",title:"End Call",children:o.jsx(D0,{size:14})})]})}const YA=()=>{const{user:i,loading:n,isAuthenticated:a}=Xa();return null},XA="__capgo_keep_url_path_after_reload",Xf="__capgo_history_stack__",Lx=100,WA=typeof window<"u"&&typeof document<"u"&&typeof history<"u";if(WA){const i=window;if(!i.__capgoHistoryPatched){i.__capgoHistoryPatched=!0;const n=()=>{try{if(i.__capgoKeepUrlPathAfterReload)return!0}catch{}try{return window.localStorage.getItem(XA)==="1"}catch{return!1}},a=()=>{try{const Z=window.sessionStorage.getItem(Xf);if(!Z)return{stack:[],index:-1};const W=JSON.parse(Z);return!W||!Array.isArray(W.stack)||typeof W.index!="number"?{stack:[],index:-1}:W}catch{return{stack:[],index:-1}}},l=(Z,W)=>{try{window.sessionStorage.setItem(Xf,JSON.stringify({stack:Z,index:W}))}catch{}},d=()=>{try{window.sessionStorage.removeItem(Xf)}catch{}},f=Z=>{try{const W=Z??window.location.href,X=new URL(W instanceof URL?W.toString():W,window.location.href);return`${X.pathname}${X.search}${X.hash}`}catch{return null}},x=(Z,W)=>{if(Z.length<=Lx)return{stack:Z,index:W};const X=Z.length-Lx,J=Z.slice(X),q=Math.max(0,W-X);return{stack:J,index:q}},v=Z=>{document.readyState==="complete"||document.readyState==="interactive"?Z():window.addEventListener("DOMContentLoaded",Z,{once:!0})};let C=!1,w=!1,A=!1;const N=()=>{if(!C)return;const Z=a(),W=f();if(W){if(Z.stack.length===0){Z.stack.push(W),Z.index=0,l(Z.stack,Z.index);return}(Z.index<0||Z.index>=Z.stack.length)&&(Z.index=Z.stack.length-1),Z.stack[Z.index]!==W&&(Z.stack[Z.index]=W,l(Z.stack,Z.index))}},R=(Z,W)=>{if(!C||w)return;const X=f(Z);if(!X)return;let{stack:J,index:q}=a();J.length===0?(J.push(X),q=J.length-1):W?((q<0||q>=J.length)&&(q=J.length-1),J[q]=X):q>=J.length-1?(J.push(X),q=J.length-1):(J=J.slice(0,q+1),J.push(X),q=J.length-1),{stack:J,index:q}=x(J,q),l(J,q)},T=()=>{if(!C||w)return;const Z=a();if(Z.stack.length===0){N();return}const W=Z.index>=0&&Z.index<Z.stack.length?Z.index:Z.stack.length-1,X=f();if(Z.stack.length===1&&X===Z.stack[0])return;const J=Z.stack[0];if(!J)return;w=!0;try{history.replaceState(history.state,document.title,J);for(let ge=1;ge<Z.stack.length;ge+=1)history.pushState(history.state,document.title,Z.stack[ge])}catch{w=!1;return}w=!1;const q=Z.stack.length-1,he=W-q;he!==0?history.go(he):(history.replaceState(history.state,document.title,Z.stack[W]),window.dispatchEvent(new PopStateEvent("popstate")))},O=()=>{!C||A||(A=!0,v(()=>{A=!1,T()}))};let L=null,B=null;const H=()=>{if(!C||w)return;const Z=f();if(!Z)return;const W=a(),X=W.stack.lastIndexOf(Z);X>=0?W.index=X:(W.stack.push(Z),W.index=W.stack.length-1);const J=x(W.stack,W.index);l(J.stack,J.index)},U=()=>{L&&B||(L=history.pushState,B=history.replaceState,history.pushState=function(W,X,J){const q=L.call(history,W,X,J);return R(J,!1),q},history.replaceState=function(W,X,J){const q=B.call(history,W,X,J);return R(J,!0),q},window.addEventListener("popstate",H))},P=()=>{L&&(history.pushState=L,L=null),B&&(history.replaceState=B,B=null),window.removeEventListener("popstate",H)},K=Z=>{if(C===Z){C&&(N(),O());return}C=Z,C?(U(),N(),O()):(P(),d())};window.addEventListener("CapacitorUpdaterKeepUrlPathAfterReload",Z=>{var W;const X=Z,J=(W=X?.detail)===null||W===void 0?void 0:W.enabled;typeof J=="boolean"?(i.__capgoKeepUrlPathAfterReload=J,K(J)):(i.__capgoKeepUrlPathAfterReload=!0,K(!0))}),K(n())}}const QA=Xi("CapacitorUpdater",{web:()=>td(()=>import("./web-ClXBcAyh.js"),[],import.meta.url).then(i=>new i.CapacitorUpdaterWeb)});var qo;(function(i){i.Prompt="PROMPT",i.Camera="CAMERA",i.Photos="PHOTOS"})(qo||(qo={}));var Zl;(function(i){i.Rear="REAR",i.Front="FRONT"})(Zl||(Zl={}));var Bx;(function(i){i.Uri="uri",i.Base64="base64",i.DataUrl="dataUrl"})(Bx||(Bx={}));class KA extends nd{async getPhoto(n){return new Promise(async(a,l)=>{if(n.webUseInput||n.source===qo.Photos)this.fileInputExperience(n,a,l);else if(n.source===qo.Prompt){let d=document.querySelector("pwa-action-sheet");d||(d=document.createElement("pwa-action-sheet"),document.body.appendChild(d)),d.header=n.promptLabelHeader||"Photo",d.cancelable=!1,d.options=[{title:n.promptLabelPhoto||"From Photos"},{title:n.promptLabelPicture||"Take Picture"}],d.addEventListener("onSelection",async f=>{f.detail===0?this.fileInputExperience(n,a,l):this.cameraExperience(n,a,l)})}else this.cameraExperience(n,a,l)})}async pickImages(n){return new Promise(async(a,l)=>{this.multipleFileInputExperience(a,l)})}async cameraExperience(n,a,l){if(customElements.get("pwa-camera-modal")){const d=document.createElement("pwa-camera-modal");d.facingMode=n.direction===Zl.Front?"user":"environment",document.body.appendChild(d);try{await d.componentOnReady(),d.addEventListener("onPhoto",async f=>{const x=f.detail;x===null?l(new Go("User cancelled photos app")):x instanceof Error?l(x):a(await this._getCameraPhoto(x,n)),d.dismiss(),document.body.removeChild(d)}),d.present()}catch{this.fileInputExperience(n,a,l)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(n,a,l)}fileInputExperience(n,a,l){let d=document.querySelector("#_capacitor-camera-input");const f=()=>{var x;(x=d.parentNode)===null||x===void 0||x.removeChild(d)};d||(d=document.createElement("input"),d.id="_capacitor-camera-input",d.type="file",d.hidden=!0,document.body.appendChild(d),d.addEventListener("change",x=>{const v=d.files[0];let C="jpeg";if(v.type==="image/png"?C="png":v.type==="image/gif"&&(C="gif"),n.resultType==="dataUrl"||n.resultType==="base64"){const w=new FileReader;w.addEventListener("load",()=>{if(n.resultType==="dataUrl")a({dataUrl:w.result,format:C});else if(n.resultType==="base64"){const A=w.result.split(",")[1];a({base64String:A,format:C})}f()}),w.readAsDataURL(v)}else a({webPath:URL.createObjectURL(v),format:C}),f()}),d.addEventListener("cancel",x=>{l(new Go("User cancelled photos app")),f()})),d.accept="image/*",d.capture=!0,n.source===qo.Photos||n.source===qo.Prompt?d.removeAttribute("capture"):n.direction===Zl.Front?d.capture="user":n.direction===Zl.Rear&&(d.capture="environment"),d.click()}multipleFileInputExperience(n,a){let l=document.querySelector("#_capacitor-camera-input-multiple");const d=()=>{var f;(f=l.parentNode)===null||f===void 0||f.removeChild(l)};l||(l=document.createElement("input"),l.id="_capacitor-camera-input-multiple",l.type="file",l.hidden=!0,l.multiple=!0,document.body.appendChild(l),l.addEventListener("change",f=>{const x=[];for(let v=0;v<l.files.length;v++){const C=l.files[v];let w="jpeg";C.type==="image/png"?w="png":C.type==="image/gif"&&(w="gif"),x.push({webPath:URL.createObjectURL(C),format:w})}n({photos:x}),d()}),l.addEventListener("cancel",f=>{a(new Go("User cancelled photos app")),d()})),l.accept="image/*",l.click()}_getCameraPhoto(n,a){return new Promise((l,d)=>{const f=new FileReader,x=n.type.split("/")[1];a.resultType==="uri"?l({webPath:URL.createObjectURL(n),format:x,saved:!1}):(f.readAsDataURL(n),f.onloadend=()=>{const v=f.result;a.resultType==="dataUrl"?l({dataUrl:v,format:x,saved:!1}):l({base64String:v.split(",")[1],format:x,saved:!1})},f.onerror=v=>{d(v)})})}async checkPermissions(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}const ZA=Xi("Camera",{web:()=>new KA}),$A=Xi("App",{web:()=>td(()=>import("./web-Tn47pWLp.js"),[],import.meta.url).then(i=>new i.AppWeb)}),JA=()=>{const{supabase:i,validateSessionAndRefresh:n,ensureConnected:a}=ds();M.useEffect(()=>{const l=()=>{console.log("Visibility changed:",document.visibilityState),document.visibilityState==="visible"&&(console.log("App resumed, validating session..."),n&&n())};document.addEventListener("visibilitychange",l);let d;ui.isNativePlatform()&&(d=$A.addListener("appStateChange",x=>{console.log("App state changed:",x),x.isActive&&(console.log("App resumed on native, validating session..."),n&&n())}));const f=x=>{a&&!a()&&(x.preventDefault(),x.stopImmediatePropagation())};return document.addEventListener("click",f,!0),()=>{document.removeEventListener("visibilitychange",l),document.removeEventListener("click",f,!0),d&&d.remove()}},[i,n,a])};QA.notifyAppReady();const bs=({children:i})=>{const{user:n,loading:a,isAuthenticated:l}=Xa();return a?o.jsx(Gi,{}):l?i:o.jsx(Qx,{to:"/login",replace:!0})},Lu=({children:i})=>{const{isAuthenticated:n,loading:a}=Xa();return a?o.jsx(Gi,{}):n?o.jsx(Qx,{to:"/",replace:!0}):i},eN=({children:i})=>{const{user:n}=Xa();return o.jsx(o_,{currentUser:n,children:i})};function tN(){const[i,n]=M.useState(!0),{supabase:a}=ds();return JA(),M.useEffect(()=>{const{pathname:l,search:d}=window.location;if(d.startsWith("?/")){const f=d.slice(2).replace(/~and~/g,"&");window.history.replaceState(null,"",l+f)}if(a){const{data:{subscription:f}}=a.auth.onAuthStateChange(async(x,v)=>{x==="SIGNED_IN"&&v?.user&&console.log("Google OAuth success, redirecting to home")});return()=>f?.unsubscribe()}},[a]),M.useEffect(()=>{(async()=>{if(ui.isNativePlatform())try{const d=await ZA.requestPermissions();d.camera==="granted"||d.camera==="limited"?console.log("Camera Permission Granted by Android!"):console.log("Camera Permission Denied!")}catch(d){console.error("Error asking permissions:",d)}})()},[]),o.jsxs(eN,{children:[i?o.jsx(qA,{onComplete:()=>n(!1)}):o.jsxs(Fb,{children:[o.jsx(Fn,{path:"/",element:o.jsx(bs,{children:o.jsx(yE,{})})}),o.jsx(Fn,{path:"/login",element:o.jsx(Lu,{children:o.jsx(l_,{})})}),o.jsx(Fn,{path:"/signup",element:o.jsx(Lu,{children:o.jsx(c_,{})})}),o.jsx(Fn,{path:"/forgot-password",element:o.jsx(Lu,{children:o.jsx(u_,{})})}),o.jsx(Fn,{path:"/reset-password",element:o.jsx(Lu,{children:o.jsx(d_,{})})}),o.jsx(Fn,{path:"/chat/:chatId/:otherUserId",element:o.jsx(bs,{children:o.jsx(f0,{})})}),o.jsx(Fn,{path:"/chat/new/:userId",element:o.jsx(bs,{children:o.jsx(f0,{})})}),o.jsx(Fn,{path:"/call/:callId",element:o.jsx(bs,{children:o.jsx(VA,{})})}),o.jsx(Fn,{path:"/profile",element:o.jsx(bs,{children:o.jsx(jA,{})})}),o.jsx(Fn,{path:"/settings",element:o.jsx(bs,{children:o.jsx(RA,{})})}),o.jsx(Fn,{path:"/news",element:o.jsx(bs,{children:o.jsx(IA,{})})}),o.jsx(Fn,{path:"/reminders",element:o.jsx(bs,{children:o.jsx(OA,{})})}),o.jsx(Fn,{path:"/create-reminder",element:o.jsx(bs,{children:o.jsx(MA,{})})}),o.jsx(Fn,{path:"/calls",element:o.jsx(bs,{children:o.jsx(LA,{})})}),o.jsx(Fn,{path:"/qr",element:o.jsx(bs,{children:o.jsx(TA,{})})}),o.jsx(Fn,{path:"/blocked",element:o.jsx(bs,{children:o.jsx(BA,{})})}),o.jsx(Fn,{path:"/about",element:o.jsx(bs,{children:o.jsx(zA,{})})}),o.jsx(Fn,{path:"/support",element:o.jsx(bs,{children:o.jsx(FA,{})})}),o.jsx(Fn,{path:"/admin",element:o.jsx(bs,{children:o.jsx(HA,{})})}),o.jsx(Fn,{path:"/user-details/:id",element:o.jsx(bs,{children:o.jsx(UA,{})})}),o.jsx(Fn,{path:"/shared-profile/:id",element:o.jsx(bs,{children:o.jsx(PA,{})})})]}),o.jsx(GA,{}),o.jsx(Cy,{}),o.jsx(YA,{})]})}Kw.createRoot(document.getElementById("root")).render(o.jsx(M.StrictMode,{children:o.jsx(uv,{children:o.jsx(V3,{children:o.jsx(s_,{children:o.jsx(fE,{children:o.jsx(h_,{children:o.jsx(tN,{})})})})})})}));export{nd as W};
